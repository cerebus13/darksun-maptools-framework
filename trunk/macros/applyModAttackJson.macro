[h:arrayJson       = arg(0)]
[h:tokenName       = arg(1)]

[h: updateTargetProperty("AllAtkModList",arrayJson,tokenName)]
[h: AllModifier = "{}"]
[h: HitModifier = "{}"]
[h: DamageModifier = "{}"]

[for(i,0,json.length(arrayJson),1,""), CODE:
{
  [h:mod = json.get(arrayJson, i)]
  [h:attack = json.get(mod, "modAtk")]
  [h:value = json.get(mod, "modValue")]
  [h:modName = json.get(mod, "modName")]
  [h:modJson = '{'+modName+':'+value+'}']
  [h,SWITCH(attack):
    case 0: AllModifier = json.merge(AllModifier, modJson);
    case 1: HitModifier = json.merge(HitModifier, modJson);
    case 2: DamageModifier = json.merge(DamageModifier, modJson);
    default: ""
  ]
}]
[h: propHitTargetJson = json.merge(HitModifier, AllModifier)]
[h: propDamageTargetJson = json.merge(DamageModifier, AllModifier)]
[h: updateTargetProperty("AttackBonuses", propHitTargetJson, tokenName)]
[h: updateTargetProperty("DamageBonuses", propDamageTargetJson, tokenName)]