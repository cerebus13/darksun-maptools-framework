@@ @onCampaignLoad
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet ; tooltip= ; minWidth= ; 
[h:defineFunction("die100", "die100@"+getMacroLocation(), 0, 0 ) ]
[h: selectedCount=listCount(getSelected())]
[frame("Sheet"):{
<html>
<link rel="onChangeSelection" type="macro" href="[r: macroLinkText('SheetLoad@this', 'none','','selected')]"></link>
<head><title>Character Sheet</title></head>
<body>
			<table width="100%">
				<tr>
					<td align="center"><image src='[r: tableImage("Icons",1,300)]' border="0" align="middle"></image><br>
						<font size = "5"><b>Loaded<br>Please select a token you own</b></font>
					</td>
				</tr>
			</table>
		}
	]
</body>
</html>
}]

!!
@@ @AbilitiesDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
<table width="100%" cellpadding="0" border="1" bgcolor="white">
<table border="0" cellpadding="2" width="100%">

	<tr bgcolor="[r: table(PageColor,2)]">
		<td  valign="middle" colspan="2">&nbsp; &nbsp; <font color="white"><b>APTITUDES</b></font>
		</td>
		<td  align="right" colspan="2"><a href='[r:macroLinkText("TraitsUpdateDialog@this","none","", currentToken())]'><image src='[r: tableImage("Buttons", 5)]' border="0" align="middle"></image></a>&nbsp; 
		</td>		
	</tr>[h: num = 1]
[h: abilityList = "COG,COO,INT,REF,SAV,SOM,WIL"]
[foreach(abl, abilityList,""),code:{

[if(roll.count == 0||roll.count==4),code:{<tr>}; {}]
		<td>
			<table width="100%">
				[h:jsonData=json.set("{}","name",abl,"rank",getProperty(abl),"modifier",0)]
				<tr><td bgcolor="[r: table(PageColor,2)]" color="white" align="center" width="100%"><font color="white"><b><a href='[r:macroLinkText("d20Check@this","all",jsonData, currentToken())]'>[r: table("Aptitudes",num)]</a></b>
					</td>
				</tr>
				<tr>
		[h: jsonData = json.append("[]",abl,getProperty(abl),"Ability")]	<td align="center" width="100%" bgcolor="[r: table(PageColor,3)]"><font color="black"><a href='[r:macroLinkText("Entry@this","none",jsonData, currentToken())]'><b>[r: getProperty(abl)]</b></font></a>
					</td>
				</tr>
			</table>
		</td>

[if(roll.count == 3||roll.count==7),code:{</tr>}; {}]
[h: num = num+1]
}]
				</tr>
			</table>
		</td>
	</tr>
</table>

!!
@@ @AptitudesDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
<table width="100%" cellpadding="0" border="1" bgcolor="white">
<table border="0" cellpadding="2" width="100%">

	<tr bgcolor="[r: table(PageColor,2)]">
		<td  valign="middle" colspan="2">&nbsp; &nbsp; <font color="white"><b>APTITUDES</b></font>
		</td>
		<td  align="right" colspan="2"><a href='[r:macroLinkText("AptitudesUpdateDialog@this","none","", currentToken())]'><image src='[r: tableImage("Buttons", 5)]' border="0" align="middle"></image></a>&nbsp; 
		</td>		
	</tr>[h: num = 1]
[h: abilityList = "COG,COO,INT,REF,SAV,SOM,WIL"]
[foreach(abl, abilityList,""),code:{

[if(roll.count == 0||roll.count==4),code:{<tr>}; {}]
		<td>
			<table width="100%">
				[h:jsonData=json.set("{}","targetNumber",getProperty(abl)*3,"mods",0,"rollerName",getName(currentToken()),"rollTitle",strformat("default %s Aptitude check",abl))]
				<tr><td bgcolor="[r: table(PageColor,2)]" color="white" align="center" width="100%"><font color="white"><b><a href='[r:macroLinkText("die100@this","all",jsonData, currentToken())]'>[r: table("Aptitudes",num)]</a></b>
					</td>
				</tr>
				<tr>
		[h: jsonData = json.append("[]",abl,strformat(" %s Aptitude check",abl),"Aptitude")]	<td align="center" width="100%" bgcolor="[r: table(PageColor,3)]"><font color="black"><a href='[r:macroLinkText("Entry@this","none",jsonData, currentToken())]'><b>[r: getProperty(abl)]</b></font></a>
					</td>
				</tr>
			</table>
		</td>

[if(roll.count == 3||roll.count==7),code:{</tr>}; {}]
[h: num = num+1]
}]
				</tr>
			</table>
		</td>
	</tr>
</table>

!!
@@ @StatsDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
<table width="100%" cellpadding="0" border="1" bgcolor="white">
<table border="0" cellpadding="2" width="100%">

	<tr bgcolor="[r: table(PageColor,2)]">
		<td  valign="middle" colspan="2">&nbsp; &nbsp; <font color="white"><b>STATS</b></font>
		</td>
		<td  align="right" colspan="3"><a href='[r:macroLinkText("StatsUpdateDialog@this","none","", currentToken())]'><image src='[r: tableImage("Buttons", 5)]' border="0" align="middle"></image></a>&nbsp; 
		</td>		
	</tr>
  <tr>
    <td>
			<table width="100%">
				[h:jsonData=json.set("{}","rollerName",getName(currentToken()))]
				<tr>
          <td bgcolor="[r: table(PageColor,2)]" color="white" align="center" width="100%">
            <font color="white"><b><a href='[r:macroLinkText("UseMoxie@this","all",jsonData,currentToken())]'>[r: strformat("MOX (%s)",getProperty("MOX_base"))]</a></b></font>
					</td>
				</tr>
				<tr>
          [h: jsonData = json.append("[]","MOX",getProperty("MOX"),"Moxie",getName(currentToken()))]	
          <td align="center" width="100%" bgcolor="[r: table(PageColor,3)]">
            <font color="black"><a href='[r:macroLinkText("Entry@this","none",jsonData, currentToken())]'><b>[r: getProperty("MOX")]</b></font></a>
					</td>
				</tr>
			</table>
		</td>
    [h: statList = "TT,LUC,IR,WT,DUR,DR,INIT,SPD,DB"]    
    [h: num = 2]
    [foreach(stat, statList,""),code:{

    [if(roll.count==4),code:{<tr>}; {}]
		<td>
			<table width="100%">
				[h:jsonData=json.append("[]",stat)]
				<tr>
          <td bgcolor="[r: table(PageColor,2)]" color="white" align="center" width="100%">
            <font color="white"><b><a href='[r:macroLinkText("StatsInfoDisplay@this","none",jsonData, currentToken())]'>[r: table("Stats",num)]</a></b></font>
					</td>
				</tr>
				<tr>
          <td align="center" width="100%" bgcolor="[r: table(PageColor,3)]">
            <font color="black"><b>[r: getProperty(stat)]</b></font>
					</td>
				</tr>
			</table>
		</td>

    [if(roll.count == 4||roll.count==9),code:{</tr>}; {}]
    [h: num = num+1]
    }]
				</tr>
			</table>
		</td>
	</tr>
</table>

!!
@@ @DamageStressDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
<table width="100%" cellpadding="0" border="1" bgcolor="white">
<table border="0" cellpadding="2" width="100%">

	<tr bgcolor="[r: table(PageColor,2)]">
		<td  valign="middle" colspan="2">&nbsp; &nbsp; <font color="white"><b><a href='[r:macroLinkText("DerangementDisorderInfoDisplay@this","none","",currentToken())]'>DAMAGE & STRESS</a></b></font>
		</td>
		<td  align="right" colspan="2"><a href='[r:macroLinkText("DamageStressUpdateDialog@this","none","", currentToken())]'><image src='[r: tableImage("Buttons", 5)]' border="0" align="middle"></image></a>&nbsp; 
		</td>		
	</tr>[h: num = 1]
[h: statList = "DAMAGE,WOUNDS,STRESS,TRAUMA"]
[foreach(stat, statList,""),code:{

[if(roll.count == 0||roll.count==5),code:{<tr>}; {}]
		<td>
			<table width="100%">
				[h:jsonData=json.append("[]",stat)]
				<tr>
          <td bgcolor="[r: table(PageColor,2)]" color="white" align="center" width="100%">
            <font color="white"><b><a href='[r:macroLinkText("DamageStressInfoDisplay@this","none",jsonData, currentToken())]'>[r: table("DamageStress",num)]</a></b>
					</td>
				</tr>
				<tr>
          <td align="center" width="100%" bgcolor="[r: table(PageColor,3)]">
            [h:jsonData=json.append("[]",stat)]
            <font color="black"><a href='[r:macroLinkText("DSUpdate@this","all",jsonData,currentToken())]'><b>[r: getProperty(stat)]</b></font></a>
					</td>
				</tr>
			</table>
		</td>

[if(roll.count == 4||roll.count==9),code:{</tr>}; {}]
[h: num = num+1]
}]
				</tr>
			</table>
		</td>
	</tr>
</table>

!!
@@ @RepDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
<table width="100%" cellpadding="0" border="1" bgcolor="white">
<table border="0" cellpadding="2" width="100%">

	<tr bgcolor="[r: table(PageColor,2)]">
		<td valign="middle" colspan="2">
      &nbsp; &nbsp; <font color="white"><b><a href='[r:macroLinkText("ReputationInfoDisplay@this","none","",currentToken())]'>REPUTATION</a></b></font>
		</td>
		<td align="right" colspan="2"><a href='[r:macroLinkText("RepUpdateDialog@this","none","", currentToken())]'><image src='[r: tableImage("Buttons", 5)]' border="0" align="middle"></image></a>&nbsp; 
		</td>		
	</tr>[h: num = 1]
[h: statList = "A-Rep,c-Rep,e-Rep,f-Rep,g-Rep,i-Rep,r-Rep"]
[foreach(stat, statList,""),code:{

[if(roll.count == 0||roll.count==4),code:{<tr>}; {}]
		<td>
			<table width="100%">
				<tr>
          [h:jsonData=json.set("{}","repName",stat,"repFavors",getProperty(stat+"_favors"),"rollerName",getName(currentToken()))]
          <td bgcolor="[r: table(PageColor,2)]" color="white" align="center" width="100%">
            <font color="white"><b><a href='[r:macroLinkText("UseFavor@this","all",jsonData, currentToken())]'>[r: table("Rep",num)]</a></b>
					</td>
				</tr>
				<tr>
          [h: jsonData = json.append("[]",stat,getProperty(stat),"Rep", getName(currentToken()))]	
          <td align="center" width="100%" bgcolor="[r: table(PageColor,3)]">
            <font color="black"><a href='[r:macroLinkText("Entry@this","none",jsonData, currentToken())]'><b>[r: getProperty(stat)]</b></font></a>
					</td>
				</tr>
			</table>
		</td>

[if(roll.count == 3||roll.count==7),code:{</tr>}; {}]
[h: num = num+1]
}]
				</tr>
			</table>
		</td>
	</tr>
</table>

!!
@@ @AdvantagesDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
<table border="0" cellpadding="2" width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td valign="middle">&nbsp; &nbsp; <font color="white"><b>ADVANTAGES</b></font>
		</td>
		<td width="5%">
			<a href='[r:macroLinkText("AdvantageShowUpdate@this","none","",currentToken())]'><image src='[r: tableImage("OpenClose", getProperty("AdvantageShow"))]' border="0" align="middle"></image></a>&nbsp; 
		</td>
	</tr>
[if(AdvantageShow),code:{
</table>
<table border="0" cellpadding="2" width="100%">
		[h: color = table(PageColor,4)]
				[h,if(json.isEmpty(Advantages)): propList = ""; propList = json.fields(Advantages)]
				[h: propList=listSort(propList,"A")]
				[foreach(prop, propList, ""), code: {
	<tr bgcolor="[r: color]">
		<td width="100%">
				[h: propDetails = json.get(Advantages, prop)]
				[h: jsonData = json.append("[]", prop, json.get(propDetails, 0))]<font color="black"><a href='[r:macroLinkText("AdvantagesUpdateDisplay@this","none",jsonData,currentToken())]'>[r: prop]</a></font>
				
				
		</td>
	</tr>
[h: colorcheck = table(PageColor,4)]
[h, if(color == colorcheck): color = "white"; color = colorcheck]
}]
	<tr  bgcolor="[r:table(PageColor,3)]">
		<td>
			<b><center><font color="black">[h: jsonData = json.append("[]", "New Advantage", encode(""))]<a href='[r:macroLinkText("AdvantagesUpdateDialog@this","none",jsonData,currentToken())]'>Add New Advantage</a></font></center></b>
		</td>
	</tr>
</table>}; {</table>}]

!!
@@ @DamageDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
<table border="0" cellpadding="2" width="100%">
	<tr>
		<td valign="middle">
			<image src="[r: tableImage("Damage",6,80)]" border="0" align="middle"></image>
		</td>
		<td valign="middle" align="left"><a href='[r:macroLinkText("DamageUpdate@this","none","",currentToken())]'><image src="[r: tableImage("Number",Bruises,30)]" border="0"></image></a>
		</td>
		<td>
			<a href='[r:macroLinkText("DamageUpdateDazed@this","none","Dazed",currentToken())]'><image src="[r: tableImage("Damage",3,40)]" border="0"></image></a>
		</td>
		<td>
			<a href='[r:macroLinkText("DamageUpdateStaggered@this","none","Staggered",currentToken())]'><image src="[r: tableImage("Damage",4,40)]" border="0"></image></a>
		</td>
		<td>
			<a href='[r:macroLinkText("DamageUpdateIncapacitated@this","none","Incapacitated",currentToken())]'><image src="[r: tableImage("Damage",5,40)]" border="0"></image></a>
		</td>
		<td>
			[h: jsonData = json.append("[]", "D20", 0, "Roll",0)]<a href='[r:macroLinkText("D20basic@this","all",jsonData,currentToken())]'><image src="[r: tableImage("Icons",9,40)]" border="0"></image></a>
		</td>
	</tr>
</table>

!!
@@ @DefenseDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
<table border="0" cellpadding="0" width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td  valign="middle">&nbsp; &nbsp; <font color="white"><b>DEFENSES</b></font>
		</td>
		<td align="right"><image src='[r: tableImage("Icons", 10,23)]' border="0" align="middle"></image></a>
	</td>
		
	</tr>
</table>
<table border="0" cellpadding="2" width="100%"  align="center" bgcolor="white">

[h: color = table(PageColor,4)]

[h: defenseList = "Dodge,Parry,Fortitude,Toughness,Will"]
[foreach(def,defenseList,""),code:{
		
				<tr bgcolor="[r: color]">
	<td>
		[h:jsonData=json.set("{}","name",def,"rank",getProperty(def),"modifier",0)]
		<font color="black"><a href='[r:macroLinkText("d20Check@this","all", jsonData, currentToken())]'>[r: def]</a></font>
					</td>
					<td align="center">
[h: jsonData = json.append("[]", def, getProperty(def),"Defense")]
<font color="black"><a href='[r:macroLinkText("Entry@this","none", jsonData, currentToken())]'>[r: getProperty(def)]</a></font>[if(getProperty(def+"Norm")==""),code:{}; {[h: jsonData = json.append("[]", def, getProperty(def+"Norm"),"Defense")]/<font color="black"><a href='[r:macroLinkText("Entry@this","none", jsonData, currentToken())]'>[r: getProperty(def+"Norm")]</a></font>*}]
					</td>
</tr>
[h: color = if(color == table(PageColor,4),"white", table(PageColor,4))]

}]

[if(DodgeNorm==""&&ParryNorm==""&&FortitudeNorm==""&&ToughnessNorm==""&&WillNorm==""),code:{
}; {
<tr><td align="center" colspan="2" ><font size="2">*without bonus</font></td></tr>
}]				
				
</table>

!!
@@ @OffenseDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
<table border="0" cellpadding="0" width="100%"  align="center">
				<tr>
					<td>
<table border="0" cellpadding="2" width="100%"  align="center" >
[h,if(json.isEmpty(Attacks)): propList = ""; propList = json.fields(Attacks)][h: color = table(PageColor,4)]
				[foreach(prop, propList, ""), code: {

					<tr bgcolor="[r: color]">
						<td align="left" width="35%">
						<font color="black"><a href='[r:macroLinkText("OffenseUpdateDialog@this","none", prop, currentToken())]'><b>[r: prop]</b></a></font>
						</td>
						<td align="left"  width="55%">
					[r: json.get(json.get(Attacks,prop),1)][r: if(json.get(json.get(Attacks,prop),1)!=""&&json.get(json.get(Attacks,prop),2)!="",", ","")][r: if(json.get(json.get(Attacks,prop),2)!="",json.get(json.get(Attacks,prop),2)+" Area","")]
						</td>
						<td align="right" width="5%">
[h:jsonData=json.set("{}","name",prop)]
<a href='[r:macroLinkText("AttackCheck@this","all", jsonData, currentToken())]'><image src='[r: tableImage("Buttons", 2)]' border="0"></image></a>
					
						</td>
[h: jsonData = json.append("[]", prop, "", "Attack")]			<td align="right"  width="5%">
[h: Rank =  json.get(json.get(Attacks,prop),3)][if(Rank==""),code:{<a href='[r:macroLinkText("Entry@this","none", json.append("[]", prop, "", "Area"), currentToken())]'><image src='[r: tableImage("Buttons", 1)]' border="0"></image></a>}; {
<a href='[r:macroLinkText("Entry@this","none", jsonData, currentToken())]'><image src='[r: tableImage("Buttons", 1)]' border="0"></image></a>}]
						</td>
					</tr>
[h: colorcheck = table(PageColor,4)]
[h, if(color == colorcheck): color = "white"; color = colorcheck]}]
</table>
					</td>
				</tr>
</table>

!!
@@ @OffenseDisplayTop
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
<table border="1" cellpadding="0" width="100%"   bgcolor="[r:table(PageColor,3)]">
<table border="0" cellpadding="2" width="100%"  align="center">
				<tr  bgcolor="[r:table(PageColor,2)]">
					<td valign="middle">
&nbsp; &nbsp; <font color="white"><b>OFFENSE</b></font>

					</td>
					<td align="right">
				<a href='[r:macroLinkText("OffenseShowUpdate@this","none","",currentToken())]'><image src='[r: tableImage("OpenClose", getProperty("OffenseShow"))]' border="0" align="middle"></image></a>&nbsp; 
					</td>
				</tr>
</table>

[if(OffenseShow),code:{

[r, macro("OffenseDisplay@this"):""]

<center>
<a href='[r:macroLinkText("OffenseUpdateDialogNew@this","none","",currentToken())]'><b><font color="black">Add New Attack</font></b></a></center>
}; {}]
</table>

!!
@@ @PowersDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
<table border="1" cellpadding="0" width="100%"   bgcolor="[r:table(PageColor,3)]">
<table border="0" cellpadding="2" width="100%">
	<tr bgcolor="[r:table(PageColor,2)]">
		<td valign="middle">&nbsp; &nbsp; <font color="white"><b>POWERS</b></font>
		</td>
		<td   align="right">
				<a href='[r:macroLinkText("PowersShowUpdate@this","none","",currentToken())]'><image src='[r: tableImage("OpenClose", getProperty("PowersShow"))]' border="0" align="middle"></image></a>&nbsp; </td>
	</tr>
</table>
[if(PowersShow),code:{
<html>
<body><table border="0" cellpadding="2" width="100%" bgcolor="white">
[h: text = getProperty("Powers")]
[h: text = replace(text,"%0A","</p><p style='margin-left:.15in; text-indent:-.15in'>")]
<p  style="margin-left:.15in; text-indent:-.15in">
[r: decode(text)]
</p>
</table>

<center>
<a href='[r:macroLinkText("PowersUpdateDialog@this","none","",currentToken())]'><b><font color="black">Edit Powers</font></b></a></center>
</body>
</html>
}; {}]
</table>

!!
@@ @SkillsDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
[h: skill = json.get(macro.args,0)]
[h: color = json.get(macro.args,1)]
<tr bgcolor="[r: color]">
		<td align="left">
		 	[h: Rank = json.get(json.get(Skills,skill),0)]
			[h: Misc =  json.get(json.get(Skills,skill),1)]
			[h: Attribute =  getProperty(json.get(json.get(Skills,skill),2))]
			[h: RankTotal = Rank+Misc+Attribute]
			[h:jsonData=json.set("{}","name",skill,"rank",RankTotal,"modifier",0)]
			[h: info=json.append("[]",skill,json.get(json.get(Skills,skill),2))]
			<font color="black"><a href='[r:macroLinkText("SkillsInfoDisplay@this","none",info, currentToken())]'>[r: skill]</a></font>
		</td>
		<td align="center" width="25%">
			<font color="black"><a href='[r:macroLinkText("d20Check@this","all", jsonData, currentToken())]'>[r: Rank]</a></font>
		</td>
		<td width="25%" align="right">[h: jsonData = json.append("[]",skill,RankTotal,"Skill")]
			(<font color="black"><a href='[r:macroLinkText("Entry@this","none", jsonData, currentToken())]'>+[r: RankTotal]</a></font>)
		</td>

</tr>
[h: colorcheck = table(PageColor,4)]
[h: macro.return = if(color == colorcheck,"white", colorcheck)]

!!
@@ @KnowSkillsDisplayBottom
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
[h: skill = json.get(macro.args,0)]
[h: color = json.get(macro.args,1)]
<tr bgcolor="[r: color]">
  [h: base = json.get(json.get(KnowledgeSkills,skill),0)]
  [h: bonus =  json.get(json.get(KnowledgeSkills,skill),1)]
  [h: aptitude = json.get(json.get(KnowledgeSkills,skill),2)]
  [h: default = json.get(json.get(KnowledgeSkills,skill),3)]
  [h: spec = json.get(json.get(KnowledgeSkills,skill),4)]
  [h,if(length(spec)==0): specText = "no";specText = "yes"]
  [h: knowTotal = base+bonus]
  <td align="left">
    [h: jsonData=json.set("{}","name",skill,"base",knowTotal,"modifier",0)]
    [h: info=json.append("[]",skill,json.get(json.get(KnowledgeSkills,skill),2))]
    <font color="black"><a href='[r:macroLinkText("KnowSkillsInfoDisplay@this","none",info, currentToken())]'>[r: skill]</a></font>
  </td>
  <td align="center" width="15%">
    [h: specData=json.set("{}","specName",spec,"knowName",skill)]
    <font color="black"><a href='[r:macroLinkText("KnowSpecUpdate@this","none", specData, currentToken())]'>[r: specText]</a></font>
  </td>
  <td align="left" width="15%">
    [h: jsonData = json.append("[]",aptitude,strformat(" %s Aptitude check",aptitude),"Aptitude")]	
    [h,if(default): outputter = "<font color='black'><a href='"+macroLinkText("Entry@this","none",jsonData, currentToken())+"'>"+aptitude+"</font></a>"; outputter = "<font color='black'>"+aptitude+"</font>"]
    {outputter}
  </td>
  <td width="15%" align="right">
    [h: jsonData = json.append("[]",skill,knowTotal,"KnowSkill",strformat(" %s skill check",skill),spec)]
    (<font color="black"><a href='[r:macroLinkText("Entry@this","none", jsonData, currentToken())]'>+[r: knowTotal]</a></font>)
  </td>

</tr>
[h: colorcheck = table(PageColor,4)]
[h: macro.return = if(color == colorcheck,"white", colorcheck)]

!!
@@ @ActiveSkillsDisplayBottom
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
[h: skill = json.get(macro.args,0)]
[h: color = json.get(macro.args,1)]
<tr bgcolor="[r: color]">
  [h: base = json.get(json.get(ActiveSkills,skill),0)]
  [h: bonus =  json.get(json.get(ActiveSkills,skill),1)]
  [h: aptitude = json.get(json.get(ActiveSkills,skill),2)]
  [h: default = json.get(json.get(ActiveSkills,skill),3)]
  [h: spec = json.get(json.get(ActiveSkills,skill),4)]
  [h,if(length(spec)==0): specText = "no";specText = "yes"]
  [h: activeTotal = base+bonus]
  <td align="left">
    [h: jsonData=json.set("{}","name",skill,"base",activeTotal,"modifier",0)]
    [h: info=json.append("[]",skill,json.get(json.get(ActiveSkills,skill),2))]
    <font color="black"><a href='[r:macroLinkText("ActiveSkillsInfoDisplay@this","none",info, currentToken())]'>[r: skill]</a></font>
  </td>
  <td align="center" width="15%">
    [h: specData=json.set("{}","specName",spec,"activeName",skill)]
    <font color="black"><a href='[r:macroLinkText("ActiveSpecUpdate@this","none", specData, currentToken())]'>[r: specText]</a></font>
  </td>
  <td align="left" width="15%">
    [h: jsonData = json.append("[]",aptitude,strformat(" %s Aptitude check",aptitude),"Aptitude")]	
    [h,if(default): outputter = "<font color='black'><a href='"+macroLinkText("Entry@this","none",jsonData, currentToken())+"'>"+aptitude+"</font></a>"; outputter = "<font color='black'>"+aptitude+"</font>"]
    {outputter}
  </td>
  <td width="15%" align="right">
    [h: jsonData = json.append("[]",skill,activeTotal,"ActiveSkill",strformat(" %s skill check",skill),spec)]
    (<font color="black"><a href='[r:macroLinkText("Entry@this","none", jsonData, currentToken())]'>+[r: activeTotal]</a></font>)
  </td>

</tr>
[h: colorcheck = table(PageColor,4)]
[h: macro.return = if(color == colorcheck,"white", colorcheck)]

!!
@@ @SkillsDisplayTop
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
<table border="0" cellpadding="2" width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td valign="middle">&nbsp; &nbsp; <font color="white"><a href='[r:macroLinkText("SkillsUpdateDialog@this","none","", currentToken())]'><b>SKILLS</b></a></font>
		</td>
		<td  align="center" width="25%" color="white">
			<b>Rank</b>
		</td>
		<td  align="right" width="25%" color="white">
			<b>Total</b>
		</td>
		
	</tr>
</table>
<table border="0" cellpadding="2" width="100%" bgcolor="white">
[h,if(json.isEmpty(Skills)): skillListunsort = ""; skillListunsort = json.fields(Skills)]
[h: skillList = listsort(skillListunsort, "A")]
[h: color = table(PageColor,4)]
[foreach(skill, skillList, ""), code: {

[h: skillDetails = json.get(Skills, skill)]
[h: skillRank = json.get(skillDetails, 0)]
[h: skillMisc = json.get(skillDetails,1)]
[h: skillTrained = json.get(skillDetails,3)]

[if(skillMisc==0&&skillRank==0&&skillTrained==0), code:{}; {
[h: jsonData = json.append("[]", skill,color)]
[r, macro("SkillsDisplay@this"):jsonData]
[h: color = macro.return]
}]

}]

</table>

!!
@@ @KnowSkillsDisplayTop
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
<table border="0" cellpadding="2" width="100%" bgcolor="white">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td valign="middle">&nbsp; &nbsp; <font color="white"><a href='[r:macroLinkText("KnowSkillsUpdateDialog@this","none","", currentToken())]'><b>KNOW. SKILLS</b></a></font>
		</td>
		<td align="center" width="15%" color="white">
			<b>Spec.</b>
		</td>
    <td align="left" width="15%" color="white">
			<b>Aptitude</b>
		</td>
		<td align="right" width="15%" color="white">
			<b>Total</b>
		</td>
	</tr>
  [h,if(json.isEmpty(KnowledgeSkills)): skillListunsort = ""; skillListunsort = json.fields(KnowledgeSkills)]
  [h: skillList = listsort(skillListunsort, "A")]
  [h: color = table(PageColor,4)]
  [foreach(skill, skillList, ""), code: 
  {
    [h: skillDetails = json.get(KnowledgeSkills, skill)]
    [h: skillBase = json.get(skillDetails,0)]
    [h: skillBonus = json.get(skillDetails,1)]
    [if(skillBonus==0&&skillBase==0), code: {}; 
    {
      [h: jsonData = json.append("[]", skill,color)]
      [r, macro("KnowSkillsDisplayBottom@this"):jsonData]
      [h: color = macro.return]
    }]
  }]
</table>

!!
@@ @ActiveSkillsDisplayTop
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
<table border="0" cellpadding="2" width="100%" bgcolor="white">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td valign="middle">&nbsp; &nbsp; <font color="white"><a href='[r:macroLinkText("ActiveSkillsUpdateDialog@this","none","", currentToken())]'><b>ACTIVE SKILLS</b></a></font>
		</td>
		<td align="center" width="15%" color="white">
			<b>Spec.</b>
		</td>
    <td align="left" width="15%" color="white">
			<b>Aptitude</b>
		</td>
		<td align="right" width="15%" color="white">
			<b>Total</b>
		</td>
	</tr>
  [h,if(json.isEmpty(ActiveSkills)): skillListunsort = ""; skillListunsort = json.fields(ActiveSkills)]
  [h: skillList = listsort(skillListunsort, "A")]
  [h: color = table(PageColor,4)]
  [foreach(skill, skillList, ""), code: 
  {
    [h: skillDetails = json.get(ActiveSkills, skill)]
    [h: skillBase = json.get(skillDetails,0)]
    [h: skillBonus = json.get(skillDetails,1)]
    [if(skillBonus==0&&skillBase==0), code: {}; 
    {
      [h: jsonData = json.append("[]", skill,color)]
      [r, macro("ActiveSkillsDisplayBottom@this"):jsonData]
      [h: color = macro.return]
    }]
  }]
</table>

!!
@@ @StatesDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
[h:theList = getTokenStates(",","Combined Conditions")]
[h: theList=listSort(theList,"A")]
[r, foreach(item, theList, ""),code:{[if(getState(item)),code:{<a href='[r:macroLinkText("ConditionsInfoRemove@this","none",item,currentToken())]'><image src="[r: getStateImage(item, 25)]" border="0" alt="[r: item]"></image></a>}; {}]}]
[h:theList = getTokenStates(",","Basic Conditions")]
[h: theList=listSort(theList,"A")]
[r, foreach(item, theList, ""),code:{[if(getState(item)),code:{<a href='[r:macroLinkText("ConditionsInfoRemove@this","none",item,currentToken())]'><image src="[r: getStateImage(item, 25)]" border="0" alt="[r: item]"></image></a>}; {}]}]

!!
@@ @AbilityEntry
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
<head>
<title>Aptitude Check</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="SkillCheck" action="[r:macroLinkText('EntryType@Lib:MnM', 'none', '', currentToken())]">

<table width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td color="white">
			<center><b>[r: json.get(macro.args,0)]</center>
		</td>
	</tr>
</table>
<table width="100%" bgcolor="white">
	<tr>
		<td>
			<b>Difficulty Class:</b>
		</td>
		<td align="left">
			<input type="text" name="DC" value="" size="5"></input>
		</td>
	</tr>
	<tr>
		<td>
			Aid Another:
		</td>
		<td align="left">
			[H: pcList=getExposedTokenNames()]
			[h: pcList = replace(pcList,token.name+",","")]
			[h: pcList = "No,"+pcList]
			<select name="aid" selected="">
			[foreach(name,pcList,""),code:{
			<option value='[r: name]'>[r: name]</option>
			}]</select>
		</td>
	</tr>
	<tr>
		<td>
			<b>Modifier:</b>
		</td>
		<td align="left">
			<input type="text" name="modifier" value="" size="5"></input>
		</td>
	</tr>
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,3)]">
		<td align="left">
			Private: <input type="checkbox" name="Output" value="Private"></input>
		</td>
		<td alignt="right">
			Hide Roll: <input type="checkbox" name="hide" value="1"]></input>
		</td>
	</tr>
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,4)]">
		<td align="center">
			<input type="hidden" name="name" value="[r: json.get(macro.args,0)]"></input>					<input type="hidden" name="rank" value="[r: json.get(macro.args,1)]"></input>
			<input type="hidden" name="ExeMacro" value="d20Check"></input>
			<input type='submit' name='Roll' value='Roll'></input>
		</td>
	</tr>
</table>
</form>
</body>
</html>

!!
@@ @AptitudeEntry
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
<head>
<title>Aptitude Check</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="SkillCheck" action="[r:macroLinkText('EntryType@Lib:MnM', 'none', '', currentToken())]">

<table width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td color="white">
			<center><b>[r: strformat("%s (%d)",json.get(macro.args,0),getProperty(json.get(macro.args,0)))]</center>
		</td>
	</tr>
</table>
<table width="100%" bgcolor="white">
	<tr>
		<td>
			<b>Pre-made Target Numbers:</b>
		</td>
		<td align="left">
      <select name="targetNumber" selected="">
        <option value='0'>Custom</option>
        <option value='[r: getProperty(json.get(macro.args,0)) * 3]'>Aptitude x 3</option>
        <option value='[r: getProperty(json.get(macro.args,0)) * 2]'>Aptitude x 2</option>
        <option value='[r: getProperty(json.get(macro.args,0))]'>Aptitude</option>
			</select>
		</td>
	</tr>
  <tr>
		<td>
			<b>Custom Target Number:</b>
		</td>
		<td align="left">
			<input type="text" name="secondaryTargetNumber" value="" size="5"></input>
		</td>
	</tr>
	<tr>
		<td>
			Teamwork:
		</td>
		<td align="left">
			<select name="teamWork" selected="">
        <option value='0'>None</option>
        <option value='1'>One</option>
        <option value='2'>Two</option>
        <option value='3'>Three</option>
			</select>
		</td>
	</tr>
	<tr>
		<td>
			<b>Modifier:</b>
		</td>
		<td align="left">
			<input type="text" name="mods" value="" size="5"></input>
		</td>
	</tr>
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,3)]">
		<td align="left">
			Private: <input type="checkbox" name="Output" value="Private"></input>
		</td>
		<td alignt="right">
			Hide Roll: <input type="checkbox" name="hide" value="1"></input>
		</td>
	</tr>
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,4)]">
		<td align="center">
			<input type="hidden" name="rollTitle" value="[r: json.get(macro.args,1)]"></input>	
      <input type="hidden" name="rollerName" value="[r: getName(currentToken())]"></input>
			<input type="hidden" name="ExeMacro" value="die100"></input>
			<input type='submit' name='Roll' value='Roll'></input>
		</td>
	</tr>
</table>
</form>
</body>
</html>

!!
@@ @StatEntry
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
<head>
<title>Stats Check</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="SkillCheck" action="[r:macroLinkText('EntryType@Lib:MnM', 'none', '', currentToken())]">

<table width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td color="white">
			<center><b>[r: json.get(macro.args,0)] [r: strformat("%s (%d)",json.get(macro.args,0),getProperty(json.get(macro.args,0)))]</center>
		</td>
	</tr>
</table>
<table width="100%" bgcolor="white">
	<tr>
		<td>
			<b>Difficulty Class:</b>
		</td>
		<td align="left">
			<input type="text" name="DC" value="" size="5"></input>
		</td>
	</tr>
	<tr>
		<td>
			Aid Another:
		</td>
		<td align="left">
			[H: pcList=getExposedTokenNames()]
			[h: pcList = replace(pcList,token.name+",","")]
			[h: pcList = "No,"+pcList]
			<select name="aid" selected="">
			[foreach(name,pcList,""),code:{
			<option value='[r: name]'>[r: name]</option>
			}]</select>
		</td>
	</tr>
	<tr>
		<td>
			<b>Modifier:</b>
		</td>
		<td align="left">
			<input type="text" name="modifier" value="" size="5"></input>
		</td>
	</tr>
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,3)]">
		<td align="left">
			Private: <input type="checkbox" name="Output" value="Private"></input>
		</td>
		<td alignt="right">
			Hide Roll: <input type="checkbox" name="hide" value="1"]></input>
		</td>
	</tr>
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,4)]">
		<td align="center">
			<input type="hidden" name="name" value="[r: json.get(macro.args,0)]"></input>					<input type="hidden" name="rank" value="[r: json.get(macro.args,1)]"></input>
			<input type="hidden" name="ExeMacro" value="d20Check"></input>
			<input type='submit' name='Roll' value='Roll'></input>
		</td>
	</tr>
</table>
</form>
</body>
</html>

!!
@@ @MoxieEntry
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
[h,if(MOX==0): input(".|You do not have any Moxie to spend!||LABEL|SPAN=TRUE")]
[h,if(MOX==0): abort(0)]

<head>
<title>Moxie Usage</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="MoxieEntry" action="[r:macroLinkText('EntryType@Lib:MnM', 'none', '', currentToken())]">

<table width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td color="white">
			<center><b>MOX ([r: MOX + " / " + MOX_base])</center>
		</td>
	</tr>
</table>
<table width="100%" bgcolor="white">
  <tr>
		<td>
			<b>Pick one Option:</b>
		</td>
		<td align="left">
      <INPUT TYPE=RADIO NAME="moxOption" VALUE="1" CHECKED>Ignore all negative modifiers that apply to a test. The Moxie point must be spent before dice are rolled.<BR>
      <INPUT TYPE=RADIO NAME="moxOption" VALUE="2"        >Flip-flop a d100 roll result. For example, an 83 would become a 38.<BR>
      <INPUT TYPE=RADIO NAME="moxOption" VALUE="3"        >Upgrade a success, making it a critical success, as if you rolled doubles. You must succeed in the test before you spend the Moxie point.<BR>
      <INPUT TYPE=RADIO NAME="moxOption" VALUE="4"        >Ignore a critical failure, treating it as a regular failure instead.<BR>
      <INPUT TYPE=RADIO NAME="moxOption" VALUE="5"        >Go first in an Action Phase.
		</td>
	</tr>
	<tr>	
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,4)]">
		<td align="center">	
      <input type="hidden" name="rollerName" value="[r: json.get(macro.args,3)]"></input>
			<input type="hidden" name="ExeMacro" value="UseMoxie"></input>
			<input type='submit' name='Roll' value='Pick'></input>
		</td>
	</tr>
</table>
</form>
</body>
</html>

!!
@@ @RepEntry
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
[h:repNamer = json.get(macro.args,0)]
[h:repValuer = json.get(macro.args,1)]
[h,if(repValuer==0): input(".|You do not have any "+repNamer+" to burn!||LABEL|SPAN=TRUE")]
[h,if(repValuer==0): abort(0)]
[h,switch(repNamer):
  case "A-Rep": networkName = "Networking: Autonomists";
  case "c-Rep": networkName = "Networking: Hypercorps";
  case "e-Rep": networkName = "Networking: Ecologists";
  case "f-Rep": networkName = "Networking: Media";
  case "g-Rep": networkName = "Networking: Criminals";
  case "i-Rep": networkName = "Networking: Firewall";
  case "r-Rep": networkName = "Networking: Scientists"
]
[h,if(repNamer=="A-Rep"): repNamer = "@-Rep"]

<head>
<title>Reputation Burn</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="RepCheck" action="[r:macroLinkText('EntryType@Lib:MnM', 'none', '', currentToken())]">

<table width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td color="white">
			<center><b>[r: repNamer] Burn ([r: repValuer])</center>
		</td>
	</tr>
</table>
<table width="100%" bgcolor="white">
	<tr>
		<td>
			<b>Pick one:</b>
		</td>
		<td>
			<input type="radio" name="burnChoice" value="1" checked="checked">Get a bonus on a [r: networkName] test (max of +30).</input><br>
      <input type="radio" name="burnChoice" value="2">Get a Favor before it has refreshed.</input>
		</td>
	</tr>
	<tr>
		<td>
			<b># to burn for Networking:</b>
		</td>
		<td>
			<input type="text" name="choiceOneValue" value="" size="5"></input>
		</td>
	</tr>
  <tr>
		<td>
			<b># to burn for a Favor:</b>
		</td>
		<td>
			<input type="radio" name="choiceTwoValue" value="0" checked="checked">Trivial Favor (Cost 0)</input><br>
      <input type="radio" name="choiceTwoValue" value="1">Low Favor (Cost 1)</input><br>
      <input type="radio" name="choiceTwoValue" value="5">Moderate Favor (Cost 5)</input><br>
      <input type="radio" name="choiceTwoValue" value="10">High Favor (Cost 10)</input><br>
      <input type="radio" name="choiceTwoValue" value="20">Scarce Favor (Cost 20)</input>
		</td>
	</tr>
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,4)]">
		<td align="center">
			<input type="hidden" name="repName" value="[r: json.get(macro.args,0)]"></input>					
      <input type="hidden" name="repValue" value="[r: json.get(macro.args,1)]"></input>
      <input type="hidden" name="rollerName" value="[r: json.get(macro.args,3)]"></input>
      <input type="hidden" name="networkName" value="[r: networkName]"></input>
			<input type="hidden" name="ExeMacro" value="BurnRep"></input>
			<input type='submit' name='Done' value='Done'></input>
		</td>
	</tr>
</table>
</form>
</body>
</html>

!!
@@ @AttackCheck
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
[h: Roll = d20]
[h: Name = json.get(macro.args,"name")]
[h: Rank =  json.get(json.get(Attacks,name),3)]
[h: range =  json.get(json.get(Attacks,name),1)]
[h: area =  json.get(json.get(Attacks,name),2)]
[h: Misc = json.get(macro.args,"range") + json.get(macro.args,"cover") + json.get(macro.args,"concealment") + json.get(macro.args,"attack")]
[h: Target = json.get(macro.args,"target")]
[h, if(Misc == ""): Misc = 0; Misc = Misc]
[h: CritTotal = ""]

<b>[r: Name]</b>
[if(area!=""||range=="Perception"),code:{<br>}; {<br>
<b>Attack</b>[r, if(Target !=""): " against "+Target; ""]:  [R, if(json.get(macro.args, "hide") == "1"), CODE:{[gt, st, t(Roll + Rank + Misc): Roll + Rank + Misc]}; {[t(Roll + Rank + Misc):Roll + Rank + Misc]}][r, macro("d20@this"):Roll] vs. [r: json.get(json.get(Attacks,name),4)]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 

[h: Crit = json.get(json.get(Attacks,name),5)][h: jsonData=json.append("[]",Roll,Crit)][r, macro("Critical@this"):jsonData][h: CritTotal = macro.return]
}]

[h: Damage = json.get(json.get(Attacks,name),9)]
[h, if(Damage == 1): Num = 10; Num = 15]
[h, if(Damage == 1): newTarget = "Resistance"; newTarget = "Damage"]

[h: effectrank = if(json.get(json.get(Attacks,name),7)=="",0,json.get(json.get(Attacks,name),7))]
[h: strengthrank = if(json.get(json.get(Attacks,name),8)=="",0,getProperty("Strength"))]
[h: Bonus = json.get(macro.args,"effect")]
[h, if(Bonus == ""): Bonus = 0; Bonus = Bonus]
[h: Effect = effectrank + strengthrank]
[h: jsonEffect = Effect+Bonus]

[if(range!="Perception"&&area!=""),code:{<b>Attack:</b> 
[r: macroLink("Dodge","Entry@this","none",json.append('[]','Dodge',jsonEffect,'Resistance'),'selected')] to halve effect&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }; {}]
<b>Hit</b>:
[h: jsonData = json.append(json.get(json.get(Attacks,name),6),jsonEffect,newTarget)]
[r: macroLink(json.get(json.get(Attacks,name),6),"Entry@this","none",jsondata,'selected')]  vs. DC [R, if(json.get(macro.args, "hide") == "1"), CODE:{[gt, st, t(Effect + Num+ Bonus): Effect + Num + Misc]}; {[t(Effect + Num + Bonus):Effect + Num + Bonus]}][r: CritTotal]
<br>
<i>[r, macro("ConditionsLink@this"):json.get(json.get(Attacks,name),11)]</i>

!!
@@ @DefenseEntry
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
<head>
<title>Defense Check</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="SkillCheck" action="[r:macroLinkText('EntryType@Lib:MnM', 'none', '', currentToken())]">

<table width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td color="white">
			<center><b>[r: json.get(macro.args,0)]</center>
		</td>
	</tr>
</table>
<table width="100%" bgcolor="white">
	<tr>
		<td>
			<b>Difficulty Class:</b>
		</td>
		<td align="left">
			<input type="text" name="DC" value="" size="5"></input>
		</td>
	</tr>
	<tr>
		<td>
			Aid Another:
		</td>
		<td align="left">
			[H: pcList=getExposedTokenNames()]
			[h: pcList = replace(pcList,token.name+",","")]
			[h: pcList = "No,"+pcList]
			<select name="aid" selected="">
			[foreach(name,pcList,""),code:{
			<option value='[r: name]'>[r: name]</option>
			}]</select>
		</td>
	</tr>
	<tr>
		<td>
			<b>Modifier:</b>
		</td>
		<td align="left">
			<input type="text" name="modifier" value="" size="5"></input>
		</td>
	</tr>
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,3)]">
		<td align="left">
			Private: <input type="checkbox" name="Output" value="Private"></input>
		</td>
		<td alignt="right">
			Hide Roll: <input type="checkbox" name="hide" value="1"]></input>
		</td>
	</tr>
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,4)]">
		<td align="center">
			<input type="hidden" name="name" value="[r: json.get(macro.args,0)]"></input>					<input type="hidden" name="rank" value="[r: json.get(macro.args,1)]"></input>
			<input type="hidden" name="ExeMacro" value="d20Check"></input>
			<input type='submit' name='Roll' value='Roll'></input>
		</td>
	</tr>
</table>
</form>
</body>
</html>

!!
@@ @Entry
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
[H, macro("EntrySize@this"):""]
[H: sizeSettings = json.get(macro.return, json.get(macro.args, 2))]

[H: Width = listget(sizeSettings, 0)+0]
[H: Height = listget(sizeSettings, 1)+0]

[R, dialog("EntryWindow", "temp=1; closebutton=0; width=" + Width + "; height=" + Height):

	{
		[r, macro(json.get(macro.args,2)+"Entry@this"):macro.args]
	}
]

!!
@@ @EntrySize
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
[macro.return = json.set("",

"Attack", "405, 256",
"Damage", "365, 204",
"Resistance", "365, 204",
"Skill", "305, 223",
"Ability", "305, 196",
"Aptitude", "305, 212",
"Defense", "305, 196",
"Initiative", "305, 146",
"Area","305, 150",
"Moxie", "305, 320",
"Rep", "520, 325",
"KnowSkill", "305, 320",
"ActiveSkill", "305, 320"

)]

!!
@@ @EntryType
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
[h: checkLink=macroLinkText(json.get(macro.args,"ExeMacro")+"@this", if(json.get(macro.args, "Output") == "Private", if(isGM() == 1, "gm", "gm-self"), "all"), macro.args, currentToken())]
[execLink(checkLink)]

!!
@@ @InitiativeCheck
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
[h: Roll = d20]
[h: Name = json.get(macro.args,"name")]
[h: Rank = json.get(macro.args,"rank")]
[h: Misc = json.get(macro.args,"modifier")]
[h, if(Misc == ""): Misc = 0; Misc = Misc]

[ if(json.get(macro.args,"setinit")==""),code:{

I make an [r: Name] Check and get a [R, if(json.get(macro.args, "hide") == "1"), CODE:{[gt, st, t(Roll + Rank + Misc): Roll + Rank + Misc]}; {[t(Roll + Rank + Misc):Roll + Rank + Misc]}]

[h:addtoInitiative()][h: setInitiative(Roll + Rank + Misc)]

}; 
{
I set my initative to 
[h:addtoInitiative()][r: setInitiative(json.get(macro.args,"setinit"))]

}]

!!
@@ @InitiativeEntry
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
<head>
<title>Initiative Check</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="SkillCheck" action="[r:macroLinkText('EntryType@Lib:MnM', 'none', '', currentToken())]">

<table width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td color="white">
			<center><b>[r: json.get(macro.args,0)]</center>
		</td>
	</tr>
</table>
<table width="100%" bgcolor="white">
	<tr>
		<td>
			<b>Modifier:</b>
		</td>
		<td align="left">
			<input type="text" name="modifier" value="" size="5"></input>
		</td>
		<td>
			Set Initiative:
		</td>
		<td align="left">
			<input type="text" name="setinit" value="" size="5"></input>
		</td>
	</tr>
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,3)]">
		<td align="left">
			Private: <input type="checkbox" name="Output" value="Private"></input>
		</td>
		<td alignt="right">
			Hide Roll: <input type="checkbox" name="hide" value="1"]></input>
		</td>
	</tr>
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,4)]">
		<td align="center">
			<input type="hidden" name="name" value="[r: json.get(macro.args,0)]"></input>					<input type="hidden" name="rank" value="[r: json.get(macro.args,1)]"></input>
			<input type="hidden" name="ExeMacro" value="InitiativeCheck"></input>
			<input type='submit' name='Roll' value='Roll'></input>
		</td>
	</tr>
</table>
</form>
</body>
</html>

!!
@@ @SkillAltType
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy=z ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
[if(json.get(macro.args,"ability")=="No"),code:{}; {
[h: name = json.get(macro.args,"name")]
[h: ability = json.get(macro.args, "ability")]

		 	[h: Rank = json.get(json.get(Skills,name),0)]
			[h: Misc =  json.get(json.get(Skills,name),1)]
			[h: Attribute =  getProperty(ability)]
			[h: RankTotal = Rank+Misc+Attribute]
[h: macro.args = json.set(macro.args,"rank",RankTotal)]
}]

[h: checkLink=macroLinkText(json.get(macro.args,"ExeMacro")+"@this", if(json.get(macro.args, "Output") == "Private", if(isGM() == 1, "gm", "gm-self"), "all"), macro.args, currentToken())]
[execLink(checkLink)]

!!
@@ @SkillEntry
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
<head>
<title>Skill Check</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="SkillCheck" action="[r:macroLinkText('SkillAltType@Lib:MnM', 'none', '', currentToken())]">

<table width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td color="white">
			<center><b>[r: json.get(macro.args,0)]</center>
		</td>
	</tr>
</table>
<table width="100%" bgcolor="white">
	<tr>
		<td>
			<b>Difficulty Class:</b>
		</td>
		<td align="left">
			<input type="text" name="DC" value="" size="5"></input>
		</td>
	</tr>
	<tr>
		<td>
			Alternate Ability:
		</td>
		<td align="left">
			<select name="ability" selected="">
			<option value='No'>No</option>
      <option value='COG'>COG</option>	
			<option value='COO'>COO</option>			
			<option value='INT'>INT</option>      
      <option value='REF'>REF</option>
			<option value='SAV'>SAV</option>
			<option value='SOM'>SOM</option>
      <option value='WIL'>WIL</option>
			</select>
		</td>
	</tr>
	<tr>
		<td>
			Aid Another:
		</td>
		<td align="left">
			[H: pcList=getExposedTokenNames()]
			[h: pcList = replace(pcList,token.name+",","")]
			[h: pcList = "No,"+pcList]
			<select name="aid" selected="">
			[foreach(name,pcList,""),code:{
			<option value='[r: name]'>[r: name]</option>
			}]</select>
		</td>
	</tr>
	<tr>
		<td>
			<b>Modifier:</b>
		</td>
		<td align="left">
			<input type="text" name="modifier" value="" size="5"></input>
		</td>
	</tr>
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,3)]">
		<td align="left">
			Private: <input type="checkbox" name="Output" value="Private"></input>
		</td>
		<td alignt="right">
			Hide Roll: <input type="checkbox" name="hide" value="1"]></input>
		</td>
	</tr>
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,4)]">
		<td align="center">
			<input type="hidden" name="name" value="[r: json.get(macro.args,0)]"></input>					<input type="hidden" name="rank" value="[r: json.get(macro.args,1)]"></input>
			<input type="hidden" name="ExeMacro" value="d20Check"></input>
			<input type='submit' name='Roll' value='Roll'></input>
		</td>
	</tr>
</table>
</form>
</body>
</html>

!!
@@ @KnowSkillEntry
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
[h: specValue = json.get(macro.args,4)]
<head>
<title>Knowledge Skill Check</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="KnowSkillCheck" action="[r:macroLinkText('EntryType@Lib:MnM', 'none', '', currentToken())]">

<table width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td color="white">
			<center><b>[r: strformat("%s (%d)",json.get(macro.args,0),json.get(macro.args,1))]</center>
		</td>
	</tr>
</table>
<table width="100%" bgcolor="white">
	<tr>
		<td>
			Teamwork:
		</td>
		<td align="left">
			<select name="teamWork" selected="">
        <option value='0'>None</option>
        <option value='1'>One</option>
        <option value='2'>Two</option>
        <option value='3'>Three</option>
			</select>
		</td>
	</tr>
  <tr>
		<td>
			<b>Modifier:</b>
		</td>
		<td align="left">
			<input type="text" name="mods" value="" size="5"></input>
		</td>
	</tr>
  [h,if(length(specValue)==0): specRow = "";specRow = '<tr><td>Use Specialization ('+specValue+'):</td><td align="left"><input type="checkbox" name="useSpec" value="1"></input></td></tr>']
  {specRow}
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,3)]">
		<td align="left">
			Private: <input type="checkbox" name="Output" value="Private"></input>
		</td>
		<td alignt="right">
			Hide Roll: <input type="checkbox" name="hide" value="1"]></input>
		</td>
	</tr>
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,4)]">
		<td align="center">
			<input type="hidden" name="rollTitle" value="[r: json.get(macro.args,3)]"></input>					
			<input type="hidden" name="ExeMacro" value="die100"></input>
      <input type="hidden" name="targetNumber" value="[r: json.get(macro.args,1)]"></input>
      <input type="hidden" name="rollerName" value="[r: getName(currentToken())]"></input>
      <input type="hidden" name="specName" value="[r: specValue]"></input>
			<input type='submit' name='Roll' value='Roll'></input>
		</td>
	</tr>
</table>
</form>
</body>
</html>

!!
@@ @ActiveSkillEntry
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
[h: specValue = json.get(macro.args,4)]
<head>
<title>Active Skill Check</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="ActiveSkillCheck" action="[r:macroLinkText('EntryType@Lib:MnM', 'none', '', currentToken())]">

<table width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td color="white">
			<center><b>[r: strformat("%s (%d)",json.get(macro.args,0),json.get(macro.args,1))]</center>
		</td>
	</tr>
</table>
<table width="100%" bgcolor="white">
	<tr>
		<td>
			Teamwork:
		</td>
		<td align="left">
			<select name="teamWork" selected="">
        <option value='0'>None</option>
        <option value='1'>One</option>
        <option value='2'>Two</option>
        <option value='3'>Three</option>
			</select>
		</td>
	</tr>
  <tr>
		<td>
			<b>Modifier:</b>
		</td>
		<td align="left">
			<input type="text" name="mods" value="" size="5"></input>
		</td>
	</tr>
  [h,if(length(specValue)==0): specRow = "";specRow = '<tr><td>Use Specialization ('+specValue+'):</td><td align="left"><input type="checkbox" name="useSpec" value="1"></input></td></tr>']
  {specRow}
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,3)]">
		<td align="left">
			Private: <input type="checkbox" name="Output" value="Private"></input>
		</td>
		<td alignt="right">
			Hide Roll: <input type="checkbox" name="hide" value="1"]></input>
		</td>
	</tr>
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,4)]">
		<td align="center">
			<input type="hidden" name="rollTitle" value="[r: json.get(macro.args,3)]"></input>					
			<input type="hidden" name="ExeMacro" value="die100"></input>
      <input type="hidden" name="targetNumber" value="[r: json.get(macro.args,1)]"></input>
      <input type="hidden" name="rollerName" value="[r: getName(currentToken())]"></input>
      <input type="hidden" name="specName" value="[r: specValue]"></input>
			<input type='submit' name='Roll' value='Roll'></input>
		</td>
	</tr>
</table>
</form>
</body>
</html>

!!
@@ @d20
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy=z ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
[h: Roll = macro.args]
[h:  macro.return = if(Roll == 1, " &#8226; <b>Natural 1!</b>","")]

[h:  macro.return = if(Roll == 20, " &#8226; <b>Natural 20!!!</b>",macro.return)]

!!
@@ @d20Check
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
[h: Roll = d20]
[h: Name = json.get(macro.args,"name")]
[h: Rank = json.get(macro.args,"rank")]
[h: Misc = json.get(macro.args,"modifier")]
[h, if(json.get(macro.args,"aid")==""): Aid="No"; Aid = json.get(macro.args,"aid")]
[h, if(json.get(macro.args,"ability")==""): Ability="No"; Ability = json.get(macro.args,"ability")]
[h, if(Misc == ""): Misc = 0; Misc = Misc]

I make a [r: Name] Check[r, if(Ability == "No"):""; " together with "+Ability][r, if(Aid == "No"):""; " to aid "+Aid] and get a [R, if(json.get(macro.args, "hide") == "1"), CODE:{[gt, st, t(Roll + Rank + Misc): Roll + Rank + Misc]}; {[t(Roll + Rank + Misc):Roll + Rank + Misc]}][r, macro("d20@this"):Roll]

[if(json.get(macro.args, "DC") == ""), CODE:{[r: macro.return]}; { vs. DC [r: json.get(macro.args, "DC")][r: macro.return]
<br>
[h:resulta=(Roll+Rank+Misc)-json.get(macro.args, "DC")][r: table("DegreesSuccess",resulta)]}]

!!
@@ @Acrobatics
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
Use Acrobatics to flip, dive, roll, tumble, and perform other acrobatic maneuvers, as well as keeping your balance under difficult circumstances.<p>

<b>Balancing:</b> You can keep your balance and move along a precarious surface at your ground speed minus 1 rank with a successful Acrobatics check against the surface's DC. A degree of failure indicates you spend your move action just maintaining your balance and do not actually move, while two or more degrees of failure means you lose your balance and fall. You are vulnerable while balancing. If you accept a +5 increase to the Acrobatics DC, you are not vulnerable.<p>

<b>Maneuvering:</b> You can make Acrobatics checks for various acrobatic stunts or maneuvers, from back flips to jumping over an opponent (to get behind them), flipping up onto a ledge, tumbling through obstacles, and so forth. The GM sets the DC. Success means you accomplish the maneuver.<p>

<b>Standing:</b> You can make a DC 20 Acrobatics check to go from prone to standing as a free action rather than a move action. A failed check means you remain prone.<p>

<b>Tumbling:</b> You can make an Acrobatics check (DC 5) to lessen damage from a fall, reducing the damage by 1 per degree. A fall reduced to rank 0 damage does no damage and you quickly roll to your feet as a free action. Otherwise, you are prone at the end of a fall.

!!
@@ @Asleep
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=bb ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
While asleep, a character is <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none"," Defenseless",currentToken())]'>defenseless</a></font>, <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Stunned",currentToken())]'>stunned</a></font>, and <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Unaware",currentToken())]'>unaware</a></font>. A hearing Perception check with three or more degrees of success wakes the character and removes all these conditions, as does any sudden movement (such as shaking the sleeping character) or any effect allowing a resistance check.

!!
@@ @Athletics
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
Use Athletics for physical feats like climbing, jumping, riding animal mounts, and swimming. <p>

<b>Climbing:</b> With a successful Athletics check, you can climb along a slope, wall, or other steep incline at your ground speed rank minus 2 as a move action. A perfectly smooth, flat, vertical surface can't be climbed without the Wall-crawling effect of Movement (see the Powers chapter). <p>

<b>Jumping:</b> The result of an Athletics check is the distance (in feet) you can clear in a running long-jump. If you make a standing jump, divide the distance in half. If you make a vertical jump (straight up) divide the distance by 5, and if you make a standing vertical jump, divide it by 10. Your Athletics bonus + 10 is the base distance you can jump under routine circumstances. <p>

<b>Running:</b> You can make a DC 15 Athletics check as a free action to run faster: success increases your ground speed rank by +1 for one round. <p>

<b>Swimming:</b> A successful DC 10 Athletics check allows you to swim your ground speed rank minus 2 as a move action. If the check fails, you make no progress through the water during the action. With more than one degree of failure, you go under. If underwater, you must hold your breath to avoid drowning.<p>

!!
@@ @Blind
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=bb ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
The character cannot see. Everything effectively has full visual concealment from him. He is <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Hindered",currentToken())]'>hindered</a></font>, visually <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Unaware",currentToken())]'>unaware</a></font>, and <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Vulnerable",currentToken())]'>vulnerable</a></font>, and
may be <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Impaired",currentToken())]'>impaired</a></font> or <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Disabled",currentToken())]'>disabled</a></font> for activities where vision is a factor.

!!
@@ @Bound
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=bb ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
A bound character is <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Defenseless",currentToken())]'>defenseless</a></font>, <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Immobile",currentToken())]'>immobile</a></font>, and <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Impaired",currentToken())]'>impaired</a></font>.

!!
@@ @Close Combat
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
You're trained with a particular type of close attack, giving you a bonus to your attack checks with it equal to your skill rank (see Attack Check in The Basics and in the Action & Adventure chapter). Each close attack is a separate Close Combat skill with its own rank, and encompasses a single weapon or power, although an array may be considered one power, at the Gamemaster's discretion (see Arrays in the Powers chapter for more information).

!!
@@ @Compelled
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=b ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
A compelled character is directed by an outside force, but struggling against it; the character is limited to free actions and a single standard action per turn, with both types of action being chosen by another, controlling character. As usual, this standard action can be traded for a move action. <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Controlled",currentToken())]'><b>Controlled</b></a></font> supersedes compelled.

!!
@@ @ConditionsInfoDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=c ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
[h: info=json.get(macro.args,0)]
[frame("Conditions"): {
<html>
<head>
<title>Condition Display</title>
</head>
<body bgcolor="white">
<table width="100%" height="100%" cellpadding="2" align="center" border="0" bgcolor="white">
	<tr bgcolor="[r: table(PageColor,2)]" color="white">
		<td align="left" width="50">
<image src="[r: getStateImage(info,50)]" border="0"></image>
		</td>
		<td align="left">
		<font  size="5"><b>[r: info]</b></font>
		</td>
		<td align="right">
		</td>
	</tr>
	<tr>	
		<td></td>
		<td colspan="2" aligh="left">[r, macro(info+"@this"):""]</td>
	</tr>
</table>
</body>
</html>
}]

!!
@@ @ConditionsInfoRemove
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=c ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
[h: info=json.get(macro.args,0)]
[frame("Conditions"): {
<html>
<head>
<title>Condition Display</title>
</head>
<body bgcolor="white">
<table width="100%" height="100%" cellpadding="2" align="center" border="0" bgcolor="white">
	<tr bgcolor="[r: table(PageColor,2)]" color="white">
		<td align="left" width="50">
<image src="[r: getStateImage(info,50)]" border="0"></image>
		</td>
		<td align="left">
		<font  size="5"><b>[r: info]</b></font>
		</td>
		<td align="right">
			Remove <a href="[r: macroLinkText("StatesUpdateRemove@this", "none", info, currentToken())]"><image src="[r: tableImage("Buttons",10)]" border="0"></image></a>&nbsp; &nbsp; 
		</td>
	</tr>
	<tr>	
		<td></td>
		<td colspan="2" align="left">[r, macro(info+"@this"):""]</td>
	</tr>
</table>
</body>
</html>
}]

!!
@@ @Controlled
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=b ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
A controlled character has no free will; the characters actions each turn are dictated by another, controlling, character.

!!
@@ @Dazed
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=b ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
A dazed character is limited to free actions and a single standard action per turn, although the character may use that action to perform a move, as usual. <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Stunned",currentToken())]'><b>Stunned</b></a></font> supersedes dazed.

!!
@@ @Deaf
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=bb ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
The character cannot hear, giving everything total auditory concealment from him. This may allow for surprise attacks on the unaware character. Interaction with other characters is limited to sign-language and lip-reading.

!!
@@ @Debilitated
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=b ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
The character has one or more abilities lowered below 5.

!!
@@ @Deception
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
Deception is the skill of getting others to believe what you want them to believe. It covers things like acting, bluffing, fast-talk, trickery, and subterfuge. Deception takes as long as it takes to spin-out your story. <p>

<b>Bluffing:</b> Make a Deception check to tell a believable lie or get someone do go along with you. A bluff is usually opposed by the target's Deception or Insight check. Favorable and unfavorable circumstances weigh heavily on the outcome. <p>

<b>Disguise:</b> You can use makeup, costumes, and other props to change your appearance. Your Deception check result determines the effectiveness of the disguise, opposed by others' Perception check results. The GM makes the Deception check secretly, so you are not sure exactly how well your disguise holds up under scrutiny. 
<p>
<b>Feinting:</b> You can use Deception as a standard action to mislead an opponent in combat. Make a Deception check as a standard action. If your Deception check succeeds, the target is vulnerable against your next attack, until the end of your next round (see Vulnerable in the Conditions section of The Basics chapter). 
<p>
<b>Innuendo:</b> You can use Deception to send covert messages using wordplay and double-meanings while apparently talking about other things. The DC for a basic message is 10. Complex messages or messages trying to communicate new information have DCs of 15 or 20, respectively. The recipient of the message must make an Insight check against the same DC to understand it. 
<p>
<b>Tricking:</b> You can use Deception to mislead an opponent into taking a potentially unwise action, such as trying to hit you while standing in front of an electrical junction box or at the edge of a precipice. If your Deception check opposed by Deception or Insight succeeds, your opponent is heedless of the potential danger and may hit the junction box or lose his balance and fall, if his attack against you fails.

!!
@@ @Defenseless
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=b ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
A defenseless character has active defense bonuses of 0. Attackers can make attacks on defenseless opponents as routine checks. If the attacker chooses to forgo the routine check and make a normal attack check, any hit is treated as a critical hit. Defenseless characters are often <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Prone",currentToken())]'><b>Prone</b></a></font>, providing opponents with an additional bonus to attack checks.

!!
@@ @Disabled
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=b ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
A disabled character is at a 5 circumstance penalty on checks. If the penalty applies to specific checks, they are added to the name of the
condition, such as Attack Disabled, Fighting Disabled, Perception Disabled, and so forth.<font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Debilitated",currentToken())]'><b>Debilitated</b></a></font>, if it applies to the same trait(s), supersedes disabled.

!!
@@ @Dying
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=bb ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
A dying character is <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Incapacitated",currentToken())]'>incapacitated</a></font> (<font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Defenseless",currentToken())]'>defenseless</a></font>, <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Stunned",currentToken())]'>stunned</a></font>, and <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Unaware",currentToken())]'>unaware</a></font>) and near death. When the character gains this condition, immediately make a Fortitude check (DC 15). If the check succeeds, nothing happens. With two degrees of success, the character stabilizes, removing this condition. If the check fails, the character remains dying. Three or more total degrees of failure mean the character dies: so three failed Fortitude checks or one or two checks adding up to three degrees. Dying characters make a Fortitude check each round until they either die or stabilize. Another character can stabilize a dying character with a successful Treatment check (DC 15) or use of a Healing effect.

!!
@@ @Entranced
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=bb ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
An entranced character is <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Stunned",currentToken())]'>stunned</a></font>, taking no actions other than paying attention to the entrancing effect. Any obvious threat automatically
breaks the trance. An ally can also shake a character free of the condition with an interaction skill check (DC 10 + effect rank).

!!
@@ @Exhausted
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=bb ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
Exhausted characters are near collapse. They are <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Impaired",currentToken())]'>impaired</a></font> and <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Hindered",currentToken())]'>hindered</a></font>. Characters recover from an exhausted condition after an hour of rest in comfortable surroundings.

!!
@@ @Expertise
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
Expertise is a broad skill encompassing knowledge and training in a variety of specialized fields, particularly professional disciplines and scholarship. Each is considered a separate skill and training in each is acquired separately, so a former police officer turned district attorney might have Expertise: Police Officer and Expertise: Law, each with their own ranks, for example. Sample Expertise domains: Art, Business, Carpentry, Cooking, Criminal, Current Events, Dance, History, Journalism, Law, Law Enforcement, Medicine, Military, Music, Magic, Philosophy, Politics, Popular Culture, Psychiatry, Science, Sociology, Streetwise, Theology.

!!
@@ @Fatigued
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=b ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
Fatigued characters are <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Hindered",currentToken())]'><b>hindered</b></a></font>. Characters recover from a fatigued condition after an hour of rest.

!!
@@ @Grab
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=bb ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
You are <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Hindered",currentToken())]'>hindered</a></font> and <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Vulnerable",currentToken())]'>vulnerable</a></font> while grabbing and holding an opponent.

!!
@@ @Hindered
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=b ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
A hindered character moves at half normal speed (1 speed rank). <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Immobile",currentToken())]'><b>Immobile</b></a></font> supersedes hindered.

!!
@@ @Immobile
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=b ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
Immobile characters have no movement speed and cannot move from the spot they occupy, although they are still capable of taking actions unless prohibited by another condition.

!!
@@ @Impaired
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=b ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
An impaired character is at a 2 circumstance penalty on checks. If the impairment applies to specific checks, they are added to the name of
the condition, such as Attack Impaired, Fighting Impaired, Perception Impaired, and so forth. If it applies to the same trait(s), <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Disabled",currentToken())]'><b>Disabled</b></a></font> supersedes impaired.

!!
@@ @Incapacitated
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=bb ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
An incapacitated character is <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Defenseless",currentToken())]'>defenseless</a></font>, <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Stunned",currentToken())]'>stunned</a></font>, and <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Unaware",currentToken())]'>unaware</a></font>. Incapacitated characters generally also fall <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Prone",currentToken())]'>prone</a></font>, unless some outside
force or aid keeps them standing.

!!
@@ @Insight
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
You can tell someone's true intentions and feelings by paying attention to things like body language, inflection, and your own intuition.
<p>
<b>Detect Illusion:</b> The GM makes a secret Insight check to determine if your hero senses the true nature of an illusion (DC 10 + Illusion rank). Success means you pick up on a flaw in the illusion, sensing it is not real. See the Illusion effect in the Powers chapter for details. 
<p>
<b>Detect Influence:</b> You can make an Insight check to notice someone acting under outside influence. The DC is 10 + the rank of the effect or skill affecting the subject. If you succeed, you notice the subject is not acting entirely of his or her own will. Three or more degrees give you a general idea of what is influencing them (and perhaps even whom, depending on the situation and the Gamemaster's judgment).
<p>
<b>Evaluate:</b> With an Insight check, opposed by Deception, you can tell if someone is trustworthy and honorable (or not) upon meeting them. You can also make an Insight check (DC 20) to evaluate a social situation, getting a feel for the overall mood and prevailing attitudes. Two or more degrees of failure on either check mean you misinterpret the signs, so the GM may make these checks for you in secret. 
<p>
<b>Innuendo:</b> You can use Insight to pick up on hidden messages sent via the Deception skill (see the Deception skill description). Resist Influence: Make an Insight check when called to do so to resist or overcome the effects of certain interaction skills, such as Deception or Intimidation. If the result of your check exceeds your opponent's, you are unaffected by their attempt to influence you.

!!
@@ @Intimidation
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
You know how to use threats (both real and implied) to get others to do what you want. 
<p>
<b>Coercing:</b> Make an Intimidation check, opposed by the target's Insight or Will defense (whichever has the highest bonus). If your check succeeds, you may treat the target as friendly, but only for actions taken in your presence. That is, the target retains his normal attitude, but will talk, advise, offer limited help, or advocate on your behalf while intimidated. The target cooperates, but won't necessarily obey your every whim or do anything that would directly endanger him. 
<p>
<b>Demoralizing:</b> You can use Intimidation in combat as a standard action to undermine an opponent's confidence. Make an Intimidation check as a standard action. If it succeeds, your target is impaired (a -2 circumstance penalty on checks) until the end of your next round. With four or more degrees of success, the target is disabled (a -5 penalty) until the end of your next round. 
<p>
<b>Intimidating Minions:</b> You can intimidate a whole group of minions - who can all see and hear you - with a single check. If the group has you at a disadvantage, you suffer the usual circumstance penalty on your check. Compare your check result against a single resistance check made by the GM for the entire group. Your Intimidation check must have the same effect on every member of the group.

!!
@@ @Investigation
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
You know how to search for and study clues, gather information through interviews and surveillance, and analyze evidence to help solve crimes. The GM may make Investigation checks for you in secret, so you do not know exactly what you have found, or if you may have missed something. 
<p>
<b>Search:</b> You can search an area for clues, hidden items, traps, and other details. Perception allows you to immediately notice things, while an Investigation check allows you to pick up on details with some effort. 
<p>
<b>Gather Evidence:</b> To collect a piece of evidence for analysis, make an Investigation check (DC 15). If the check succeeds, the evidence can be analyzed (see the following). If the check fails, an analysis can be done, but with a -5 penalty for highly unfavorable circumstances. With more than one degree of failure, the evidence is ruined and no analysis can be done. On the other hand, two or more degrees of success provide a +2 circumstance bonus to later analysis. 
<p>
<b>Analyze Evidence:</b> You can make an Investigation check to apply forensic knowledge to evidence. This function of Investigation does not give you clues where none exist. It simply allows you to extract useful information from evidence and clues you have found. Gather Information: You know how to make contacts, collect gossip and rumors, question informants, and otherwise get information from people. 
<p>
<b>Surveillance:</b> You can set up surveillance of a particular area, watching from a stationary location. The DC of the subject's Stealth check to evade your notice is equal to the result of your Investigation check. For actively following a subject, see Tailing in the Stealth skill description.

!!
@@ @Paralyzed
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=bb ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
A paralyzed character is <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Defenseless",currentToken())]'>defenseless</a></font>, <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Immobile",currentToken())]'>immobile</a></font>, and physically <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Stunned",currentToken())]'>stunned</a></font>, frozen in place and unable to move, but still aware and able to take purely mental actions, involving no physical movement whatsoever.

!!
@@ @Perception
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
Use this skill to notice and pick up on things. Discerning details - such as clearly hearing conversation or reading fine text - requires at least three degrees of success on the Perception check. 
<p>
<b>Hearing:</b> Make a check against a DC based on how loud the noise is or against an opposed Stealth check. Normal conversation is DC 0, a soft noise DC 10. Listening through a door is +5 DC, +15 for a solid wall. While you're asleep, hearing something well enough to wake up is +10 DC. 
<p>
<b>Seeing:</b> Make a check against a DC based on how visible the object is or against an opposed Stealth check. Something in plain sight is DC 0, while something subtle or easily overlooked may be DC 5, 10 or more. Visual perception is also used to detect someone in disguise (see the Deception skill) or to notice a concealed object (see the Sleight of Hand skill). 
<p>
<b>Other Senses:</b> You can make Perception checks involving other sense types as well (see the Powers chapter for more on sense types). Noticing something obvious to a sense is DC 0. Less obvious things are DC 10 or so, hidden things DC 20 or more, and discerning details requires at least three degrees of success, as usual.

!!
@@ @Persuasion
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
You're skilled in dealing with people, from etiquette and social graces to a way with words and public speaking, all of which helps to get your point across, make a good impression, negotiate, and generally win people over to your way of seeing things. In negotiations, all participants roll Persuasion checks to see who gains the advantage. Opposed checks also resolve cases where two advocates plead opposing cases before a third party. Non-player characters each have an initial attitude towards you or your cause. The GM chooses the character's initial attitude based on circumstances. Most of the time, people are favorable or indifferent toward heroes, but a specific circumstance or complication may call for a different attitude.

!!
@@ @Prone
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=bb ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
A prone character is lying on the ground, receiving a 5 circumstance penalty on close attack checks. Opponents receive a +5 circumstance bonus to close attack checks but a 5 penalty to ranged attack checks (effectively giving the prone character total cover
against ranged attacks). Prone characters are <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Hindered",currentToken())]'>hindered</a></font>. Standing up from a prone position is a move action.

!!
@@ @Ranged Combat
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
You're trained with a particular type of ranged attack, giving you a bonus to your attack checks with it equal to your skill rank (see Attack Check in The Basics and in the Action & Adventure chapter). Each ranged attack is a separate Ranged Combat skill with its own rank, and encompasses a single weapon or power, although an array may be considered one power, at the Gamemaster's discretion (see Arrays in the Powers chapter for more information).

!!
@@ @Restrained
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=bb ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
A restrained character is <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Hindered",currentToken())]'>hindered</a></font> and <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Vulnerable",currentToken())]'>vulnerable</a></font>. If the restraints are anchored to an immobile object, the character is <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Immobile",currentToken())]'>immobile</a></font> rather than
hindered. If restrained by another character, the restrained character is immobile but may be moved by the restraining character.

!!
@@ @SkillsInfoDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=z ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
[h: skill=json.get(macro.args,0)]
[h: ability=json.get(macro.args,1)]

[h: skill = if(startsWith(skill, "CC"),"Close Combat",skill)]
[h: skill = if(startsWith(skill, "Exp"),"Expertise",skill)]
[h: skill = if(startsWith(skill, "RC"),"Ranged Combat",skill)]

[frame("Skills"): {
<html>
<head>
<title>[r: skill] Info</title>
</head>
<body bgcolor="white">
<table border="0" cellpadding="0" width="100%" height="50%">
	<tr bgcolor="[r: table(PageColor,2)]"  color="white" valign="middle">
		<td><font size="5">
<center><b>[r: skill]</b> ([r: ability])</center><p>
		</font></td>
	</tr>
</table>
[r, macro(skill+"@this"):""]
</body>
</html>
}]

!!
@@ @KnowSkillsInfoDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=z ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
[h: skill=json.get(macro.args,0)]
[h: ability=json.get(macro.args,1)]

<!-- Skills that can have multiple fields get a prefix -->
[h: skill = if(startsWith(skill, "Academics"),"Academics",skill)]
[h: skill = if(startsWith(skill, "Art"),"Art",skill)]
[h: skill = if(startsWith(skill, "Interest"),"Interest",skill)]
[h: skill = if(startsWith(skill, "Language"),"Language",skill)]
[h: skill = if(startsWith(skill, "Profession"),"Profession",skill)]

[frame("KnowledgeSkills"): {
<html>
<head>
<title>[r: skill] Info</title>
</head>
<body bgcolor="white">
<table border="0" cellpadding="0" width="100%" height="50%">
	<tr bgcolor="[r: table(PageColor,2)]"  color="white" valign="middle">
		<td><font size="5">
<center><b>[r: skill]</b> ([r: ability])</center><p>
		</font></td>
	</tr>
</table>
[r, macro(skill+"@this"):""]
</body>
</html>
}]

!!
@@ @ActiveSkillsInfoDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=z ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
[h: skill=json.get(macro.args,0)]
[h: ability=json.get(macro.args,1)]

<!-- Skills that can have multiple fields get a prefix -->
[h: skill = if(startsWith(skill, "Exotic Melee"),"Exotic Melee",skill)]
[h: skill = if(startsWith(skill, "Exotic Ranged"),"Exotic Ranged",skill)]
[h: skill = if(startsWith(skill, "Hardware"),"Hardware",skill)]
[h: skill = if(startsWith(skill, "Medicine"),"Medicine",skill)]
[h: skill = if(startsWith(skill, "Networking"),"Networking",skill)]
[h: skill = if(startsWith(skill, "Pilot"),"Pilot",skill)]

[frame("ActiveSkills"): {
<html>
<head>
<title>[r: skill] Info</title>
</head>
<body bgcolor="white">
<table border="0" cellpadding="0" width="100%" height="50%">
	<tr bgcolor="[r: table(PageColor,2)]"  color="white" valign="middle">
		<td><font size="5">
<center><b>[r: skill]</b> ([r: ability])</center><p>
		</font></td>
	</tr>
</table>
[r, macro(skill+"@this"):""]
</body>
</html>
}]

!!
@@ @StatsInfoDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=z ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
[h: statShort=json.get(macro.args,0)]

[h,switch(statShort):
  case "TT": statLong = "Trauma Threshold";
  case "LUC": statLong = "Lucidity";
  case "IR": statLong = "Insanity Rating";
  case "WT": statLong = "Wound Threshold";
  case "DUR": statLong = "Durability";
  case "DR": statLong = "Death Rating";
  case "INIT": statLong = "Initiative";
  case "SPD": statLong = "Speed";
  case "DB": statLong = "Damage Bonus";
  default: statLong = ""
]

[frame("StatsInfo"): {
<html>
<head>
<title>[r: statLong] Info</title>
</head>
<body bgcolor="white">
<table border="0" cellpadding="0" width="100%" height="50%">
	<tr bgcolor="[r: table(PageColor,2)]"  color="white" valign="middle">
		<td><font size="5">
      <center><b>[r: statLong]</b> ([r: statShort])</center><p>
		</font></td>
	</tr>
</table>
[r, macro(statShort+"@this"):""]
</body>
</html>
}]

!!
@@ @DamageStressInfoDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=z ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
[h: nameShort=json.get(macro.args,0)]

[frame("DamageStressInfo"): {
<html>
<head>
<title>[r: nameShort] Info</title>
</head>
<body bgcolor="white">
<table border="0" cellpadding="0" width="100%" height="50%">
	<tr bgcolor="[r: table(PageColor,2)]"  color="white" valign="middle">
		<td><font size="5">
      <center><b>[r: nameShort]</b></center><p>
		</font></td>
	</tr>
</table>
[r, macro(nameShort+"@this"):""]
</body>
</html>
}]

!!
@@ @DerangementDisorderInfoDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=z ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
[frame("DD"): {
<html>
<head>
<title>Derangement & Disorder Info</title>
</head>
<body bgcolor="white">
  <table border="0" cellpadding="0" width="100%" height="50%">
    <tr bgcolor="[r: table(PageColor,2)]"  color="white" valign="middle">
      <td><font size="5">
        <center><b>Derangements & Disorders</b></center><p>
      </font></td>
    </tr>
  </table>
  <h1>DERANGEMENTS</h1>
  Derangements are temporary mental conditions that result from traumas. Derangements are measured as Minor, Moderate, or Major. The gamemaster and player should cooperate in choosing which derangement to apply, as appropriate to the scenario and character personality.
  <p>
  Derangements last for 1d10 / 2 hours (round down) or until the character receives psychiatric help, whichever comes first. At the gamemasters discretion, a derangement may last longer if the character has not been distanced from the source of the stress or if they remain embroiled in other stress-inducing situations.
  <p>
  Derangement effects are meant to be roleplayed.  The player should incorporate the derangement into their characters words and actions. If the gamemaster does not feel the player is stressing the effects enough, they can emphasize them. If the gamemaster feels it is appropriate, they may also call for additional modifiers or tests for certain actions.
  <h2>ANXIETY (MINOR)</h2>
  You suffer a panic attack, exhibiting the physiological conditions of fear and worry: sweatiness, racing heart, trembling, shortness of breath, headaches, and so on.
  <h2>AVOIDANCE (MINOR)</h2>
  You are psychologically incapable of dealing with the source of the stress or some circumstance related to it, so you avoid it-even covering your ears, curling up in a ball, or shutting off your sensors if you have to.
  <h2>DIZZINESS (MINOR)</h2>
  The stress makes you light-headed and disoriented.
  <h2>ECHOLALIA (MINOR)</h2>
  You involuntarily repeat words and phrases spoken by others.
  <h2>FIXATION (MINOR)</h2>
  You become fixated on something that you did wrong or some circumstance that led to your stress. You obsess over it, repeating the behavior, trying to fix it, running scenarios through your head and out loud, and so on.
  <h2>HUNGER (MINOR)</h2>
  You are suddenly consumed by an irrational yet overwhelming desire to eat something-perhaps even something unusual.
  <h2>INDECISIVENESS (MINOR)</h2>
  You are flustered by the cause of your stress, finding it difficult to make choices or select courses of action.
  <h2>LOGORRHOEA (MINOR)</h2>
  Your response to the trauma is to engage in excessive talking and babbling. You don't shut up.
  <h2>NAUSEA (MINOR)</h2>
  The stress sickens you, forcing you to fight down queasiness.
  <h2>CHILLS (MODERATE)</h2>
  Your body temperature rises, making you feel cold, and shivering sets in. You just can't get warm.
  <h2>CONFUSION (MODERATE)</h2>
  The trauma scrambles your concentration, making you forget what you're doing, mix up simple tasks, and falter over easy decisions.
  <h2>ECHOPRAXIA (MODERATE)</h2>
  You involuntarily repeat and mimic the actions of others around you.
  <h2>MOOD SWINGS (MODERATE)</h2>
  You lose control of your emotions. You switch from ecstasy to tears and back to rage without warning.
  <h2>MUTE (MODERATE)</h2>
  The trauma shocks you into speechlessness and a complete inability to effectively communicate.
  <h2>NARCISSISM (MODERATE)</h2>
  In the wake of the mental shock, all you can think about is yourself. You cease caring about those around you.
  <h2>PANIC (MODERATE)</h2>
  You are overwhelmed by fear or anxiety and immediately seek to distance yourself from the cause of the stress.
  <h2>TREMORS (MODERATE)</h2>
  You shake violently, making it difficult to hold things or stay still.
  <h2>BLACKOUT (MAJOR)</h2>
  You operate on auto-pilot in a temporary fugue state. Later, you will be incapable of recalling what happened during this period. (Synthetic shells and infomorphs may call up memory records from storage.)
  <h2>FRENZY (MAJOR)</h2>
  You have a major freak out over the source of the stress and attack it.
  <h2>HALLUCINATIONS (MAJOR)</h2>
  You see, hear, or otherwise sense things that aren't really there.
  <h2>HYSTERIA (MAJOR)</h2>
  You lose control, panicking over the source of the stress. This typically results in an emotional outburst of crying, laughing, or irrational fear.
  <h2>IRRATIONALITY (MAJOR)</h2>
  You are so jarred by the stress that your capacity for logical judgment breaks down. You are angered by imaginary offenses, hold unreasonable expectations, or otherwise accept things with unconvincing evidence.
  <h2>PARALYSIS (MAJOR)</h2>
  You are so shocked by the trauma that you are effectively frozen, incapable of making decisions or taking action.
  <h2>PSYCHOSOMATIC CRIPPLING (MAJOR)</h2>
  The trauma overwhelms you, impairing some part of your physical functioning. You suffer from an inexplicable blindness, deafness, or phantom pain or are suddenly incapable of using a limb or other extremity.
  <h1>DISORDERS</h1>
  Disorders reflect more permanent madness. In this case, "permanent" does not necessarily mean forever, but the condition is ongoing until the character receives lengthy and effective psychiatric help. Disorders are inflicted whenever a character accumulates 4 traumas.  The gamemaster and player should choose a disorder that fits the situation and character.
  <p>
  Disorders are not always "active"-they may remain dormant until triggered by certain conditions.  While it is certainly possible to act under a disorder, it represents a severe impairment to a persons ability to maintain normal relationships and do a job successfully. Disorders should not be glamorized as cute roleplaying quirks. They represent the best attempts of a damaged psyche to deal with a world that has failed it in some way.  Additionally, people in many habitats, particularly those in the inner system, still regard disorders as a mark of social stigma and may react negatively towards impaired characters.
  <p>
  Characters that acquire disorders over the course of their adventures may get rid of them in one of two ways, either through in-game attempts to treat them (p. 215) or by buying them off as they would a negative trait (see  Gaining/Losing Traits, p. 153).
  <h2>ADDICTION</h2>
  Addiction as a disorder can refer to any sort of addictive behavior focused toward a particular behavior or substance, to the point where the user is unable to function without the addiction but is also severely impaired due to the effects of the addiction. It is marked by a desire on the part of the subject to seek help or reduce the use of the addicting substance/act, but also by the subject spending large amounts of time in pursuit of their addiction to the exclusion of other activities. This is a step up from the Addiction negative trait on p. 148-this is much more of a crippling behavior that compensates for spending time away from the addiction. Addictions are typically related to the trauma that caused the disorder (VR or drug addictions are encouraged).
  <p>
  <b>Suggested Game Effects:</b> The addict functions in only two states: under the influence of their addiction or in withdrawal. Additionally, they spend large amounts of time away from their other responsibilities in pursuit of their addiction.
  <h2>ATAVISM</h2>
  Atavism is a disorder that mainly affects uplifts. It results in them regressing to an earlier un- or partially uplifted state. They may exhibit behaviors more closely in line with their more animalistic forbears, or they may lose some of their uplift benefits such as the ability for abstract reasoning or speech.  
  <p>
  <b>Suggested Game Effects:</b>  The player and gamemaster should discuss how much of the uplifts nature is lost and adjust game penalties accordingly. It is important to note that other uplifts view atavistic uplifts with something akin to horror and will usually have nothing to do with them.
  <h2>ATTENTION DEFICIT HYPERACTIVITY DISORDER (ADHD)</h2>
  This disorder manifests as a marked inability to focus on any one task for an extended period of time, and also an inability to notice details in most situations.  Sufferers may find themselves starting multiple tasks, beginning a new one after only a cursory attempt at the prior task. ADHD suffers may also have a manic edge that manifests as confidence in their ability to get a given job done, even though they will quickly lose all interest in it.
  <p>
  <b>Suggested Game Effects:</b> Perception and related skill penalties. Increased difficulty modifiers to task actions, particularly as the action drags on.
  <h2>AUTOPHAGY</h2>
  This is a disorder that usually only occurs among uplifted octopi. It is a form of anxiety disorder characterized by self-cannibalism of the limbs. Subjects afflicted with autophagy will, under stress, begin to consume their limbs if at all possible, causing themselves potentially serious harm.
  <p>
  <b>Suggested Game Effects:</b>  Anytime an uplifted octopus with this disorder is placed in a stressful situation they must make a successful WIL x 3 Test or begin to consume one of their limbs.
  <h2>BIPOLAR DISORDER</h2>
  Bipolar disorder is also called manic depression. It is similar to depression except for the fact that the periods of depression are interrupted by brief (a matter of days at most) periods of mania where the subject feels inexplicably "up" about everything with heightened energy and a general disregard for consequences. The depressive stages are similar in all ways to depression. The manic stages are dangerous since the subject will take risks, spend wildly, and generally engage in behavior without much in the way of forethought or potential long term consequences.
  <p>
  <b>Suggested Game Effects:</b>  Similar to depression, but when manic the character must make a WIL x 3 Test to not do some action that may be potentially risky.  They will also try to convince others to go along with the idea.
  <h2>BODY DYSMORPHIA</h2>
  Subjects afflicted with this disorder believe that they are so unspeakably hideous that they are unable to interact with others or function normally for fear of ridicule and humiliation at their appearance. They tend to be very secretive and reluctant to seek help because they are afraid others will think them vain-or they may feel too embarrassed to do so. Ironically, BDD is often misunderstood as a vanity-driven obsession, whereas it is quite the opposite; people with BDD believe themselves to be irrevocably ugly or defective. A similar disorder, gender identity disorder, where the patient is upset with their entire sexual biology, often precipitates BDD-like feelings. Gender identity disorder is directed specifically at external sexually dimorphic features, which are in constant conflict with the patients internal psychiatric gender.
  <p>
  <b>Suggested Game Effects:</b> Because of the nature of Eclipse Phase and the ability to swap out and modify a body, this is a fairly common disorder. It is suggested that characters with this suffer increased or prolonged resleeving penalties since they are unable to fully adjust to the reality of their new morph.
  <h2>BORDERLINE PERSONALITY DISORDER</h2>
  This disorder is marked by a general inability to fully experience ones self any longer. Emotional states are variable and often marked by extremes and acting out. Simply put, the subject feels like they are losing their sense of self and seeks constant reassurance from others around them, yet is not fully able to act in an appropriate way. They may also engage in impulsive behaviors in an attempt to experience some sort of feeling. In extreme cases, there may be suicidal thoughts or attempts.
  <p>
  <b>Suggested Game Effects:</b> The character needs to be around others and will not be left alone, however they also are not quite able to relate to others in a normal way and may also take risks or make impulsive decisions.
  <h2>DEPRESSION</h2>
  Clinical depression is characterized by intense feelings of hopelessness and worthlessness. Subjects usually report feeling as though nothing they do matters and no one would care anyway, so they are disinclined to 
  attempt much in the way of anything. The character is depressed and finds it difficult to be motivated to do much of anything. Even simple acts such as eating and bathing can seem to be monumental tasks.
  <p>
  <b>Suggested Game Effect:</b> Depressives often lack the will to take any sort of action, often to the point of requiring a WIL x 3 Test to engage in sustained activity.
  <h2>FUGUE</h2>
  The character enters into a fugue state where they display little attention to external stimuli.  They will still function physiologically but refrain from speaking and stare off into the distance, unable to focus on events around them. Unlike catatonia, a person in a fugue state will walk around if lead about by a helper, but is otherwise unresponsive. The fugue state is usually a persistent state, but it can be an occasional state that is triggered by some sort of external stimuli similar to the original trauma that triggered the disorder.
  <p>
  <b>Suggested Game Effects:</b> Characters in a fugue state are totally non-responsive to most stimuli around them. They will not even defend themselves if attacked and will usually attempt to curl into a fetal position if physically assaulted.
  <h2>GENERAL ANXIETY DISORDER (GAD)</h2>
  GAD results in severe feelings of anxiety about nearly everything the character comes into contact with. Even simple tasks represent the potential for failure on a catastrophic scale and should be avoided or minimized. Additionally, negative outcomes for any action are always assumed to be the only possible outcomes.
  <p>
  <b>Suggested Game Effects:</b>  A character with GAD will be almost entirely useless unless convinced otherwise, and then only for a short period of time. Another character can attempt to use a relevant social skill to coax the GAD character into doing what is required of them. If the character with the disorder fails at the task, however, all future attempts to coax them will suffer a cumulative 10 penalty.
  <h2>HYPOCHONDRIA</h2>
  Hypochondriacs suffer from a delusion that they are sick in ways that they are not. They will create disorders that they believe they suffer from, usually to get the attention of others. Often hypochondriacs will inflict harm on themselves or even ingest substances that will aid in producing symptoms similar to the disorder they believe they have. These attempts to simulate symptoms can and will cause actual harm to hypochondriacs.
  <p>
  <b>Possible Game Effects:</b> A subject that is hypochondriac will often behave as though they are under the effects of some other disorder or physical malady.  This can be consistent over time or can be different and ever changing. They will react with hostility to claims that they are faking or not actually ill.
  <h2>IMPULSE CONTROL DISORDER</h2>
  Subjects have a certain act or belief that they must engage in a certain activity that comes into their mind.  This can be kleptomania, pyromania, sexual exhibitionism, etc. They feel a sense of building anxiety whenever they are prevented from engaging in this behavior for an extended period (usually several times a day to weekly, depending on the impulse) and will often attempt to engage in this behavior at inconvenient or inappropriate times. This is different from OCD in the sense that OCD is usually a single contained behavior that must be engaged in to reduce anxiety. Impulse control disorder is a variety of behaviors and can be virtually any sort of highly  inappropriate action.
  <p>
  <b>Suggested Game Effects:</b> Similar to OCD, if the character does not engage in the behavior they will grow increasingly disturbed and suffer penalties to all actions until they are able to engage in the compulsion that alleviates their anxiety.
  <h2>INSOMNIA</h2>
  Insomniacs find themselves unable to sleep, or unable to sleep for an extended period of time. This is most often due to anxiety about their lives or as a result of depression and the accompanying negative thought patterns. This is not the sort of sleeplessness that is brought about as a result of normal stress but rather a near total inability to find rest in sleep when it is desired.  Insomniacs may find themselves nodding off at inopportune times, but never for long, and never enough to gain any restful sleep. As a result, they are frequently lethargic and inattentive as their lack of sleep robs them of their edge and eventually any semblance of alertness.   Additionally, insomniacs are frequently irritable due to being on edge and unable to rest.
  <p>
  <b>Suggested Game Effects:</b> Due to the lack of meaningful sleep, insomniacs should suffer from blanket penalties to perception-related tasks or anything requiring concentration or prolonged fine motor abilities.
  <h2>MEGALOMANIA</h2>
  A megalomaniac believes themselves to be the single most important person in the universe. Nothing is more important than the megalomaniac and everything around them must be done according to their whim. Failure to comply with the dictates of a megalomaniac can often result in rages or actual physical assaults by the subject.
  <p>
  <b>Suggested Game Effects:</b>  A character that has megalomania will demand attention and has difficulty in nearly any social situation. Additionally, they may be provoked to violence if they think they are being slighted.
  <h2>MULTIPLE PERSONALITY DISORDER</h2>
  This is the development of a separate, distinct personality from the original or control personality.  The personalities may or may not be aware of each other and "conscious" during the actions of the other personality. Usually there is some sort of trigger that results in the emergence of the non-control personality.  Most subjects have only a single extra personality, but it is not unheard of to have several personalities.  It is important to note that these are distinct individual personalities and not just crude caricatures of the Dr. Jekyll/Mr. Hyde sort. Each personality sees itself as a distinct person with their own wants, needs, and motivations.  Additionally, they are usually unaware of the experiences of the others, though there is some basic information sharing (such as language and core skill sets).
  <p>
  <b>Suggested Game Effects:</b> When the player is under the effects of another personality, they should be treated as an NPC. In some rare cases the player and the gamemaster can work out the second personality and allow the player to roleplay this. This does not however constitute an entire new character that can be "turned on" at will.
  <h2>OBSESSIVE COMPULSIVE DISORDER (OCD)</h2>
  Subjects with OCD are marked by intrusive or inappropriate thoughts or impulses that cause acute anxiety if a particular obsession or compulsion is not engaged in to alleviate them. These obsessions and compulsions can be nearly any sort of behavior that must be immediately engaged in to keep the rising anxiety at bay. Players and gamemasters are encouraged to come up with a behavior that is suitable.  Examples of common behaviors include repetitive tics (touching every finger of each hand to another part of the body, tapping the right foot twenty times), pathological behaviors such as gambling or eating, or a mental ritual that must be completed (reciting a 
  book passage).
  <p>
  <b>Suggested Game Effects:</b> If the character does not engage in the behavior they will grow increasingly disturbed and suffer penalties to all actions until they are able to engage in the compulsion that alleviates their anxiety.
  <h2>POST TRAUMATIC STRESS DISORDER (PTSD)</h2>
  PTSD occurs as a result of being exposed to either a single incident or a series of incidents where the sufferer had their own life, or saw the lives of others, threatened with death. These incidents are often marked by an inability on the part of the victim, either real or perceived, to do anything to alter the outcomes.  As a result, they develop an acute anxiety and fixation on these incidents to the point where they lose sleep, become irritated or easily angered, or are depressed over feelings that they lack control in their own lives.
  <p>
  <b>Suggested Game Effects:</b> Penalties to task actions, also treat situations similar to the initial episodes that caused the disorder as a phobia.
  <h2>SCHIZOPHRENIA</h2>
  While schizophrenia is generally acknowledged as a genetic disorder that has an onset in early adulthood, it also seems to develop in a number of egos that undergo frequent morph changes. It has been theorized that this is due to some sort of repetitive error in the download process. Regardless, it remains a rare, yet persistent danger of dying and being brought back. Schizophrenia is a psychotic disorder where the subject loses their ability to discern reality from unreality. This can involve delusions, hallucinations (often in support of the delusions), and fragmented or disorganized speech. The subject will not be aware of these behaviors and will perceive themselves as functioning normally, often to the point of becoming paranoid that others are somehow involved in a grand deception.
  <p>
  <b>Suggested Game Effects:</b> Schizophrenia represents a total break from reality. A character that is schizophrenic may see and hear things and act on those delusions and hallucinations while seeing attempts by their friends to stop or explain to them as part of a wider conspiracy. Adding to this is the difficulty of communicating coherently. Characters that have become schizophrenic are only marginally functional and only for short periods of time until they have the disorder treated.
</body>
</html>
}]

!!
@@ @ReputationInfoDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=z ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
[frame("ReputationInfoDisplay"): {
<html>
<head>
<title>Reputation Tables and Info</title>
</head>
<body>
  <table bgcolor="[r: table(PageColor,4)]">
    <tr>
      <td colspan="4" style="background-color:'[r: table(PageColor,2)]'  ; margin:0px; padding:0px; height:0px">
        <center><h2><span style="color:white">Reputation Networks</span></h2></center>
      </td>
    </tr>
    <tr>
      <td colspan="4" style="background-color:'[r: table(PageColor,3)]'  ; margin:0px; padding:0px; height:0px"><img src='[r: tblImage("Icons",10,5)]' border="0"></img></td>
    </tr>
    <tr bgcolor='[r: table(PageColor,2)]'>
      <td><b><span style="color:white">Network Name</td>
      <td><b><span style="color:white">Rep Name</td>
      <td><b><span style="color:white">Networking Field</td>
      <td><b><span style="color:white">Factions and Others</td>
    </tr>
    <tr bgcolor="white">
      <td>The Circle-A List</td>
      <td>@-Rep</td>
      <td>Autonomists</td>
      <td>anarchists, Barsoomians, Extropians, Titanian, and scum</td>
    </tr>
    <tr>
      <td>CivicNet</td>
      <td>c-Rep</td>
      <td>Hypercorps</td>
      <td>hypercorps, Jovians, Lunars, Martians, Venusians</td>
    </tr>
    <tr bgcolor="white">
      <td>EcoWave</td>
      <td>e-Rep</td>
      <td>Ecologists</td>
      <td>nano-ecologists, preservationists, and reclaimers</td>
    </tr>
    <tr>
      <td>Fame</td>
      <td>f-Rep</td>
      <td>Media</td>
      <td>socialites (also artists, glitterati, and media)</td>
    </tr>
    <tr bgcolor="white">
      <td>Guanxi</td>
      <td>g-Rep</td>
      <td>Criminals</td>
      <td>criminals</td>
    </tr>
    <tr>		
      <td>The Eye</td>
      <td>i-Rep</td>
      <td>Firewall</td>
      <td>Firewall</td>
    </tr>
    <tr bgcolor="white">
      <td>Research Network Associates</td>
      <td>r-Rep</td>
      <td>Scientists</td>
      <td>argonauts (also technologists, researchers, and scientists)</td>
    </tr>
  </table>
  <br>
  <table bgcolor="[r: table(PageColor,4)]">
    <tr>
      <td valign="top">
        <table bgcolor="[r: table(PageColor,4)]">
          <tr>
            <td colspan="2" style="background-color:'[r: table(PageColor,2)]'  ; margin:0px; padding:0px; height:0px">
              <center><h2><span style="color:white">Networking Skill modifiers</span></h2></center>
            </td>
          </tr>
          <tr>
            <td colspan="2" style="background-color:'[r: table(PageColor,3)]'  ; margin:0px; padding:0px; height:0px"><img src='[r: tblImage("Icons",10,5)]' border="0"></img></td>
          </tr>
          <tr bgcolor='[r: table(PageColor,2)]'>
            <td><b><span style="color:white">Situation</td>
            <td><b><span style="color:white">Modifier</td>
          </tr>
          <tr bgcolor="white">
            <td>Favor level exceeds Rep level</td>
            <td>-10 per level</td>
          </tr>
          <tr>
            <td>Rep level exceeds Favor level</td>
            <td>+10 per level</td>
          </tr>
          <tr bgcolor="white">
            <td>Keeping quiet</td>
            <td>-Variable (p. 288)</td>
          </tr>
          <tr>
            <td>Burning Rep</td>
            <td>+Rep amount burned</td>
          </tr>
          <tr bgcolor="white">
            <td>Paying extra</td>
            <td>+10 per level</td>
          </tr>
        </table>
      </td>
      <td valign="top">
        <table bgcolor="[r: table(PageColor,4)]">
          <tr>
            <td colspan="2" style="background-color:'[r: table(PageColor,2)]'  ; margin:0px; padding:0px; height:0px">
              <center><h2><span style="color:white">Reputation levels</span></h2></center>
            </td>
          </tr>
          <tr>
            <td colspan="2" style="background-color:'[r: table(PageColor,3)]'  ; margin:0px; padding:0px; height:0px"><img src='[r: tblImage("Icons",10,5)]' border="0"></img></td>
          </tr>
          <tr bgcolor='[r: table(PageColor,2)]'>
            <td><b><span style="color:white">Reputation Score</td>
            <td><b><span style="color:white">Reputation Level</td>
          </tr>
          <tr bgcolor="white">
            <td>0-19</td>
            <td>Level 1</td>
          </tr>
          <tr>
            <td>20-39</td>
            <td>Level 2</td>
          </tr>
          <tr bgcolor="white">
            <td>40-59</td>
            <td>Level 3</td>
          </tr>
          <tr>
            <td>60-79</td>
            <td>Level 4</td>
          </tr>
          <tr bgcolor="white">
            <td>80-99</td>
            <td>Level 5</td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
  <br>
  <table bgcolor="[r: table(PageColor,4)]">
    <tr>
      <td valign="top">
        <table bgcolor="[r: table(PageColor,4)]">
          <tr>
            <td colspan="4" style="background-color:'[r: table(PageColor,2)]'  ; margin:0px; padding:0px; height:0px">
              <center><h2><span style="color:white">Favors</span></h2></center>
            </td>
          </tr>
          <tr>
            <td colspan="4" style="background-color:'[r: table(PageColor,3)]'  ; margin:0px; padding:0px; height:0px"><img src='[r: tblImage("Icons",10,5)]' border="0"></img></td>
          </tr>
          <tr bgcolor='[r: table(PageColor,2)]'>
            <td><b><span style="color:white">Favor Level</td>
            <td><b><span style="color:white">Timeframe</td>
            <td><b><span style="color:white">Burning Rep cost</td>
            <td><b><span style="color:white">Refresh Rate</td>
          </tr>
          <tr bgcolor="white">
            <td>1 (Trivial)</td>
            <td>1 minute</td>
            <td>0</td>
            <td>1 hour</td>
          </tr>
          <tr>
            <td>2 (Low)</td>
            <td>30 minutes</td>
            <td>1</td>
            <td>1 day</td>
          </tr>
          <tr bgcolor="white">
            <td>3 (Moderate)</td>
            <td>1 hour</td>
            <td>5</td>
            <td>1 week</td>
          </tr>
          <tr>
            <td>4 (High)</td>
            <td>1 day</td>
            <td>10</td>
            <td>1 month</td>
          </tr>
          <tr bgcolor="white">
            <td>5 (Scarce)</td>
            <td>3 days</td>
            <td>20</td>
            <td>3 months</td>
          </tr>
        </table>
      </td>
      <td valign="top">
        <table bgcolor="[r: table(PageColor,4)]">
          <tr>
            <td colspan="2" style="background-color:'[r: table(PageColor,2)]'  ; margin:0px; padding:0px; height:0px">
              <center><h2><span style="color:white">Acquire/Unload Goods</span></h2></center>
            </td>
          </tr>
          <tr>
            <td colspan="2" style="background-color:'[r: table(PageColor,3)]'  ; margin:0px; padding:0px; height:0px"><img src='[r: tblImage("Icons",10,5)]' border="0"></img></td>
          </tr>
          <tr bgcolor='[r: table(PageColor,2)]'>
            <td><b><span style="color:white">Level</td>
            <td><b><span style="color:white">Service</td>
          </tr>
          <tr bgcolor="white">
            <td>1</td>
            <td>Acquire/unload item with an expense of Trivial.</td>
          </tr>
          <tr>
            <td>2</td>
            <td>Acquire/unload item with an expense of Low.</td>
          </tr>
          <tr bgcolor="white">
            <td>3</td>
            <td>Acquire/unload item with an expense of Moderate.</td>
          </tr>
          <tr>
            <td>4</td>
            <td>Acquire/unload item with an expense of High.</td>
          </tr>
          <tr bgcolor="white">
            <td>5</td>
            <td>Acquire/unload item with an expense of Expensive.</td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
  <br>
  <table bgcolor="[r: table(PageColor,4)]">
    <tr>
      <td valign="top">
        <table bgcolor="[r: table(PageColor,4)]">
          <tr>
            <td colspan="2" style="background-color:'[r: table(PageColor,2)]'  ; margin:0px; padding:0px; height:0px">
              <center><h2><span style="color:white">Acquire Services</span></h2></center>
            </td>
          </tr>
          <tr>
            <td colspan="2" style="background-color:'[r: table(PageColor,3)]'  ; margin:0px; padding:0px; height:0px"><img src='[r: tblImage("Icons",10,5)]' border="0"></img></td>
          </tr>
          <tr bgcolor='[r: table(PageColor,2)]'>
            <td><b><span style="color:white">Level</td>
            <td><b><span style="color:white">Service</td>
          </tr>
          <tr bgcolor="white">
            <td>1</td>
            <td><b>Trivial favor:</b> Get someone to perform services for 15 minutes. Move a chair. Browbeat someone. Catch a ride. Research someone online. Borrow 50 credits. Other Trivial cost services.</td>
          </tr>
          <tr>
            <td>2</td>
            <td><b>Minor favor:</b> Get someone to perform services for an hour. Move to a new cubicle. Rough someone up. Loan a vehicle. Provide an alibi. Healing vat rental. Minor hacking assistance. Basic legal or police assistance. Borrow 250 credits. Other Low cost services.</td>
          </tr>
          <tr bgcolor="white">
            <td>3</td>
            <td><b>Moderate favor:</b>  Get someone to perform services for a day. Move to a habitat in the same cluster. Serious beating. Lookout. Short-distance egocast. Short shuttle trip (under 50,000 km). Minor psychosurgery. Uploading. Reservations at the best restaurant ever. Major legal representation or police favors. Borrow 1,000 credits. Other Moderate cost services</td>
          </tr>
          <tr>
            <td>4</td>
            <td><b>Major favor:</b> Get someone to perform services for a month. Move a body. Homicide. Getaway shuttle pilot. Industrial sabotage. Large-volume shipping contract on bulk freighter. Medium-distance egocast. Mid-range shuttle trip (50,000-150,000 km). Moderate psychosurgery. Resleeving. Get out of jail free. Borrow 5,000 credits. Other High cost services.</td>
          </tr>
          <tr bgcolor="white">
            <td>5</td>
            <td><b>Partnership:</b> Get someone to perform services for a year. Move dismembered body. Mass murder. Major embezzlement. Acts of terrorism. Relocate a mid-size asteroid. Long-distance egocast. Long-range shuttle trip (150,000 km or more). Borrow 20,000 credits. Other Expensive cost services.</td>
          </tr>
        </table>
      </td>
      <td valign="top">
        <table bgcolor="[r: table(PageColor,4)]">
          <tr>
            <td colspan="2" style="background-color:'[r: table(PageColor,2)]'  ; margin:0px; padding:0px; height:0px">
              <center><h2><span style="color:white">Acquire Information</span></h2></center>
            </td>
          </tr>
          <tr>
            <td colspan="2" style="background-color:'[r: table(PageColor,3)]'  ; margin:0px; padding:0px; height:0px"><img src='[r: tblImage("Icons",10,5)]' border="0"></img></td>
          </tr>
          <tr bgcolor='[r: table(PageColor,2)]'>
            <td><b><span style="color:white">Level</td>
            <td><b><span style="color:white">Service</td>
          </tr>
          <tr bgcolor="white">
            <td>1</td>
            <td><b>Common Information:</b> Where to eat. What biz a certain hypercorp is in. Who is in charge.</td>
          </tr>
          <tr>
            <td>2</td>
            <td><b>Public Information:</b> Make gray market connections. Where the "bad neighborhood" is. Obscure public database info. Who is the local crime syndicate. Public hypercorp news.</td>
          </tr>
          <tr bgcolor="white">
            <td>3</td>
            <td><b>Private Information:</b> Make black market connections. Where an unlisted hypercorp facility is. Who is a cop. Who is a crime syndicate member. Where someone hangs out. Internal hypercorp news. Who is sleeping with whom.</td>
          </tr>
          <tr>
            <td>4</td>
            <td><b>Secret Information:</b> Make exotic black market connections. Where a secret corp facility is. Where someone is hiding out. Secret hypercorp projects. Who is cheating on whom.</td>
          </tr>
          <tr bgcolor="white">
            <td>5</td>
            <td><b>Top Secret Intel:</b> Where a top secret black-budget lab is. Illegal hypercorp projects. Scandalous data. Blackmail material.</td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
  
</body>
</html>
}]

!!
@@ @Academics
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Field, Knowledge
<p>
<b>Linked Aptitude:</b> COG
<p>
<b>What it is:</b> Academics covers any sort of specialized non-applied knowledge you can only get through intensive education. Most theoretical and applied sciences, social sciences, transhumanities, etc. are covered by this skill. Most of the other skills listed in this chapter could also be taken as an Academics field, reflecting a working theoretical knowledge of the skill-for example, Academics: Armorer or Academics: Interrogation.
<p>
<b>When you use it:</b> Academics is used when a character wishes to call upon a specific body of knowledge. For example, Academics: Chemistry could be used to identify a particular substance, understand an unusual chemical reaction, or determine what elements are needed to nanofabricate something that requires exotic materials. At the gamemaster's discretion, some Academics-related tests might not be defaultable, given that only someone who has been educated in that subject is likely to be able to tackle it.
<p>
<b>Sample Fields:</b> Archeology, Astrobiology, Astronomy, Astrophysics, Astrosociology, Biochemistry, Biology, Botany, Computer Science, Cryptography, Economics, Engineering, Genetics, Geology, Linguistics, Mathematics, Memetics, Nanotechnology, Old Earth History, Physics, Political Science, Psychology, Sociology, Xeno-archeology, Xenolinguistics, Zoology
<p>
<b>Specializations:</b> As appropriate to the field

!!
@@ @Art
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Field, Knowledge
<p>
<b>Linked Aptitude:</b> INT
<p>
<b>What it is:</b> Art confers the ability to create and evaluate artistic endeavors. This is a particularly useful skill in Eclipse Phase, especially in the post-scarcity economies where creativity and vision can be a key component to a character's reputation.
<p>
<b>When you use it:</b> The Art skill can be used to either create a new work of art or to duplicate an existing piece of art in the hopes of passing it off as your own. The skill can also determine the approximate value of a piece of art either on the open market, for monetary exchange systems, or in terms of reputation for the artist.
<p>
<b>Sample Fields:</b> Architecture, Criticism, Dance, Drama, Drawing, Painting, Performance, Sculpture, Simulspace Design, Singing, Speech, Writing
<p>
<b>Specializations:</b> As appropriate to the field

!!
@@ @Interest
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Field, Knowledge
<p>
<b>Linked Aptitude:</b> COG
<p>
<b>What it is:</b> Interest includes just about any topic that captures your attention that isn't covered by another skill. This includes hobbies, obsessions, causes, pastimes, and other recreational pursuits.
<p>
<b>When you use it:</b> Use the Interest skill whenever you need to recall or use knowledge related to the particular interest in question.
<p>
<b>Sample Fields:</b> Ancient Sports, Celebrity Gossip, Conspiracies, Factor Trivia, Gambling, Hypercorp Politics, Lunar Habitats, Martian Beers, Old Earth Nation-States, Reclaimer Blogs, Science Fiction, Scum Drug Dealers, Spaceship Models, Triad Economics, Underground XP
<p>
<b>Specializations:</b> As appropriate to the field

!!
@@ @Language
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Field, Knowledge
<p>
<b>Linked Aptitude:</b> INT
<p>
<b>What it is:</b> Language covers the speaking and reading of languages other than the player's native tongue. A speaker is considered fluent at a skill level of 50; anything above this indicates further refinement in technical vocabulary, accents, and knowledge of dialects.
<p>
<b>When you use it:</b> Use the Language skill whenever you want to speak, understand, or read something in a language at which you are skilled. Most speaking and reading comprehension tests can be considered Simple Success Tests if your skill is over 50, unless the gamemaster rules the subject is sufficiently complex that a non-native speaker would have trouble understanding it.
<p>
<b>Sample Fields:</b> Arabic, Cantonese, English, French, Hindi, Japanese, Mandarin, Portuguese, Russian, Spanish
<p>
<b>Specializations:</b> As appropriate to the field, representing dialects, technical jargon, and subcultural slang

!!
@@ @Animal Handling
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Social
<p>
<b>Linked Aptitude:</b> SAV
<p>
<b>What it is:</b> Skilled animal handlers are able to train and control a wide variety of natural and transgenic animals, including partial uplifts. Though many animal species went extinct during the Fall, a few ark and zoo habitats keep some species alive, and many others can be resurrected from genetic samples. Exotic animals are considered a sign of prestige among the hypercorp elites, and guard animals are occasionally used to protect high-security installations. Likewise, many habitats and settlements employ small armies of partially uplifted, genetically modified, and behavior-controlled creatures for sanitation or other purposes. Many new and strange breeds of animal are created daily to serve a variety of roles.
<p>
<b>When you use it:</b> Animal Handling is used whenever you are trying to manipulate an animal, whether your intent is to calm it down, keep it from attacking, intimidate it, acquire its trust, or goad it into attacking. Your Margin of Success determines how effective you are at convincing the creature. At the gamemasters discretion, modifiers may be applied to the test. Likewise, winning an animal over may sometimes take time and so could be handled as a Task Action with a timeframe of five minutes or more.
<p>
<b>Specializations:</b> Per animal species (dogs, horses, smart rats, etc.)
<h3>Training Animals</h3>
Training animals is a time-consuming task requiring repeated efforts and rewards to reinforce the trained behavior. Treat this as a Task Action with a timeframe of one day to one month, depending on the complexity of the action. Apply modifiers to this test based on the relative intelligence of the animal being trained, how domestic it is, and the complexity of the task.
<p>
Once an animal has been trained, commanding it is treated as a Simple Success Test (see p. 118) except for unusual or stressful situations, in which case the trainer receives a +30 modifier on their Animal Handling Tests when convincing the animal to complete the trained action.

!!
@@ @Beam Weapons
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Combat
<p>
<b>Linked Aptitude:</b> COO
<p>
<b>What it is:</b> The Beam Weapons skill covers the usage and maintenance of standard coherent beam energy weapons such as lasers, particle beam weapons, plasma rifles, and microwave weapons (p. 338).
<p>
<b>When you use it:</b> A player uses their Beam Weapons skill whenever attacking with a beam weapon in combat (p. 191). Beam Weapons may also be used for tests involving maintenance of the weapon, but not for repairing or modifying the weapon (that would be Hardware: Armorer skill).
<p>
<b>Specializations:</b> Lasers, Microwave Weapons, Particle Beam Weapons, Plasma Rifles

!!
@@ @Blades
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Combat
<p>
<b>Linked Aptitude:</b> SOM
<p>
<b>What it is:</b> The Blades skill covers the usage and maintenance of standard bladed weapons (p. 334).
<p>
<b>When you use it:</b> A player uses their Blades skill whenever attacking with a blade weapon in melee combat (p. 191). Blades may also be used for tests involving maintenance of the weapon, but not for repairing or modifying the weapon (that would be Hardware: Armorer skill). This skill is used for blade weapons implanted in the body at the end of an appendage (hands, forearms, feet, octomorph arms, etc.), but the Exotic Melee Weapon skill is used for blades implanted in other parts of the body.
<p>
<b>Specializations:</b> Axes, Implant Blades, Knives, Swords

!!
@@ @Climbing
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Physical
<p>
<b>Linked Aptitude:</b> SOM
<p>
<b>What it is:</b> Climbing is the skill of ascending and descending sheer surfaces with or without the aid of specialized equipment.
<p>
<b>When you use it:</b> This skill is used whenever a character wishes to scale a climbable surface. For heights greater than one story, climbing is handled as a Task Action with a timeframe equivalent to one meter per Combat Turn. For rappelling, the timeframe for descent is 50 meters per Action Turn. Climbing gear (Grip Pads, p. 305; Traction Pads, p. 317; Spindle Climber, p. 333) provides appropriate modifiers.
<p>
<b>Specializations:</b> Assisted, Freehand, Rappelling

!!
@@ @Clubs
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Combat
<p>
<b>Linked Aptitude:</b> SOM
<p>
<b>What it is:</b> The Clubs skill covers the usage and maintenance of standard blunt melee weapons such as batons or sticks (see Clubs, p. 334).
<p>
<b>When you use it:</b> Players use their Clubs skill whenever they want to attack with a blunt weapon in melee combat (p. 191). The Clubs skill may also be used for tests involving maintenance of the weapon, but not for repairing or modifying the weapon (that would be Hardware: Armorer skill).
<p>
<b>Specializations:</b> Batons, Hammers, Staffs

!!
@@ @Control
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Mental, Psi
<p>
<b>Linked Aptitude:</b> WIL (no defaulting)
<p>
<b>What it is:</b> Control is the use of psi to manipulate individuals or actively penetrate their mental processes. This skill is only available to characters with the Psi trait, (p. 147).
<p>
<b>When you use it:</b> Use Control when taking a psionic tour through a foreign ego - messing around included. See Psi, p. 220
<p>
<b>Specializations:</b> By sleight

!!
@@ @Deception
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Social
<p>
<b>Linked Aptitude:</b> SAV
<p>
<b>What it is:</b> Deception is your ability to act, bluff, con, fast talk, lie, misrepresent, and pretend. Accomplished users of deception are able to convince anyone of nearly anything. This skill does not include using a physical disguise or passing yourself off as another person (the Disguise and Impersonate skills cover those areas).
<p>
<b>When you use it:</b> Use this skill whenever you want to deceive someone with words or gestures. A successful skill test means that you have passed off your deception convincingly. At the gamemasters discretion, someone who is actively alert for signs of deception may make an Opposed Test using the Kinesics skill.
<p>
<b>Specializations:</b> Acting, Bluffing, Fast Talk

!!
@@ @Demolitions
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Technical
<p>
<b>Linked Aptitude:</b> COG (no defaulting)
<p>
<b>What it is:</b> Demolitions covers the use of controlled explosives.
<p>
<b>When you use it:</b> Use it when making, placing, and disarming explosives and explosive devices. see Demolitions, p. 197
<p>
<b>Specializations:</b> Commercial Explosives, Disarming, Improvised Explosives

!!
@@ @Disguise
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Physical
<p>
<b>Linked Aptitude:</b> INT
<p>
<b>What it is:</b> Disguise is the art of physically altering your appearance so that you look like someone else. This includes both the use of props (wigs, contacts, skin pigments) and the altering of subtle physical 
characteristics (gait, posture, poise).
<p>
<b>When you use it:</b> Use Disguise to fool someone into thinking you are someone you are not. This can be used to hide your identity or to make yourself look like someone in particular. When used against someone who knows your true look or the appearance of the person you are imitating, this is handled as an Opposed Test against Perception or Investigation.
<p>
<b>Specializations:</b> Cosmetic, Theatrical

!!
@@ @Exotic Melee Weapon
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Field, Active, Combat
<p>
<b>Linked Aptitude:</b> SOM
<p>
<b>What it is:</b> The Exotic Melee Weapon skill covers the use and maintenance of all melee weapons not covered by the Clubs or Blades skills (see p. 334).
<p>
<b>When you use it:</b> Use the Exotic Melee Weapon skill when attacking someone with an exotic melee weapon in melee combat (see p. 191).
<p>
<b>Sample Fields:</b> Morning Star, Spear, Whip
<p>
<b>Specializations:</b> N/A

!!
@@ @Exotic Ranged Weapon
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Field, Active, Combat
<p>
<b>Linked Aptitude:</b> COO
<p>
<b>What it is:</b> Exotic Ranged Weapon skill includes the use and maintenance of all ranged weapons not covered by the Beam, Kinetic, Seeker, Spray, or Throwing Weapons skills.
<p>
<b>When you use it:</b> Use this skill whenever attacking with an exotic ranged weapon in ranged combat (see p. 191).
<p>
<b>Sample Fields:</b> Blowgun, Crossbow, Slingshot
<p>
<b>Specializations:</b> N/A

!!
@@ @Flight
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Physical
<p>
<b>Linked Aptitude:</b> SOM
<p>
<b>What it is:</b> Flight is the skill of using your body to fly. This skill is used when sleeved in or jamming a winged or otherwise flight-capable morph (manual and remote-control flight are handled using Pilot skill).
<p>
<b>When you use it:</b> Use this skill whenever you need to make an aerial maneuver, land in difficult conditions, maintain your course in steep winds, or otherwise keep from crashing or falling.
<p>
<b>Specializations:</b> Diving, Landing, Takeoff, specific maneuvers

!!
@@ @Fray
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Combat
<p>
<b>Linked Aptitude:</b> REF
<p>
<b>What it is:</b> Fray is the ability to get out of the way of incoming attacks, debris, or inconvenient passers-by. Characters that have a high Fray score are able to react quicker than others when dodging or maneuvering.
<p>
<b>When you use it:</b> Whenever a character is physically attacked by an opponent in melee combat, roll Fray to avoid getting hit (see Step 2: Declare Defense, p. 191). Fray may also be used to dodge other events that may harm the character, such as avoiding a charging vehicle or jumping out of the way of a collapsing stack of crates.
<p>
<b>Specializations:</b> Blades, Clubs, Full Defense, Unarmed

!!
@@ @Free Fall
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Physical
<p>
<b>Linked Aptitude:</b> REF
<p>
<b>What it is:</b> Free Fall is about moving in free-fall and microgravity environments.
<p>
<b>When you use it:</b> Use whenever you need to maneuver in a zero-g situation, such as propelling yourself across a large open space or making sure you do not accidentally send yourself spinning off into space. Free Fall is also used when moving with spacesuit maneuvering jets and when parachuting.
<p>
<b>Specializations:</b> Microgravity, Parachuting, Vacsuits

!!
@@ @Freerunning
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Physical
<p>
<b>Linked Aptitude:</b> SOM
<p>
<b>What it is:</b> Freerunning is part running, part gymnastics. It is about moving fast, maneuvering over/under/around/through obstacles, and placing your body where it needs to go. Freerunning/parkour is a popular pastime in habitats where open space is limited.
<p>
<b>When you use it:</b> Use Freerunning whenever you need to overcome an obstacle via movement, such as hurdling a railing, rolling across the hood of a car, jumping across a pit, or swinging around a pole. Freerunning is also used for sprinting (p. 191) and full defense against attacks (p. 198).
<p>
<b>Specializations:</b> Balance, Gymnastics, Jumping, Running

!!
@@ @Gunnery
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Combat
<p>
<b>Linked Aptitude:</b> INT
<p>
<b>What it is:</b> Gunnery skill covers the use and maintenance of large, vehicular, or non-portable weapons systems. Firing these weapons is more like playing a video game than firing a gun.
<p>
<b>When you use it:</b> Use Gunnery when attacking with a vehicle-mounted weapon or weapon emplacement in ranged combat (p. 191).
<p>
<b>Specializations:</b> Artillery, Missiles

!!
@@ @Hardware
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Field, Active, Technical
<p>
<b>Linked Aptitude:</b> COG
<p>
<b>What it is:</b> This skill encompasses the ability to build, repair, physically hack, and upgrade equipment of a specific type.
<p>
<b>When you use it:</b> Hardware is primarily used to repair devices, vehicles, habitat systems, or synthetic morphs. See Building, Repairing, and Modifying below.
<p>
<b>Sample Fields:</b> Aerospace (all air and space vehicles), Armorer (armor and weapons), Electronics (all computerized devices), Groundcraft, Implants, Industrial (habitat, factory, and life support systems), Nautical (watercraft and submarines), Robotics (synthetic morphs).
<p>
<b>Specializations:</b> As appropriate to the field.
<h3>Building</h3>
Creating an item from scratch is handled as a Task Action with a timeframe determined by the gamemaster. The timeframe should be set according to the complexity of the object and could range from an hour (constructing a set of shelves) to days (assembling a robot from spare parts) or even months (building a house). Numerous factors may apply modifiers to the test, such as the use of entoptic blueprints/help manuals (+20) or poor working conditions (10 to30). Tools are also a factor, perhaps making the job easier (superior tools +10 to +30), more difficult (poor or inadequate tools, 10 to 30), or even impossible (lack of required tools).
<h3>Repairing</h3>
Damaged items may be repaired in a similar manner. See the rules for Synthmorph and Object Repair, p. 208.
<h3>Modifying</h3>
Altering an objects design and function follows the same basic rules as build and repair, above. The timeframe is determined by the gamemaster as appropriate to the modification.

!!
@@ @TT
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<p>
The Trauma Threshold determines if you suffer a trauma (mental wound) each time you take stress (see Mental Health, p. 209). A higher Trauma Threshold means that your mental state is more resilient against experiences that might inflict psychiatric disorders or other serious mental instabilities.
<p>
Trauma Threshold is calculated by dividing Lucidity by 5 (rounding up).

!!
@@ @LUC
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<p>
Lucidity is similar to Durability, except that it measures mental health and state of mind rather than physical well-being. Your Lucidity determines how much stress (mental damage) you can take before you are incapacitated or driven insane (see Mental Health, p. 209).
<p>
Lucidity is unlimited, but generally ranges from 20 to 60 for baseline unmodified humans. Lucidity is determined by your Willpower aptitude x 2.

!!
@@ @IR
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<p>
Your Insanity Rating is the total amount of stress your mind can take before you go permanently insane and are lost for good. Insanity Rating equals LUC x 2.

!!
@@ @WT
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<p>
A Wound Threshold is used to determine if you receive a wound each time you take physical damage (see Physical Health, p. 206). The higher the Wound Threshold, the more resistant to serious injury you are.
<p>
Wound Threshold is calculated by dividing Durability by 5 (rounding up).

!!
@@ @DUR
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<p>
Durability is your morph's physical health (or structural integrity in the case of synthetic shells, or system integrity in the case of infomorphs). It determines the amount of damage your morph can take before you are incapacitated or killed (see Physical Health, p. 206).
<p>
Durability is unlimited, though the range for base-line (unmodified) humans tends to fall between 20 and 60. Your Durability stat is determined by your morph.

!!
@@ @DR
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<p>
Death Rating is the total amount of damage your morph can take before it is killed or destroyed beyond repair. Death Rating is equal to DUR x 1.5 for biomorphs and DUR x 2 for synthmorphs.

!!
@@ @INIT
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<p>
Your character's Initiative stat helps determine when they act in relation to other characters during the Action Turn (see Initiative, p. 188). Your Initiative stat is equal to your character's Intuition (INT) + Reflexes (REF) aptitudes divided by 5 (rounded up). Certain implants and other factors may modify this score.

!!
@@ @SPD
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<p>
The Speed stat determines how often your character gets to act in an Action Turn (see Initiative, p. 188). All characters start with a Speed stat of 1, meaning they act once per turn. Certain implants and other advantages may boost this up to a maximum of 4.

!!
@@ @DB
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<p>
The Damage Bonus stat quantifies how much extra oomph your character is able to give their melee and thrown weapons attacks. Damage Bonus is determined by dividing your Somatics (SOM) aptitude by 10 and rounding down.

!!
@@ @DAMAGE
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Damage Points</b>
<p>
Any physical harm that befalls your character is measured in damage points. These points are cumulative, and are recorded on your character sheet. Damage points are characterized as fatigue, stun, bruises, bumps, sprains, minor cuts, and similar hurts that, while painful, do not significantly impair or threaten your character's life unless they accumulate to a significant amount. Any source of harm that inflicts a large amount of damage points at once, however, is likely to have a more severe effect (see Wounds).
<p>
Damage points may be reduced by rest, medical care, and/or repair (see Healing and Repair, p. 208).
<p>
<b>Damage Types</b>
<p>
Physical damage comes in three forms: Energy, Kinetic, and Psi.
<p>
<b>Energy Damage</b>
<p>
Energy damage includes lasers, plasma guns, fire, electrocution, explosions, and others sources of damaging energy.
<p>
<b>Kinetic Damage</b>
<p>
Kinetic damage is caused by projectiles and other objects moving at great speeds that disperse their energy into the target upon impact. Kinetic attacks include slug-throwers, flechette weapons, knives, and punches.
<p>
<b>Psi Damage</b>
<p>
Psi damage is caused by offensive psi sleights like Psychic Stab (p. 228).

!!
@@ @WOUNDS
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
Wounds represent more grievous injuries: bad cuts and hemorrhaging, fractures and breaks, mangled limbs, and other serious damage that impairs your ability to function and may lead to death or long-term damage.
<p>
Any time your character sustains damage, compare the amount inflicted (after it has been reduced by armor) to your Wound Threshold. If the modified DV equals or exceeds your Wound Threshold, you have suffered a wound. If the inflicted damage is double your Wound Threshold, you suffer 2 wounds; if triple your Wound Threshold, you suffer 3 wounds; and so on.
<p>
Wounds are cumulative and must be marked on your character sheet.
<p>
<b>Wound Effects</b>
<p>
Each wound applies a cumulative -10 modifier to actions and -1 to Initiative. A character with 3 wounds, for example, suffers -30 to all actions and -3 to Initiative.
<p>
Some traits, morphs, implants, drugs, and psi allow a character to ignore wound modifiers. These effects are cumulative, though a maximum of 3 wounds worth of modifiers may be negated (-30 to actions and -3 to Initiative). 
<p>
<b>Knockdown:</b> Any time a character takes a wound, they must make an immediate SOM x 3 Test. Wound modifiers apply. If they fail, they are knocked down and must expend a Quick Action to get back up. Bots and vehicles must make a Pilot Test to avoid crashing.
<p>
<b>Unconsciousness:</b> Any time a character receives 2 or more wounds at once (from the same attack), they must also make an immediate SOM x 3 Test; wound modifiers again apply. If they fail, they have been knocked unconscious (until they are awoken or heal). Bots and vehicles that take 2 or more wounds at once automatically crash (see Crashing, p. 196).
<p>
<b>Bleeding:</b> Any biomorph character who has suffered a wound and who takes damage that exceeds their Durability is in danger of bleeding to death. They incur 1 additional damage point per Action Turn (20 per minute) until they receive medical care or die.

!!
@@ @STRESS
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Stress Points</b>
<p>
Stress points represent fractures in your ego's integrity, cracks in the mental image of yourself. This mental damage is experienced as cerebral shocks, disorientation, cognitive disconnects, synaptic misfires, or an undermining of the intellectual faculties. On their own, these stress points do not significantly impair your character's functioning, but if allowed to accumulate they can have severe repercussions. Additionally, any source that inflicts a large amount of stress points at once is likely to have a more severe impact (see Trauma, p. 209).
<p>
Stress points may be reduced by long-term rest, psychiatric care, and/or psychosurgery (p. 215).
<p>
<b>Lucidity and Stress</b>
<p>
Your Lucidity stat benchmarks your character's mental stability. If you build up an amount of stress points equal to or greater than your Lucidity score, your character's ego immediately suffers a mental breakdown. You effectively go into shock and remain in a catatonic state until your stress points are reduced to a level below your Lucidity stat. Accumulated stress points will overwhelm egos housed inside synthetic shells or infomorphs just as they will biological brains-the mental software effectively seizes up, incapable of functioning until it is debugged.

!!
@@ @TRAUMA
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
Mental trauma is more severe than stress points. Traumas represent severe mental shocks, a crumbling of personality/self, delirium, paradigm shifts, and other serious cognitive malfunctions. Traumas impair your character's functioning and may result in temporary derangements or permanent disorders.
<p>
If your character receives a number of stress points at once that equals or exceeds their Trauma Threshold, they have suffered a trauma. If the inflicted stress points are double or triple the Trauma Threshold, they suffer 2 or 3 traumas, respectively, and so on. Traumas are cumulative and must be recorded on your character sheet.
<p>
<b>Trauma Effects</b>
<p>
Each trauma applies a cumulative -10 modifier to all of the character's actions and -1 to Initiative. A character with 2 traumas, for example, suffers -20 to all actions and -2 Initiative. These modifiers are also cumulative with wound modifiers.
<p>
<b>Disorientation:</b>  Any time a character suffers a trauma, they must make an immediate WIL x 3 Test. Trauma modifiers apply. If they fail, they are temporarily stunned and disoriented and must expend a Complex Action to regain their wits.
<p>
<b>Derangements and Disorders:</b> Any time a character is hit with a trauma, they suffer a temporary derangement (see Derangements). The first trauma inflicts a minor derangement. If a second trauma is applied, the first derangement is either upgraded from minor to a moderate derangement or else a second minor derangement is applied (gamemaster's discretion). Likewise, a third trauma may upgrade that derangement from moderate to major or else inflict a new minor. It is generally recommended that derangements be upgraded in potency, especially when result from the same set of ongoing circumstances. In the case of traumas that result from distinctly separate situations and sources, separate derangements may be applied.
<p>
<b>Disorder:</b> When four or more traumas have been inflicted on a character, a major derangement is upgraded to a disorder. Disorders represent long-lasting psychological afflictions that typically require weeks or even months of psychotherapy and/or psychosurgery to remedy (see Disorders, p. 211).

!!
@@ @Profession
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Field, Knowledge
<p>
<b>Linked Aptitude:</b> COG
<p>
<b>What it is:</b> Profession skills indicate training in a profession practiced in Eclipse Phase. This can indicate either formal training or informal, on-the-job type training and includes both legal and extralegal trades.
<p>
<b>When you use it:</b> Use Profession to perform work-related tasks for a specific trade (i.e. mining, balancing accounts, designing a security system, etc.) or to reference specialized knowledge that someone trained in that profession might have.
<p>
<b>Sample Fields:</b> Accounting, Appraisal, Asteroid Prospecting, Banking, Cool Hunting, Con Schemes, Distribution, Forensics, Lab Technician, Mining, Police Procedures, Psychotherapy, Security Ops, Smuggling Tricks, Social Engineering, Squad Tactics, Viral Marketing, XP Production
<p>
<b>Specializations:</b> As appropriate to the field

!!
@@ @Slight of Hand
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
You can perform dexterous feats of legerdemain such as palming small objects, picking pockets, slipping out of restraints, and so forth. Stage magicians use Sleight of Hand legitimately as a performance skill, but it is most commonly known for its criminal applications.
<p>
<b>Concealing:</b> You can use Sleight of Hand to conceal a small item on your person, making your check result the DC of an Investigation or Perception check to find it. 
<p>
<b>Contorting:</b> Make a DC 30 Sleight of Hand check to fit through a tight space wide enough for your head but too narrow for the width of your shoulders, or to reach through an opening wide enough for your hand, but too narrow for your arm. Escaping: Make a Sleight of Hand check to slip out of various restraints. This takes at least a minute per check. 
<p>
<b>Legerdemain:</b> Minor feats of Sleight of Hand, such as making a coin or playing card 'vanish', have a DC of 10 unless an observer is focused on noticing what you are doing. When you perform this skill under observation, your check is opposed by the observer's Perception check to see if they notice the trick. 
<p>
<b>Stealing:</b> To covertly take something from another person make a Sleight of Hand check (DC 20). Your target makes a Perception check and notices the attempt if his check result beats yours, whether you succeed in taking the object or not. You can also make a Sleight of Hand check to plant a small object on someone, slip something into their pocket, drop something into their drink, place a tiny radio tracer on them, and so forth.

!!
@@ @Staggered
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=bb ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
A staggered character is <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Dazed",currentToken())]'>dazed</a></font> and <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Hindered",currentToken())]'>hindered</a></font>.

!!
@@ @Stealth
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
You're skilled in going unnoticed. While using Stealth, you can move at your speed rank minus 1 with no penalty. Faster than that, up to your full speed, you take a -5 circumstance penalty to your Stealth checks. 
<p>
<b>Hiding:</b> If you have cover or concealment, make a Stealth check, opposed by an observer's Perception check, to hide and go unnoticed. 
<p>
<b>Tailing:</b> You can use Stealth to tail someone at your normal speed. This assumes you have some cover or concealment (crowds of people, shadows, fog, etc.). If the subject is worried about being followed, he can make a Perception check (opposed by your Stealth check) every time he changes course (goes around a street corner, exits a building, and so on). If he is unsuspecting, he only gets one Perception check for the scene.

!!
@@ @Stunned
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=b ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
Stunned characters cannot take any actions, including free actions

!!
@@ @Surprised
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=bb ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
A surprised character is <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Stunned",currentToken())]'>stunned</a></font> and <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Vulnerable",currentToken())]'>vulnerable</a></font>, caught off-guard and therefore unable to act, and less able to avoid attacks.

!!
@@ @Technology
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
Technology covers operating, building, repairing, and generally working with technological devices and equipment. Without the proper tools or equipment, you take a -5 penalty to Technology checks for highly unfavorable circumstances. 
<p>
<b>Operating:</b> Most routine operations of technological equipment don't require a skill check and can be done untrained. Using an unfamiliar device does require a check, with the DC determined by how foreign or unusual the device is, from simple (DC 10) to highly advanced (DC 25 or more). 
<p>
<b>Building:</b> The difficulty and time required to make an item depends on its complexity, as shown on the Building Items table. If your Technology check succeeds, you have made the item after the necessary time. 
<p>
<b>Repairing:</b> You can also use Technology to repair damaged items, with a -5 to the DC to build the item and -2 to the time rank required. So you can perform repairs on a complex item in eight hours (time rank 12) with a DC of 20. 
<p>
<b>Jury-rigging:</b> You can also attempt jury-rigged, or temporary, repairs. Doing this reduces the repair DC by an additional 5 (for a total of -10 to the DC to build the item), and allows you to make the Technology check as a standard action. However, a jury-rigged repair can only fix a single problem, and the repair only lasts until the end of the scene. 
<p>
<b>Demolitions:</b> Careful placement of an explosive against a fixed structure can maximize damage by exploiting vulnerabilities in the structure. This requires at least a minute and a DC 10 Technology check. The GM makes the check, so you don't know exactly how well you have done until the explosive goes off. 
<p>
<b>Inventing:</b> If you have the Inventor advantage (see the Advantages chapter), you can use Technology to create inventions, temporary devices. See Inventing, page 145, for details. 
<p>
<b>Security:</b> You can use Technology to disarm or sabotage various security devices, including locks, traps, and sensors. This takes at least a minute, possibly longer, at the GM's discretion. The GM makes your Technology check secretly, so you don't necessarily know right away if you have succeeded.

!!
@@ @Transformed
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=b ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
Transformed characters have some or all of their traits altered by an outside agency. This may range from a change in the characters appearance to a complete change in trait ranks, even the removal of some traits and the addition of others! The primary
limit on the transformed condition is the characters power point total cannot increase, although it can effectively decrease for the duration of the transformation, such as when a powerful superhero is turned into an otherwise powerless mouse or frog (obviously based on considerably fewer power points)

!!
@@ @Treatment
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
You're trained in treating injuries and ailments. 
<p>
<b>Diagnosis:</b> You can diagnose injuries and ailments with an eye toward further treatment. This takes at least a minute. At the GM's discretion, a successful diagnosis provides a +2 bonus for favorable circumstances on further Treatment checks. 
<p>
<b>Provide Care:</b>  Providing care means treating an injured patient for a day or more. If successful, the patient further reduces the recovery time by 1 rank (see Recovery in the Action & Adventure chapter). You can provide care for up to your Treatment rank in patients at one time. 
<p>
<b>Revive:</b> You can remove the dazed or stunned conditions from a subject (see Conditions in the Action & Adventure chapter). The check to revive is a standard action. A successful check removes the condition. 
<p>
<b>Stabilize:</b> As a standard action, a successful Treatment check stabilizes a dying character. 
<p>
<b>Treat Disease and Poison:</b> You can treat a character afflicted with a disease or poison. Each time the character makes a resistance check against the ailment, you make a Treatment check. One degree of success provides the patient with a +2 circumstance bonus to the resistance check, three or more degrees of success provides a +5 circumstance bonus.

!!
@@ @Unaware
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=b ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
The character is completely unaware of his surroundings, unable to make interaction or Perception checks or perform any action based on them. If the condition applies to a specific sense or senses, they are added to the name of the condition, such as visually unaware, tactilely unaware (or numb), and so forth. Subjects have full concealment from all of a characters unaware senses.

!!
@@ @Vehicles
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
Use this skill to operate vehicles, from ground vehicles like cars to boats, planes, or even spaceships! See Vehicles in the Gadgets & Gear chapter for details. Routine tasks, such as ordinary operation of known vehicles, don't require a check and may even be done untrained for some vehicles, particularly common ones like cars. Make a check only when operating the vehicle in a stressful or dramatic situation like being chased or attacked, or trying to reach a destination in a limited amount of time.

!!
@@ @Vulnerable
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=b ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
Vulnerable characters are limited in their ability to defend themselves, halving their active defenses (round up the final value). <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Defenseless",currentToken())]'><b>Defenseless</b></a></font>
supersedes vulnerable.

!!
@@ @Weakened
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=b ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
The character has temporarily lost power points in a trait. See the Weaken effect in the Powers chapter for more. <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none","Debilitated",currentToken())]'><b>Debilitated</b></a></font> supersedes weakened.

!!
@@ @AdvantageShowUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[if(getProperty("AdvantageShow")): setProperty("AdvantageShow",0); setProperty("AdvantageShow",1)]
[r, macro("SheetLoad@this"):macro.args]

!!
@@ @AdvantagesUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[h: text = json.get(macro.args, "Text")]
[h: text = encode(text)]
[h: jsonData = json.append("[]",text)]
[h:Advantages = json.set(Advantages, json.get(macro.args, "Name"), jsonData)]
[if(json.get(macro.args, "Deletecheck")=="1"), code:{[h: Advantages = json.remove(Advantages, json.get(macro.args, "Name"))]}; {}]

[if( json.get(macro.args, "Name") != json.get(macro.args, "overwrite")),code:{[h: Advantages = json.remove(Advantages, json.get(macro.args, "overwrite"))]}; {}]
[h, macro("SheetLoad@this"):""]
Advantages Updated

!!
@@ @ConditionsLink
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[h: temp = macro.args]

[h: cond1Data = ""]
[h: cond1Title = 0]
[h: cond1List="Dazed, Entranced, Fatigued, Hindered, Impaired, Vulnerable, Restrained"]
[FOREACH(cond1, cond1List, ""),code:{
[if(listContains(temp,cond1)),code:{[h: cond1Data=listappend(cond1Data, cond1)][h: cond1Title = 1]}; {}]
}]
[r, if(cond1Title):"(1st Degree: "; ""]
[FOREACH(var, cond1Data, ","),code:{
[r: macroLink(var,"StatesUpdate@this","none",var,"selected")]}]

[h: cond2Data = ""]
[h: cond2Title = 0]
[h: cond2List="Compelled, Defenseless, Disabled, Exhausted, Immobile, Prone, Stunned, Bound"]
[FOREACH(cond2, cond2List, ""),code:{
[if(listContains(temp,cond2)),code:{[h: cond2Data=listappend(cond2Data, cond2)][h: cond2Title = 1]}; {}]
}]
[r, if(cond2Title):", 2nd Degree: "; ""]
[FOREACH(var, cond2Data, ","),code:{
[r: macroLink(var,"StatesUpdate@this","none",var,"selected")]}]

[h: cond3Data = ""]
[h: cond3Title = 0]
[h: cond3List="Asleep, Controlled, Incapacitated, Paralyzed, Transformed, Unaware"]
[FOREACH(cond3, cond3List, ""),code:{
[if(listContains(temp,cond3)),code:{[h: cond3Data=listappend(cond3Data, cond3)][h: cond3Title = 1]}; {}]
}]
[r, if(cond3Title):", 3rd Degree: "; ""]
[FOREACH(var, cond3Data, ","),code:{
[r: macroLink(var,"StatesUpdate@this","none",var,"selected")]}]
[r, if(cond1Title):")"; ""]

!!
@@ @ConditionsUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[setAllStates(0)]
[h: if(Bruises==0, "", setState("Bruises"+Bruises,1))]
[h: data = json.remove(macro.args, "Submit")]
[h, foreach(item, data),code:{

[r, macro(item+"Update@this"):""]
}]

[h, macro("SheetLoad@Lib:MnM"):""]

!!
@@ @DamageUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[h: status=input(
"function|Increase, Decrease, Clear|Change Bruises|RADIO|ORIENT=H SPAN=TRUE"
)]
[h: abort(status)]

[if(function==2),code:{

[h: setState("Bruises"+Bruises,0)]
[h: Bruises=0]

}; {
	
	[if(function==0),code:{
[h: setState("Bruises"+Bruises,0)]
[h: Bruises=Bruises+1]
[h: setState("Bruises"+Bruises,1)]

	}; {
[h: setState("Bruises"+Bruises,0)]
[h: Bruises=Bruises-1][h: Bruises=if(Bruises < 0,0,Bruises)]
[h: if(Bruises==0, "", setState("Bruises"+Bruises,1))]

	}]

}]
[r, macro("SheetLoad@this"):""]

!!
@@ @DamageUpdateDazed
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[if(getState("Dazed")),code:{

[if(getState("Incapacitated")),code:{
}; {
[h: setState("Bruises"+Bruises,0)]
[h:  Bruises=Bruises+1]
[h: setState("Bruises"+Bruises,1)]
}]
}; {

[if(getState("Incapacitated")),code:{
}; {
[h: setState("Bruises"+Bruises,0)]
[h:  Bruises=Bruises+1]
[h: setState("Bruises"+Bruises,1)]
[h, macro("DazedUpdate@this"):""]
}]

}]
[h, macro("SheetLoad@this"):""]

!!
@@ @DamageUpdateIncapacitated
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[if(getState("Incapacitated")),code:{
}; {
[h, macro("IncapacitatedUpdate@this"):""]
}]

[h, macro("SheetLoad@Lib:MnM"):""]

!!
@@ @DamageUpdateQuick
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[h: setState("Bruises"+Bruises,0)]
[h: Bruises=Bruises+1]
[h: setState("Bruises"+Bruises,1)]

[r, macro("SheetLoad@this"):""]

!!
@@ @DamageUpdateStaggered
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[if(getState("Staggered")),code:{

[if(getState("Incapacitated")),code:{
}; {
[h, macro("IncapacitatedUpdate@this"):""]
}]
}; {

[if(getState("Incapacitated")),code:{
}; {
[h: setState("Bruises"+Bruises,0)]
[h:  Bruises=Bruises+1]
[h: setState("Bruises"+Bruises,1)]
[h: setState("Dazed",0)]
[h, macro("StaggeredUpdate@this"):""]
}]

}]

[h, macro("SheetLoad@Lib:MnM"):""]

!!
@@ @HeroPointsUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[h: status=input(
".|Spend Hero Point||LABEL|SPAN=TRUE",
"check|0|Restore Hero Point|CHECK|"
)]
[h: abort(status)]
[if(check),code:{
[h: HeroPoints = HeroPoints + 1] I gain a Hero Point
}; 
{
[r, if(HeroPoints),code:{[h: HeroPoints = HeroPoints-1]I spend a Hero Point}; {[h: HeroPoints = HeroPoints]I have no Hero Points left to spend}] 

}]

[r, macro("SheetLoad@this"):""]

!!
@@ @RezPointsUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[h: status = input("rez|"+RezPoints+"|Rez Points")]
[h: abort(status)]
[h,if(isNumber(rez) != 1): abort(0)]
[h,if(rez < 0): abort(0)]
[h: RezPoints = rez]
[h, macro("SheetLoad@this"):""]
[h: outputter = strformat("<span bgcolor=#cccccc>%s updated Rez Points to: <b>%d</b> !!</span>",getName(currentToken()),RezPoints)]
{outputter}

!!
@@ @DSUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[h: argName = json.get(macro.args,0)]
[if(argName == "DAMAGE" || argName == "STRESS"),code:
  {
    [h: status = input("val|0|"+argName+" Points taken")]
    [h: abort(status)]
    [h,if(isNumber(val) != 1): abort(0)]
    [h,if(val < 1): abort(0)]
    [h: setProperty(argName, getProperty(argName) + val)]
    [h, macro("SheetLoad@this"):""]
    [h: outputter = strformat("<span bgcolor=#cccccc>%s took %s points: <b>%d</b> !! (new total: %d)</span>",getName(currentToken()),argName,val,getProperty(argName))]
    {outputter}
  };
  {
    [h: setProperty(argName, getProperty(argName) + 1)]
    [h, macro("SheetLoad@this"):""]
    [h: outputter = strformat("<span bgcolor=#cccccc>%s took 1 %s !! (new total: %d)</span>",getName(currentToken()),argName,getProperty(argName))]
    {outputter}
  }
]

!!
@@ @OffenseShowUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[if(getProperty("OffenseShow")): setProperty("OffenseShow",0); setProperty("OffenseShow",1)]
[r, macro("SheetLoad@this"):macro.args]

!!
@@ @OffenseUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[h: name = json.get(macro.args, "name")]
[h: action = json.get(macro.args, "action")]
[h: range = json.get(macro.args, "range")]
[h: area = json.get(macro.args, "area")]

[h: attackbonus = json.get(macro.args, "attackbonus")]
[h: defenseclass = json.get(macro.args, "defenseclass")]
[h: critical = json.get(macro.args, "critical")]

[h: resistance = json.get(macro.args, "resistance")]
[h: effectrank = json.get(macro.args, "effectrank")]
[h: damage = json.get(macro.args, "damage")]
[h: strengthrank = json.get(macro.args, "strengthrank")]

[h: notes = json.get(macro.args, "notes")]

[h: delete = json.get(macro.args, "delete")]

[h: condData = ""]
[h: condList = "Dazed, Entranced, Fatigued, Hindered, Impaired, Vulnerable, Compelled, Defenseless, Disabled, Exhausted, Immobile, Prone, Stunned, Asleep, Controlled, Incapacitated, Paralyzed, Transformed, Unaware"]
[foreach( temp, condList, ""),code:{[h: tempName = json.get(macro.args,temp)][if(tempName !=""),code:{[h: condData =listappend(condData, tempName)]}; {}]
}]
[h: cond = condData]

[if (delete == 1), code:{
[h: Attacks = json.remove(Attacks, name)]
}; {
[h: jsonData = json.append("[]",action,range,area,attackbonus,defenseclass,critical,resistance,effectrank,strengthrank,damage,notes,cond)]
[h: Attacks = json.set(Attacks, name, jsonData)]
}]
[if(name != json.get(macro.args, "overwrite")),code:{[h: Attacks = json.remove(Attacks, json.get(macro.args, "overwrite"))]}; {}]
[h, macro("SheetLoad@Lib:MnM"):""]
Offense Updated

!!
@@ @PowersShowUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[if(getProperty("PowersShow")): setProperty("PowersShow",0); setProperty("PowersShow",1)]
[r, macro("SheetLoad@this"):macro.args]

!!
@@ @PowersUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[h: text = json.get(macro.args, "Text")]

<!-- encode it -->
[h: text = encode(text)]

[h:  setProperty("Powers", text)]
[h, macro("SheetLoad@this"):""]
Powers Updated

!!
@@ @SetHeroPointsUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[h: status=input(
"hp|1|Hero Point(s)|TEXT",
"function|Add, Subtract, Make Total|Set Hero Points|RADIO"
)]
[h: abort(status)]

[if(function==2),code:{

[h: HeroPoints=hp]

}; {
	
	[if(function==0),code:{

[h: HeroPoints=HeroPoints+1]

	}; {

[h: HeroPoints=HeroPoints-1][h: HeroPoints=if(HeroPoints < 0,0,HeroPoints)]

	}]

}]
[r, macro("SheetLoad@this"):""]

!!
@@ @SkillsUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[foreach(tempAbility, json.fields(Skills), ""), code: {
[h: propRank = json.get(macro.args, tempAbility+"Rank")]
[h: propAttribute = json.get(macro.args, tempAbility+"Attribute")]
[h: propMisc = json.get(macro.args, tempAbility+"Misc")]
[h: propTrained = json.get(macro.args, tempAbility+"Trained")]
[h: propdata = json.append("[]", propRank, propMisc, propAttribute, propTrained)]
[h: Skills = json.set(Skills, tempAbility, propdata)]
}]

[h: newExp = json.get(macro.args, "newExp1")]
[if(newExp == ""),code:{}; {
[h: name = "Exp: "+newExp]
[h: propRank = json.get(macro.args, "newExpRank1")]
[h: propMisc = json.get(macro.args, "newExpMisc1")]
[h: propdata = json.append("[]", propRank,propMisc, "Intellect",  0)]
[h: Skills = json.set(Skills, name, propdata)]
}]
[h: newExp = json.get(macro.args, "newExp2")]
[if(newExp == ""),code:{}; {
[h: name = "Exp: "+newExp]
[h: propRank = json.get(macro.args, "newExpRank2")]
[h: propMisc = json.get(macro.args, "newExpMisc2")]
[h: propdata = json.append("[]", propRank,propMisc, "Intellect",  0)]
[h: Skills = json.set(Skills, name, propdata)]
}]

[h: newCC = json.get(macro.args, "newCC1")]
[if(newCC == ""),code:{}; {
[h: name = "CC: "+newCC]
[h: propRank = json.get(macro.args, "newCCRank1")]
[h: propMisc = json.get(macro.args, "newCCMisc1")]
[h: propdata = json.append("[]", propRank, propMisc,"Fighting", 0)]
[h: Skills = json.set(Skills, name, propdata)]
}]
[h: newCC = json.get(macro.args, "newCC2")]
[if(newCC == ""),code:{}; {
[h: name = "CC: "+newCC]
[h: propRank = json.get(macro.args, "newCCRank2")]
[h: propMisc = json.get(macro.args, "newCCMisc2")]
[h: propdata = json.append("[]", propRank, propMisc,"Fighting", 0)]
[h: Skills = json.set(Skills, name, propdata)]
}]

[h: newRC = json.get(macro.args, "newRC1")]
[if(newRC == ""),code:{}; {
[h: name = "RC: "+newRC]
[h: propRank = json.get(macro.args, "newRCRank1")]
[h: propMisc = json.get(macro.args, "newRCMisc1")]
[h: propdata = json.append("[]", propRank,  propMisc,"Dexterity", 0)]
[h: Skills = json.set(Skills, name, propdata)]
}]
[h: newRC = json.get(macro.args, "newRC2")]
[if(newRC == ""),code:{}; {
[h: name = "RC: "+newRC]
[h: propRank = json.get(macro.args, "newRCRank2")]
[h: propMisc = json.get(macro.args, "newRCMisc2")]
[h: propdata = json.append("[]", propRank,  propMisc,"Dexterity", 0)]
[h: Skills = json.set(Skills, name, propdata)]
}]

[h, macro("SheetLoad@Lib:MnM"):""]
Skills Updated

!!
@@ @KnowSkillsUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[foreach(tempAbility, json.fields(KnowledgeSkills), ""), code: {
  [h: propDelete = json.get(macro.args, tempAbility+"Delete")]
  [h, if(propDelete!=""), code: 
  {
    [h: KnowledgeSkills = json.remove(KnowledgeSkills,tempAbility)]
  };{
    [h: propBase = json.get(macro.args, tempAbility+"Base")]
    [h: propBonus = json.get(macro.args, tempAbility+"Bonus")]
    [h: propAptitude = json.get(macro.args, tempAbility+"Aptitude")]
    [h: propSpec = json.get(macro.args, tempAbility+"Spec")]
    [h: propData = json.append("[]", propBase, propBonus, propAptitude, 1, propSpec)]
    [h: KnowledgeSkills = json.set(KnowledgeSkills, tempAbility, propData)]
  }]
}]

[h: newKnow = json.get(macro.args, "newAcademics")]
[if(newKnow == ""),code:{}; {
  [h: name = "Academics: "+newKnow]
  [h: propBase = json.get(macro.args, "newAcademicsBase")]
  [h: propBonus = json.get(macro.args, "newAcademicsBonus")]
  [h: propSpec = json.get(macro.args, "newAcademicsSpec")]
  [h: propData = json.append("[]", propBase, propBonus, "COG", 1, propSpec)]
  [h: KnowledgeSkills = json.set(KnowledgeSkills, name, propData)]
}]
[h: newKnow = json.get(macro.args, "newArt")]
[if(newKnow == ""),code:{}; {
  [h: name = "Art: "+newKnow]
  [h: propBase = json.get(macro.args, "newArtBase")]
  [h: propBonus = json.get(macro.args, "newArtBonus")]
  [h: propSpec = json.get(macro.args, "newArtSpec")]
  [h: propData = json.append("[]", propBase, propBonus, "INT", 1, propSpec)]
  [h: KnowledgeSkills = json.set(KnowledgeSkills, name, propData)]
}]
[h: newKnow = json.get(macro.args, "newInterest")]
[if(newKnow == ""),code:{}; {
  [h: name = "Interest: "+newKnow]
  [h: propBase = json.get(macro.args, "newInterestBase")]
  [h: propBonus = json.get(macro.args, "newInterestBonus")]
  [h: propSpec = json.get(macro.args, "newInterestSpec")]
  [h: propData = json.append("[]", propBase, propBonus,"COG", 1, propSpec)]
  [h: KnowledgeSkills = json.set(KnowledgeSkills, name, propData)]
}]
[h: newKnow = json.get(macro.args, "newLanguage")]
[if(newKnow == ""),code:{}; {
  [h: name = "Language: "+newKnow]
  [h: propBase = json.get(macro.args, "newLanguageBase")]
  [h: propBonus = json.get(macro.args, "newLanguageBonus")]
  [h: propSpec = json.get(macro.args, "newLanguageSpec")]
  [h: propData = json.append("[]", propBase, propBonus,"INT", 1, propSpec)]
  [h: KnowledgeSkills = json.set(KnowledgeSkills, name, propData)]
}]
[h: newKnow = json.get(macro.args, "newProfession")]
[if(newKnow == ""),code:{}; {
  [h: name = "Profession: "+newKnow]
  [h: propBase = json.get(macro.args, "newProfessionBase")]
  [h: propBonus = json.get(macro.args, "newProfessionBonus")]
  [h: propSpec = json.get(macro.args, "newProfessionSpec")]
  [h: propData = json.append("[]", propBase, propBonus,"COG", 1, propSpec)]
  [h: KnowledgeSkills = json.set(KnowledgeSkills, name, propData)]
}]

[h, macro("SheetLoad@Lib:MnM"):""]
Knowledge Skills Updated

!!
@@ @ActiveSkillsUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[foreach(tempAbility, json.fields(ActiveSkills), ""), code: {
  [h: propDelete = json.get(macro.args, tempAbility+"Delete")]
  [h, if(propDelete!=""), code: 
  {
    [h: ActiveSkills = json.remove(ActiveSkills,tempAbility)]
  };{
    [h: propBase = json.get(macro.args, tempAbility+"Base")]
    [h: propBonus = json.get(macro.args, tempAbility+"Bonus")]
    [h: propAptitude = json.get(macro.args, tempAbility+"Aptitude")]
    [h: propDefault = json.get(macro.args, tempAbility+"Default")]
    [h: propSpec = json.get(macro.args, tempAbility+"Spec")]
    [h: propData = json.append("[]", propBase, propBonus, propAptitude, propDefault, propSpec)]
    [h: ActiveSkills = json.set(ActiveSkills, tempAbility, propData)]
  }]
}]

[h: newActive = json.get(macro.args, "newExoticMelee")]
[if(newActive == ""),code:{}; {
  [h: name = "Exotic Melee: "+newActive]
  [h: propBase = json.get(macro.args, "newExoticMeleeBase")]
  [h: propBonus = json.get(macro.args, "newExoticMeleeBonus")]
  [h: propSpec = json.get(macro.args, "newExoticMeleeSpec")]
  [h: propData = json.append("[]", propBase, propBonus, "SOM", 1, propSpec)]
  [h: ActiveSkills = json.set(ActiveSkills, name, propData)]
}]
[h: newActive = json.get(macro.args, "newExoticRanged")]
[if(newActive == ""),code:{}; {
  [h: name = "Exotic Ranged: "+newActive]
  [h: propBase = json.get(macro.args, "newExoticRangedBase")]
  [h: propBonus = json.get(macro.args, "newExoticRangedBonus")]
  [h: propSpec = json.get(macro.args, "newExoticRangedSpec")]
  [h: propData = json.append("[]", propBase, propBonus, "COO", 1, propSpec)]
  [h: ActiveSkills = json.set(ActiveSkills, name, propData)]
}]
[h: newActive = json.get(macro.args, "newHardware")]
[if(newActive == ""),code:{}; {
  [h: name = "Hardware: "+newActive]
  [h: propBase = json.get(macro.args, "newHardwareBase")]
  [h: propBonus = json.get(macro.args, "newHardwareBonus")]
  [h: propSpec = json.get(macro.args, "newHardwareSpec")]
  [h: propData = json.append("[]", propBase, propBonus,"COG", 1, propSpec)]
  [h: ActiveSkills = json.set(ActiveSkills, name, propData)]
}]
[h: newActive = json.get(macro.args, "newMedicine")]
[if(newActive == ""),code:{}; {
  [h: name = "Medicine: "+newActive]
  [h: propBase = json.get(macro.args, "newMedicineBase")]
  [h: propBonus = json.get(macro.args, "newMedicineBonus")]
  [h: propSpec = json.get(macro.args, "newMedicineSpec")]
  [h: propData = json.append("[]", propBase, propBonus,"COG", 1, propSpec)]
  [h: ActiveSkills = json.set(ActiveSkills, name, propData)]
}]
[h: newActive = json.get(macro.args, "newNetworking")]
[if(newActive == ""),code:{}; {
  [h: name = "Networking: "+newActive]
  [h: propBase = json.get(macro.args, "newNetworkingBase")]
  [h: propBonus = json.get(macro.args, "newNetworkingBonus")]
  [h: propSpec = json.get(macro.args, "newNetworkingSpec")]
  [h: propData = json.append("[]", propBase, propBonus,"SAV", 1, propSpec)]
  [h: ActiveSkills = json.set(ActiveSkills, name, propData)]
}]
[h: newActive = json.get(macro.args, "newPilot")]
[if(newActive == ""),code:{}; {
  [h: name = "Pilot: "+newActive]
  [h: propBase = json.get(macro.args, "newPilotBase")]
  [h: propBonus = json.get(macro.args, "newPilotBonus")]
  [h: propSpec = json.get(macro.args, "newPilotSpec")]
  [h: propData = json.append("[]", propBase, propBonus,"REF", 1, propSpec)]
  [h: ActiveSkills = json.set(ActiveSkills, name, propData)]
}]

[h, macro("SheetLoad@Lib:MnM"):""]
Active Skills Updated

!!
@@ @StatesUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[h: temp=json.get(macro.args, 0)]
[r, macro(temp+"Update@this"):""]
[h, macro("SheetLoad@Lib:MnM"):""]

!!
@@ @StatesUpdateRemove
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[h: temp=json.get(macro.args, 0)]
[r, macro(temp+"Update@this"):""]
[h, macro("SheetLoad@Lib:MnM"):""]
[h, macro("ConditionsInfoDisplay@Lib:MnM"):temp]

!!
@@ @TraitsUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[h: setProperty("COG", json.get(macro.args, "COG"))]
[h: setProperty("COO", json.get(macro.args, "COO"))]
[h: setProperty("INT", json.get(macro.args, "INT"))]
[h: setProperty("REF", json.get(macro.args, "REF"))]
[h: setProperty("SAV", json.get(macro.args, "SAV"))]
[h: setProperty("SOM", json.get(macro.args, "SOM"))]
[h: setProperty("WIL", json.get(macro.args, "WIL"))]
[h: setProperty("Dodge", json.get(macro.args, "Dodge"))]
[h: setProperty("DodgeNorm", json.get(macro.args, "DodgeNorm"))]
[h: setProperty("Parry", json.get(macro.args, "Parry"))]
[h: setProperty("ParryNorm", json.get(macro.args, "ParryNorm"))]
[h: setProperty("Fortitude", json.get(macro.args, "Fortitude"))]
[h: setProperty("FortitudeNorm", json.get(macro.args, "FortitudeNorm"))]
[h: setProperty("Toughness", json.get(macro.args, "Toughness"))]
[h: setProperty("ToughnessNorm", json.get(macro.args, "ToughnessNorm"))]
[h: setProperty("Will", json.get(macro.args, "Will"))]
[h: setProperty("WillNorm", json.get(macro.args, "WillNorm"))]
[h: setProperty("Initiative", json.get(macro.args, "Initiative"))]
[h: setProperty("Minion", json.get(macro.args, "Minion"))]
[h, macro("SheetLoad@this"):""]
Traits Updated

!!
@@ @AptitudesUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[h: setProperty("COG", json.get(macro.args, "COG"))]
[h: setProperty("COO", json.get(macro.args, "COO"))]
[h: setProperty("INT", json.get(macro.args, "INT"))]
[h: setProperty("REF", json.get(macro.args, "REF"))]
[h: setProperty("SAV", json.get(macro.args, "SAV"))]
[h: setProperty("SOM", json.get(macro.args, "SOM"))]
[h: setProperty("WIL", json.get(macro.args, "WIL"))]
[h, macro("SheetLoad@this"):""]
Aptitudes Updated

!!
@@ @StatsUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[h: setProperty("MOX", json.get(macro.args, "MOX"))]
[h: setProperty("MOX_base", json.get(macro.args, "MOX_base"))]
[h: setProperty("TT", json.get(macro.args, "TT"))]
[h: setProperty("LUC", json.get(macro.args, "LUC"))]
[h: setProperty("IR", json.get(macro.args, "IR"))]
[h: setProperty("WT", json.get(macro.args, "WT"))]
[h: setProperty("DUR", json.get(macro.args, "DUR"))]
[h: setProperty("DR", json.get(macro.args, "DR"))]
[h: setProperty("INIT", json.get(macro.args, "INIT"))]
[h: setProperty("SPD", json.get(macro.args, "SPD"))]
[h: setProperty("DB", json.get(macro.args, "DB"))]
[h, macro("SheetLoad@this"):""]
Stats Updated

!!
@@ @DamageStressUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[h: setProperty("DAMAGE", json.get(macro.args, "DAMAGE"))]
[h: setProperty("WOUNDS", json.get(macro.args, "WOUNDS"))]
[h: setProperty("STRESS", json.get(macro.args, "STRESS"))]
[h: setProperty("TRAUMA", json.get(macro.args, "TRAUMA"))]
[h, macro("SheetLoad@this"):""]
Damage & Stress Updated

!!
@@ @RepUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[h: setProperty("A-Rep", json.get(macro.args, "A-Rep"))]
[h: setProperty("c-Rep", json.get(macro.args, "c-Rep"))]
[h: setProperty("e-Rep", json.get(macro.args, "e-Rep"))]
[h: setProperty("f-Rep", json.get(macro.args, "f-Rep"))]
[h: setProperty("g-Rep", json.get(macro.args, "g-Rep"))]
[h: setProperty("i-Rep", json.get(macro.args, "i-Rep"))]
[h: setProperty("r-Rep", json.get(macro.args, "r-Rep"))]
[h, macro("SheetLoad@this"):""]
Reputation Updated

!!
@@ @AdvantagesUpdateDialog
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[dialog("Advantages", "temporary=0; input=1; noframe=0"): {
[h: name = json.get(macro.args, 0)]
[h: text = json.get(macro.args, 1)]

<html>
<head>
<title>Edges Update</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="AdvantagesUpdate" action="[r:macroLinkText('AdvantagesUpdate@Lib:MnM', 'none', '', currentToken())]">
<table>
<tr>
<td valign="top" align="center">
<label for="Name"><b>Advantage Name and Rank: </b></label><br><input type="text" name="Name" value="[r: name]"></input>
</td>
</tr>
<tr>
<td valign="top">
<textarea name="Text" value="[r: text]" rows="10" cols="50">[r: decode(text)]</textarea>
</td>
</tr>
<tr>
<td align="center">
Delete this Advantage? <input type="checkbox" name="Deletecheck" value="1"></input>
</td>
</tr>
<tr>
<td align="center">
<input type='hidden' name='overwrite' value='[r: overwrite =  json.get(macro.args, 0)]'></input>
<input type='submit' name='Submit' value='Submit'></input>
</td>
</tr>
</table> 
</form>
</body>
</html>
} ]

!!
@@ @ColorUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[h: number = 0]
[h, if(PageColor == "Bright Green"): number = 1; number = number]
[h, if(PageColor == "Dark Blue"): number = 2; number = number]
[h, if(PageColor == "Dark Orange"): number = 3; number = number]
[h, if(PageColor == "Light Blue"): number = 4; number = number]
[h, if(PageColor == "Light Orange"): number = 5; number = number]
[h, if(PageColor == "Maroon"): number = 6; number = number]
[h, if(PageColor == "Olive Green"): number = 7; number = number]
[h, if(PageColor == "Purple"): number = 8; number = number]
[h, if(PageColor == "Red"): number = 9; number = number]
[h, if(PageColor == "Teal Blue"): number = 10; number = number]

[h: status = input(
"PageColor|Gray,Bright Green,Dark Blue,Dark Orange,Light Blue,Light Orange,Maroon,Olive Green,Purple,Red,Teal Blue|Choose Sheet Color|LIST|VALUE=STRING SELECT="+number
)]
[h: abort(status)]

[r, macro("SheetLoad@this"):macro.args]

!!
@@ @ConditionsUpdateDialog
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[dialog("Conditions", "width=300; height=405; temporary=0; input=1; noframe=0"): {

<html>
<head>
<title>Conditions</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="ConditionsUpdate" action="[r:macroLinkText('ConditionsUpdate@Lib:MnM', 'none', '', currentToken())]">
<table>
<tr bgcolor="[r: table(PageColor,2)]" color="white">
<td colspan="3"><center>
<b>Basic Conditions</b></center>
</td>
</tr>
[h:theList = getTokenStates(",","Basic Conditions")]
[h: theList=listSort(theList,"A")]
[h: columncheck = 1]
[r, foreach(item, theList, ""),code:{
[r, if(columncheck > 1):""; "<tr>"]
<td>
<input type="checkbox" name="[r: item]" value="1" [r: if(getState(item),"CHECKED","")]> <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none",item,currentToken())]'>[r: item]</a></font></input>
</td>
[r, if(columncheck < 3):""; "</tr>"]
[h: columncheck = if(columncheck == 3, 1, columncheck+1)]

}]
<tr bgcolor="[r: table(PageColor,2)]" color="white">
<td colspan="3" ><center>
<b>Combined Conditions</b></center>
</td>
</tr>
[h:theList = getTokenStates(",","Combined Conditions")]
[h: theList=listSort(theList,"A")]
[h: columncheck = 1]
[r, foreach(item, theList, ""),code:{
[r, if(columncheck > 1):""; "<tr>"]
<td>
<input type="checkbox" name="[r: item]" value="1" [r: if(getState(item),"CHECKED","")]> <font color="black"><a href='[r:macroLinkText("ConditionsInfoDisplay@this","none",item,currentToken())]'>[r: item]</a></font></input>
</td>
[r, if(columncheck < 3):""; "</tr>"]
[h: columncheck = if(columncheck == 3, 1, columncheck+1)]
}]
<tr>
<td colspan="3"><hr><center>
<input type="checkbox" name="Clear All" value="1"> Clear All</input></center
</td>
</tr>
<tr>
<td align="center" colspan="3"><hr>
<input type='submit' name='Submit' value='Submit'></input>
</td>
</tr>
</table>
</form>
</body>
</html>
} ]

!!
@@ @OffenseUpdateDialog
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[h: name = macro.args]
[h: data = json.get(Attacks, name)]

[dialog("Offense Update", "temporary=0; height=480; width=400; input=1; noframe=0"): {<html>
<head>
<title>Offense Update</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="Offense Update" action="[r:macroLinkText('OffenseUpdate@Lib:MnM', 'none', '', currentToken())]">
<table width="100%" valign="top">
	<tr>
		<td>
			<b>Name: </b> <input type="text" name="name" value="[r: name]"></input>
		</td>
		<td align="center">		
	 Delete? <input type="checkbox" name="delete" value="1"></input>
		</td>
	</tr>
</table>
<table width="100%" valign="top">
	<tr>
		<td>
			Action: <select name="action" selected="[r: action = json.get(data,0)]">
<option value="No Action" [r: if(action == "No Action", "selected", "")]>No Action</option>
<option value="Standard" [r: if(action == "Standard", "selected", "")]>Standard</option>
<option value="Move" [r: if(action == "Move", "selected", "")]>Move</option>
<option value="Free" [r: if(action == "Free", "selected", "")]>Free</option>
<option value="Reaction" [r: if(action == "Reaction", "selected", "")]>Reaction</option>
</select>
Range: <select name="range" selected="[r: range = json.get(data,1)]">
<option value="" [r: if(range == "", "selected", "")]></option>
<option value="Close" [r: if(range == "Close", "selected", "")]>Close</option>
<option value="Ranged" [r: if(range == "Ranged", "selected", "")]>Ranged</option>
<option value="Perception" [r: if(range == "Perception", "selected", "")]>Perception</option>
</select>  
Area: <select name="area" selected="[r: area = json.get(data,2)]">
<option value="" [r: if(area == "", "selected", "")]></option>
<option value="Burst" [r: if(area == "Burst", "selected", "")]>Burst</option>
<option value="Cloud" [r: if(area == "Cloud", "selected", "")]>Cloud</option>
<option value="Cone" [r: if(area == "Cone", "selected", "")]>Cone</option>
<option value="Cylinder" [r: if(area == "Cylinder", "selected", "")]>Cylinder</option>
<option value="Line" [r: if(area == "Line", "selected", "")]>Line</option>
<option value="Perception" [r: if(area == "Perception", "selected", "")]>Perception</option>
<option value="Shapeable" [r: if(area == "Shapeable", "selected", "")]>Shapeable</option>
</select><hr>
		</td>
	</tr>
	<tr>
		<td>
			Attack Bonus: <input type="text" name="attackbonus" value="[r: attackbonus = json.get(data,3)]" size="2"></input> vs. <select name="defenseclass" selected="[r: defenseclass = json.get(data,4)]">
<option value="" [r: if(defenseclass == "", "selected", "")]></option>
<option value="Dodge" [r: if(defenseclass == "Dodge", "selected", "")]>Dodge</option>
<option value="Parry" [r: if(defenseclass == "Parry", "selected", "")]>Parry</option>
<option value="Toughness" [r: if(defenseclass == "Toughness", "selected", "")]>Toughness</option>
<option value="Fortitude" [r: if(defenseclass == "Fortitude", "selected", "")]>Fortitude</option>
<option value="Will" [r: if(defenseclass == "Will", "selected", "")]>Will</option>
</select> Critical on: <input type="text" name="critical" value="[r: critical = json.get(data,5)]" size="2"></input>+
		</td>
	</tr>	
	<tr>
		<td>
			<select name="resistance" selected="[r: resistance = json.get(data,6)]">
<option value="" [r: if(resistance == "", "selected", "")]></option>
<option value="Toughness" [r: if(resistance == "Toughness", "selected", "")]>Toughness</option>
<option value="Fortitude" [r: if(resistance == "Fortitude", "selected", "")]>Fortitude</option>
<option value="Will" [r: if(resistance == "Will", "selected", "")]>Will</option>
<option value="Dodge" [r: if(resistance == "Dodge", "selected", "")]>Dodge</option>
<option value="Parry" [r: if(resistance == "Parry", "selected", "")]>Parry</option>
</select>  vs. Effect Rank: <input type="text" name="effectrank" value="[r: effectrank = json.get(data,7)]" size="2"></input> + Strength? <input type="checkbox" name="strengthrank" value="1" [r, if(json.get(data,8)=="1"):"CHECKED"; ""]></input>  
		</td>
	</tr>
	<tr>
		<td>
			Non-Damage Effect/Conditions Only: <input type="checkbox" name="damage" value="1" [r,  if(json.get(data,9)=="1"):"CHECKED"; ""]></input><hr>
		</td>
	</tr>
	<tr>
		<td>
			Notes: <textarea name="notes" value="[r: notes = json.get(data,10)]" rows="2" cols="40">[r: notes = json.get(data,10)]</textarea>
		</td>
	</tr>
[h: cond = json.get(data, 11)]
	<tr>
		<td>
			<label for="cond"><b>Conditions: </b></label><hr>
		</td>
	</tr>
	<tr>
		<td>
			<table width="100%">
				<tr>
					<td>
						1st Degree<br>
[h: cond1List="Dazed, Entranced, Fatigued, Hindered, Impaired, Vulnerable"]
[FOREACH(cond1, cond1List, "<br>"),code:{<input type="checkbox" name="[r: cond1]" value="[r: cond1]" [r, if(listContains(cond,cond1)):"checked"; ""]></input> <font size = "2">[r: cond1]</font>}]
					</td>
					<td>
						2nd Degree<br>
[h: cond2List="Compelled, Defenseless, Disabled, Exhausted, Immobile, Prone, Stunned"]
[FOREACH(cond2, cond2List, "<br>"),code:{<input type="checkbox" name="[r: cond2]" value="[r: cond2]" [r, if(listContains(cond,cond2)):"checked"; ""]></input> <font size = "2">[r: cond2]</font>}]
					</td>
					<td>
3rd Degree<br>
[h: cond3List="Asleep, Controlled, Incapacitated, Paralyzed, Transformed, Unaware"]
[FOREACH(cond3, cond3List, "<br>"),code:{<input type="checkbox" name="[r: cond3]" value="[r: cond3]" [r, if(listContains(cond,cond3)):"checked"; ""]></input> <font size = "2">[r: cond3]</font>}]
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td align="center"><input type='hidden' name='overwrite' value='[r: name]'></input>
			<input type='submit' name='Submit' value='Submit'></input>
		</td>
	</tr>
</table>
</form>
</body>
</html>
}]

!!
@@ @OffenseUpdateDialogNew
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[dialog("Offense Update", "temporary=0; height=480; width=400; input=1; noframe=0"): {<html>
<head>
<title>Offense Update</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="Offense Update" action="[r:macroLinkText('OffenseUpdate@Lib:MnM', 'none', '', currentToken())]">
<table width="100%" valign="top">
	<tr>
		<td>
			<b>Name: </b> <input type="text" name="name" value="New Power"></input>
		</td>
		<td align="center">		
	 Delete? <input type="checkbox" name="delete" value="1"></input>
		</td>
	</tr>
</table>
<table width="100%" valign="top">
	<tr>
		<td>
			Action: <select name="action" selected="">
<option value="No Action" >No Action</option>
<option value="Standard" >Standard</option>
<option value="Move" >Move</option>
<option value="Free" >Free</option>
<option value="Reaction" >Reaction</option>
</select>
Range: <select name="range" selected="">
<option value="" ></option>
<option value="Close" >Close</option>
<option value="Ranged" >Ranged</option>
<option value="Perception" >Perception</option>
</select>  
Area: <select name="area" selected="">
<option value="" ></option>
<option value="Burst" >Burst</option>
<option value="Cloud" >Cloud</option>
<option value="Cone" >Cone</option>
<option value="Cylinder" >Cylinder</option>
<option value="Line" >Line</option>
<option value="Perception" >Perception</option>
<option value="Shapeable" >Shapeable</option>
</select><hr>
		</td>
	</tr>
	<tr>
		<td>
			Attack Bonus: <input type="text" name="attackbonus" value="" size="2"></input> vs. <select name="defenseclass" selected="">
<option value="" ></option>
<option value="Dodge" >Dodge</option>
<option value="Parry" >Parry</option>
<option value="Toughness" >Toughness</option>
<option value="Fortitude" >Fortitude</option>
<option value="Will" >Will</option>
</select> Critical on: <input type="text" name="critical" value="" size="2"></input>+
		</td>
	</tr>	
	<tr>
		<td>
			<select name="resistance" selected="">
<option value="" ></option>
<option value="Toughness" >Toughness</option>
<option value="Fortitude" >Fortitude</option>
<option value="Will" >Will</option>
<option value="Dodge" >Dodge</option>
<option value="Parry" >Parry</option>
</select>  vs. Effect Rank: <input type="text" name="effectrank" value="" size="2"></input> + Strength? <input type="checkbox" name="strengthrank" value="1" ></input>  
		</td>
	</tr>
	<tr>
		<td>
			Non-Damage Effect/Conditions Only: <input type="checkbox" name="damage" value="1"></input><hr>
		</td>
	</tr>
	<tr>
		<td>
			Notes: <textarea name="notes" value="" rows="2" cols="40"></textarea>
		</td>
	</tr>
	<tr>
		<td>
			<label for="cond"><b>Conditions: </b></label><hr>
		</td>
	</tr>
	<tr>
		<td>
			<table width="100%">
				<tr>
					<td>
						1st Degree<br>
[h: cond1List="Dazed, Entranced, Fatigued, Hindered, Impaired, Vulnerable"]
[FOREACH(cond1, cond1List, "<br>"),code:{<input type="checkbox" name="[r: cond1]" value="[r: cond1]" ></input> <font size = "2">[r: cond1]</font>}]
					</td>
					<td>
						2nd Degree<br>
[h: cond2List="Compelled, Defenseless, Disabled, Exhausted, Immobile, Prone, Stunned"]
[FOREACH(cond2, cond2List, "<br>"),code:{<input type="checkbox" name="[r: cond2]" value="[r: cond2]" ></input> <font size = "2">[r: cond2]</font>}]
					</td>
					<td>
3rd Degree<br>
[h: cond3List="Asleep, Controlled, Incapacitated, Paralyzed, Transformed, Unaware"]
[FOREACH(cond3, cond3List, "<br>"),code:{<input type="checkbox" name="[r: cond3]" value="[r: cond3]" ></input> <font size = "2">[r: cond3]</font>}]
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td align="center"><input type='hidden' name='overwrite' value=''></input>
			<input type='submit' name='Submit' value='Submit'></input>
		</td>
	</tr>
</table>
</form>
</body>
</html>
}]

!!
@@ @PowersUpdateDialog
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[dialog("Powers", "height = 520; width=400; temporary=0; input=1; noframe=0"): {
[h: text = getProperty("Powers")]

<html>
<head>
<title>Powers Update</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="PowersUpdate" action="[r:macroLinkText('PowersUpdate@Lib:MnM', 'none', '', currentToken())]">
<table>
<tr>
<td valign="top">
<textarea name="Text" value="[r: text]" rows="30" cols="50" wrap="hard">[r: decode(text)]</textarea>
</td>
</tr>
<tr>
<td align="center">
<input type='submit' name='Submit' value='Submit'></input>
</td>
</tr>
</table> 
</form>
</body>
</html>
} ]

!!
@@ @SkillsUpdateDialog
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[dialog("Skills Update", "temporary=0; input=1; noframe=0; closebutton=0"): {
<html>
<head>
<title>Skills Update</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="SkillsUpdate" action="[r:macroLinkText('SkillsUpdate@Lib:MnM', 'none', '', currentToken())]">
<table>
[h: color = "#ededed"]

				[h: propListunsort = json.fields(Skills)]
				[h: propList = listsort(propListunsort, "A")]
				[foreach(tempAbility, propList, ""), code: {
<tr bgcolor="[r: color]">
<td>
<label for="Name"><b>[r: tempAbility]</b></label>
</td>
<td>
<label for="Rank">Rank: </label><input type="text" name="[r: tempAbility+"Rank"]" value="[r: json.get(json.get(Skills, tempAbility), 0)]" size="2"></input>
</td>
<td>
<label for="Name">Misc: </label><input type="text" name="[r: tempAbility+"Misc"]" value="[r: json.get(json.get(Skills, tempAbility), 1)]" size="2"></input><input type="hidden" name="[r: tempAbility+"Attribute"]" value="[r: json.get(json.get(Skills, tempAbility), 2)]"></input><input type="hidden" name="[r: tempAbility+"Trained"]" value="[r: json.get(json.get(Skills, tempAbility), 3)]"></input>
</td>
</tr>
[h: color=if(color=="#ededed","white","#ededed")]
}]

<tr bgcolor="[r: color]">
<td>
<label for="Name"><b>Expertise: </b></label><input type="text" name="newExp1" value="" size="8"></input>
</td>
<td>
<label for="Rank">Rank: </label><input type="text" name="newExpRank1" value="0" size="2"></input>
</td>
<td>
<label for="Name">Misc: </label><input type="text" name="newExpMisc1" value="0" size="2"></input>
<input type="hidden" name="newExpTrained1" value="0"></input>
</td>
</tr>
[h: color=if(color=="#ededed","white","#ededed")]
<tr bgcolor="[r: color]">
<td>
<label for="Name"><b>Expertise: </b></label><input type="text" name="newExp2" value="" size="8"></input>
</td>
<td>
<label for="Rank">Rank: </label><input type="text" name="newExpRan2k" value="0" size="2"></input>
</td>
<td>
<label for="Name">Misc: </label><input type="text" name="newExpMisc2" value="0" size="2"></input>
<input type="hidden" name="newExpTrained2" value="0"></input>
</td>
</tr>
[h: color=if(color=="#ededed","white","#ededed")]
<tr bgcolor="[r: color]">
<td>
<label for="Name"><b>Close Combat: </b></label><input type="text" name="newCC1" value="" size="8"></input>
</td>
<td>
<label for="Rank">Rank: </label><input type="text" name="newCCRank1" value="0" size="2"></input>
</td>
<td>
<label for="Name">Misc: </label><input type="text" name="newCCMisc1" value="0" size="2"></input><input type="hidden" name="newCCTrained1" value="0"></input>
</td>
</tr>
[h: color=if(color=="#ededed","white","#ededed")]
<tr bgcolor="[r: color]">
<td>
<label for="Name"><b>Close Combat: </b></label><input type="text" name="newCC2" value="" size="8"></input>
</td>
<td>
<label for="Rank">Rank: </label><input type="text" name="newCCRank2" value="0" size="2"></input>
</td>
<td>
<label for="Name">Misc: </label><input type="text" name="newCCMisc2" value="0" size="2"></input><input type="hidden" name="newCCTrained2" value="0"></input>
</td>
</tr>
[h: color=if(color=="#ededed","white","#ededed")]
<tr bgcolor="[r: color]">
<td>
<label for="Name"><b>Ranged Combat: </b></label><input type="text" name="newRC1" value="" size="8"></input>
</td>
<td>
<label for="Rank">Rank: </label><input type="text" name="newRCRank1" value="0" size="2"></input>
</td>
<td>
<label for="Name">Misc: </label><input type="text" name="newRCMisc1" value="0" size="2"></input><input type="hidden" name="newRCTrained1" value="0"></input>
</td>
</tr>
[h: color=if(color=="#ededed","white","#ededed")]
<tr bgcolor="[r: color]">
<td>
<label for="Name"><b>Ranged Combat: </b></label><input type="text" name="newRC2" value="" size="8"></input>
</td>
<td>
<label for="Rank">Rank: </label><input type="text" name="newRCRank2" value="0" size="2"></input>
</td>
<td>
<label for="Name">Misc: </label><input type="text" name="newRCMisc2" value="0" size="2"></input><input type="hidden" name="newRCTrained2" value="0"></input>
</td>
</tr>

<tr>
<td align="center" colspan="4">
<input type='submit' name='Submit' value='Submit'></input>
</td>
</tr>
</table> 
</form>
</body>
</html>
} ]

!!
@@ @KnowSkillsUpdateDialog
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[dialog("Knowledge Skills Update", "width=550; height=400; temporary=0; input=1; noframe=0; closebutton=0"): {
<html>
<head>
<title>Knowledge Skills Update</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="KnowSkillsUpdate" action="[r:macroLinkText('KnowSkillsUpdate@Lib:MnM', 'none', '', currentToken())]">
  <table>
  [h: color = "#ededed"]
  [h: propListunsort = json.fields(KnowledgeSkills)]
  [h: propList = listsort(propListunsort, "A")]

  [foreach(tempAbility, propList, ""), code: {
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>[r: tempAbility]</b></label>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="[r: tempAbility+"Base"]" value="[r: json.get(json.get(KnowledgeSkills, tempAbility), 0)]" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="[r: tempAbility+"Bonus"]" value="[r: json.get(json.get(KnowledgeSkills, tempAbility), 1)]" size="2"></input>
        <input type="hidden" name="[r: tempAbility+"Aptitude"]" value="[r: json.get(json.get(KnowledgeSkills, tempAbility), 2)]"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="[r: tempAbility+"Spec"]" value="[r: json.get(json.get(KnowledgeSkills, tempAbility), 4)]" size="10"></input>
      </td>
      <td>
        <label for="del">Delete: </label><input type="checkbox" name="[r: tempAbility+"Delete"]" value="1"></input>
      </td>
    </tr>
    [h: color=if(color=="#ededed","white","#ededed")]
  }]
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Academics: </b></label><input type="text" name="newAcademics" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newAcademicsBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newAcademicsBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newAcademicsSpec" value="" size="10"></input>
      </td>
    </tr>
    [h: color=if(color=="#ededed","white","#ededed")]
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Art: </b></label><input type="text" name="newArt" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newArtBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newArtBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newArtSpec" value="" size="10"></input>
      </td>
    </tr>
    [h: color=if(color=="#ededed","white","#ededed")]
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Interest: </b></label><input type="text" name="newInterest" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newInterestBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newInterestBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newInterestSpec" value="" size="10"></input>
      </td>
    </tr>
    [h: color=if(color=="#ededed","white","#ededed")]
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Language: </b></label><input type="text" name="newLanguage" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newLanguageBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newLanguageBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newLanguageSpec" value="" size="10"></input>
      </td>
    </tr>
    [h: color=if(color=="#ededed","white","#ededed")]
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Profession: </b></label><input type="text" name="newProfession" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newProfessionBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newProfessionBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newProfessionSpec" value="" size="10"></input>
      </td>
    </tr>

    <tr>
      <td align="center" colspan="4">
        <input type='submit' name='Submit' value='Submit'></input>
      </td>
    </tr>
  </table> 
</form>
</body>
</html>
} ]

!!
@@ @ActiveSkillsUpdateDialog
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[dialog("Active Skills Update", "width=550; height=400; temporary=0; input=1; noframe=0; closebutton=0"): {
<html>
<head>
<title>Active Skills Update</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="ActiveSkillsUpdate" action="[r:macroLinkText('ActiveSkillsUpdate@Lib:MnM', 'none', '', currentToken())]">
  <table>
  [h: color = "#ededed"]
  [h: propListunsort = json.fields(ActiveSkills)]
  [h: propList = listsort(propListunsort, "A")]

  [foreach(tempAbility, propList, ""), code: {
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>[r: tempAbility]</b></label>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="[r: tempAbility+"Base"]" value="[r: json.get(json.get(ActiveSkills, tempAbility), 0)]" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="[r: tempAbility+"Bonus"]" value="[r: json.get(json.get(ActiveSkills, tempAbility), 1)]" size="2"></input>
        <input type="hidden" name="[r: tempAbility+"Aptitude"]" value="[r: json.get(json.get(ActiveSkills, tempAbility), 2)]"></input>
        <input type="hidden" name="[r: tempAbility+"Default"]" value="[r: json.get(json.get(ActiveSkills, tempAbility), 3)]"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="[r: tempAbility+"Spec"]" value="[r: json.get(json.get(ActiveSkills, tempAbility), 4)]" size="10"></input>
      </td>
      [h: tmpStr = tempAbility + "Delete"]
      [h,if(indexOf(tempAbility,":")==-1): delStr = ""; delStr = '<td><label for="del">Delete: </label><input type="checkbox" name="'+tmpStr+'" value="1"></input></td>']
      [r: delStr]
    </tr>
    [h: color=if(color=="#ededed","white","#ededed")]
  }]
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Exotic Melee: </b></label><input type="text" name="newExoticMelee" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newExoticMeleeBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newExoticMeleeBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newExoticMeleeSpec" value="" size="10"></input>
      </td>
    </tr>
    [h: color=if(color=="#ededed","white","#ededed")]
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Exotic Ranged: </b></label><input type="text" name="newExoticRanged" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newExoticRangedBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newExoticRangedBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newExoticRangedSpec" value="" size="10"></input>
      </td>
    </tr>
    [h: color=if(color=="#ededed","white","#ededed")]
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Hardware: </b></label><input type="text" name="newHardware" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newHardwareBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newHardwareBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newHardwareSpec" value="" size="10"></input>
      </td>
    </tr>
    [h: color=if(color=="#ededed","white","#ededed")]
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Medicine: </b></label><input type="text" name="newMedicine" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newMedicineBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newMedicineBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newMedicineSpec" value="" size="10"></input>
      </td>
    </tr>
    [h: color=if(color=="#ededed","white","#ededed")]
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Networking: </b></label><input type="text" name="newNetworking" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newNetworkingBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newNetworkingBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newNetworkingSpec" value="" size="10"></input>
      </td>
    </tr>
    [h: color=if(color=="#ededed","white","#ededed")]
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Pilot: </b></label><input type="text" name="newPilot" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newPilotBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newPilotBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newPilotSpec" value="" size="10"></input>
      </td>
    </tr>

    <tr>
      <td align="center" colspan="4">
        <input type='submit' name='Submit' value='Submit'></input>
      </td>
    </tr>
  </table> 
</form>
</body>
</html>
} ]

!!
@@ @TraitsUpdateDialog
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[dialog("Traits Update", "temporary=0; height=380; width=320; input=1; noframe=0"): {
<html>
<head>
<title>Traits Update</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="TraitsUpdate" action="[r:macroLinkText('TraitsUpdate@Lib:MnM', 'none', '', currentToken())]">
<table>
	<tr>
		<td bgcolor="black" valign="middle" colspan="7">&nbsp; &nbsp; <font color="white"><b>APTITUDES</b></font>
		</td>
	</tr>
	<tr>
		<td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>COG</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="COG" value="[r: getProperty("COG")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>COO</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="COO" value="[r: getProperty("COO")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>INT</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="INT" value="[r: getProperty("INT")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>REF</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="REF" value="[r: getProperty("REF")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>SAV</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="SAV" value="[r: getProperty("SAV")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>SOM</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="SOM" value="[r: getProperty("SOM")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>WIL</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="WIL" value="[r: getProperty("WIL")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td bgcolor="black" valign="middle" colspan="8">&nbsp; &nbsp; <font color="white"><b>DEFENSES & INITIATIVE</b></font>
		</td>
	</tr>	
	<tr>
		<td colspan="2">Defense
		</td>
		<td align="center" colspan="3">Defense<br>Rank
		</td>
		<td align="center" colspan="3">Defense Rank<br>without Bonuses
		</td>
	</tr>
	<tr>
		<td colspan="2">Dodge
		</td>
		<td align="center" colspan="3"><input type="text" name="Dodge" value="[r: getProperty("Dodge")]" size="2"></input>
		</td>
		<td align="center" colspan="3"><input type="text" name="DodgeNorm" value="[r: getProperty("DodgeNorm")]" size="2"></input>
		</td>
	</tr>
	<tr>
		<td colspan="2">Parry
		</td>
		<td align="center" colspan="3"><input type="text" name="Parry" value="[r: getProperty("Parry")]" size="2"></input>
		</td>
		<td align="center" colspan="3"><input type="text" name="ParryNorm" value="[r: getProperty("ParryNorm")]" size="2"></input>
		</td>
	</tr>
	<tr>
		<td colspan="2">Fortitude
		</td>
		<td align="center" colspan="3"><input type="text" name="Fortitude" value="[r: getProperty("Fortitude")]" size="2"></input>
		</td>
		<td align="center" colspan="3"><input type="text" name="FortitudeNorm" value="[r: getProperty("FortitudeNorm")]" size="2"></input>
		</td>
	</tr>
	<tr>
		<td colspan="2">Toughness
		</td>
		<td align="center" colspan="3"><input type="text" name="Toughness" value="[r: getProperty("Toughness")]" size="2"></input>
		</td>
		<td align="center" colspan="3"><input type="text" name="ToughnessNorm" value="[r: getProperty("ToughnessNorm")]" size="2"></input>
		</td>
	</tr>
	<tr>
		<td colspan="2">Will
		</td>
		<td align="center" colspan="3"><input type="text" name="Will" value="[r: getProperty("Will")]" size="2"></input>
		</td>
		<td align="center" colspan="3"><input type="text" name="WillNorm" value="[r: getProperty("WillNorm")]" size="2"></input>
		</td>
	</tr>
	<tr>
		<td colspan="8"><hr>
		</td>
	</tr>
	<tr>
		<td colspan="2">Initiative
		</td>
		<td align="center" colspan="3"><input type="text" name="Initiative" value="[r: getProperty("Initiative")]" size="2"></input>
		</td>
	</tr>
	<tr>
		<td colspan="8"><hr>
			Is Character a minion: <input type="checkbox" name="Minion" value="1" [r,  if(getProperty("Minion")=="1"):"CHECKED"; ""]></input>
		</td>
	</tr>
<tr>
<td align="center" colspan="8">
<input type='submit' name='Submit' value='Submit'></input>
</td>
</tr>
</table> 
</form>
</body>
</html>
} ]

!!
@@ @AptitudesUpdateDialog
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[dialog("Aptitudes Update", "temporary=0; height=200; width=270; input=1; noframe=0"): {
<html>
<head>
<title>Aptitudes Update</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="AptitudesUpdate" action="[r:macroLinkText('AptitudesUpdate@Lib:MnM', 'none', '', currentToken())]">
<table>
	<tr>
		<td bgcolor="black" valign="middle" colspan="7">&nbsp; &nbsp; <font color="white"><b>APTITUDES</b></font>
		</td>
	</tr>
	<tr>
		<td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>COG</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="COG" value="[r: getProperty("COG")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>COO</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="COO" value="[r: getProperty("COO")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>INT</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="INT" value="[r: getProperty("INT")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>REF</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="REF" value="[r: getProperty("REF")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>SAV</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="SAV" value="[r: getProperty("SAV")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>SOM</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="SOM" value="[r: getProperty("SOM")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>WIL</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="WIL" value="[r: getProperty("WIL")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
	</tr>
<tr>
<td align="center" colspan="8">
<input type='submit' name='Submit' value='Submit'></input>
</td>
</tr>
</table> 
</form>
</body>
</html>
} ]

!!
@@ @StatsUpdateDialog
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[dialog("Stats Update", "temporary=1; height=200; width=440; input=1; noframe=0"): {
<html>
<head>
<title>Stats Update</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="StatsUpdate" action="[r:macroLinkText('StatsUpdate@Lib:MnM', 'none', '', currentToken())]">
<table>
	<tr>
		<td bgcolor="black" valign="middle" colspan="11">&nbsp; &nbsp; <font color="white"><b>STATS</b></font>
		</td>
	</tr>
	<tr>
		<td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>MOX</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="MOX" value="[r: getProperty("MOX")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>Base MOX</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="MOX_base" value="[r: getProperty("MOX_base")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>TT</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="TT" value="[r: getProperty("TT")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>LUC</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="LUC" value="[r: getProperty("LUC")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>IR</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="IR" value="[r: getProperty("IR")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>WT</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="WT" value="[r: getProperty("WT")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>DUR</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="DUR" value="[r: getProperty("DUR")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>DR</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="DR" value="[r: getProperty("DR")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>INIT</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="INIT" value="[r: getProperty("INIT")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>SPD</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="SPD" value="[r: getProperty("SPD")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>DB</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="DB" value="[r: getProperty("DB")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
	</tr>
<tr>
<td align="center" colspan="11">
<input type='submit' name='Submit' value='Submit'></input>
</td>
</tr>
</table> 
</form>
</body>
</html>
} ]

!!
@@ @DamageStressUpdateDialog
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[dialog("Stats Update", "temporary=1; height=250; width=265; input=1; noframe=0"): {
<html>
<head>
<title>Damage & Stress Update</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="DamageStressUpdate" action="[r:macroLinkText('DamageStressUpdate@Lib:MnM', 'none', '', currentToken())]">
<table>
	<tr>
		<td bgcolor="black" valign="middle" colspan="10">&nbsp; &nbsp; <font color="white"><b>DAMAGE & STRESS</b></font>
		</td>
	</tr>
	<tr>
		<td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>DAMAGE</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="DAMAGE" value="[r: getProperty("DAMAGE")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>WOUNDS</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="WOUNDS" value="[r: getProperty("WOUNDS")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>STRESS</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="STRESS" value="[r: getProperty("STRESS")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>TRAUMA</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="TRAUMA" value="[r: getProperty("TRAUMA")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
	</tr>
<tr>
<td align="center" colspan="4">
<input type='submit' name='Submit' value='Submit'></input>
</td>
</tr>
</table> 
</form>
</body>
</html>
} ]

!!
@@ @RepUpdateDialog
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[dialog("Reputation Update", "temporary=0; height=200; width=335; input=1; noframe=0"): {
<html>
<head>
<title>Reputation Update</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="StatsUpdate" action="[r:macroLinkText('RepUpdate@Lib:MnM', 'none', '', currentToken())]">
<table>
	<tr>
		<td bgcolor="black" valign="middle" colspan="8">&nbsp; &nbsp; <font color="white"><b>REPUTATION</b></font>
		</td>
	</tr>
	<tr>
		<td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>@-Rep</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="A-Rep" value="[r: getProperty("A-Rep")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>c-Rep</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="c-Rep" value="[r: getProperty("c-Rep")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>e-Rep</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="e-Rep" value="[r: getProperty("e-Rep")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>f-Rep</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="f-Rep" value="[r: getProperty("f-Rep")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>g-Rep</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="g-Rep" value="[r: getProperty("g-Rep")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>i-Rep</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="i-Rep" value="[r: getProperty("i-Rep")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>r-Rep</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="r-Rep" value="[r: getProperty("r-Rep")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
	</tr>
<tr>
<td align="center" colspan="8">
<input type='submit' name='Submit' value='Submit'></input>
</td>
</tr>
</table> 
</form>
</body>
</html>
} ]

!!
@@ @VsCheckDialog
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[h: abilityList=" ,COG,COO,INT,REF,SAV,SOM,WIL"]
[h: defenseList= " ,Dodge,Parry,Fortitude,Toughness,Will"]
[h: skillListunsort = json.fields(Skills)]
[h: skillList = listsort(skillListunsort, "A")]
[h: skillList = " ,"+skillList]

[h:status=input(

"DC|0|Target DC|TEXT|WIDTH=2",
"ability|"+abilityList+"|Ability|LIST|VALUE=STRING",
"defense|"+defenseList+"|Defense|LIST|VALUE=STRING",
"skill|"+skillList+"|Skill|LIST|VALUE=STRING",
"Misc|0|Misc Bonus|TEXT|WIDTH=2"

)]
[h:abort(status)]

[if(skill ==""),code:{}; {
[h: skillRank = json.get(json.get(Skills,skill),0)]
[h: skillMisc =  json.get(json.get(Skills,skill),1)]
[h: skillAtt =  getProperty(json.get(json.get(Skills,skill),2))]
[h: skillTotal = skillRank+skillMisc+skillAtt]
}]

[h, if(ability == ""): Rank = 0; Rank = getProperty(ability)]
[h, if(defense == ""): Rank = Rank; Rank = getProperty(defense)]
[h, if(skill == ""): Rank = Rank; Rank = skillTotal]

[h, if(ability == ""): Name = "d20 Roll"; Name = ability+" Check"]
[h, if(defense == ""): Name = Name; Name = defense+" Check"]
[h, if(skill == ""): Name = Name; Name = skill+" Check"]

[h: Roll = d20]

[h:resulta=(Roll+Rank+Misc)-DC]
[r: name] : [t: Roll+ Rank+Misc][r, if(DC): " vs. DC "+ DC; ""][r, macro("d20@this"):Roll][r: macro.return]
[r, if(DC),code:{<br>
[r: table("DegreesSuccess",resulta)]
}; {}]

!!
@@ @VsCheckDialogDM
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[h:status=input(

"DC|0|Target DC|TEXT|",
"roll|0|Roll Result|TEXT|"

)]
[h:abort(status)]

[h:resulta=roll-DC]
[r: table("DegreesSuccess",resulta)]

!!
@@ @AdvantagesUpdateDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Display ; tooltip= ; minWidth= ; 
[dialog("Advantages", "temporary=0; input=1; noframe=0"): {
<html>
<head>
<title>Advantages Display</title>
</head>
<body>
<table width="100%" height="100%" cellpadding="2" align="center" border="0" bgcolor="white">
	<tr  bgcolor="[r: table(PageColor,2)]" color="white">
		<td align="center" width="98%">
		<font  size="5"><b>[r: json.get(macro.args, 0)]</b></font>
		</td>
		<td align="right" width="1%">
		<font color="white"><a href="[r: macroLinkText("AdvantagesUpdateDialog@this", "none", macro.args, currentToken())]"><image src="[r: tableImage("Buttons",5)]" border="0"></image></a></font>
		</td>
	</tr>
	<tr>	
		<td colspan="2">[r: decode(json.get(macro.args,1))]</td>
	</tr>
</table>
</body>
</html>
}]

!!
@@ @AreaEntry
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Attack ; tooltip= ; minWidth= ; 
<head>
<title>Area Attack Modifiers</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="SkillCheck" action="[r:macroLinkText('EntryType@Lib:MnM', 'none', '', currentToken())]">

<table width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td color="white">
			<center><b>[r: json.get(macro.args,0)]</center>
		</td>
	</tr>
</table>
<table width="100%"  bgcolor="white">
	<tr>
		<td align="center" colspan="2">
			Effect Modifiers: <input type="text" name="effect" value="" size="5"></input>
		</td>
	</tr>
	<tr  bgcolor="[r: table(PageColor,3)]">
		<td align="left">
			Private: <input type="checkbox" name="Output" value="Private"></input>
		</td>
		<td alignt="right">
			Hide Roll: <input type="checkbox" name="hide" value="1"]></input>
		</td>
	</tr>
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,4)]">
		<td align="center">
			<input type="hidden" name="name" value="[r: json.get(macro.args,0)]"></input>					<input type="hidden" name="ExeMacro" value="AttackCheck"></input>
			<input type='submit' name='Roll' value='Roll'></input>
		</td>
	</tr>
</table>
</form>
</body>
</html>

!!
@@ @AttackArea
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Attack ; tooltip= ; minWidth= ; 
<table width="100%"  bgcolor="white">
	<tr>
		<td alignt="center">
			Effect Modifiers: <input type="text" name="effect" value="" size="5"></input>
		</td>
	</tr>
</table>

!!
@@ @AttackDamage
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Attack ; tooltip= ; minWidth= ; 


!!
@@ @AttackEntry
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Attack ; tooltip= ; minWidth= ; 
[h: name =  json.get(macro.args,0)]
[h: range =  json.get(json.get(Attacks,name),1)]
[h: area =  json.get(json.get(Attacks,name),2)]

<head>
<title>Attack Modifiers</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="SkillCheck" action="[r:macroLinkText('EntryType@Lib:MnM', 'none', '', currentToken())]">

<table width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td color="white">
			<center><b>[r: json.get(macro.args,0)]</center>
		</td>
	</tr>
</table>
	
[if(range=="Perception"||area!=""),code:{[r, macro("AttackArea@this"):""]}; {
	[r, macro("AttackTarget@this"):""]
	[r, macro("AttackRangeMods@this"):""]
	[r, macro("AttackMods@this"):""]
}]
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,3)]">
		<td align="left">
			Private: <input type="checkbox" name="Output" value="Private"></input>
		</td>
		<td alignt="right">
			Hide Roll: <input type="checkbox" name="hide" value="1"]></input>
		</td>
	</tr>
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,4)]">
		<td align="center">
			<input type="hidden" name="name" value="[r: json.get(macro.args,0)]"></input>					<input type="hidden" name="ExeMacro" value="AttackCheck"></input>
			<input type='submit' name='Roll' value='Roll'></input>
		</td>
	</tr>
</table>
</form>
</body>
</html>

!!
@@ @AttackMods
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Attack ; tooltip= ; minWidth= ; 
<table width="100%"  bgcolor="white">
	<tr>
		<td align="left">
			Attack Modifiers: <input type="text" name="attack" value="" size="5"></input>
		</td>
		<td alignt="right">
			Effect Modifiers: <input type="text" name="effect" value="" size="5"></input>
		</td>
	</tr>
</table>

!!
@@ @AttackRangeMods
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Attack ; tooltip= ; minWidth= ; 
<table width="100%"  bgcolor="white">
	<tr>
		<td>
			Range:
		</td>
		<td align="left">
<input type="radio" name="range" value="0" checked> None</input>
<input type="radio" name="range" value="-2"> Medium</input>
<input type="radio" name="range" value="-5"> Long</input>
		</td>
	</tr>
	<tr>
		<td>
			Cover:
		</td>
		<td align="left">
<input type="radio" name="cover" value="0" checked> None</input>
<input type="radio" name="cover" value="-2"> Partial</input>
<input type="radio" name="cover" value="-5"> Total</input>
		</td>
	</tr>
	<tr>
		<td>
			Concealment:
		</td>
		<td align="left">
<input type="radio" name="concealment" value="0" checked> None</input>
<input type="radio" name="concealment" value="-2"> Partial</input>
<input type="radio" name="concealment" value="-5"> Total</input>
		</td>
	</tr>
</table>

!!
@@ @AttackResistance
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Attack ; tooltip= ; minWidth= ; 


!!
@@ @AttackTarget
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Attack ; tooltip= ; minWidth= ; 
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,3)]">
		<td><center><b> Attack Target:</b> 
			
			<select name="target">
			<option value="">None</option>
			<option value="[r: token.name]">Self</option>
			[H: tokenList=getExposedTokenNames()]
			[h: tokenList = replace(tokenList,token.name+",","")]
			[foreach(name,tokenList,""),code:{
			<option value='[r: name]'>[r: name]</option>
			}]</select></center>
		</td>
	</tr>
</table>

!!
@@ @Critical
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy=z ; color=default ; playerEditable=false ; applyToSelected=false ; group=Attack ; tooltip= ; minWidth= ; 
[h: Roll = json.get(macro.args,0)]
[h: Crit = json.get(macro.args,1)]
[h: Crit = if(Crit=="",20,Crit)]
[h:  macro.return = if(Roll == 1, " &#8226; <b>Natural 1!</b>","")]

[h:  macro.return = if(Roll >= Crit, " &#8226; <b>Critical Hit!!!</b>",macro.return)]

[h:  macro.return = if(Roll == 20, " &#8226; <b>Natural 20!!!</b>",macro.return)]

!!
@@ @AsleepUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=a ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
[if(getState("Asleep")): setState("Asleep",0); setState("Asleep",1)]

!!
@@ @BlindUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=a ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
[if(getState("Blind")): setState("Blind",0); setState("Blind",1)]

!!
@@ @BoundUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=a ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
[if(getState("Bound")): ""; setState("Hindered",0)]
[if(getState("Bound")): ""; setState("Vulnerable",0)]
[if(getState("Bound")): ""; setState("Restrained",0)]
[if(getState("Bound")): setState("Bound",0); setState("Bound",1)]

!!
@@ @Clear AllUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=b ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
[setAllStates(0)]
[h: if(Bruises==0, "", setState("Bruises"+Bruises,1))]

!!
@@ @CompelledUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
[if(getState("Compelled")): setState("Compelled",0); setState("Compelled",1)]

!!
@@ @ControlledUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
[if(getState("Controlled")): setState("Controlled",0); setState("Controlled",1)]
[setState("Compelled", 0)]

!!
@@ @DazedUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
[if(getState("Dazed")): setState("Dazed",0); setState("Dazed",1)]

!!
@@ @DeafUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=a ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
[if(getState("Deaf")): setState("Deaf",0); setState("Deaf",1)]

!!
@@ @DebilitatedUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
[if(getState("Debilitated")): setState("Debilitated",0); setState("Debilitated",1)]

!!
@@ @DefenselessUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
[if(getState("Defenseless")): setState("Defenseless",0); setState("Defenseless",1)]
[setState("Vulnerable",0)]

!!
@@ @DisabledUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
[if(getState("Disabled")): setState("Disabled",0); setState("Disabled",1)]
[setState("Impaired",0)]

!!
@@ @DyingUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=a ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
[if(getState("Dying")): ""; setState("Dazed",0))]
[if(getState("Dying")): ""; setState("Hindered",0))]
[if(getState("Dying")): ""; setState("Staggered",0))]
[if(getState("Dying")): ""; setState("Incapacitated",0))]
[if(getState("Dying")): setState("Dying",0); setState("Dying",1)]

!!
@@ @EntrancedUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=a ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
[if(getState("Entranced")): setState("Entranced",0); setState("Entranced",1)]

!!
@@ @ExhaustedUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=a ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
[if(getState("Exhausted")): setState("Exhausted",0); setState("Exhausted",1)]

!!
@@ @FatiguedUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
[if(getState("Fatigued")): setState("Fatigued",0); setState("Fatigued",1)]

!!
@@ @GrabUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=aa ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
[if(getState("Grab")): setState("Grab",0); setState("Grab",1)]]

!!
@@ @HinderedUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
[if(getState("Hindered")): setState("Hindered",0); setState("Hindered",1)]

!!
@@ @ImmobileUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
[if(getState("Immobile")): setState("Immobile",0); setState("Immobile",1)]
[setState("Hindered",0)]

!!
@@ @ImpairedUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
[if(getState("Impaired")): setState("Impaired",0); setState("Impaired",1)]

!!
@@ @IncapacitatedUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=a ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
[if(getState("Incapacitated")): ""; setState("Dazed",0))]
[if(getState("Incapacitated")): ""; setState("Hindered",0))]
[if(getState("Incapacitated")): ""; setState("Staggered",0))]
[if(getState("Incapacitated")): ""; setState("Dying",0))]
[if(getState("Incapacitated")): setState("Incapacitated",0); setState("Incapacitated",1)]

!!
@@ @ParalyzedUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=a ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
[if(getState("Paralyzed")): setState("Paralyzed",0); setState("Paralyzed",1)]

!!
@@ @ProneUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=a ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
[if(getState("Prone")): setState("Prone",0); setState("Prone",1)]

!!
@@ @Reset BruisesUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=b ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
[h: setState("Bruises"+Bruises,0)]
[h: Bruises=0]

!!
@@ @RestrainedUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=a ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
[if(getState("Restrained")): setState("Restrained",0); setState("Restrained",1)]

!!
@@ @StaggeredUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=a ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
[if(getState("Staggered")): setState("Staggered",0); setState("Staggered",1)]

!!
@@ @StunnedUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
[if(getState("Stunned")): setState("Stunned",0); setState("Stunned",1)]
[setState("Dazed",0)]

!!
@@ @SurprisedUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=a ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
[if(getState("Surprised")): setState("Surprised",0); setState("Surprised",1)]

!!
@@ @TransformedUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
[if(getState("Transformed")): setState("Transformed",0); setState("Transformed",1)]

!!
@@ @UnawareUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
[if(getState("Unaware")): setState("Unaware",0); setState("Unaware",1)]

!!
@@ @VulnerableUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
[if(getState("Vulnerable")): setState("Vulnerable",0); setState("Vulnerable",1)]

!!
@@ @WeakenedUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
[if(getState("Weakened")): setState("Weakened",0); setState("Weakened",1)]

!!
@@ @Attack
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Check ; tooltip= ; minWidth= ; 
[h: name=macro.args]

[h: Roll = d20]
[h: Rank =  json.get(json.get(Attacks,name),3)]
[h: Crit = json.get(json.get(Attacks,name),5)]
[h: CritTotal = ""]

<b>[r: name]</b>

[if(Rank == ""),code:{<br>}; {<br>

[r, macro("AttackModifier@this"):macro.args]
[h: Misc = json.get(macro.return,0)]
[h: Bonus = json.get(macro.return,1)]
[h: Target = json.get(macro.return,2)]

<b>Attack</b>[r, if(Target !=""): " against "+Target; ""]: 
[t: Roll + Rank + Misc] vs. [r: json.get(json.get(Attacks,name),4)]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <b>Hit</b>:
[h: Misc = Bonus][h: jsonData=json.append("[]",Roll,Crit)][r, macro("Critical@this"):jsonData][h: CritTotal = macro.return]
}]

[h: Damage = json.get(json.get(Attacks,name),9)]
[h: Resistance = json.get(json.get(Attacks,name),6)]

[if(Resistance==""),code:{}; {

[if(Damage == 1),code:{

[h: Rank = if(json.get(json.get(Attacks,name),7)=="",0,json.get(json.get(Attacks,name),7))]
[h: effecttotal = Rank+Misc]
[h: jsonData = json.append("[]", json.get(json.get(Attacks,name),6),effecttotal, json.get(json.get(Attacks,name),11))]
[r: macroLink(json.get(json.get(Attacks,name),6),"Resistance@this","all",jsondata,"selected")]  vs. DC [t: Rank + 10 + Misc] [r: CritTotal]
[h: jsonData = json.get(json.get(Attacks,name),11)]<br>
<i>[r, macro("ConditionsLink@this"):jsonData]</i>

}; {

[h: effectrank = if(json.get(json.get(Attacks,name),7)=="",0,json.get(json.get(Attacks,name),7))]
[h: strengthrank = if(json.get(json.get(Attacks,name),8)=="",0,getProperty("Strength"))]
[h: Rank = effectrank + strengthrank]
[h: effecttotal = effectrank+strengthrank+Misc]
[h: jsonData = json.append("[]", json.get(json.get(Attacks,name),6),effecttotal)]
[r: macroLink(json.get(json.get(Attacks,name),6),"Damage@this","all",jsondata,"selected")]  vs. DC [t: Rank + 15 + Misc] [r: CritTotal]

}]

}]

!!
@@ @CharSheet
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet ; tooltip= ; minWidth= ; 
[h: page = getStrProp(macro.args, "Page")]
[h: tempPage = getStrProp(CharPage, "Page")]

[h, if(page==""&&tempPage==""): page="Stats"]
[h, if(page==""&&tempPage!=""): page=tempPage]
[h: CharPage="Page="+page]
[h: icon = tblImage("Header",1)]

<table width="100%" cellpadding="0" border="1" bgcolor="white">
<table width="100%" cellpadding="2" border="0" bgcolor="[r: table(PageColor,2)]" background="[r: tblImage('Icons',2)]">
	<tr>
		<td width="30%" rowspan="2">
			<a href="[r: macroLinktext("ColorUpdate@this", "none", "", currentToken())]"><image src='[r:getTokenImage(75)]' border="0"></image></a>
		</td>
		<td width="30%" align="center" >
      <a href="[r: macroLinktext("SheetLoad@this", "none", "Page=Stats", currentToken())]">
			<font color="[r: if(page=="Stats","yellow","white")]" size="4"><b>Stats</b></font></a>
		</td>
    <td width="30%" align="center" >
      <a href="[r: macroLinktext("SheetLoad@this", "none", "Page=Skills", currentToken())]">
			<font color="[r: if(page=="Skills","yellow","white")]" size="4"><b>Skills</b></font></a>
		</td>
		<td width="30%" align="center" >
      <a href="[r: macroLinktext("SheetLoad@this", "none", "Page=Powers", currentToken())]">
			<font color="[r: if(page=="Powers","yellow","white")]" size="4"><b>Powers</b></font></a>
		</td>
	</tr>
	<tr>
		<td align="right" colspan="2" color="white">
			<font size="6"><b>[r: token.name]</b>&nbsp; </font>
		</td>
	</tr>
</table>

[r, macro("HeaderSheet@this"):macro.args]
</table>
<table width="100%" cellpadding="2" border="0">
	<tr>
		<td>
      <image src='[r: tableImage("Actions", 1)]' border="0" align="middle"></image>
		</td>
	</tr>
</table>
[r, macro(page+"Sheet@this"):macro.args]

!!
@@ @HeaderSheet
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet ; tooltip= ; minWidth= ; 
<table width="100%" cellpadding="2" border="0">
	<tr bgcolor="[r: table(PageColor,4)]">
    <td>
			<b><font color="black">Background:</b> [r: Background]</font>
		</td>
  </tr>
  <tr bgcolor="[r: table(PageColor,4)]">
    <td>
      <b><font color="black">Motivations:</b> [r: Motivations]</font>
    </td>
  </tr>
</table>
<table width="100%" cellpadding="2" border="0">
	<tr bgcolor="[r: table(PageColor,4)]">
		<td width="34%">
			<b><font color="black">Faction:</b> [r: Faction]</font>
		</td>
		<td width="33%">
      <b><font color="black">Morph:</b> [r: Morph]</font>
		</td>	
    <td width="33%">
			<b><font color="black">Age:</b> [r: Age]</font>
		</td>
	</tr>
	<tr bgcolor="[r: table(PageColor,4)]">
		<td width="34%" align="center">
			<b><font color="black"><a href='[r:macroLinkText("TableLoad@this","none",'', currentToken())]'>Tables</a></font></b>
		</td>
		<td width="33%" align="center">
			<b><font color="black"><a href='[r: macroLinktext("RezPointsUpdate@this", "all", "Page=Stats", currentToken())]'>Rez Points:</a></font> [r: RezPoints]</b>
		</td>
		<td width="33%" align="center">

		</td>	
	</tr>
</table>
<table width="100%" cellpadding="5" border="0" valign="middle">
  <tr>
    <td  align="left" width="10%">
      <b><font color="black"><a href='[r:macroLinkText("ConditionsUpdateDialog@this","none", "", currentToken())]'>Conditions:</a></font></b>
    </td>
    <td align="left">
       [r, macro("StatesDisplay@this"):""]
    </td>
  </tr>
</table>

!!
@@ @PowersSheet
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet ; tooltip= ; minWidth= ; 
<table width="100%" cellpadding="0">
	<tr>
		<td valign="top" align="center" width="100%"><!--Left side of character sheet-->
			<table width="100%" cellpadding="0">
				<tr>
					<td>
						[r, macro("OffenseDisplayTop@this"):""]
					</td>
				</tr>
<table width="100%" cellpadding="2" border="0">
	<tr>
		<td>
<image src='[r: tableImage("Actions", 1)]' border="0" align="middle"></image>
		</td>
	</tr>
</table>
				<tr>
					<td>
						[r, macro("PowersDisplay@this"):""]
					</td>
				</tr>
			</table>
		</td>
	</tr>
</table>

!!
@@ @Sheet
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet ; tooltip= ; minWidth= ; 
[h: selectedCount=listCount(getSelected())]
[frame("Sheet"):{
<html>
<link rel="onChangeSelection" type="macro" href="[r: macroLinkText('SheetLoad@this', 'none','','selected')]"></link>
<head><title>Character Sheet</title></head>
<body>

	[r, if(getPropertyType() != "Basic" && getPropertyType() != "zLibrary" && selectedCount <= 1), code:
		{
			[r, macro("CharSheet@this"): macro.args]
		}; 
		{
			<table width="100%">
				<tr>
					<td align="center"><image src='[r: tableImage("Icons",1,300)]' border="0" align="middle"></image><br>
						<font size = "5"><b>[r, if(SelectedCount <= 1): "This is not a character token."; "Multiple tokens selected."]</b></font>
					</td>
				</tr>
			</table>
		}
	]
</body>
</html>
}]

!!
@@ @SheetLoad
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet ; tooltip= ; minWidth= ; 
[H: OwnedCurrent = listContains(getOwned(getPlayerName()), currentToken())]
[H: OwnedSelected = listContains(getOwned(getPlayerName()), getSelected())]

[R, if(	OwnedCurrent == 1  ||
		OwnedSelected == 1 ||
		isGM() ), CODE:
	{
		[r, macro("Sheet@this"): macro.args]	
	}; {
		[h: ""]
	}
]

!!
@@ @StatsSheet
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet ; tooltip= ; minWidth= ; 
<table width="100%" cellpadding="0">
	<tr>
		<td width="100%" valign="top">
			[r, macro("AptitudesDisplay@this"):""]
		</td>
	</tr>
</table>
<table width="100%" cellpadding="0">
	<tr>
		<td width="100%" valign="top">
			[r, macro("StatsDisplay@this"):""]
		</td>
	</tr>
</table>
<table width="100%" cellpadding="0">
	<tr>
		<td width="100%" valign="top">
			[r, macro("DamageStressDisplay@this"):""]
		</td>
	</tr>
</table>
<table width="100%" cellpadding="0">
	<tr>
		<td width="100%" valign="top">
			[r, macro("RepDisplay@this"):""]
		</td>
	</tr>
</table>

!!
@@ @SkillsSheet
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet ; tooltip= ; minWidth= ; 
<table width="100%" cellpadding="0" border="1">
  <tr>
    <td width="100%">
      [r, macro("ActiveSkillsDisplayTop@this"):""]
    </td>
  </tr>
</table>
<table width="100%" cellpadding="0" border="1">
  <tr>
    <td width="100%">
      [r, macro("KnowSkillsDisplayTop@this"):""]
    </td>
  </tr>
</table>

!!
@@ @D20basic
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dice ; tooltip= ; minWidth= ; 
[h:status=input(

"rollName|"+json.get(macro.args,0)+"|Roll Name",
"rollType|Roll, Check, Attack|Type of Roll|LIST| VALUE=STRING",
"rollMod|0|D20 Bonus/Penalty|TEXT|",
"hp|0|Improved Roll|CHECK"

)]
[h:abort(status)]
[h: jsonData=json.append("[]",rollName,rollMod,rollType,0,hp)]
[r, macro("D20rollbasic@this"):jsonData]

!!
@@ @D20mod
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dice ; tooltip= ; minWidth= ; 
[h: name=json.get(macro.args,0)]
[h:status=input(

"rollMod|0|"+name+" Bonus/Penalty|TEXT|"

)]
[h:abort(status)]
[h: jsonData= json.set(macro.args,3,rollMod)]
[r, macro("D20roll@this"):jsonData]

!!
@@ @D20rollbasic
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dice ; tooltip= ; minWidth= ; 
[h: rollName = json.get(macro.args, 0)]
[h: rollBonus = json.get(macro.args, 1)]
[h: rollType = json.get(macro.args, 2)]
[h: rollMisc = json.get(macro.args, 3)]
[h: rollImproved = json.get(macro.args, 4)]
[h: rolldie = if(rollImproved==1, d20r10 , d20)]

[r: rollname] [r:rollType][r: if(rollImproved==1, " <i>(Improved Roll)</i>","")]: [t:rolldie+rollBonus+rollMisc] [if(rolldie == 1), code: {<span style color="blue"> &#8226; <b>Natural 1!</b></span>}; {}] [if(rolldie == 20), code: {<span style color="red"> &#8226; <b>Natural 20!!!</b></span>}; {}]

!!
@@ @DamageCheck
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Damage ; tooltip= ; minWidth= ; 
[h: Roll = d20]
[h: Effect =  json.get(macro.args,"effect")]

[if(json.get(macro.args,"ability")=="No"),code:{
[h: Rank = getProperty(json.get(macro.args,"name"))]
}; {
[h: Rank = getProperty(json.get(macro.args,"ability"))]
}]
[h, if(json.get(macro.args,"rankmod")==""): Misc=0-getProperty("Bruises"); Misc = json.get(macro.args,"rankmod")-getProperty("Bruises")]
[h, if(json.get(macro.args,"effectmod")==""): Bonus=0; Bonus = json.get(macro.args,"effectmod")]

[if(json.get(macro.args,"half")=="1"),code:{[h: Effect = floor(Effect/2)][h, if(Effect <= 0):Effect = 1; Effect = Effect]}; {}]

I make a [r, if(json.get(macro.args,"ability") == "No"):json.get(macro.args,"name"); json.get(macro.args,"ability")] Check:  [R, if(json.get(macro.args, "hide") == "1"), CODE:{[gt, st, t(Roll + Rank + Misc): Roll + Rank + Misc]}; {[t(Roll + Rank + Misc):Roll + Rank + Misc]}][r, macro("d20@this"):Roll] 

vs. DC  [R, if(json.get(macro.args, "hide") == "1"), CODE:{[gt, st, t( Effect+15+Bonus):  Effect+15+Bonus]}; {[t( Effect+15+Bonus): Effect+15+Bonus]}][r: macro.return]
<br>
[h:resulta=-1*(Roll+Rank+Misc-(Effect+15+Bonus))]

[if(getProperty("Minion")),code:{

[h: margina= table("MinionDamage",resulta)]

}; {

[h: margina= table("Damage",resulta)]

}]

[switch(margina),code:
case 0: {
No Effect!!!
}; 
case 1: {
[r: macroLink("-1 Penalty","DamageUpdateQuick@this","none","","selected")]
}; 
case 2: {
[r: macroLink("Dazed & -1 Penalty","DamageUpdateDazed@this","none","Dazed","selected")]
}; 
case 3: {
[r: macroLink("Staggered & -1 Penalty","DamageUpdateStaggered@this","none","Staggered","selected")]
}; 
case 4: {
[r: macroLink("Incapacitated!","DamageUpdateIncapacitated@this","none","Incapacitated","selected")]
}]

!!
@@ @DamageEntry
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Damage ; tooltip= ; minWidth= ; 
<head>
<title>Damage Resistance Check</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="SkillCheck" action="[r:macroLinkText('EntryType@Lib:MnM', 'none', '', currentToken())]">

<table width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td color="white">
			<center><b>[r: json.get(macro.args,0)] vs. DC [r: json.get(macro.args,1)+15]</center>
		</td>
	</tr>
</table>
<table width="100%" bgcolor="white">
	<tr>
		<td  colspan = "2">
			Alternate Defense:
			<select name="ability" selected="">
			<option value='No'>No</option>
			<option value='Dodge'>Dodge</option>
			<option value='Parry'>Parry</option>
			<option value='Fortitude'>Fortitude</option>	
			<option value='Toughness'>Toughness</option>
			<option value='Will'>Will</option>
			</select>
		</td>
	</tr>
	<tr>
		<td colspan = "2">
			Half Effect Rank: <input type="checkbox" name="half" value="1"></input>
		</td>
	</tr>
	<tr>
		<td align="left">
			Defense Modifiers: <input type="text" name="rankmod" value="" size="5"></input>
		</td>
		<td alignt="right">
			DC Modifiers: <input type="text" name="effectmod" value="" size="5"></input>
		</td>
	</tr>
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,3)]">
		<td align="left">
			Private: <input type="checkbox" name="Output" value="Private"></input>
		</td>
		<td alignt="right">
			Hide Roll: <input type="checkbox" name="hide" value="1"]></input>
		</td>
	</tr>
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,4)]">
		<td align="center">
			<input type="hidden" name="name" value="[r: json.get(macro.args,0)]"></input>					<input type="hidden" name="effect" value="[r: json.get(macro.args,1)]"></input>
			<input type="hidden" name="ExeMacro" value="DamageCheck"></input>
			<input type='submit' name='Roll' value='Roll'></input>
		</td>
	</tr>
</table>
</form>
</body>
</html>

!!
@@ @ResistanceCheck
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Damage ; tooltip= ; minWidth= ; 
[h: Roll = d20]
[h: Effect =  json.get(macro.args,"effect")]

[if(json.get(macro.args,"ability")=="No"),code:{
[h: Rank = getProperty(json.get(macro.args,"name"))]
}; {
[h: Rank = getProperty(json.get(macro.args,"ability"))]
}]
[h, if(json.get(macro.args,"rankmod")==""): Misc=0-getProperty("Bruises"); Misc = json.get(macro.args,"rankmod")-getProperty("Bruises")]
[h, if(json.get(macro.args,"effectmod")==""): Bonus=0; Bonus = json.get(macro.args,"effectmod")]

[if(json.get(macro.args,"half")=="1"),code:{[h: Effect = floor(Effect/2)][h, if(Effect <= 0):Effect = 1; Effect = Effect]}; {}]

I make a [r, if(json.get(macro.args,"ability") == "No"):json.get(macro.args,"name"); json.get(macro.args,"ability")] Check:  [R, if(json.get(macro.args, "hide") == "1"), CODE:{[gt, st, t(Roll + Rank + Misc): Roll + Rank + Misc]}; {[t(Roll + Rank + Misc):Roll + Rank + Misc]}][r, macro("d20@this"):Roll] 

vs. DC [R, if(json.get(macro.args, "hide") == "1"), CODE:{[gt, st, t( Effect+10+Bonus):  Effect+10+Bonus]}; {[t( Effect+10+Bonus): Effect+10+Bonus]}][r: macro.return]
<br>
[h:resulta=-1*(Roll+Rank+Misc-(Effect+10+Bonus))]

[if(getProperty("Minion")),code:{

[r: table("MinionMargin",resulta)]

}; {

[r: table("Margin",resulta)]

}]

!!
@@ @ResistanceEntry
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Damage ; tooltip= ; minWidth= ; 
<head>
<title>Resistance Check</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="SkillCheck" action="[r:macroLinkText('EntryType@Lib:MnM', 'none', '', currentToken())]">

<table width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td color="white">
			<center><b>[r: json.get(macro.args,0)] vs. DC [r: json.get(macro.args,1)+10]</center>
		</td>
	</tr>
</table><table width="100%" bgcolor="white">
	<tr>
		<td  colspan = "2">
			Alternate Defense:
			<select name="ability" selected="">
			<option value='No'>No</option>
			<option value='Dodge'>Dodge</option>
			<option value='Parry'>Parry</option>
			<option value='Fortitude'>Fortitude</option>	
			<option value='Toughness'>Toughness</option>
			<option value='Will'>Will</option>
			</select>
		</td>
	</tr>
	<tr>
		<td colspan = "2">
			Half Effect Rank: <input type="checkbox" name="half" value="1"></input>
		</td>
	</tr>
	<tr>
		<td align="left">
			Defense Modifiers: <input type="text" name="rankmod" value="" size="5"></input>
		</td>
		<td alignt="right">
			DC Modifiers: <input type="text" name="effectmod" value="" size="5"></input>
		</td>
	</tr>
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,3)]">
		<td align="left">
			Private: <input type="checkbox" name="Output" value="Private"></input>
		</td>
		<td alignt="right">
			Hide Roll: <input type="checkbox" name="hide" value="1"]></input>
		</td>
	</tr>
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,4)]">
		<td align="center">
			<input type="hidden" name="name" value="[r: json.get(macro.args,0)]"></input>					<input type="hidden" name="effect" value="[r: json.get(macro.args,1)]"></input>
			<input type="hidden" name="ExeMacro" value="ResistanceCheck"></input>
			<input type='submit' name='Roll' value='Roll'></input>
		</td>
	</tr>
</table>
</form>
</body>
</html>

!!
@@ @GMLoad
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=GM ; tooltip= ; minWidth= ; 
[r, macro("GMSheet@this"): macro.args]

!!
@@ @GMSheet
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=GM ; tooltip= ; minWidth= ; 
[frame("GM"):{
<html>
<head><title>GM Screen</title></head>
<body>
<table border="0" width="100%" cellpadding="3">
<tr>
<td>
[r,macro("StatesDisplayGM@this"):""]
</td>
</tr>
</table>
</body>
</html>
}]

!!
@@ @Measurements Table
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=z ; color=default ; playerEditable=false ; applyToSelected=false ; group=GM ; tooltip= ; minWidth= ; 
[dialog("Measurements Table","width=400; height=600; temporary=1; noframe=0; "): {

<table bgcolor="[r: table(PageColor,4)]">
	<tr bgcolor='[r: table(PageColor,2)]'>
		<td ><span style="color:white"><b><center>Rank</td>
		<td ><span style="color:white"><b><center>Mass</td>
		<td ><span style="color:white"><b><center>Time</td>
		<td ><span style="color:white"><b><center>Distance</td>
		<td ><span style="color:white"><b><center>Volume</td>
	</tr><tr>
<td colspan="7" style="background-color:'[r: table(PageColor,3)]'  ; margin:0px; padding:0px; height:0px"><img src='[r: tblImage("Icons",10,5)]' border="0"></img></td>
</tr>
	<tr bgcolor="white">
		<td ><center>-5</td>
		<td ><center>1.5 lb.</td>
		<td ><center>1/8 second</td>
		<td ><center>6 inches</td>
		<td ><center>1/32 cft.</td>
	</tr>
	<tr>
		<td ><center>-4</td>
		<td ><center>3 lbs.</td>
		<td ><center>1/4 second</td>
		<td ><center>1 foot</td>
		<td ><center>1/16 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>-3</td>
		<td ><center>6 lbs.</td>
		<td ><center>1/2 second</td>
		<td ><center>3 feet</td>
		<td ><center>1/8 cft.</td>
	</tr>
	<tr>
		<td ><center>-2</td>
		<td ><center>12 lbs.</td>
		<td ><center>1 second</td>
		<td ><center>6 feet</td>
		<td ><center>1/4 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>-1</td>
		<td ><center>25 lbs.</td>
		<td ><center>3 seconds</td>
		<td ><center>15 feet</td>
		<td ><center>1/2 cft.</td>
	</tr>
	<tr>
		<td ><center>0</td>
		<td ><center>50 lbs.</td>
		<td ><center>6 seconds</td>
		<td ><center>30 feet</td>
		<td ><center>1 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>1</td>
		<td ><center>100 lbs.</td>
		<td ><center>12 seconds</td>
		<td ><center>60 feet</td>
		<td ><center>2 cft.</td>
	</tr>
	<tr>
		<td ><center>2</td>
		<td ><center>200 lbs.</td>
		<td ><center>30 seconds</td>
		<td ><center>120 feet</td>
		<td ><center>4 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>3</td>
		<td ><center>400 lbs.</td>
		<td ><center>1 minute</td>
		<td ><center>250 feet</td>
		<td ><center>8 cft.</td>
	</tr>
	<tr>
		<td ><center>4</td>
		<td ><center>800 lbs.</td>
		<td ><center>2 minutes</td>
		<td ><center>500 feet</td>
		<td ><center>15 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>5</td>
		<td ><center>1600 lbs.</td>
		<td ><center>4 minutes</td>
		<td ><center>900 feet</td>
		<td ><center>30 cft.</td>
	</tr>
	<tr>
		<td ><center>6</td>
		<td ><center>3200 lbs.</td>
		<td ><center>8 minutes</td>
		<td ><center>1800 feet</td>
		<td ><center>60 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>7</td>
		<td ><center>3 tons</td>
		<td ><center>15 minutes</td>
		<td ><center>1/2 mile</td>
		<td ><center>125 cft.</td>
	</tr>
	<tr>
		<td ><center>8</td>
		<td ><center>6 tons</td>
		<td ><center>30 minutes</td>
		<td ><center>1 mile</td>
		<td ><center>250 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>9</td>
		<td ><center>12 tons</td>
		<td ><center>1 hour</td>
		<td ><center>2 miles</td>
		<td ><center>500 cft.</td>
	</tr>
	<tr>
		<td ><center>10</td>
		<td ><center>25 tons</td>
		<td ><center>2 hours</td>
		<td ><center>4 miles</td>
		<td ><center>1,000 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>11</td>
		<td ><center>50 tons</td>
		<td ><center>4 hours</td>
		<td ><center>8 miles</td>
		<td ><center>2,000 cft.</td>
	</tr>
	<tr>
		<td ><center>12</td>
		<td ><center>100 tons</td>
		<td ><center>8 hours</td>
		<td ><center>16 miles</td>
		<td ><center>4,000 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>13</td>
		<td ><center>200 tons</td>
		<td ><center>16 hours</td>
		<td ><center>30 miles</td>
		<td ><center>8,000 cft.</td>
	</tr>
	<tr>
		<td ><center>14</td>
		<td ><center>400 tons</td>
		<td ><center>1 day</td>
		<td ><center>60 miles</td>
		<td ><center>16,000 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>15</td>
		<td ><center>800 tons</td>
		<td ><center>2 days</td>
		<td ><center>120 miles</td>
		<td ><center>32,000 cft.</td>
	</tr>
	<tr>
		<td ><center>16</td>
		<td ><center>1600 tons</td>
		<td ><center>4 days</td>
		<td ><center>250 miles</td>
		<td ><center>65,000 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>17</td>
		<td ><center>3.2 ktons</td>
		<td ><center>1 week</td>
		<td ><center>500 miles</td>
		<td ><center>125,000 cft.</td>
	</tr>
	<tr>
		<td ><center>18</td>
		<td ><center>6 ktons</td>
		<td ><center>2 weeks</td>
		<td ><center>1,000 miles</td>
		<td ><center>250,000 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>19</td>
		<td ><center>12 ktons</td>
		<td ><center>1 month</td>
		<td ><center>2,000 miles</td>
		<td ><center>500,000 cft.</td>
	</tr>
	<tr>
		<td ><center>20</td>
		<td ><center>25 ktons</td>
		<td ><center>2 months</td>
		<td ><center>4,000 miles</td>
		<td ><center>1 million cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>21</td>
		<td ><center>50 ktons</td>
		<td ><center>4 months</td>
		<td ><center>8,000 miles</td>
		<td ><center>2 million cft.</td>
	</tr>
	<tr>
		<td ><center>22</td>
		<td ><center>100 ktons</td>
		<td ><center>8 months</td>
		<td ><center>1,6000 miles</td>
		<td ><center>4 million cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>23</td>
		<td ><center>200 ktons</td>
		<td ><center>1.5 years</td>
		<td ><center>32,000 miles</td>
		<td ><center>8 million cft.</td>
	</tr>
	<tr>
		<td ><center>24</td>
		<td ><center>400 ktons</td>
		<td ><center>3 years</td>
		<td ><center>64,000 miles</td>
		<td ><center>15 million cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>25</td>
		<td ><center>800 ktons</td>
		<td ><center>6 years</td>
		<td ><center>125,000 miles</td>
		<td ><center>32 million cft.</td>
	</tr>
	<tr>
		<td ><center>26</td>
		<td ><center>1,600 ktons</td>
		<td ><center>12 years</td>
		<td ><center>250,000 miles</td>
		<td ><center>65 million cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>27</td>
		<td ><center>3,200 ktons</td>
		<td ><center>25 years</td>
		<td ><center>500,000 miles</td>
		<td ><center>125 million cft.</td>
	</tr>
	<tr>
		<td ><center>28</td>
		<td ><center>6,400 ktons</td>
		<td ><center>50 years</td>
		<td ><center>1 million miles</td>
		<td ><center>250 million cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>29</td>
		<td ><center>12,500 ktons</td>
		<td ><center>100 years</td>
		<td ><center>2 million miles</td>
		<td ><center>500 million cft.</td>
	</tr>
	<tr>
		<td ><center>30</td>
		<td ><center>25,000 ktons</td>
		<td ><center>200 years</td>
		<td ><center>4 million miles</td>
		<td ><center>1 billion cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>+1</td>
		<td ><center>x2</td>
		<td ><center>x2</td>
		<td ><center>x2</td>
		<td ><center>x2</td>
	</tr>
</table>

}]
[abort(0)]

!!
@@ @Size Rank Modifiers
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=z ; color=default ; playerEditable=false ; applyToSelected=false ; group=GM ; tooltip= ; minWidth= ; 
[dialog("Size Rank Modifiers","width=475; height=353; temporary=1; noframe=0; "): {

<table bgcolor="[r: table(PageColor,4)]">
	<tr bgcolor='[r: table(PageColor,2)]'>
		<td ><span style="color:white"><b><center>Size Rank</td>
		<td ><span style="color:white"><b><center>Height/Length</td>
		<td ><span style="color:white"><b><center>Active Defense</td>
		<td ><span style="color:white"><b><center>Stealth</td>
		<td ><span style="color:white"><b><center>Intimidation</td>
		<td ><span style="color:white"><b><center>STR</td>
		<td ><span style="color:white"><b><center>STA</td>
		<td ><span style="color:white"><b><center>Speed</td>
	</tr>
	<tr>
		<td colspan="8" style="background-color:'[r: table(PageColor,3)]'  ; margin:0px; padding:0px; height:0px"><img src='[r: tblImage("Icons",10,5)]' border="0"></img></td>
	</tr>
	<tr bgcolor="white">
		<td ><center>3</td>
		<td ><center>250 feet.</td>
		<td ><center>-10</td>
		<td ><center>-20</td>
		<td ><center>+10</td>
		<td ><center>+20</td>
		<td ><center>+20</td>
		<td ><center>+2</td>
	</tr>
	<tr>
		<td ><center>2</td>
		<td ><center>120 feet</td>
		<td ><center>-8</td>
		<td ><center>-16</td>
		<td ><center>+8</td>
		<td ><center>+16</td>
		<td ><center>+16</td>
		<td ><center>+2</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>1</td>
		<td ><center>60 feet</td>
		<td ><center>-6</td>
		<td ><center>-12</td>
		<td ><center>+6</td>
		<td ><center>+12</td>
		<td ><center>+12</td>
		<td ><center>+1</td>
	</tr>
	<tr>
		<td ><center>0</td>
		<td ><center>30 feet</td>
		<td ><center>-4</td>
		<td ><center>-8</td>
		<td ><center>+4</td>
		<td ><center>+8</td>
		<td ><center>+8</td>
		<td ><center>+1</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>-1</td>
		<td ><center>15 feet</td>
		<td ><center>-2</td>
		<td ><center>-4</td>
		<td ><center>+2</td>
		<td ><center>+4</td>
		<td ><center>+4</td>
		<td ><center>+0</td>
	</tr>
	<tr>		
		<td ><center>-2</td>
		<td ><center>6 feet</td>
		<td ><center>0</td>
		<td ><center>0</td>
		<td ><center>0</td>
		<td ><center>0</td>
		<td ><center>0</td>
		<td ><center>+0</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>-3</td>
		<td ><center>3 feet</td>
		<td ><center>+2</td>
		<td ><center>+4</td>
		<td ><center>-2</td>
		<td ><center>-1</td>
		<td ><center>0</td>
		<td ><center>+0</td>
	</tr>
	<tr>
		<td ><center>-4</td>
		<td ><center>1 feet</td>
		<td ><center>+4</td>
		<td ><center>+8</td>
		<td ><center>-4</td>
		<td ><center>-2</td>
		<td ><center>0</td>
		<td ><center>-1</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>-5</td>
		<td ><center>6 inches</td>
		<td ><center>+6</td>
		<td ><center>+12</td>
		<td ><center>-6</td>
		<td ><center>-3</td>
		<td ><center>0</td>
		<td ><center>-1</td>
	</tr>
	<tr>
		<td ><center>-6</td>
		<td ><center>3 inches</td>
		<td ><center>+8</td>
		<td ><center>+16</td>
		<td ><center>-8</td>
		<td ><center>-4</td>
		<td ><center>0</td>
		<td ><center>-2</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>-7</td>
		<td ><center>1 inches</td>
		<td ><center>+10</td>
		<td ><center>+20</td>
		<td ><center>-10</td>
		<td ><center>-5</td>
		<td ><center>0</td>
		<td ><center>-2</td>
	</tr>
</table>

}]
[abort(0)]

!!
@@ @StatesDisplayGM
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=GM ; tooltip= ; minWidth= ; 
[h:theList = getTokenStates(",","Basic Conditions")]
[h: theList=listSort(theList,"A")]
[r, foreach(item, theList, ""),code:{

<font color="black"><a href='[r:macroLinkText("StatesUpdate@this","none",item,"selected")]'><image src="[r: getStateImage(item, 35)]" border="0" alt="[r: item]"></image></a></font>

}]<br><hr>
[h:theList = getTokenStates(",","Combined Conditions")]
[h: theList=listSort(theList,"A")]
[r, foreach(item, theList, ""),code:{

<font color="black"><a href='[r:macroLinkText("StatesUpdate@this","none",item,"selected")]'><image src="[r: getStateImage(item, 35)]" border="0" alt="[r: item]"></image></a></font>

}]<br><hr>
<font color="black"><a href='[r:macroLinkText("StatesUpdate@this","none","Clear All","selected")]'>Clear All</a></font>&nbsp; 
<font color="black"><a href='[r:macroLinkText("StatesUpdate@this","none","Reset Bruises","selected")]'>Reset Bruises</a></font>&nbsp; 
<font color="black"><a href='[r:macroLinkText("SetHeroPointsUpdate@this","none","Reset Bruises","selected")]'>Set Hero Points</a></font>&nbsp; 
<font color="black"><a href='[r:macroLinkText("VsCheckDialogGM@this","GM","","none")]'>Vs. Check</a></font>

!!
@@ @TableLoad
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=GM ; tooltip= ; minWidth= ; 
[status=input(
"chart|Measurements Table,Size Rank Modifiers|Choose Table|RADIO|VALUE=STRING SPAN=TRUE"
)]

[h: abort(status)]

[r, macro(chart+"@this"):""]

!!
@@ @die100
@PROPS@ fontColor=black;autoExecute=true;fontSize=1.00em;sortBy=;color=default;playerEditable=false;applyToSelected=false;group=User-Defined Functions;tooltip=
[h,if(json.contains(macro.args,"rollTitle")):rollTitle = json.get(macro.args, "rollTitle");rollTitle = "2d10"]
[h,if(json.contains(macro.args,"targetNumber")):targetNumber = json.get(macro.args, "targetNumber");targetNumber = 0]
[h,if(json.contains(macro.args,"mods")):mods = json.get(macro.args, "mods");mods = 0]
[h,if(json.contains(macro.args,"rollerName")):rollerName = json.get(macro.args, "rollerName");rollerName = getPlayerName()]
[h,if(json.contains(macro.args,"teamWork")):teamWork = json.get(macro.args, "teamWork");teamWork = 0]
[h,if(json.contains(macro.args,"secondaryTargetNumber")):secondaryTargetNumber = json.get(macro.args, "secondaryTargetNumber");secondaryTargetNumber = 0]
[h,if(json.contains(macro.args,"useSpec")):useSpec = json.get(macro.args, "useSpec");useSpec = 0]
[h,if(json.contains(macro.args,"specName")):specName = json.get(macro.args, "specName");specName = ""]

[h,if(isNumber(mods)==0): mods = 0]
[h,if(isNumber(targetNumber)==0): targetNumber = 0]
[h,if(isNumber(secondaryTargetNumber)==0): secondaryTargetNumber = 0]
[h,if(targetNumber==0): targetNumber = secondaryTargetNumber]
[h,if(mods==0): modsText = ""; modsText = strformat(" + %d",mods)]
[h,if(number(teamWork)==0): teamWorkText = ""; teamWorkText = strformat(" + %d (with %d assisting)",number(teamWork)*10,number(teamWork))]
[h,if(useSpec==0): useSpecText = ""; useSpecText = strformat(" + 10 (with %s spec)",specName)]
[h,if(useSpec): specMod = 10; specMod = 0]

[h:dieRoll1=1d10-1]
[h:dieRoll2=1d10-1]
[h,if(dieRoll1 == 0 && dieRoll1 != dieRoll2): dieRoll = dieRoll2; dieRoll = number(concat(string(dieRoll1),string(dieRoll2)))]
[h,if(dieRoll1 == 0 && dieRoll1 == dieRoll2): dieRollText = "00"; dieRollText = string(dieRoll)]

[h,if(dieRoll1 == dieRoll2): result = "CRITICAL "; result = ""]
[h,if(dieRoll <= targetNumber + mods + specMod + number(teamWork)*10): result = strformat('<font color="green">%sSUCCESS</font>',result); result = strformat('<font color="red">%sFAILURE</font>',result)]
[h,if(dieRoll <= targetNumber + mods + specMod + number(teamWork)*10): margin = strformat('%sMargin of %s: <b>%d</b>.',if(dieRoll > 30,"<u>Excellent</u> ",""),"Success",dieRoll); margin = strformat('%sMargin of %s: <b>%d</b>.',if((dieRoll - (targetNumber + mods + specMod + number(teamWork)*10)) > 30,"<u>Severe</u> ",""),"Failure",dieRoll - (targetNumber + mods + specMod + number(teamWork)*10))]

<p><span bgcolor=#cccccc><b>{rollerName}</b> rolls a <i>{rollTitle}</i>.</span>
<br>The total rolled is <b>{dieRollText}</b>.
<br>The Target Number is <b>{targetNumber + mods + specMod + number(teamWork)*10}</b>.
<br>Result: <b>{result}</b>.
<br>{margin}
<br><small>{dieRollText} vs. {targetNumber}{modsText}{teamWorkText}{useSpecText}</small>.</p>

!!
@@ @UseMoxie
@PROPS@ fontColor=black;autoExecute=true;fontSize=1.00em;sortBy=;color=default;playerEditable=false;applyToSelected=false;group=User-Defined Functions;tooltip=
[h,if(MOX==0): input(".|You do not have any Moxie to spend!||LABEL|SPAN=TRUE")]
[h,if(MOX==0): abort(0)]

[h,if(json.contains(macro.args,"moxOption")):moxOption = json.get(macro.args, "moxOption");moxOption = ""]
[h,if(json.contains(macro.args,"rollerName")):rollerName = json.get(macro.args, "rollerName");rollerName = getPlayerName()]

[h,switch(moxOption):
  case "1": res = "<br>Result: Ignore all negative modifiers that apply to a test. The Moxie point must be spent before dice are rolled.";
  case "2": res = "<br>Result: Flip-flop a d100 roll result. For example, an 83 would become a 38.";
  case "3": res = "<br>Result: Upgrade a success, making it a critical success, as if you rolled doubles. You must succeed in the test before you spend the Moxie point.";
  case "4": res = "<br>Result: Ignore a critical failure, treating it as a regular failure instead.";
  case "5": res = "<br>Result: Go first in an Action Phase.";
  default: res = ""
]

[h:MOX = MOX - 1]
<p><span bgcolor=#cccccc><b>{rollerName}</b> spends a Moxie point.</span>
{res}
[h, macro("SheetLoad@this"):""]

!!
@@ @BurnRep
@PROPS@ fontColor=black;autoExecute=true;fontSize=1.00em;sortBy=;color=default;playerEditable=false;applyToSelected=false;group=User-Defined Functions;tooltip=
[h,if(json.contains(macro.args,"repName")):repName = json.get(macro.args, "repName");repName = ""]
[h,if(json.contains(macro.args,"repValue")):repValue = json.get(macro.args, "repValue");repValue = 0]
[h,if(repValue==0): input(".|You do not have any "+repName+" to burn!||LABEL|SPAN=TRUE")]
[h,if(repValue==0): abort(0)]
[h,if(json.contains(macro.args,"burnChoice")):burnChoice = json.get(macro.args, "burnChoice");burnChoice = ""]
[h,if(json.contains(macro.args,"choiceOneValue")):choiceOneValue = json.get(macro.args, "choiceOneValue");choiceOneValue = ""]
[h,if(json.contains(macro.args,"choiceTwoValue")):choiceTwoValue = json.get(macro.args, "choiceTwoValue");choiceTwoValue = ""]
[h,if(json.contains(macro.args,"networkName")):networkName = json.get(macro.args, "networkName");networkName = ""]
[h,if(json.contains(macro.args,"rollerName")):rollerName = json.get(macro.args, "rollerName");rollerName = getPlayerName()]
[h,if(burnChoice=="1"),code: 
  {
    [h,if(isNumber(choiceOneValue)==0),code:
      {
        [h: input(".|Invalid input for amount of Rep to burn!||LABEL|SPAN=TRUE")]
        [h: abort(0)]
      };{}
    ]
    [h,if(number(choiceOneValue) < 1),code:
      {
        [h: input(".|Invalid input for amount of Rep to burn!||LABEL|SPAN=TRUE")]
        [h: abort(0)]
      };{}
    ]
    [h,if(number(choiceOneValue) > repValue),code:
      {
        [h: input(".|Entered Rep value to burn is more than you have!||LABEL|SPAN=TRUE")]
        [h: abort(0)]
      };{}
    ]
    [h,if(number(choiceOneValue) > 30),code:
      {
        [h: input(".|Entered Rep value to burn is greater than 30!||LABEL|SPAN=TRUE")]
        [h: abort(0)]
      };{}
    ]
  };{}
]
[h,if(burnChoice=="2" && number(choiceTwoValue) > repValue),code: 
  {
    [h: input(".|Entered Rep value to burn is more than you have!||LABEL|SPAN=TRUE")]
    [h: abort(0)]
  };{}
]

[switch(burnChoice),code:
  case "1": 
  {
    [h:setProperty(repName,repValue - number(choiceOneValue))]
    [h,if(repName=="A-Rep"): repName = "@-Rep"]
    <p><span bgcolor=#cccccc><b>{rollerName}</b> burns {choiceOneValue} {repName} points ({repValue - number(choiceOneValue)} remaining).</span>
    <br>
    Result: Adds a +{choiceOneValue} bonus to a {networkName} roll.
  }; 
  case "2": 
  {
    [h,switch(choiceTwoValue):
      case "0": favorName = "Trivial";
      case "1": favorName = "Low";
      case "5": favorName = "Moderate";
      case "10": favorName = "High";
      case "20": favorName = "Scarce"
    ]
    [h:setProperty(repName,repValue - number(choiceTwoValue))]
    [h,if(repName=="A-Rep"): repName = "@-Rep"]
    <p><span bgcolor=#cccccc><b>{rollerName}</b> burns {choiceTwoValue} {repName} points ({repValue - number(choiceTwoValue)} remaining).</span>
    <br>
    Result: Gets a {favorName} Favor.
  }
]

[h, macro("SheetLoad@this"):""]

!!
@@ @UseFavor
@PROPS@ fontColor=black;autoExecute=true;fontSize=1.00em;sortBy=;color=default;playerEditable=false;applyToSelected=false;group=User-Defined Functions;tooltip=
[h,if(json.contains(macro.args,"repName")):repName = json.get(macro.args, "repName");repName = ""]
[h,if(json.contains(macro.args,"rollerName")):rollerName = json.get(macro.args, "rollerName");rollerName = getPlayerName()]
[h,if(json.contains(macro.args,"repFavors")):repFavors = json.get(macro.args, "repFavors");repFavors = ""]

[h:allFavors = json.append("[]","1 (Trivial)","2 (Low)","3 (Moderate)","4 (High)","5 (Scarce)")]
[h:spendFavors = json.sort(json.difference(allFavors,repFavors))]
[h:choice = input(
      strformat(".|Used Favors: %s||LABEL|SPAN=TRUE ",if(json.length(repFavors)>0,json.toList(repFavors,", "),"None")),
      "pick|Use Favor,Regain Favor|Choose Option|RADIO",
      strformat("spendChoice|%s|Favor to Spend|LIST|SELECT=0 VALUE=STRING",if(json.length(spendFavors)>0,json.toList(spendFavors),"None")),
      strformat("regainChoice|%s|Favor to Regain|LIST|SELECT=0 VALUE=STRING",if(json.length(repFavors)>0,json.toList(repFavors),"None"))
)]
[h:abort(choice)]

[h,switch(pick),code:
  case 0:
  {
    [h,if(spendChoice=="None"): updateFavors = "[]"; updateFavors = json.sort(json.append(repFavors,spendChoice))]
    [h,if(json.length(updateFavors)>0): setProperty(repName+"_favors",updateFavors)]
    [h,if(repName=="A-Rep"): repName = "@-Rep"]
    [h,if(spendChoice=="None"): outStr = "";outStr = strformat("spends a Favor (<b>%s</b>)",spendChoice)]
  };
  case 1:
  {
    [h,if(regainChoice=="None"): updateFavors = "[]"; updateFavors = json.sort(json.difference(repFavors,regainChoice))]
    [h,if(regainChoice!="None"): setProperty(repName+"_favors",updateFavors)]
    [h,if(repName=="A-Rep"): repName = "@-Rep"]
    [h,if(regainChoice=="None"): outStr = "";outStr = strformat("regains a Favor (<b>%s</b>)",regainChoice)]
  }
]
[h,if(length(outStr)==0): abort(0)]
[h, macro("SheetLoad@this"):""]

<p><span bgcolor=#cccccc><b>{rollerName}</b> {outStr} for {repName}.</span><br>
Result: Has (<b>{json.toList(json.sort(json.difference(allFavors,updateFavors)),"</b>, <b>")}</b>) Favors remaining for {repName}.

!!
@@ @KnowSpecUpdate
@PROPS@ fontColor=black;autoExecute=true;fontSize=1.00em;sortBy=;color=default;playerEditable=false;applyToSelected=false;group=User-Defined Functions;tooltip=
[h,if(json.contains(macro.args,"specName")):specName = json.get(macro.args, "specName");specName = ""]
[h,if(json.contains(macro.args,"knowName")):knowName = json.get(macro.args, "knowName");knowName = ""]

[h: status = input(
  ".|<html><b>"+knowName+"</b>|Knowledge Skill|LABEL",
  "spec|"+specName+"|Specialization"
)]
[h: abort(status)]
[h,if(spec == "0"): abort(0)]

[h: knowArray = json.get(KnowledgeSkills, knowName)]
[h: knowArray = json.set(knowArray, 4, spec)]
[h: KnowledgeSkills = json.set(KnowledgeSkills, knowName, knowArray)]

[h, macro("SheetLoad@this"):""]

!!
@@ @ActiveSpecUpdate
@PROPS@ fontColor=black;autoExecute=true;fontSize=1.00em;sortBy=;color=default;playerEditable=false;applyToSelected=false;group=User-Defined Functions;tooltip=
[h,if(json.contains(macro.args,"specName")):specName = json.get(macro.args, "specName");specName = ""]
[h,if(json.contains(macro.args,"activeName")):activeName = json.get(macro.args, "activeName");activeName = ""]

[h: status = input(
  ".|<html><b>"+activeName+"</b>|Active Skill|LABEL",
  "spec|"+specName+"|Specialization"
)]
[h: abort(status)]
[h,if(spec == "0"): abort(0)]

[h: activeArray = json.get(ActiveSkills, activeName)]
[h: activeArray = json.set(activeArray, 4, spec)]
[h: ActiveSkills = json.set(ActiveSkills, activeName, activeArray)]

[h, macro("SheetLoad@this"):""]

!!