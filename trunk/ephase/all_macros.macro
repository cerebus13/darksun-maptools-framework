@@ @Acrobatics
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=1 ; color=default ; playerEditable=false ; applyToSelected=true ; group=Skills ; tooltip= ; minWidth= ; 
[if(Acrobatics=="No"),CODE:{
You are unable to test using <b>Acrobatics</b>
}; {
[h:Da=1d20]
[h:Mod=Roll_Modifiers]
[h:roll=Da+Acrobatics+Mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls <i>1d20 + Acrobatics</i>.</b></span><br>The total rolled is <b>{roll}</b>.<br> <small>({da}) d20 + {Acrobatics} + {Mod}</small>.
}]

!!
@@ @Athletics
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=1 ; color=default ; playerEditable=true ; applyToSelected=false ; group=Skills ; tooltip= ; minWidth= ; 
[h:Da=1d20]
[h:Mod=Roll_Modifiers]
[h:roll=Da+Athletics+Mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls <i>1d20 + Athletics</i>.</b></span><br>The total rolled is <b>{roll}</b>.<br> <small>({da}) d20 + {Athletics} + {Mod}</small>.

!!
@@ @BuildSkills
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=red ; playerEditable=true ; applyToSelected=false ; group=Skills ; tooltip= ; minWidth= ; 
[h,if(Acrobatics==0),CODE:{[h:Acrobaticsa='No']}; {[h:Acrobaticsa=Acrobatics]}]
[h,if(Investigation==0),CODE:{[h:Investigationa='No']}; {[h:Investigationa=Investigation]}]
[h,if(SleightofHand==0),CODE:{[h:SleightofHanda='No']}; {[h:SleightofHanda=SleightofHand]}]
[h,if(Technology==0),CODE:{[h:Technologya='No']}; {[h:Technologya=Technology]}]
[h,if(Treatment==0),CODE:{[h:Treatmenta='No']}; {[h:Treatmenta=Treatment]}]
[h,if(Vehicles==0),CODE:{[h:Vehiclesa='No']}; {[h:Vehiclesa=Vehicles]}]

[h:status=input(
"Acroa|"+Acrobaticsa+"|Edit Acrobatics total",
"Athla|"+Athletics+"|Edit Athletics total",
"Decea|"+Deception+"|Edit Deception total",
"Insia|"+Insight+"|Edit Insight total",
"Intia|"+Intimidation+"|Edit Intimidation total",
"Invea|"+Investigationa+"|Edit Investigation total",
"Perca|"+Perception+"|Edit Perception total",
"Persa|"+Persuasion+"|Edit Persuasion total",
"Sleia|"+SleightofHanda+"|Edit Sleight of Hand total",
"Steaa|"+Stealth+"|Edit Stealth total",
"Techa|"+Technologya+"|Edit Technology total",
"Treaa|"+Treatmenta+"|Edit Treatment total",
"Vehia|"+Vehiclesa+"|Edit Vehicles total",
"SPACE|:-----Name and Ranks-----:|:-----Expertise Skills-----|LABEL",

"E1Namea|"+E1Name+"|Enter Expertise skill name",
"E1a|"+E1+"|Edit Expertise total",

"E2Namea|"+E2Name+"|Enter Expertise skill name",
"E2a|"+E2+"|Edit Expertise total",

"E3Namea|"+E3Name+"|Enter Expertise skill name",
"E3a|"+E3+"|Edit Expertise total",

"E4Namea|"+E4Name+"|Enter Expertise skill name",
"E4a|"+E4+"|Edit Expertise total",

"E5Namea|"+E5Name+"|Enter Expertise skill name",
"E5a|"+E5+"|Edit Expertise total"

)]

[h:abort(status)]

[h: Acrobatics =Acroa]
[h: Athletics =Athla]
[h: Deception =Decea]
[h: Insight =Insia]
[h: Intimidation =Intia]
[h: Investigation =Invea]
[h: Perception =Perca]
[h: Persuasion =Persa]
[h: SleightofHand =Sleia]
[h: Stealth =Steaa]
[h: Technology =Techa]
[h: Treatment =Treaa]
[h: Vehicles =Vehia]
[h,if(E1Namea=='Name'):E1Name =0; E1Name =E1Namea]
[h,if(E1a=='No'):E1a ='No Ranks'; E1 =E1a]

[h,if(E2Namea=='Name'):E2Name =0; E2Name =E2Namea]
[h,if(E2a=='No'):E2a ='No Ranks'; E2 =E2a]

[h,if(E3Namea=='Name'):E3Name =0; E3Name =E3Namea]
[h,if(E3a=='No Ranks'):E3a ='No'; E3 =E3a]

[h,if(E4Namea=='Name'):E4Name =0; E4Name =E4Namea]
[h,if(E4a=='No'):E4a ='No'; E4 =E4a]

[h,if(E5Namea=='Name'):E5Name =0; E5Name =E5Namea]
[h,if(E5a=='No'):E5a ='No'; E5 =E5a]

[macro('CharacterSheet@Lib:dcfiles'):'']

[abort(0)]

!!
@@ @Deception
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=1 ; color=default ; playerEditable=true ; applyToSelected=false ; group=Skills ; tooltip= ; minWidth= ; 
[h:Da=1d20]
[h:Mod=Roll_Modifiers]
[h:roll=Da+Deception+Mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls <i>1d20 + Deception</i>.</b></span><br>The total rolled is <b>{roll}</b>.<br> <small>({da}) d20 + {Deception} + {Mod}</small>.

!!
@@ @E1Name
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=true ; applyToSelected=false ; group=Skills ; tooltip= ; minWidth= ; 
[h:Da=1d20]
[h:Mod=Roll_Modifiers]
[h:roll=Da+E1+Mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls <i>1d20 + {E1Name}</i>.</b></span><br>The total rolled is <b>{roll}</b>.<br> <small>({da}) d20 + {E1} + {Mod}</small>.

!!
@@ @E2Name
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=true ; applyToSelected=false ; group=Skills ; tooltip= ; minWidth= ; 
[h:Da=1d20]
[h:Mod=Roll_Modifiers]
[h:roll=Da+E2+Mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls <i>1d20 + {E2Name}</i>.</b></span><br>The total rolled is <b>{roll}</b>.<br> <small>({da}) d20 + {E2} + {Mod}</small>.

!!
@@ @E3Name
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=true ; applyToSelected=false ; group=Skills ; tooltip= ; minWidth= ; 
[h:Da=1d20]
[h:Mod=Roll_Modifiers]
[h:roll=Da+E3+Mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls <i>1d20 + {E3Name}</i>.</b></span><br>The total rolled is <b>{roll}</b>.<br> <small>({da}) d20 + {E3} + {Mod}</small>.

!!
@@ @E4Name
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=true ; applyToSelected=false ; group=Skills ; tooltip= ; minWidth= ; 
[h:Da=1d20]
[h:Mod=Roll_Modifiers]
[h:roll=Da+E4+Mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls <i>1d20 + {E4Name}</i>.</b></span><br>The total rolled is <b>{roll}</b>.<br> <small>({da}) d20 + {E4} + {Mod}</small>.

!!
@@ @E5Name
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=true ; applyToSelected=false ; group=Skills ; tooltip= ; minWidth= ; 
[h:Da=1d20]
[h:Mod=Roll_Modifiers]
[h:roll=Da+E5+Mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls <i>1d20 + {E5Name}</i>.</b></span><br>The total rolled is <b>{roll}</b>.<br> <small>({da}) d20 + {E5} + {Mod}</small>.

!!
@@ @Insight
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=1 ; color=default ; playerEditable=true ; applyToSelected=false ; group=Skills ; tooltip= ; minWidth= ; 
[h:Da=1d20]
[h:Mod=Roll_Modifiers]
[h:roll=Da+Insight+Mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls <i>1d20 + Insight</i>.</b></span><br>The total rolled is <b>{roll}</b>.<br> <small>({da}) d20 + {Insight} + {Mod}</small>.

!!
@@ @Intimidation
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=1 ; color=default ; playerEditable=true ; applyToSelected=false ; group=Skills ; tooltip= ; minWidth= ; 
[h:Da=1d20]
[h:Mod=Roll_Modifiers]
[h:roll=Da+Intimidation+Mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls <i>1d20 + Intimidation</i>.</b></span><br>The total rolled is <b>{roll}</b>.<br> <small>({da}) d20 + {Intimidation} + {Mod}</small>.

!!
@@ @Investigation
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=1 ; color=default ; playerEditable=true ; applyToSelected=false ; group=Skills ; tooltip= ; minWidth= ; 
[if(Investigation=="No"),CODE:{
You are unable to test using <b>Investigation</b>
}; {
[h:Da=1d20]
[h:Mod=Roll_Modifiers]
[h:roll=Da+Investigation+Mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls <i>1d20 + Investigation</i>.</b></span><br>The total rolled is <b>{roll}</b>.<br> <small>({da}) d20 + {Investigation} + {Mod}</small>.
}]

!!
@@ @Perception
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=1 ; color=default ; playerEditable=true ; applyToSelected=false ; group=Skills ; tooltip= ; minWidth= ; 
[h:Da=1d20]
[h:Mod=Roll_Modifiers]
[h:roll=Da+Perception+Mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls <i>1d20 + Perception</i>.</b></span><br>The total rolled is <b>{roll}</b>.<br> <small>({da}) d20 + {Perception} + {Mod}</small>.

!!
@@ @Persuasion
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=1 ; color=default ; playerEditable=true ; applyToSelected=false ; group=Skills ; tooltip= ; minWidth= ; 
[h:Da=1d20]
[h:Mod=Roll_Modifiers]
[h:roll=Da+Persuasion+Mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls <i>1d20 + Persuasion</i>.</b></span><br>The total rolled is <b>{roll}</b>.<br> <small>({da}) d20 + {Persuasion} + {Mod}</small>.

!!
@@ @SleightofHand
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=1 ; color=default ; playerEditable=true ; applyToSelected=false ; group=Skills ; tooltip= ; minWidth= ; 
[if(SleightofHand=="No"),CODE:{
You are unable to test using <b>Sleight of hand</b>
}; {
[h:Da=1d20]
[h:Mod=Roll_Modifiers]
[h:roll=Da+SleightofHand+Mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls <i>1d20 + Sleight of Hand</i>.</b></span><br>The total rolled is <b>{roll}</b>.<br> <small>({da}) d20 + {SleightofHand} + {Mod}</small>.
}]

!!
@@ @Stealth
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=1 ; color=default ; playerEditable=true ; applyToSelected=false ; group=Skills ; tooltip= ; minWidth= ; 
[h:Da=1d20]
[h:Mod=Roll_Modifiers]
[h:roll=Da+Stealth+Mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls <i>1d20 + Stealth</i>.</b></span><br>The total rolled is <b>{roll}</b>.<br> <small>({da}) d20 + {Stealth} + {Mod}</small>.

!!
@@ @Technology
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=1 ; color=default ; playerEditable=true ; applyToSelected=false ; group=Skills ; tooltip= ; minWidth= ; 
[if(Technology=="No"),CODE:{
You are unable to test using <b>Technology</b>
}; {
[h:Da=1d20]
[h:Mod=Roll_Modifiers]
[h:roll=Da+Technology+Mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls <i>1d20 + Technology</i>.</b></span><br>The total rolled is <b>{roll}</b>.<br> <small>({da}) d20 + {Technology} + {Mod}</small>.
}]

!!
@@ @Treatment
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=1 ; color=default ; playerEditable=true ; applyToSelected=false ; group=Skills ; tooltip= ; minWidth= ; 
[if(Treatment=="No"),CODE:{
You are unable to test using <b>Treatment</b>
}; {
[h:Da=1d20]
[h:Mod=Roll_Modifiers]
[h:roll=Da+Treatment+Mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls <i>1d20 + Treatment</i>.</b></span><br>The total rolled is <b>{roll}</b>.<br> <small>({da}) d20 + {Treatment} + {Mod}</small>.
}]

!!
@@ @Vehicles
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=1 ; color=default ; playerEditable=true ; applyToSelected=false ; group=Skills ; tooltip= ; minWidth= ; 
[if(Vehicles=="No"),CODE:{
You are unable to test using <b>Vehicles</b>
}; {
[h:Da=1d20]
[h:Mod=Roll_Modifiers]
[h:roll=Da+Vehicles+Mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls <i>1d20 + Vehicles</i>.</b></span><br>The total rolled is <b>{roll}</b>.<br> <small>({da}) d20 + {Vehicles} + {Mod}</small>.
}]

!!
@@ @Advance_Initiative
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Initiative ; tooltip= ; minWidth= ; 
[h:abort(isGM())]

[h:INITO=getInitiativeToken()]

[h:setHalo('None',INITO)]

[h:nextInitiative()]

[h:INITN=getInitiativeToken()]

[h:setHalo('#009999',INITN)]

!!
@@ @End_Initiative
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Initiative ; tooltip= ; minWidth= ; 
[h:abort(isGM())]
[h:ask=input(
"clearyn|Yes, No|Clear Initiative?|RADIO|SELECT=1 VALUE=STRING")]

[h,if(clearyn=="Yes"),CODE:{
[h:INITO=getInitiativeToken()]
[h:setHalo('None',INITO)]
[h: removeAllFromInitiative()]
; 
''
}]

!!
@@ @Start_Initiative
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Initiative ; tooltip= ; minWidth= ; 
[h:abort(isGM())]
[h:sortInitiative()]

[h:nextInitiative()]

[h:INITN=getInitiativeToken()]

[h:setHalo('#009999',INITN)]

!!
@@ @Agility
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=3 ; color=default ; playerEditable=false ; applyToSelected=false ; group=Attributes ; tooltip= ; minWidth= ; 
[h:Da=1d20]
[h:Mod=Roll_Modifiers]
[h:roll=Da+Agility+Mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls <i>1d20 + Agility</i>.</b></span><br>The total rolled is <b>{roll}</b>.<br> <small>({da}) d20 + {Agility} + {Mod}</small>.

!!
@@ @Awareness
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=7 ; color=default ; playerEditable=false ; applyToSelected=false ; group=Attributes ; tooltip= ; minWidth= ; 
[h:Da=1d20]
[h:Mod=Roll_Modifiers]
[h:roll=Da+Awareness+Mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls <i>1d20 + Awareness</i>.</b></span><br>The total rolled is <b>{roll}</b>.<br> <small>({da}) d20 + {Awareness} + {Mod}</small>.

!!
@@ @BuildAttributes
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=red ; playerEditable=false ; applyToSelected=false ; group=Attributes ; tooltip= ; minWidth= ; 
[h:status=input(
"STRa|"+Strength+"|Edit Strength",
"STAa|"+Stamina+"|Edit Stamina",
"AGIa|"+Agility+"|Edit Agility",
"DEXa|"+Dexterity+"|Edit Dexterity",
"FTGa|"+Fighting+"|Edit Fighting",
"INTa|"+Intellect+"|Edit Intellect",
"AWRa|"+Awareness+"|Edit Awareness",
"PREa|"+Presence+"|Edit Presence"
)]
[h:abort(status)]

[h: Strength =STRa]
[h: Stamina=STAa]
[h: Agility=AGIa]
[h: Dexterity=DEXa]
[h: Fighting=FTGa]
[h: Intellect=INTa]
[h: Awareness=AWRa]
[h: Presence=PREa]

[macro('CharacterSheet@Lib:dcfiles'):'']

[abort(0)]

!!
@@ @Dexterity
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=4 ; color=default ; playerEditable=false ; applyToSelected=false ; group=Attributes ; tooltip= ; minWidth= ; 
[h:Da=1d20]
[h:Mod=Roll_Modifiers]
[h:roll=Da+Dexterity+Mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls <i>1d20 + Dexterity</i>.</b></span><br>The total rolled is <b>{roll}</b>.<br> <small>({da}) d20 + {Dexterity} + {Mod}</small>.

!!
@@ @Fighting
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=5 ; color=default ; playerEditable=false ; applyToSelected=false ; group=Attributes ; tooltip= ; minWidth= ; 
[h:Da=1d20]
[h:Mod=Roll_Modifiers]
[h:roll=Da+Fighting+Mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls <i>1d20 + Fighting</i>.</b></span><br>The total rolled is <b>{roll}</b>.<br> <small>({da}) d20 + {Fighting} + {Mod}</small>.

!!
@@ @HeroPoints
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=999 ; color=red ; playerEditable=false ; applyToSelected=false ; group=Attributes ; tooltip= ; minWidth= ; 
[h:stuff=input(
"Hitsa|"+HeroPoints+"|Set Value for Hero Points|TEXT")]
[h:abort(stuff)]
[h:HeroPoints=abs(Hitsa)]

[macro('CharacterSheet@Lib:dcfiles'):'']

!!
@@ @Hits
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=999 ; color=red ; playerEditable=false ; applyToSelected=false ; group=Attributes ; tooltip= ; minWidth= ; 
[h:stuff=input(
"Hitsa|"+Hits+"|Set Value for Hits|TEXT")]
[h:abort(stuff)]
[h:Hits=abs(Hitsa)]

[macro('CharacterSheet@Lib:dcfiles'):'']

!!
@@ @Intellect
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=6 ; color=default ; playerEditable=false ; applyToSelected=false ; group=Attributes ; tooltip= ; minWidth= ; 
[h:Da=1d20]
[h:Mod=Roll_Modifiers]
[h:roll=Da+Intellect+Mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls <i>1d20 + Intellect</i>.</b></span><br>The total rolled is <b>{roll}</b>.<br> <small>({da}) d20 + {Intellect} + {Mod}</small>.

!!
@@ @Presence
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=10 ; color=default ; playerEditable=false ; applyToSelected=false ; group=Attributes ; tooltip= ; minWidth= ; 
[h:Da=1d20]
[h:Mod=Roll_Modifiers]
[h:roll=Da+Presence+Mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls <i>1d20 + Presence</i>.</b></span><br>The total rolled is <b>{roll}</b>.<br> <small>({da}) d20 + {Presence} + {Mod}</small>.

!!
@@ @Stamina
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=2 ; color=default ; playerEditable=false ; applyToSelected=false ; group=Attributes ; tooltip= ; minWidth= ; 
[h:Da=1d20]
[h:Mod=Roll_Modifiers]
[h:roll=Da+Stamina+Mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls <i>1d20 + Stamina</i>.</b></span><br>The total rolled is <b>{roll}</b>.<br> <small>({da}) d20 + {Stamina} + {Mod}</small>.

!!
@@ @Strength
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=1 ; color=default ; playerEditable=false ; applyToSelected=false ; group=Attributes ; tooltip= ; minWidth= ; 
[h:Da=1d20]
[h:Mod=Roll_Modifiers]
[h:roll=Da+Strength+Mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls <i>1d20 + Strength</i>.</b></span><br>The total rolled is <b>{roll}</b>.<br> <small>({da}) d20 + {Strength} + {Mod}</small>.

!!
@@ @AreaDamage
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=true ; applyToSelected=false ; group=Resistances ; tooltip= ; minWidth= ; 
[h:Da=1d20]

[h:status=input(
"Dc|#|Effect Rank?|TEXT"
)]
[h:abort(status)]
[h:resulta=-1*((Da+Dodge)-(Dc+10))]
[h: margina=table("Margin",resulta)]
[h,switch(margina),code:
case 0: {
[h:result="Half Effect!"]
}; 
case 1: {
[h:result="Full Effect!"]
}; 
case 2: {
[h:result="Full Effect!"]
}; 
case 3: {
[h:result="Full Effect!"]
}; 
case 4: {
[h:result="Full Effect!"]
}]
<b>DODGE RESISTANCE</b><br>
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls {Da+Dodge} vs.  {10 + Dc}</span><br><small>{Da} (d20) + {Dodge}  against {Dc} + 10</small><br>
[r:result]

[h:Db=1d20]

[h,if(result=="Full Effect!"),CODE:{
[h:resultb=-1*(((Db+Toughness)-Hits)-(Dc+15))]
}; {
[h:resultb=-1*(((Db+Toughness)-Hits)-(round(0.5*Dc)+15)))]
}]
[h,if(result=="Full Effect!"):Dc1=Dc; Dc1=round(0.5*Dc)]

[h: marginb=table("Margin",resultb)]
[h,switch(marginb),code:
case 0: {
[h:resultd="No damage taken!"]
}; 
case 1: {
[h:oldHits=getProperty('Hits')]
[h:newHits=oldHits+1]
[h:ID = getSelected()]
[h:setProperty('Hits', newHits,ID)]
[h:resultd="-1 penalty to further <b>Toughness</b> resistances...<br>(will become "+-1*Hits+")"]
}; 
case 2: {
[h:oldHits=getProperty('Hits')]
[h:newHits=oldHits+1]
[h:ID = getSelected()]
[h:setProperty('Hits', newHits,ID)]
[h:resultd="-1 penalty to further <b>Toughness</b> resistances...<br>(will become "+-1*Hits+")<br>You are <b>Dazed</b> until the end of your Next turn."]
[h:setState("Dazed",1)]
}; 
case 3: {
[h:oldHits=getProperty('Hits')]
[h:newHits=oldHits+1]
[h:ID = getSelected()]
[h:setProperty('Hits', newHits,ID)]
[h:resultd="-1 penalty to further <b>Toughness</b> resistances...<br>(will become "+-1*Hits+")<br>You are <b>Staggered</b> until you <i>Recover</i>.<br>If <b>Staggered</b> again, you are <i>Incapacitated</i>."]

[if(getState("Staggered")): setState("Incapacitated",1); setState("Staggered",1)]
[if(getState("Incapacitated")): setState("Staggered",0)]
[h:setState("Dazed",1)]
[h:setState("Hindered",1)]
}; 
case 4: {
[h:oldHits=getProperty('Hits')]
[h:newHits=oldHits+1]
[h:ID = getSelected()]
[h:setProperty('Hits', newHits,ID)]
[h:resultd="You are <b>Incapacitated</b> until you <i>Recover</i>."]
[h:setState("Staggered",0)]
[h:setState("Dazed",0)]
[h:setState("Hindered",0)]
[h:setState("Unaware",1)]
[h:setState("Stunned",1)]
[h:setState("Defenseless",1)]
[h: setState("Incapacitated",1)]
}]<br>=======================<br>
<b>TOUGHNESS RESISTANCE</b><br>
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls {Db+Toughness-if(Hits-1<0,0,Hits-1)} vs.  {15 + Dc1}</span><br><small>{Db} (d20) + {Toughness} - {if(Hits-1<0,0,Hits-1)} against {Dc1} + 15</small><br>
[r:resultd]

<br>

!!
@@ @BuildDefenses
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=red ; playerEditable=true ; applyToSelected=false ; group=Resistances ; tooltip= ; minWidth= ; 
[h:status=input(
"DODa|"+Dodge+"|Edit Dodge",
"PARa|"+Parry+"|Edit Parry",
"FRTa|"+Fortitude+"|Edit Fortitude",
"TNSa|"+Toughness+"|Edit Toughness",
"WILa|"+Will+"|Edit Will",
"INIa|"+Initiative+"|Edit Initiative"
)]

[h:abort(status)]

[h: Dodge=DODa]
[h: Parry=PARa]
[h: Fortitude=FRTa]
[h: Toughness=TNSa]
[h: Will=WILa]
[h:Initiative=INIa]

[macro('CharacterSheet@Lib:dcfiles'):'']

[abort(0)]

!!
@@ @Dodge
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=5 ; color=default ; playerEditable=false ; applyToSelected=false ; group=Resistances ; tooltip= ; minWidth= ; 
[h:Da=1d20]

[h:status=input(
"Dc|#|Effect Rank?|TEXT"
)]
[h:abort(status)]
[h:resulta=-1*((Da+Dodge)-(Dc+10))]
[h: margina=table("Margin",resulta)]
[h,switch(margina),code:

case 0: {
[h:result="No Effect!"]
}; 
case 1: {
[h:result="Failure (<b>1</b> degree)"]
}; 
case 2: {
[h:result="Failure (<b>2</b> degrees)"]
}; 
case 3: {
[h:result="Failure (<b>3</b> degrees)"]
}; 
case 4: {
[h:result="Failure (<b>3</b> degrees)"]
}]
<b>DODGE RESISTANCE</b><br>
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls {Da+Dodge} vs.  {10 + Dc}</span><br><small>{Da} (d20) + {Dodge}  against {Dc} + 10</small><br>
[r:result]
[macro('CharacterSheet@Lib:dcfiles'):'']

!!
@@ @Fortitude
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=2 ; color=default ; playerEditable=false ; applyToSelected=false ; group=Resistances ; tooltip= ; minWidth= ; 
[h:Da=1d20]

[h:status=input(
"Dc|#|Effect Rank?|TEXT"
)]
[h:abort(status)]
[h:resulta=-1*((Da+Fortitude)-(Dc+10))]
[h: margina=table("Margin",resulta)]
[h,switch(margina),code:
case 0: {
[h:result="No Effect!"]
}; 
case 1: {
[h:result="Failure (<b>1</b> degree)"]
}; 
case 2: {
[h:result="Failure (<b>2</b> degrees)"]
}; 
case 3: {
[h:result="Failure (<b>3</b> degrees)"]
}; 
case 4: {
[h:result="Failure (<b>3</b> degrees)"]
}]
<b>FORTITUDE RESISTANCE</b><br>
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls {Da+Fortitude} vs.  {10 + Dc}</span><br><small>{Da} (d20) + {Fortitude}  against {Dc} + 10</small><br>
[r:result]

[macro('CharacterSheet@Lib:dcfiles'):'']

!!
@@ @Parry
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=0 ; color=default ; playerEditable=false ; applyToSelected=false ; group=Resistances ; tooltip= ; minWidth= ; 
[h:Da=1d20]

[h:status=input(
"Dc|#|Effect Rank?|TEXT"
)]
[h:abort(status)]
[h:resulta=-1*((Da+Parry)-(Dc+10))]
[h: margina=table("Margin",resulta)]
[h,switch(margina),code:
case 0: {
[h:result="No Effect!"]
}; 
case 1: {
[h:result="Failure (<b>1</b> degree)"]
}; 
case 2: {
[h:result="Failure (<b>2</b> degrees)"]
}; 
case 3: {
[h:result="Failure (<b>3</b> degrees)"]
}; 
case 4: {
[h:result="Failure (<b>3</b> degrees)"]
}]

<b>PARRY RESISTANCE</b><br>
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls {Da+Parry} vs.  {10 + Dc}</span><br><small>{Da} (d20) + {Parry}  against {Dc} + 10</small><br>
[r:result]

[macro('CharacterSheet@Lib:dcfiles'):'']

!!
@@ @Toughness
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=1 ; color=default ; playerEditable=false ; applyToSelected=false ; group=Resistances ; tooltip= ; minWidth= ; 
[h:Da=1d20]

[h:status=input(
"Dc|#|Damage Rank?|TEXT"
)]
[h:abort(status)]
[h:resulta=-1*(((Da+Toughness)-Hits)-(Dc+15))]
[h: margina=table("Margin",resulta)]
[h,switch(margina),code:
case 0: {
[h:result="No damage taken!"]
}; 
case 1: {
[h:oldHits=getProperty('Hits')]
[h:newHits=oldHits+1]
[h:ID = getSelected()]
[h:setProperty('Hits', newHits,ID)]
[h:result="-1 penalty to further <b>Toughness</b> resistances...<br>(will become "+-1*Hits+")"]
}; 
case 2: {
[h:oldHits=getProperty('Hits')]
[h:newHits=oldHits+1]
[h:ID = getSelected()]
[h:setProperty('Hits', newHits,ID)]
[h:result="-1 penalty to further <b>Toughness</b> resistances...<br>(will become "+-1*Hits+")<br>You are <b>Dazed</b> until the end of your Next turn."]
[h:setState("Dazed",1)]
}; 
case 3: {
[h:oldHits=getProperty('Hits')]
[h:newHits=oldHits+1]
[h:ID = getSelected()]
[h:setProperty('Hits', newHits,ID)]
[h:result="-1 penalty to further <b>Toughness</b> resistances...<br>(will become "+-1*Hits+")<br>You are <b>Staggered</b> until you <i>Recover</i>.<br>If <b>Staggered</b> again, you are <i>Incapacitated</i>."]

[if(getState("Staggered")): setState("Incapacitated",1); setState("Staggered",1)]
[if(getState("Incapacitated")): setState("Staggered",0)]
[h:setState("Dazed",1)]
[h:setState("Hindered",1)]
}; 
case 4: {
[h:oldHits=getProperty('Hits')]
[h:newHits=oldHits+1]
[h:ID = getSelected()]
[h:setProperty('Hits', newHits,ID)]
[h:result="You are <b>Incapacitated</b> until you <i>Recover</i>."]
[h:setState("Staggered",0)]
[h:setState("Dazed",0)]
[h:setState("Hindered",0)]
[h:setState("Unaware",1)]
[h:setState("Stunned",1)]
[h:setState("Defenseless",1)]
[h: setState("Incapacitated",1)]
}]
<b>TOUGHNESS RESISTANCE</b><br>
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls {Da+Toughness-if(Hits-1<0,0,Hits-1)} vs.  {15 + Dc}</span><br><small>{Da} (d20) + {Toughness} - {if(Hits-1<0,0,Hits-1)} against {Dc} + 15</small><br>
[r:result]
[macro('CharacterSheet@Lib:dcfiles'):'']

!!
@@ @Will
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=3 ; color=default ; playerEditable=false ; applyToSelected=false ; group=Resistances ; tooltip= ; minWidth= ; 
[h:Da=1d20]

[h:status=input(
"Dc|#|Effect Rank?|TEXT"
)]
[h:abort(status)]
[h:resulta=-1*((Da+Will)-(Dc+10))]
[h: margina=table("Margin",resulta)]
[h,switch(margina),code:
case 0: {
[h:result="No Effect!"]
}; 
case 1: {
[h:result="Failure (<b>1</b> degree)"]
}; 
case 2: {
[h:result="Failure (<b>2</b> degrees)"]
}; 
case 3: {
[h:result="Failure (<b>3</b> degrees)"]
}; 
case 4: {
[h:result="Failure (<b>3</b> degrees)"]
}]
<b>WILL RESISTANCE</b><br>
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls {Da+Will} vs.  {10 + Dc}</span><br><small>{Da} (d20) + {Will}  against {Dc} + 10</small><br>
[r:result][macro('CharacterSheet@Lib:dcfiles'):'']

!!
@@ @Asleep
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=1 ; color=default ; playerEditable=false ; applyToSelected=false ; group=States Combined ; tooltip= ; minWidth= ; 
/self

[if(getState("Asleep")): setState("Defenseless",0); setState("Defenseless",1)]
[if(getState("Asleep")): setState("Stunned",0); setState("Stunned",1)]
[if(getState("Asleep")): setState("Unaware",0); setState("Unaware",1)]
[if(getState("Asleep")): setState("Asleep",0); setState("Asleep",1)]

[macro('CharacterSheet@Lib:dcfiles'):'']
 [abort(0)] <!-- Suppress output text -->

!!
@@ @Blind
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=2 ; color=default ; playerEditable=false ; applyToSelected=false ; group=States Combined ; tooltip= ; minWidth= ; 
/self

[if(getState("Blind")): setState("Hindered",0); setState("Hindered",1)]
[if(getState("Blind")): setState("Unaware",0); setState("Unaware",1)]
[if(getState("Blind")): setState("Vulnerable",0); setState("Vulnerable",1)]
[if(getState("Blind")): setState("Blind",0); setState("Blind",1)]

[macro('CharacterSheet@Lib:dcfiles'):'']
 [abort(0)] <!-- Suppress output text -->

!!
@@ @Bound
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=2 ; color=default ; playerEditable=true ; applyToSelected=false ; group=States Combined ; tooltip= ; minWidth= ; 
/self

[if(getState("Bound")): setState("Immobile",0); setState("Immobile",1)]
[if(getState("Bound")): setState("Impaired",0); setState("Impaired",1)]
[if(getState("Bound")): setState("Defenseless",0); setState("Defenseless",1)]
[if(getState("Bound")): setState("Bound",0); setState("Bound",1)]

 
[macro('CharacterSheet@Lib:dcfiles'):'']
[abort(0)] <!-- Suppress output text -->

!!
@@ @Deaf
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=3 ; color=default ; playerEditable=true ; applyToSelected=false ; group=States Combined ; tooltip= ; minWidth= ; 
/self

[if(getState("Deaf")): setState("Deaf",0); setState("Deaf",1)]

[macro('CharacterSheet@Lib:dcfiles'):'']
 [abort(0)] <!-- Suppress output text -->

!!
@@ @Dying
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=4 ; color=default ; playerEditable=true ; applyToSelected=false ; group=States Combined ; tooltip= ; minWidth= ; 
/self

[if(getState("Dying")): setState("Defenseless",0); setState("Defenseless",1)]
[if(getState("Dying")): setState("Stunned",0); setState("Stunned",1)]
[if(getState("Dying")): setState("Unaware",0); setState("Unaware",1)]
[if(getState("Dying")): setState("Dying",0); setState("Dying",1)]

[macro('CharacterSheet@Lib:dcfiles'):'']
 [abort(0)] <!-- Suppress output text -->

!!
@@ @Entranced
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=5 ; color=default ; playerEditable=false ; applyToSelected=false ; group=States Combined ; tooltip= ; minWidth= ; 
/self

[if(getState("Entranced")): setState("Stunned",0); setState("Stunned",1)]
[if(getState("Entranced")): setState("Entranced",0); setState("Entranced",1)]

[macro('CharacterSheet@Lib:dcfiles'):'']
 [abort(0)] <!-- Suppress output text -->

!!
@@ @Exhausted
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=6 ; color=default ; playerEditable=false ; applyToSelected=false ; group=States Combined ; tooltip= ; minWidth= ; 
/self

[if(getState("Exhausted")): setState("Impared",0); setState("Impared",1)]
[if(getState("Exhausted")): setState("Hindered",0); setState("Hindered",1)]
[if(getState("Exhausted")): setState("Exhausted",0); setState("Exhausted",1)]

[macro('CharacterSheet@Lib:dcfiles'):'']
 [abort(0)] <!-- Suppress output text -->

!!
@@ @Incapacitated
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=7 ; color=default ; playerEditable=false ; applyToSelected=false ; group=States Combined ; tooltip= ; minWidth= ; 
/self

[if(getState("Incapacitated")): setState("Unaware",0); setState("Unaware",1)]
[if(getState("Incapacitated")): setState("Stunned",0); setState("Stunned",1)]
[if(getState("Incapacitated")): setState("Defenseless",0); setState("Defenseless",1)]
[if(getState("Incapacitated")): setState("Incapacitated",0); setState("Incapacitated",1)]

[macro('CharacterSheet@Lib:dcfiles'):'']
 [abort(0)] <!-- Suppress output text -->

!!
@@ @Paralyzed
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=8 ; color=default ; playerEditable=false ; applyToSelected=false ; group=States Combined ; tooltip= ; minWidth= ; 
/self

[if(getState("Paralyzed")): setState("Immobile",0); setState("Immobile",1)]
[if(getState("Paralyzed")): setState("Stunned",0); setState("Stunned",1)]
[if(getState("Paralyzed")): setState("Defenseless",0); setState("Defenseless",1)]
[if(getState("Paralyzed")): setState("Paralyzed",0); setState("Paralyzed",1)]

 
[macro('CharacterSheet@Lib:dcfiles'):'']
[abort(0)] <!-- Suppress output text -->

!!
@@ @Prone
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=8 ; color=default ; playerEditable=false ; applyToSelected=false ; group=States Combined ; tooltip= ; minWidth= ; 
/self

[if(getState("Hindered")): setState("Hindered",0); setState("Hindered",1)]
[if(getState("Prone")): setState("Prone",0); setState("Prone",1)]
 
[macro('CharacterSheet@Lib:dcfiles'):'']
[abort(0)] <!-- Suppress output text -->

!!
@@ @Restrained
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=9 ; color=default ; playerEditable=false ; applyToSelected=false ; group=States Combined ; tooltip= ; minWidth= ; 
/self

[if(getState("Restrained")): setState("Vulnerable",0); setState("Vulnerable",1)]
[if(getState("Restrained")): setState("Hindered",0); setState("Hindered",1)]
[if(getState("Restrained")): setState("Restrained",0); setState("Restrained",1)]
[macro('CharacterSheet@Lib:dcfiles'):'']
[abort(0)] <!-- Suppress output text -->

!!
@@ @Staggered
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=10 ; color=default ; playerEditable=false ; applyToSelected=false ; group=States Combined ; tooltip= ; minWidth= ; 
/self

[if(getState("Staggered")): setState("Dazed",0); setState("Dazed",1)]
[if(getState("Staggered")): setState("Hindered",0); setState("Hindered",1)]
[if(getState("Staggered")): setState("Staggered",0); setState("Staggered",1)]
 
[macro('CharacterSheet@Lib:dcfiles'):'']
[abort(0)] <!-- Suppress output text -->

!!
@@ @Surprised
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=11 ; color=default ; playerEditable=false ; applyToSelected=false ; group=States Combined ; tooltip= ; minWidth= ; 
/self

[if(getState("Surprised")): setState("Vulnerable",0); setState("Vulnerable",1)]
[if(getState("Surprised")): setState("Stunned",0); setState("Stunned",1)]
[if(getState("Surprised")): setState("Surprised",0); setState("Surprised",1)]

[macro('CharacterSheet@Lib:dcfiles'):'']
[abort(0)] <!-- Suppress output text -->

!!
@@ @BuildInitiative
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=red ; playerEditable=true ; applyToSelected=false ; group=Generic ; tooltip= ; minWidth= ; 
[h: Initiative =Set_Initiative]
[macro('CharacterSheet@Lib:dcfiles'):'']
[abort(0)]

!!
@@ @CharacterSheet
@PROPS@ fontColor=blue ; autoExecute=true ; fontSize=1.00em ; sortBy=1 ; color=white ; playerEditable=false ; applyToSelected=true ; group=Generic ; tooltip= ; minWidth= ; 
[h,if( isFrameVisible("CharacterSheet") ), code: {}; { [resetFrame("CharacterSheet")] } ]
[frame("CharacterSheet"): {

<title>DC Character Sheet</title>
<table bgcolor="#CCE8F2">

<tr  background="asset://8b1c6e24556bbf4a1b93f6ca490ed1d9" STYLE="background-repeat: no-repeat" bgcolor='#D32A2C'>
<td colspan="6" style="padding-top:1px; padding-bottom:1px" >
<span style="color:white">
<font size="3">
<b><span style="color:white">[r:macrolink(token.name,'Notes@Lib:dcfiles','all','','selected')] |
[r:macroLink('<font size="2">Refresh','CharacterSheet@Lib:dcfiles','all','','selected')]
</td>
<td style="padding-top:1px; padding-bottom:1px" >
<b>
<font size="2"><span style="color:white">
[r:macroLink('PL','PowerPoints@Lib:dcfiles','all','','selected')]
: <span style="color:white"> {PL} | {PowerPoints}
</span>
</td>
</tr>

<tr>
<td colspan="7" style="background-color:black  ; margin:0px; padding:0px; height:0px"><HR width="100%" height="1%" align="center" noshade></td>
</tr>

 
	<tr background="asset://737bfa88b1a6718186d9faacd5b0d70c" STYLE="background-repeat: no-repeat" bgcolor='#CDE2F5'>
	<td style="padding-top:1px; padding-bottom:1px"><font size="3"><b><span style="color:black">[r:macroLink('<b>Attributes</b>','BuildAttributes@Lib:dcfiles','all','','selected')]
</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="3"><center><span style="color:black"><b>Value</td>
		<<td style="padding-top:1px; padding-bottom:1px"><font size="3"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="3"><b><span style="color:black">[r:macroLink('<b>Defenses</b>','BuildDefenses@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="3"><center><span style="color:black"><b>Value</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="3"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="3"><span style="color:black"><b>Misc</td>
	</tr>

	<tr  bgcolor="white">
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink('Strength','Strength@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Strength}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink('Dodge','Dodge@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Dodge}<span style="color:gray"> | {Dodge+10}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink('d20 + Mod','d20@Lib:dcfiles','all','','selected')]</td>
	</tr>
	<tr>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink('Stamina','Stamina@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Stamina}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink('Parry','Parry@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Parry}<span style="color:gray"> | {Parry+10}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink('Area Damage','AreaDamage@Lib:dcfiles','all','','selected')]</td>
	</tr>
	<tr bgcolor="white">
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink('Agiltity','Agiltity@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Agility}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink('Fortitude','Fortitude@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Fortitude}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td ><font size="2"><span style= "color:#1E90FF">[r:macroLink('Measurement','MeasurementsTable@Lib:dcfiles','all','','selected')]</td>
	</tr>
	<tr>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink('Dexterity','Dexterity@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Dexterity}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink('Toughness','Toughness@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Toughness}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink('Materials','MaterialTable@Lib:dcfiles','all','','selected')]</td>
	</tr>
	<tr bgcolor="white">
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink('Fighting','Fighting@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Fighting}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink('Will','Will@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Will}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<tdstyle="padding-top:1px; padding-bottom:1px"></td>
	</tr>
	<tr>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink('Intellect','Intellect@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Intellect}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink('Hits','Hits@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Hits*-1}</td>
	<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
	<td style="padding-top:1px; padding-bottom:1px"><font size="2"><a href="http://dc.wikia.com/wiki/Main_Page">DC Wiki</a></td>
	</tr>
	<tr bgcolor="white">
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink('Awareness','Awareness@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Awareness}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink('Initiative','Initiative@Lib:dcfiles','all','','selected')] </td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Initiative}</td>
	<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
	<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF"><a href="http://www.karridian.net/dcatlas.html">DC Atlas</a></td>
		
	</tr>
	<tr>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink('Presence','Presence@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Presence}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink('Hero Pt','HeroPoints@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{HeroPoints}</td>
	<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
	<td style="padding-top:1px; padding-bottom:1px"><font size="2"><a href ="https://sites.google.com/site/dcuniversegame/">Game Site</a></td>

	</tr>

<tr>
<td colspan="7" cellspacing="0px" cellpadding="0px" style="background-color:black ; margin:0px; padding:0px; height:0px"><HR  width="100%" align="center" noshade></td>
</tr>

		<tr background="asset://737bfa88b1a6718186d9faacd5b0d70c" STYLE="background-repeat: no-repeat" bgcolor='#CDE2F5'>

		<td style="padding-top:1px; padding-bottom:1px"><font size="3"><b><span style="color:black">[r:macroLink('<b>Skills</b>','BuildSkills@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="3"><span style="color:black"><center><b>Value</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="3"></td>
		<td colspan="5" td style="padding-top:1px; padding-bottom:1px"><font size="3"><span style="color:black">[r:macroLink('<b>Powers and Effects</b>','Power_Maker@Lib:dcfiles','all','','selected')]   </td>
		</tr>

	<tr bgcolor="white">
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink('Acrobatics','Acrobatics@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Acrobatics}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r,if(Power1=='0'):''; macroLink('[x]','XPower1@lib:dcfiles','all','','selected')] [r,if(Power1=='0'):''; macroLink(Power1,Power1+'@token','all','','selected')]</td>
	</tr>
	<tr>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink('Athletics','Athletics@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Athletics}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2">[r,if(Power2=='0'):''; macroLink('[x]','XPower2@lib:dcfiles','all','','selected')] [r,if(Power2=='0'):''; macroLink(Power2,Power2+'@token','all','','selected')]</td>
	</tr>
	<tr bgcolor="white">
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink('Deception','Deception@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Deception}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r,if(Power3=='0'):''; macroLink('[x]','XPower3@lib:dcfiles','all','','selected')] [r,if(Power3=='0'):''; macroLink(Power3,Power3+'@token','all','','selected')]</td>
	</tr>
	<tr>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink('Insight','Insight@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Insight}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2">[r,if(Power4=='0'):''; macroLink('[x]','XPower4@lib:dcfiles','all','','selected')] [r,if(Power4=='0'):''; macroLink(Power4,Power4+'@token','all','','selected')]</td>
	</tr>
	<tr bgcolor="white">
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink('Intimidation','Intimidation@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Intimidation}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r,if(Power5=='0'):''; macroLink('[x]','XPower5@lib:dcfiles','all','','selected')] [r,if(Power5=='0'):''; macroLink(Power5,Power5+'@token','all','','selected')]</td>
	</tr>
	<tr>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink('Investigation','Investigation@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Investigation}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2">[r,if(Power6=='0'):''; macroLink('[x]','XPower6@lib:dcfiles','all','','selected')] [r,if(Power6=='0'):''; macroLink(Power6,Power6+'@token','all','','selected')]</td>
	</tr>
	<tr bgcolor="white">
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink('Perception','Perception@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Perception}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r,if(Power7=='0'):''; macroLink('[x]','XPower7@lib:dcfiles','all','','selected')] [r,if(Power7=='0'):''; macroLink(Power7,Power7+'@token','all','','selected')]</td>
	</tr>
	<tr>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink('Persuasion','Persuasion@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Persuasion}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2">[r,if(Power8=='0'):''; macroLink('[x]','XPower8@lib:dcfiles','all','','selected')] [r,if(Power8=='0'):''; macroLink(Power8,Power8+'@token','all','','selected')]</td>
	</tr>
	<tr bgcolor="white">
		<td style="padding-top:1px; padding-bottom:1px"><font size="1"><span style= "color:#1E90FF">[r:macroLink('Sleight of Hand','SleightofHand@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{SleightofHand}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r,if(Power9=='0'):''; macroLink('[x]','XPower9@lib:dcfiles','all','','selected')] [r,if(Power9=='0'):''; macroLink(Power9,Power9+'@token','all','','selected')]</td>
	</tr>
	<tr>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink('Stealth','Stealth@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Stealth}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2">[r,if(Power10=='0'):''; macroLink('[x]','XPower10@lib:dcfiles','all','','selected')] [r,if(Power10=='0'):''; macroLink(Power10,Power10+'@token','all','','selected')]</td>
	</tr>
	<tr bgcolor="white">
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink('Technology','Technology@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Technology}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r,if(Power11=='0'):''; macroLink('[x]','XPower11@lib:dcfiles','all','','selected')] [r,if(Power11=='0'):''; macroLink(Power11,Power11+'@token','all','','selected')]</td>
	</tr>
	<tr>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink('Treatment','Treatment@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Treatment}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2">[r,if(Power12=='0'):''; macroLink('[x]','XPower12@lib:dcfiles','all','','selected')] [r,if(Power12=='0'):''; macroLink(Power12,Power12+'@token','all','','selected')]</td>
	</tr>
	<tr bgcolor="white">
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink('Vehicles','Vehicles@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Vehicles}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r,if(Power13=='0'):''; macroLink('[x]','XPower13@lib:dcfiles','all','','selected')] [r,if(Power13=='0'):''; macroLink(Power13,Power13+'@token','all','','selected')]</td>
	</tr>
	<tr>
		<td style="padding-top:1px; padding-bottom:1px"><font size="1">[r,if(E1Name=='New Skill'),CODE:{}; {Expert: [r:macroLink(E1Name,'E1Name@lib:dcfiles','all','','selected')]}]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>[r,if(E1Name=='New Skill'):''; E1]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2">[r,if(Power14=='0'):''; macroLink('[x]','XPower14@lib:dcfiles','all','','selected')] [r,if(Power14=='0'):''; macroLink(Power14,Power14+'@token','all','','selected')]</td>
	</tr>
	<tr bgcolor="white">
		<td style="padding-top:1px; padding-bottom:1px"><font size="1"><span style= "color:#1E90FF">[r,if(E2Name=='New Skill'),CODE:{}; {Expert: [r:macroLink(E2Name,'E2Name@lib:dcfiles','all','','selected')]}]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>[r,if(E2Name=='New Skill'):''; E2]<</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r,if(Power15=='0'):''; macroLink('[x]','XPower15@lib:dcfiles','all','','selected')] [r,if(Power15=='0'):''; macroLink(Power15,Power15+'@token','all','','selected')]</td>
	</tr>
	<tr>
		<td style="padding-top:1px; padding-bottom:1px"><font size="1">[r,if(E3Name=='New Skill'),CODE:{}; {Expert: [r:macroLink(E3Name,'E3Name@lib:dcfiles','all','','selected')]}]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>[r,if(E3Name=='New Skill'):''; E3]<</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2">[r,if(Power16=='0'):''; macroLink('[x]','XPower16@lib:dcfiles','all','','selected')] [r,if(Power16=='0'):''; macroLink(Power16,Power16+'@token','all','','selected')]</td>
	</tr>
	<tr bgcolor="white">
		<td style="padding-top:1px; padding-bottom:1px"><font size="1"><span style= "color:#1E90FF">[r,if(E4Name=='New Skill'),CODE:{}; {Expert: [r:macroLink(E4Name,'E4Name@lib:dcfiles','all','','selected')]}]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>[r,if(E4Name=='New Skill'):''; E4]<</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r,if(Power17=='0'):''; macroLink('[x]','XPower17@lib:dcfiles','all','','selected')] [r,if(Power17=='0'):''; macroLink(Power17,Power17+'@token','all','','selected')]</td>
	</tr>
	<tr>
		<td style="padding-top:1px; padding-bottom:1px"><font size="1">[r,if(E5Name=='New Skill'),CODE:{}; {Expert: [r:macroLink(E5Name,'E5Name@lib:dcfiles','all','','selected')]}]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>[r,if(E5Name=='New Skill'):''; E5]<</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2">[r,if(Power18=='0'):''; macroLink('[x]','XPower18@lib:dcfiles','all','','selected')] [r,if(Power18=='0'):''; macroLink(Power18,Power18+'@token','all','','selected')]</td>
</tr>

<tr>
<td colspan="7" cellspacing="0px" cellpadding="0px" style="background-color:black ; margin:0px; padding:0px; height:0px"><HR  width="100%" align="center" noshade></td>
</tr>
<tr background="asset://737bfa88b1a6718186d9faacd5b0d70c" STYLE="background-repeat: no-repeat" width="100%" bgcolor='#CDE2F5'>
	
<td colspan="6" style="padding-top:1px; padding-bottom:1px">
	
	<font size="3"><span style="color:black">
	
	[r:macroLink('<b>Conditions</b>','ConditionsTable@Lib:dcfiles','all','','selected')]</font>
	</td>
	<td style="padding-top:1px; padding-bottom:1px"><span style="color:black; font-size:8">		[r:macroLink('<b>Clear All</b>','CLEAR_ALL@Lib:dcfiles','all','','selected')]
	</span>
	</td>
</tr>

<tr>
<td colspan="7" style="padding-top:1px; padding-bottom:1px" bgcolor='white'><font size="2"><font size="2"><span style="color:#E6F1FA">
{if(getState("Compelled"), '<span style="color:#D2262B"><b>'+macroLink('Compelled','Compelled@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Compelled','Compelled@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Controlled"), '<span style="color:#D2262B"><b>'+macroLink('Controlled','Controlled@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Controlled','Controlled@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Dazed"), '<span style="color:#D2262B"><b>'+macroLink('Dazed','Dazed@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Dazed','Dazed@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Debilitated"), '<span style="color:#D2262B"><b>'+macroLink('Debilitated','Debilitated@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Debilitated','Debilitated@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Defenseless"), '<span style="color:#D2262B"><b>'+macroLink('Defenseless','Defenseless@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Defenseless','Defenseless@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Disabled"), '<span style="color:#D2262B"><b>'+macroLink('Disabled','Disabled@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Disabled','Disabled@Lib:dcfiles','all','','selected')+'</span>')}

{if(getState("Fatigued"), '<span style="color:#D2262B"><b>'+macroLink('Fatigued','Fatigued@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Fatigued','Fatigued@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Hindered"), '<span style="color:#D2262B"><b>'+macroLink('Hindered','Hindered@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Hindered','Hindered@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Immobile"), '<span style="color:#D2262B"><b>'+macroLink('Immobile','Immobile@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Immobile','Immobile@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Impaired"), '<span style="color:#D2262B"><b>'+macroLink('Impaired','Impaired@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Impaired','Impaired@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Stunned"), '<span style="color:#D2262B"><b>'+macroLink('Stunned','Stunned@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Stunned','Stunned@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Transformed"), '<span style="color:#D2262B"><b>'+macroLink('Transformed','Transformed@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Transformed','Transformed@Lib:dcfiles','all','','selected')+'</span>')}

{if(getState("Unaware"), '<span style="color:#D2262B"><b>'+macroLink('Unaware','Unaware@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Unaware','Unaware@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Vulnerable"), '<span style="color:#D2262B"><b>'+macroLink('Vulnerable','Vulnerable@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Vulnerable','Vulnerable@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Weakened"), '<span style="color:#D2262B"><b>'+macroLink('Weakened','Weakened@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Weakened','Weakened@Lib:dcfiles','all','','selected')+'</span>')}
</td>
</tr>

<tr>
<td colspan="7" style="padding-top:1px; padding-bottom:1px; background-color:white"><hr></td>
</tr>

<tr>
<td colspan="7" style="padding-top:1px; padding-bottom:6px"><font size="2"><span style="color:white">
{if(getState("Asleep"), '<span style="color:#D2262B"><b>'+macroLink('Asleep','Asleep@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Asleep','Asleep@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Blind"), '<span style="color:#D2262B"><b>'+macroLink('Blind','Blind@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Blind','Blind@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Bound"), '<span style="color:#D2262B"><b>'+macroLink('Bound','Bound@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Bound','Bound@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Deaf"), '<span style="color:#D2262B"><b>'+macroLink('Deaf','Deaf@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Deaf','Deaf@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Dying"), '<span style="color:#D2262B"><b>'+macroLink('Dying','Dying@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Dying','Dying@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Entranced"), '<span style="color:#D2262B"><b>'+macroLink('Entranced','Entranced@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Entranced','Entranced@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Exhausted"), '<span style="color:#D2262B"><b>'+macroLink('Exhausted','Exhausted@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Exhausted','Exhausted@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Incapacitated"), '<span style="color:#D2262B"><b>'+macroLink('Incapacitated','Incapacitated@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Incapacitated','Incapacitated@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Paralyzed"), '<span style="color:#D2262B"><b>'+macroLink('Paralyzed','Paralyzed@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Paralyzed','Paralyzed@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Prone"), '<span style="color:#D2262B"><b>'+macroLink('Prone','Prone@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Prone','Prone@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Restrained"), '<span style="color:#D2262B"><b>'+macroLink('Restrained','Restrained@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Restrained','Restrained@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Staggered"), '<span style="color:#D2262B"><b>'+macroLink('Staggered','Staggered@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Staggered','Staggered@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Surprised"), '<span style="color:#D2262B"><b>'+macroLink('Surprised','Surprised@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Surprised','Surprised@Lib:dcfiles','all','','selected')+'</span>')}

<tr background="
asset://8b1c6e24556bbf4a1b93f6ca490ed1d9" STYLE="background-repeat: no-repeat" bgcolor='#D32A2C'>
<td><span style="color:#D32A2D">.</td></tr>
<tr>
<td colspan="7" style="background-color:black  ; margin:0px; padding:0px; height:0px"><HR width="100%" height="1%" align="center" noshade></td>
</tr>

</table>

}]

!!
@@ @CharacterSheet-old
@PROPS@ fontColor=blue ; autoExecute=true ; fontSize=1.00em ; sortBy=1 ; color=white ; playerEditable=true ; applyToSelected=false ; group=Generic ; tooltip= ; minWidth= ; 
[frame("CharacterSheet"): {

<table >
<tr bgcolor="black" >
<td colspan="6"><span style="color:white"><font size="2"><b>{token.name}</span> <br>[r:macroLink('<span style="color:white"><b>Refresh</b></span>','CharacterSheet@Lib:dcfiles','all','','selected')]</td>
<td><span style="color:white"><b><font size="2">[r:macroLink('Total PP','PowerPoints@Lib:dcfiles','all','','selected')]: </b> <br>{PowerPoints}</span></td>
</tr>

	<tr  bgcolor="#696969">
		<td ><font size="2"><b><span style="color:#87CEFA">[r:macroLink('<b>Attributes</b>','BuildAttributes@Lib:dcfiles','all','','selected')]</td>
		<td ><font size="2"><b>Value</td>
		<td ><font size="2"></td>
		<td ><font size="2"><b><span style="color:#87CEFA">[r:macroLink('<b>Defenses</b>','BuildDefenses@Lib:dcfiles','all','','selected')]</td>
		<td ><font size="2"><b>Value</td>
		<td ><font size="2"></td>
		<td ><font size="2"><b>Misc</td>
	</tr>
	<tr  bgcolor="white">
		<td ><font size="2"><span style= "color:#1E90FF">[r:macroLink('Strength','Strength@Lib:dcfiles','all','','selected')]</td>
		<td ><font size="2"><center>{Strength}</td>
		<td ><font size="2"></td>
		<td ><font size="2"><span style= "color:#1E90FF">[r:macroLink('Dodge','Dodge@Lib:dcfiles','all','','selected')]</td>
		<td ><font size="2"><center>{Dodge}<span style="color:gray"> | {Dodge+10}</td>
		<td ><font size="2"></td>
		<td ><font size="2"><span style= "color:#1E90FF">[r:macroLink('d20 + Mod','d20@Lib:dcfiles','all','','selected')]</td>
	</tr>
	<tr>
		<td ><font size="2">[r:macroLink('Stamina','Stamina@Lib:dcfiles','all','','selected')]</td>
		<td ><font size="2"><center>{Stamina}</td>
		<td ><font size="2"></td>
		<td ><font size="2">[r:macroLink('Parry','Parry@Lib:dcfiles','all','','selected')]</td>
		<td ><font size="2"><center>{Parry}<span style="color:gray"> | {Parry+10}</td>
		<td><font size="2"></td>
		<td><font size="2">[r:macroLink('Area Damage','AreaDamage@Lib:dcfiles','all','','selected')]</td>
	</tr>
	<tr bgcolor="white">
		<td ><font size="2"><span style= "color:#1E90FF">[r:macroLink('Agiltity','Agiltity@Lib:dcfiles','all','','selected')]</td>
		<td ><font size="2"><center>{Agility}</td>
		<td ><font size="2"></td>
		<td ><font size="2"><span style= "color:#1E90FF">[r:macroLink('Fortitude','Fortitude@Lib:dcfiles','all','','selected')]</td>
		<td ><font size="2"><center>{Fortitude}</td>
		<td ><font size="2"></td>
		<td ><font size="2"><span style= "color:#1E90FF">[r:macroLink('Measurement','MeasurementsTable@Lib:dcfiles','all','','selected')]</td>
	</tr>
	<tr>
		<td ><font size="2">[r:macroLink('Dexterity','Dexterity@Lib:dcfiles','all','','selected')]</td>
		<td ><font size="2"><center>{Dexterity}</td>
		<td ><font size="2"></td>
		<td ><font size="2">[r:macroLink('Toughness','Toughness@Lib:dcfiles','all','','selected')]</td>
		<td ><font size="2"><center>{Toughness}</td>
		<td ><font size="2"></td>
		<td ><font size="2">[r:macroLink('Materials','MaterialTable@Lib:dcfiles','all','','selected')]</td>
	</tr>
	<tr bgcolor="white">
		<td ><font size="2"><span style= "color:#1E90FF">[r:macroLink('Fighting','Fighting@Lib:dcfiles','all','','selected')]</td>
		<td ><font size="2"><center>{Fighting}</td>
		<td ><font size="2"></td>
		<td ><font size="2"><span style= "color:#1E90FF">[r:macroLink('Will','Will@Lib:dcfiles','all','','selected')]</td>
		<td ><font size="2"><center>{Will}</td>
		<td ><font size="2"></td>
		<td><font size="2"><span style= "color:#1E90FF">[r:macroLink('Set Init.','BuildInitiative@Lib:dcfiles','all','','selected')]</td>
	</tr>
	<tr>
		<td ><font size="2">[r:macroLink('Intellect','Intellect@Lib:dcfiles','all','','selected')]</td>
		<td ><font size="2"><center>{Intellect}</td>
		<td ><font size="2"></td>
		<td ><font size="2">[r:macroLink('Hits','Hits@Lib:dcfiles','all','','selected')]</td>
		<td ><font size="2"><center>{Hits*-1}</td>
<td ><font size="2"></td>
<td ><font size="2">------<a href="http://dc.wikia.com/wiki/Main_Page">DC Wiki</a></td>
	</tr>
	<tr bgcolor="white">
		<td ><font size="2"><span style= "color:#1E90FF">[r:macroLink('Awareness','Awareness@Lib:dcfiles','all','','selected')]</td>
		<td ><font size="2"><center>{Awareness}</td>
		<td ><font size="2"></td>
		<td ><font size="2"><span style= "color:#1E90FF">[r:macroLink('Initiative','Initiative@Lib:dcfiles','all','','selected')]</td>
		<td ><font size="2"><center>{Initiative}</td>
<td ><font size="2"></td>
<td ><font size="2"><span style= "color:#1E90FF">------<a href="http://www.karridian.net/dcatlas.html">DC Atlas</a></td>
		
	</tr>
	<tr>
		<td ><font size="2">[r:macroLink('Presence','Presence@Lib:dcfiles','all','','selected')]</td>
		<td ><font size="2"><center>{Presence}</td>
		<td ><font size="2"></td>
		<td ><font size="2">[r:macroLink('Hero Pt','HeroPoints@Lib:dcfiles','all','','selected')]</td>
		<td ><font size="2"><center>{HeroPoints}</td>
<td ><font size="2"></td>
<td ><font size="2">----<a href="https://sites.google.com/site/dcuniversegame/">Game Site</a></td>

	</tr>

<tr bgcolor="black" height="8">
</tr>

	<tr  bgcolor="#696969">
		<td ><font size="2"><b><span style="color:#87CEFA">[r:macroLink('<b>Skills</b>','BuildSkills@Lib:dcfiles','all','','selected')]</td>
		<td ><font size="2"><b>Value</td>
		<td ><font size="2"></td>
		<td colspan="5"><font size="2"><span style="color:#87CEFA">[r:macroLink('<b>Powers and Effects</b>','Power_Maker@Lib:dcfiles','all','','selected')]</td>
	</tr>
	<tr bgcolor="white">
		<td ><font size="2"><span style= "color:#1E90FF">[r:macroLink('Acrobatics','Acrobatics@Lib:dcfiles','all','','selected')]</td>
		<td ><font size="2"><center>{Acrobatics}</td>
		<td ><font size="2"></td>
		<td colspan="5"><font size="2"><span style= "color:#1E90FF">[r:macroLink(Power1,Power1+'@token','all','','selected')]</td>
	</tr>
	<tr>
		<td ><font size="2">[r:macroLink('Athletics','Athletics@Lib:dcfiles','all','','selected')]</td>
		<td ><font size="2"><center>{Athletics}</td>
		<td ><font size="2"></td>
		<td colspan="5"><font size="2">[r:macroLink(Power2,Power2+'@token','all','','selected')]</td>
	</tr>
	<tr bgcolor="white">
		<td ><font size="2"><span style= "color:#1E90FF">[r:macroLink('Deception','Deception@Lib:dcfiles','all','','selected')]</td>
		<td ><font size="2"><center>{Deception}</td>
		<td ><font size="2"></td>
		<td colspan="5"><font size="2"><span style= "color:#1E90FF">[r:macroLink(Power3,Power3+'@token','all','','selected')]</td>
	</tr>
	<tr>
		<td ><font size="2">[r:macroLink('Insight','Insight@Lib:dcfiles','all','','selected')]</td>
		<td ><font size="2"><center>{Insight}</td>
		<td ><font size="2"></td>
		<td colspan="5"><font size="2">[r:macroLink(Power4,Power4+'@token','all','','selected')]</td>
	</tr>
	<tr bgcolor="white">
		<td ><font size="2"><span style= "color:#1E90FF">[r:macroLink('Intimidation','Intimidation@Lib:dcfiles','all','','selected')]</td>
		<td ><font size="2"><center>{Intimidation}</td>
		<td ><font size="2"></td>
		<td colspan="5"><font size="2"><span style= "color:#1E90FF">[r:macroLink(Power5,Power5+'@token','all','','selected')]</td>
	</tr>
	<tr>
		<td ><font size="2">[r:macroLink('Investigation','Investigation@Lib:dcfiles','all','','selected')]</td>
		<td ><font size="2"><center>{Investigation}</td>
		<td ><font size="2"></td>
		<td colspan="5"><font size="2">[r:macroLink(Power6,Power6+'@token','all','','selected')]</td>
	</tr>
	<tr bgcolor="white">
		<td ><font size="2"><span style= "color:#1E90FF">[r:macroLink('Perception','Perception@Lib:dcfiles','all','','selected')]</td>
		<td ><font size="2"><center>{Perception}</td>
		<td ><font size="2"></td>
		<td colspan="5"><font size="2"><span style= "color:#1E90FF">[r:macroLink(Power7,Power7+'@token','all','','selected')]</td>
	</tr>
	<tr>
		<td ><font size="2">[r:macroLink('Persuasion','Persuasion@Lib:dcfiles','all','','selected')]</td>
		<td ><font size="2"><center>{Persuasion}</td>
		<td ><font size="2"></td>
		<td colspan="5"><font size="2">[r:macroLink(Power8,Power8+'@token','all','','selected')]</td>
	</tr>
	<tr bgcolor="white">
		<td ><font size="2"><span style= "color:#1E90FF">[r:macroLink('Sleight of Hand','SleightofHand@Lib:dcfiles','all','','selected')]</td>
		<td ><font size="2"><center>{SleightofHand}</td>
		<td ><font size="2"></td>
		<td colspan="5"><font size="2"><span style= "color:#1E90FF">[r:macroLink(Power9,Power9+'@token','all','','selected')]</td>
	</tr>
	<tr>
		<td ><font size="2">[r:macroLink('Stealth','Stealth@Lib:dcfiles','all','','selected')]</td>
		<td ><font size="2"><center>{Stealth}</td>
		<td ><font size="2"></td>
		<td colspan="5"><font size="2">[r:macroLink(Power10,Power10+'@token','all','','selected')]</td>
	</tr>
	<tr bgcolor="white">
		<td ><font size="2"><span style= "color:#1E90FF">[r:macroLink('Technology','Technology@Lib:dcfiles','all','','selected')]</td>
		<td ><font size="2"><center>{Technology}</td>
		<td ><font size="2"></td>
		<td colspan="5"><font size="2"><span style= "color:#1E90FF">[r:macroLink(Power11,Power11+'@token','all','','selected')]</td>
	</tr>
	<tr>
		<td ><font size="2">[r:macroLink('Treatment','Treatment@Lib:dcfiles','all','','selected')]</td>
		<td ><font size="2"><center>{Treatment}</td>
		<td ><font size="2"></td>
		<td colspan="5"><font size="2">[r:macroLink(Power12,Power12+'@token','all','','selected')]</td>
	</tr>
	<tr bgcolor="white">
		<td ><font size="2"><span style= "color:#1E90FF">[r:macroLink('Vehicles','Vehicles@Lib:dcfiles','all','','selected')]</td>
		<td ><font size="2"><center>{Vehicles}</td>
		<td ><font size="2"></td>
		<td colspan="5"><font size="2"><span style= "color:#1E90FF">[r:macroLink(Power13,Power13+'@token','all','','selected')]</td>
	</tr>
	<tr>
		<td ><font size="2">[r,if(E1Name=='New Skill'),CODE:{}; {Expert: [r:macroLink(E1Name,'E1Name@token','all','','selected')]}]</td>
		<td ><font size="2"><center>[r,if(E1Name=='New Skill'):''; E1]</td>
		<td ><font size="2"></td>
		<td colspan="5"><font size="2">[r:macroLink(Power14,Power14+'@token','all','','selected')]</td>
	</tr>
	<tr bgcolor="white">
		<td ><font size="2"><span style= "color:#1E90FF">[r,if(E2Name=='New Skill'),CODE:{}; {Expert: [r:macroLink(E2Name,'E2Name@token','all','','selected')]}]</td>
		<td ><font size="2"><center>[r,if(E2Name=='New Skill'):''; E2]<</td>
		<td ><font size="2"></td>
		<td colspan="5"><font size="2"><span style= "color:#1E90FF">[r:macroLink(Power15,Power15+'@token','all','','selected')]</td>
	</tr>
	<tr>
		<td ><font size="2">[r,if(E3Name=='New Skill'),CODE:{}; {Expert: [r:macroLink(E3Name,'E3Name@token','all','','selected')]}]</td>
		<td ><font size="2"><center>[r,if(E3Name=='New Skill'):''; E3]<</td>
		<td ><font size="2"></td>
		<td colspan="5"><font size="2">[r:macroLink(Power16,Power16+'@token','all','','selected')]</td>
	</tr>
	<tr bgcolor="white">
		<td ><font size="2"><span style= "color:#1E90FF">[r,if(E4Name=='New Skill'),CODE:{}; {Expert: [r:macroLink(E4Name,'E4Name@token','all','','selected')]}]</td>
		<td ><font size="2"><center>[r,if(E4Name=='New Skill'):''; E4]<</td>
		<td ><font size="2"></td>
		<td colspan="5"><font size="2"><span style= "color:#1E90FF">[r:macroLink(Power17,Power17+'@token','all','','selected')]</td>
	</tr>
	<tr>
		<td ><font size="2">[r,if(E5Name=='New Skill'),CODE:{}; {Expert: [r:macroLink(E5Name,'E5Name@token','all','','selected')]}]</td>
		<td ><font size="2"><center>[r,if(E5Name=='New Skill'):''; E5]<</td>
		<td ><font size="2"></td>
		<td colspan="5"><font size="2">[r:macroLink(Power18,Power18+'@token','all','','selected')]</td></table><table>
	<tr bgcolor="black" height="8">
</tr>
	<table><tr  bgcolor="#696969" width="100%"><td colspan="6">
		<font size="2"><b><span style="color:#87CEFA">[r:macroLink('<b>Conditions Table</b>','ConditionsTable@Lib:dcfiles','all','','selected')]</td><td><font size="2"> <span style="color:#87CEFA">[r:macroLink('<b>CLEAR ALL</b>','CLEAR_ALL@Lib:dcfiles','all','','selected')]</span></td>
	</tr>

<tr>
<td colspan="7"><font size="2">
{if(getState("Compelled"), '<span style="color:red"><b>'+macroLink('Compelled  ','Compelled@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Compelled  ','Compelled@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Controlled"), '<span style="color:red"><b>'+macroLink('Controlled  ','Controlled@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Controlled  ','Controlled@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Dazed"), '<span style="color:red"><b>'+macroLink('Dazed  ','Dazed@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Dazed  ','Dazed@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Debilitated"), '<span style="color:red"><b>'+macroLink('Debilitated  ','Debilitated@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Debilitated  ','Debilitated@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Defenseless"), '<span style="color:red"><b>'+macroLink('Defenseless  ','Defenseless@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Defenseless  ','Defenseless@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Disabled"), '<span style="color:red"><b>'+macroLink('Disabled  ','Disabled@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Disabled  ','Disabled@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Fatigued"), '<span style="color:red"><b>'+macroLink('Fatigued  ','Fatigued@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Fatigued  ','Fatigued@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Hindered"), '<span style="color:red"><b>'+macroLink('Hindered  ','Hindered@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Hindered  ','Hindered@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Immobile"), '<span style="color:red"><b>'+macroLink('Immobile  ','Immobile@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Immobile  ','Immobile@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Impaired"), '<span style="color:red"><b>'+macroLink('Impaired  ','Impaired@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Impaired  ','Impaired@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Stunned"), '<span style="color:red"><b>'+macroLink('Stunned  ','Stunned@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Stunned  ','Stunned@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Transformed"), '<span style="color:red"><b>'+macroLink('Transformed  ','Transformed@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Transformed  ','Transformed@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Unaware"), '<span style="color:red"><b>'+macroLink('Unaware  ','Unaware@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Unaware  ','Unaware@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Vulnerable"), '<span style="color:red"><b>'+macroLink('Vulnerable  ','Vulnerable@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Vulnerable  ','Vulnerable@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Weakened"), '<span style="color:red"><b>'+macroLink('Weakened  ','Weakened@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Weakened  ','Weakened@Lib:dcfiles','all','','selected')+'</span>')}
<br><br>
{if(getState("Asleep"), '<span style="color:red"><b>'+macroLink('Asleep  ','Asleep@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Asleep  ','Asleep@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Blind"), '<span style="color:red"><b>'+macroLink('Blind  ','Blind@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Blind  ','Blind@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Bound"), '<span style="color:red"><b>'+macroLink('Bound  ','Bound@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Bound  ','Bound@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Deaf"), '<span style="color:red"><b>'+macroLink('Deaf  ','Deaf@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Deaf  ','Deaf@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Dying"), '<span style="color:red"><b>'+macroLink('Dying  ','Dying@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Dying  ','Dying@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Entranced"), '<span style="color:red"><b>'+macroLink('Entranced  ','Entranced@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Entranced  ','Entranced@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Exhausted"), '<span style="color:red"><b>'+macroLink('Exhausted  ','Exhausted@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Exhausted  ','Exhausted@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Incapacitated"), '<span style="color:red"><b>'+macroLink('Incapacitated  ','Incapacitated@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Incapacitated  ','Incapacitated@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Paralyzed"), '<span style="color:red"><b>'+macroLink('Paralyzed  ','Paralyzed@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Paralyzed  ','Paralyzed@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Prone"), '<span style="color:red"><b>'+macroLink('Prone  ','Prone@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Prone   ','Prone@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Restrained"), '<span style="color:red"><b>'+macroLink('Restrained  ','Restrained@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Restrained  ','Restrained@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Staggered"), '<span style="color:red"><b>'+macroLink('Staggered  ','Staggered@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Staggered  ','Staggered@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Surprised"), '<span style="color:red"><b>'+macroLink('Surprised','Surprised@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Surprised','Surprised@Lib:dcfiles','all','','selected')+'</span>')}
</td>
</tr>
</table>

}]

!!
@@ @CharacterSheet_mod2
@PROPS@ fontColor=blue ; autoExecute=true ; fontSize=1.00em ; sortBy=1 ; color=white ; playerEditable=true ; applyToSelected=false ; group=Generic ; tooltip= ; minWidth= ; 
[frame("CharacterSheet"): {

<table bgcolor="#CCE8F2">
<tr bgcolor="#22B3E4" >
<td colspan="6" style="padding-top:1px; padding-bottom:1px" ><span style="color:white"><font size="3"><b>{token.name} |</span> [r:macroLink('<span style="color:white"><font size="2">Refresh</span>','CharacterSheet@Lib:dcfiles','all','','selected')]</td>
<td style="padding-top:1px; padding-bottom:1px" ><span style="color:white"><b><font size="2">[r:macroLink('Total PP','PowerPoints@Lib:dcfiles','all','','selected')]: {PowerPoints}</span></td>
</tr>

<tr>
<td colspan="7" style="background-color:black  ; margin:0px; padding:0px; height:0px"><HR width="100%" align="center" noshade></td>
</tr>

	<tr  bgcolor="white">
		<td style="padding-top:1px; padding-bottom:1px"><font size="3"><b><span style="color:#22B3E4">[r:macroLink('<b>Attributes</b>','BuildAttributes@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="3"><center><b>Value</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="3"><b><span style="color:#22B3E4">[r:macroLink('<b>Defenses</b>','BuildDefenses@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="3"><center><b>Value</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="3"><center><b>Misc</td>
	</tr>

<tr>
<td colspan="7" cellspacing="0px" cellpadding="0px" style="background-color:black  ; margin:0px; padding:0px; height:0px"><HR width="100%" align="center" noshade></td>
</tr>

	<tr  bgcolor="white">
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink('Strength','Strength@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Strength}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink('Dodge','Dodge@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Dodge}<span style="color:gray"> | {Dodge+10}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink('d20 + Mod','d20@Lib:dcfiles','all','','selected')]</td>
	</tr>
	<tr>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink('Stamina','Stamina@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Stamina}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink('Parry','Parry@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Parry}<span style="color:gray"> | {Parry+10}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink('Area Damage','AreaDamage@Lib:dcfiles','all','','selected')]</td>
	</tr>
	<tr bgcolor="white">
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink('Agiltity','Agiltity@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Agility}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink('Fortitude','Fortitude@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Fortitude}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td ><font size="2"><span style= "color:#1E90FF">[r:macroLink('Measurement','MeasurementsTable@Lib:dcfiles','all','','selected')]</td>
	</tr>
	<tr>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink('Dexterity','Dexterity@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Dexterity}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink('Toughness','Toughness@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Toughness}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink('Materials','MaterialTable@Lib:dcfiles','all','','selected')]</td>
	</tr>
	<tr bgcolor="white">
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink('Fighting','Fighting@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Fighting}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink('Will','Will@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Will}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<tdstyle="padding-top:1px; padding-bottom:1px"></td>
	</tr>
	<tr>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink('Intellect','Intellect@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Intellect}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink('Hits','Hits@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Hits*-1}</td>
<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
<td style="padding-top:1px; padding-bottom:1px"><font size="2">------<a href="http://dc.wikia.com/wiki/Main_Page">DC Wiki</a></td>
	</tr>
	<tr bgcolor="white">
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink('Awareness','Awareness@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Awareness}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink('Initiative','Initiative@Lib:dcfiles','all','','selected')] [r:macroLink('[Set]','BuildInitiative@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Initiative}</td>
<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">------<a href="http://www.karridian.net/dcatlas.html">DC Atlas</a></td>
		
	</tr>
	<tr>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink('Presence','Presence@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Presence}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink('Hero Pt','HeroPoints@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{HeroPoints}</td>
<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
<td style="padding-top:1px; padding-bottom:1px"><font size="2">----<a href="https://sites.google.com/site/dcuniversegame/">Game Site</a></td>

	</tr>

<tr>
<td colspan="7" cellspacing="0px" cellpadding="0px" style="background-color:black  ; margin:0px; padding:0px; height:0px"><HR width="100%" align="center" noshade></td>
</tr>

	<tr  bgcolor="white">
		<td style="padding-top:1px; padding-bottom:1px"><font size="3"><b><span style="color:#22B3E4">[r:macroLink('<b>Skills</b>','BuildSkills@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="3"><b>Value</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="3"><span style="color:#22B3E4">[r:macroLink('<b>Powers and Effects</b>','Power_Maker@Lib:dcfiles','all','','selected')]</td>
	</tr>
<tr>
<td colspan="7" style="background-color:black  ; margin:0px; padding:0px; height:0px"><HR width="100%" align="center" noshade></td>
</tr>

	<tr bgcolor="white">
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink('Acrobatics','Acrobatics@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Acrobatics}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink(Power1,Power1+'@token','all','','selected')]</td>
	</tr>
	<tr>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink('Athletics','Athletics@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Athletics}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink(Power2,Power2+'@token','all','','selected')]</td>
	</tr>
	<tr bgcolor="white">
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink('Deception','Deception@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Deception}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink(Power3,Power3+'@token','all','','selected')]</td>
	</tr>
	<tr>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink('Insight','Insight@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Insight}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink(Power4,Power4+'@token','all','','selected')]</td>
	</tr>
	<tr bgcolor="white">
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink('Intimidation','Intimidation@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Intimidation}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink(Power5,Power5+'@token','all','','selected')]</td>
	</tr>
	<tr>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink('Investigation','Investigation@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Investigation}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink(Power6,Power6+'@token','all','','selected')]</td>
	</tr>
	<tr bgcolor="white">
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink('Perception','Perception@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Perception}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink(Power7,Power7+'@token','all','','selected')]</td>
	</tr>
	<tr>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink('Persuasion','Persuasion@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Persuasion}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink(Power8,Power8+'@token','all','','selected')]</td>
	</tr>
	<tr bgcolor="white">
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink('Sleight of Hand','SleightofHand@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{SleightofHand}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink(Power9,Power9+'@token','all','','selected')]</td>
	</tr>
	<tr>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink('Stealth','Stealth@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Stealth}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink(Power10,Power10+'@token','all','','selected')]</td>
	</tr>
	<tr bgcolor="white">
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink('Technology','Technology@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Technology}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink(Power11,Power11+'@token','all','','selected')]</td>
	</tr>
	<tr>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink('Treatment','Treatment@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Treatment}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink(Power12,Power12+'@token','all','','selected')]</td>
	</tr>
	<tr bgcolor="white">
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink('Vehicles','Vehicles@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>{Vehicles}</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink(Power13,Power13+'@token','all','','selected')]</td>
	</tr>
	<tr>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r,if(E1Name=='New Skill'),CODE:{}; {Expert: [r:macroLink(E1Name,'E1Name@token','all','','selected')]}]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>[r,if(E1Name=='New Skill'):''; E1]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink(Power14,Power14+'@token','all','','selected')]</td>
	</tr>
	<tr bgcolor="white">
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r,if(E2Name=='New Skill'),CODE:{}; {Expert: [r:macroLink(E2Name,'E2Name@token','all','','selected')]}]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>[r,if(E2Name=='New Skill'):''; E2]<</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink(Power15,Power15+'@token','all','','selected')]</td>
	</tr>
	<tr>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r,if(E3Name=='New Skill'),CODE:{}; {Expert: [r:macroLink(E3Name,'E3Name@token','all','','selected')]}]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>[r,if(E3Name=='New Skill'):''; E3]<</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink(Power16,Power16+'@token','all','','selected')]</td>
	</tr>
	<tr bgcolor="white">
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r,if(E4Name=='New Skill'),CODE:{}; {Expert: [r:macroLink(E4Name,'E4Name@token','all','','selected')]}]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>[r,if(E4Name=='New Skill'):''; E4]<</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2"><span style= "color:#1E90FF">[r:macroLink(Power17,Power17+'@token','all','','selected')]</td>
	</tr>
	<tr>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2">[r,if(E5Name=='New Skill'),CODE:{}; {Expert: [r:macroLink(E5Name,'E5Name@token','all','','selected')]}]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center>[r,if(E5Name=='New Skill'):''; E5]<</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td colspan="5" style="padding-top:1px; padding-bottom:1px"><font size="2">[r:macroLink(Power18,Power18+'@token','all','','selected')]</td>
</tr>
	
<tr>
<td colspan="7" cellspacing="0px" cellpadding="0px" style="background-color:black  ; margin:0px; padding:0px; height:0px"><HR width="100%" align="center" noshade></td>
</tr>

<tr  bgcolor="white" ><td colspan="6" style="padding-top:1px; padding-bottom:1px">
		<font size="3"><b><span style="color:#22B3E4">[r:macroLink('<b>Conditions Table</b>','ConditionsTable@Lib:dcfiles','all','','selected')]</td><td style="padding-top:1px; padding-bottom:1px"><font size="3"> <span style="color:#22B3E4">[r:macroLink('<b>CLEAR ALL</b>','CLEAR_ALL@Lib:dcfiles','all','','selected')]</span></td>
	</tr>

<tr>
<td colspan="7" cellspacing="0px" cellpadding="0px" style="background-color:black  ; margin:0px; padding:0px; height:0px"><HR width="100%" align="center" noshade></td>
</tr>

<tr>
<td colspan="7" style="padding-top:1px; padding-bottom:1px"><font size="2">
{if(getState("Compelled"), '<span style="color:red"><b>'+macroLink('Compelled  ','Compelled@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Compelled  ','Compelled@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Controlled"), '<span style="color:red"><b>'+macroLink('Controlled  ','Controlled@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Controlled  ','Controlled@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Dazed"), '<span style="color:red"><b>'+macroLink('Dazed  ','Dazed@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Dazed  ','Dazed@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Debilitated"), '<span style="color:red"><b>'+macroLink('Debilitated  ','Debilitated@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Debilitated  ','Debilitated@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Defenseless"), '<span style="color:red"><b>'+macroLink('Defenseless  ','Defenseless@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Defenseless  ','Defenseless@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Disabled"), '<span style="color:red"><b>'+macroLink('Disabled  ','Disabled@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Disabled  ','Disabled@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Fatigued"), '<span style="color:red"><b>'+macroLink('Fatigued  ','Fatigued@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Fatigued  ','Fatigued@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Hindered"), '<span style="color:red"><b>'+macroLink('Hindered  ','Hindered@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Hindered  ','Hindered@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Immobile"), '<span style="color:red"><b>'+macroLink('Immobile  ','Immobile@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Immobile  ','Immobile@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Impaired"), '<span style="color:red"><b>'+macroLink('Impaired  ','Impaired@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Impaired  ','Impaired@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Stunned"), '<span style="color:red"><b>'+macroLink('Stunned  ','Stunned@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Stunned  ','Stunned@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Transformed"), '<span style="color:red"><b>'+macroLink('Transformed  ','Transformed@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Transformed  ','Transformed@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Unaware"), '<span style="color:red"><b>'+macroLink('Unaware  ','Unaware@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Unaware  ','Unaware@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Vulnerable"), '<span style="color:red"><b>'+macroLink('Vulnerable  ','Vulnerable@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Vulnerable  ','Vulnerable@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Weakened"), '<span style="color:red"><b>'+macroLink('Weakened  ','Weakened@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Weakened  ','Weakened@Lib:dcfiles','all','','selected')+'</span>')}
</td>
</tr>

<tr>
<td colspan="7" style="padding-top:1px; padding-bottom:1px"><hr></td>
</tr>

<tr>
<td colspan="7" style="padding-top:1px; padding-bottom:6px"><font size="2">
{if(getState("Asleep"), '<span style="color:red"><b>'+macroLink('Asleep  ','Asleep@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Asleep  ','Asleep@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Blind"), '<span style="color:red"><b>'+macroLink('Blind  ','Blind@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Blind  ','Blind@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Bound"), '<span style="color:red"><b>'+macroLink('Bound  ','Bound@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Bound  ','Bound@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Deaf"), '<span style="color:red"><b>'+macroLink('Deaf  ','Deaf@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Deaf  ','Deaf@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Dying"), '<span style="color:red"><b>'+macroLink('Dying  ','Dying@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Dying  ','Dying@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Entranced"), '<span style="color:red"><b>'+macroLink('Entranced  ','Entranced@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Entranced  ','Entranced@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Exhausted"), '<span style="color:red"><b>'+macroLink('Exhausted  ','Exhausted@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Exhausted  ','Exhausted@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Incapacitated"), '<span style="color:red"><b>'+macroLink('Incapacitated  ','Incapacitated@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Incapacitated  ','Incapacitated@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Paralyzed"), '<span style="color:red"><b>'+macroLink('Paralyzed  ','Paralyzed@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Paralyzed  ','Paralyzed@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Prone"), '<span style="color:red"><b>'+macroLink('Prone  ','Prone@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Prone   ','Prone@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Restrained"), '<span style="color:red"><b>'+macroLink('Restrained  ','Restrained@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Restrained  ','Restrained@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Staggered"), '<span style="color:red"><b>'+macroLink('Staggered  ','Staggered@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Staggered  ','Staggered@Lib:dcfiles','all','','selected')+'</span>')}
&#8226; 
{if(getState("Surprised"), '<span style="color:red"><b>'+macroLink('Surprised','Surprised@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Surprised','Surprised@Lib:dcfiles','all','','selected')+'</span>')}
</td>
</tr>
</table>

}]

!!
@@ @Combat
@PROPS@ fontColor=blue ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=white ; playerEditable=false ; applyToSelected=true ; group=Generic ; tooltip= ; minWidth= ; 
[frame('Combat'):{

<title>Combat Quick Reference</title>

<table width="100%">

<tr  background="asset://8b1c6e24556bbf4a1b93f6ca490ed1d9" STYLE="background-repeat: no-repeat" bgcolor='#D32A2C'>
<td><font size="2"><span style="color:white"><b>Hits</b>: <span style="color:#F9E6DD">{Hits}</td>
<td><font size="2"><span style="color:white"><b>Dodge</b>: <span style="color:#F9E6DD">{Dodge}</td>
<td><font size="2"><span style="color:white"><b>Parry</b>: <span style="color:#F9E6DD">{Parry}</td>
<td><font size="2"><span style="color:white"><b>Fort</b>:<span style="color:#F9E6DD">{Fortitude}</td>
<td><font size="2"><span style="color:white"><b>Toughness</b>:<span style="color:#F9E6DD"> {Toughness}</td>
<td><font size="2"><span style="color:white"><b>Will</b>: <span style="color:#F9E6DD">{Will}</td>
<td width="60%"><font size="2"><span style="color:white"><b>Conditions</b>:<span style="color:#F9E6DD"><small>{if(getState("Compelled"), "Compelled ", "")}
{if(getState("Controlled"), "Controlled ", "")}
{if(getState("Dazed"), "Dazed ", "")}
{if(getState("Debilitated"), "Debilitated ", "")}
{if(getState("Defenseless"), "Defenseless ", "")}
{if(getState("Disabled"), "Disabled ", "")}
{if(getState("Fatigued"), "Fatigued ", "")}
{if(getState("Hindered"), "Hindered ", "")}
{if(getState("Immobile"), "Immobile ", "")}
{if(getState("Impaired"), "Impaired ", "")}
{if(getState("Stunned"), "Stunned  ", "")}
{if(getState("Transformed"), "Transformed ", "")}
{if(getState("Unaware"), "Unaware ", "")}
{if(getState("Vulnerable"), "Vulnerable ", "")}
{if(getState("Weakened"), "Weakened ", "")}
{if(getState("Asleep"), "Asleep ", "")}
{if(getState("Blind"), "Blind ", "")}
{if(getState("Bound"), "Bound ", "")}
{if(getState("Deaf"), "Deaf ", "")}
{if(getState("Dying"), "Dying ", "")}
{if(getState("Entranced"), "Entranced ", "")}
{if(getState("Exhausted"), "Exhausted ", "")}
{if(getState("Incapacitated"), "Incapacitated ", "")}
{if(getState("Paralyzed"), "Paralyzed ", "")}
{if(getState("Prone"), "Prone ", "")}
{if(getState("Restrained"), "Restrained ", "")}
{if(getState("Staggered"), "Staggered ", "")}
{if(getState("Surprised"), "Surprised ", "")}</td>
</tr>
<tr>
<td colspan="7" style="background-color:black  ; margin:0px; padding:0px; height:0px"><HR width="100%" height="1%" align="center" noshade></td>
</tr>

}]

!!
@@ @Initiative
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=true ; group=Generic ; tooltip= ; minWidth= ; 
[h:Da=1d20]
[h:TieA=Agility/100]
[h:TieB=Awareness/10000]
[h:TieC=(1d20*1d20)/10000000]

[h:tie=sum(Da,Initiative,TieA,TieB,TieC)]

<span style="color: #c07c1e; font-weight: bold; ">Initiative:</span> <b>{token.init = tie}</b>

!!
@@ @Notes
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=true ; group=Generic ; tooltip= ; minWidth= ; 
[r:notes=getNotes()]
[dialog(getTokenName()+' Notes',"width=400; height=600; temporary=1"):{{notes}}]
[abort(0)]

!!z
@@ @PowerPoints
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=red ; playerEditable=false ; applyToSelected=true ; group=Generic ; tooltip= ; minWidth= ; 
[input(
"PPa|"+PowerPoints+"|Power Points?",
"PLa|"+PL+"|Power Level?")]

[h:PowerPoints=PPa]
[h:PL=PLa]
[macro('CharacterSheet@Lib:dcfiles'):'']
[abort(0)]

!!
@@ @Power_Maker
@PROPS@ fontColor=lime ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=black ; playerEditable=false ; applyToSelected=true ; group=Generic ; tooltip= ; minWidth=100 ; 
[h, if(Power1==0): XPower1 = "Power1,"; XPower1=""]
[h, if(Power2==0): XPower2 = "Power2,"; XPower2=""]
[h, if(Power3==0): XPower3 = "Power3,"; XPower3=""]
[h, if(Power4==0): XPower4 = "Power4,"; XPower4=""]
[h, if(Power5==0): XPower5 = "Power5,"; XPower5=""]
[h, if(Power6==0): XPower6 = "Power6,"; XPower6=""]
[h, if(Power7==0): XPower7 = "Power7,"; XPower7=""]
[h, if(Power8==0): XPower8 = "Power8,"; XPower8=""]
[h, if(Power9==0): XPower9 = "Power9,"; XPower9=""]
[h, if(Power10==0): XPower10 = "Power10,"; XPower10=""]
[h, if(Power11==0): XPower11 = "Power11,"; XPower11=""]
[h, if(Power12==0): XPower12 = "Power12,"; XPower12=""]
[h, if(Power13==0): XPower13 = "Power13,"; XPower13=""]
[h, if(Power14==0): XPower14 = "Power14,"; XPower14=""]
[h, if(Power15==0): XPower15 = "Power15,"; XPower15=""]
[h, if(Power16==0): XPower16 = "Power16,"; XPower16=""]
[h, if(Power17==0): XPower17 = "Power17,"; XPower17=""]
[h, if(Power18==0): XPower18 = "Power18"; XPower18=""]

[h:question=input(
"Q1|Standard rolled attack/effect, Area/Perception attack/effect, Non-attack general effect|Effect Base|RADIO|SELECT=0")]

[h:abort(question)]

[h,switch(Q1),code:

case 0: {       
[h:status=input(
"testa|Rolled effect name|Power/Effect title",
"ranka|#|Power/Effect attack bonus",
"crita|20,19,18,17,16|Crit Number|LIST|SELECT=0 VALUE=STRING",
"targeta|Dodge, Parry|Power/Effect targets which defense?|LIST|SELECT=1 VALUE=STRING",
"effecta|Effect (i.e.# vs Def)|Enter the descriptor text for this Power/Effect",
"powera|"+

XPower1+XPower2+XPower3+XPower4+XPower5+XPower6+XPower7+XPower8+XPower9+XPower10+XPower11+XPower12+XPower13+XPower14+XPower15+XPower16+XPower17+XPower18

+"|Power Slot for this Power/Effect|LIST|VALUE=STRING")]
}; 

      
case 1: {
[h:status=input(
"testa|Area/Perception effect name|Power/Effect title",
"targeta|Dodge, Parry, Will, Fort|Power/Effect resists with?|LIST|SELECT=0 VALUE=STRING",
"effecta|Effect (i.e.# vs Def)|Enter the descriptor text for this Power/Effect",
"powera|"+

XPower1+XPower2+XPower3+XPower4+XPower5+XPower6+XPower7+XPower8+XPower9+XPower10+XPower11+XPower12+XPower13+XPower14+XPower15+XPower16+XPower17+XPower18

+"|Power Slot for this Power/Effect|LIST|VALUE=STRING")]
}; 

case 2: {
[h:status=input(
"testa|General effect name|Power/Effect title",
"effecta|Effect or Descritpion|Enter the descriptor text for this Power/Effect",
"powera|"+

XPower1+XPower2+XPower3+XPower4+XPower5+XPower6+XPower7+XPower8+XPower9+XPower10+XPower11+XPower12+XPower13+XPower14+XPower15+XPower16+XPower17+XPower18

+"|Power Slot for this Power/Effect|LIST|VALUE=STRING")]
}
]

[h:abort(status)]

[h,switch(Q1),code:
case 0:{[H:isblank='<br>The total rolled is <b>{roll}</b>.<br>{CRIT} <small>({da}) d20 + ('+ranka+') + {mod}</small>.<br><i>The attack targets </i><b>'+targeta+'</b>.']}; 
case 1:{[h:isblank='<br><i>The attack targets </i><b>'+targeta+'</b>.'][h:ranka=0][crita=0]}; 
case 2:{[h:isblank=''][h:ranka=0][crita=0]}]

[h,switch(Q1),code:
case 0:{[H:modinside='Enter_attack_modifier']}; 
case 1:{[H:modinside=0]}; 
case 2:{[H:modinside=0]}]

[h:macroinside="
[h:da=1d20]
[h,if(da>"+(crita-1)+"):CRIT='<b>CRITICAL!</b><br>'; CRIT='']
[h:mod="+modinside+"]
[h:roll=da+"+ranka+"+mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> uses "+testa+".</b></span>"+isblank+"<br><b>Effect: </b><i>"+effecta+"</i>
"]
[h:macroprops="applyToSelected=true; autoExecute=true; color=yellow; fontColor=Black; group=Powers and Effects; minWidth=100; tooltip="+effecta]

[h:createMacro(testa,macroinside,macroprops,"; ")]

[h: Property = powera]
[h:Value=testa]
[h:ID=getSelected()]

[h: setProperty(Property, Value, ID)]
[macro('CharacterSheet@Lib:dcfiles'):'']

!!
@@ @Power_Maker*
@PROPS@ fontColor=lime ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=black ; playerEditable=true ; applyToSelected=false ; group=Generic ; tooltip= ; minWidth=100 ; 
[h:question=input(
"Q1|Standard rolled attack/effect, Area/Perception attack/effect, Non-attack general effect|Effect Base|RADIO|SELECT=0")]

[h:abort(question)]

[h,switch(Q1),code:

case 0: {       
[h:status=input(
"testa|Rolled effect name|Power/Effect title",
"ranka|#|Power/Effect attack bonus",
"crita|20,19,18,17,16|Crit Number|LIST|SELECT=0 VALUE=STRING",
"targeta|Dodge, Parry|Power/Effect targets which defense?|LIST|SELECT=1 VALUE=STRING",
"effecta|Effect (i.e.# vs Def)|Enter the descriptor text for this Power/Effect",
"powera|Power1,Power2,Power3,Power4,Power5,Power6,Power7,Power8,Power9,Power10,Power11,Power12,Power13,Power14,Power15,Power16,Power17,Power18|Power Slot for this Power/Effect|LIST|SELECT=0 VALUE=STRING")]
}; 

      
case 1: {
[h:status=input(
"testa|Area/Perception effect name|Power/Effect title",
"targeta|Dodge, Parry, Will, Fort|Power/Effect resists with?|LIST|SELECT=0 VALUE=STRING",
"effecta|Effect (i.e.# vs Def)|Enter the descriptor text for this Power/Effect",
"powera|Power1,Power2,Power3,Power4,Power5,Power6,Power7,Power8,Power9,Power10,Power11,Power12,Power13,Power14,Power15,Power16,Power17,Power18|Power Slot for this Power/Effect|LIST|SELECT=0 VALUE=STRING")]
}; 

case 2: {
[h:status=input(
"testa|General effect name|Power/Effect title",
"effecta|Effect or Descritpion|Enter the descriptor text for this Power/Effect",
"powera|Power1,Power2,Power3,Power4,Power5,Power6,Power7,Power8,Power9,Power10,Power11,Power12,Power13,Power14,Power15,Power16,Power17,Power18|Power Slot for this Power/Effect|LIST|SELECT=0 VALUE=STRING")]
}
]

[h:abort(status)]

[h,switch(Q1),code:
case 0:{[H:isblank='<br>The total rolled is <b>{roll}</b>.<br>{CRIT} <small>({da}) d20 + ('+ranka+') + {mod}</small>.<br><i>The attack targets </i><b>'+targeta+'</b>.']}; 
case 1:{[h:isblank='<br><i>The attack targets </i><b>'+targeta+'</b>.'][h:ranka=0][crita=0]}; 
case 2:{[h:isblank=''][h:ranka=0][crita=0]}]

[h,switch(Q1),code:
case 0:{[H:modinside='Enter_attack_modifier']}; 
case 1:{[H:modinside=0]}; 
case 2:{[H:modinside=0]}]

[h:macroinside="
[h:da=1d20]
[h,if(da>"+(crita-1)+"):CRIT='<b>CRITICAL!</b><br>'; CRIT='']
[h:mod="+modinside+"]
[h:roll=da+"+ranka+"+mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> uses "+testa+".</b></span>"+isblank+"<br><b>Effect: </b><i>"+effecta+"</i>
"]
[h:macroprops="applyToSelected=true; autoExecute=true; color=yellow; fontColor=Black; group=Powers and Effects; minWidth=100; tooltip="+effecta]

[h:createMacro(testa,macroinside,macroprops,"; ")]

[h: Property = powera]
[h:Value=testa]
[h:ID=getSelected()]

[h: setProperty(Property, Value, ID)]
[macro('CharacterSheet@Lib:dcfiles'):'']

!!
@@ @Reset
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=true ; applyToSelected=false ; group=Generic ; tooltip= ; minWidth= ; 
[H: currentImage = getTokenImage()]
[H: portraitImg = getTokenPortrait()]
[H: handoutImg = getTokenHandout()]
[H: stage1Image = getProperty("h.stage1")]
[H: stage2Image = getProperty("h.stage2")]
[H: stage3Image = getProperty("h.stage3")]
[H, if(stage1Image != ""), code: {
   [H: setTokenImage(stage1Image)]
   [H: resetProperty("h.stage1")]
}; {}]
[H: flag = 0]
[H, if(stage2Image != "" && portraitImg == stage2Image): resetProperty("h.stage2"); flag = 1]
[H, if(stage3Image != "" && handoutImg == stage3Image): resetProperty("h.stage3"); flag = 1]
[H, if(flag), code: {
   [H: hasInput = input("confirm||<html>Your token images do not match the originals or token has already been reset.<br><br>The originals could be lost... are you sure?</html>|LABEL|TEXT=FALSE")]
   [H, if(1), code: {
      [H, if(!isPropertyEmpty("h.stage2")): resetProperty("h.stage2")]
      [H, if(!isPropertyEmpty("h.stage3")): resetProperty("h.stage3")]
      [H, if(!isPropertyEmpty("h.currentStage")): resetProperty("h.currentStage")]
   }; {
      [H: inputStr = "junk||<html>If you do not have those images in your reference library,<br>it may be possible to recover them by exporting them as a<br>campaign repository file.  Change the file created extension<br>to .zip (for windows), open and browse the asset folder and<br>look for the following ids.  You can save/move them in to<br>your repository and add to appropriate image slot.<br><br><b>Portrait Image = "+substring(stage2Image,9)+"<br>Handout Image = "+substring(stage3Image,9)+"</b></html>|LABEL|TEXT=FALSE"]
      [H: input(inputStr)]
   }]
}; {
   [H, if(!isPropertyEmpty("h.currentStage")): resetProperty("h.currentStage")]
}]

!!
@@ @Set_Stage
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=true ; applyToSelected=true ; group=Generic ; tooltip= ; minWidth= ; 
[H: currentStage = getProperty("h.currentStage")]
[H, if(json.isEmpty(currentStage)), code: {
   [H, macro("Setup@this"):""]
   [H: currentStage = getProperty("h.currentStage")]
}; {}]
[H: assetList = json.append("",getProperty("h.stage1"),getProperty("h.stage2"),getProperty("h.stage3"))]
[H: hasInput = input("stage| "+json.toList(assetList)+"||LIST|ICON=TRUE TEXT=FALSE SPAN=TRUE ICONSIZE=100 SELECT="+(currentStage-1))]
[H, if(hasInput), code: {
   [H: imgID = getProperty("h.stage"+(stage+1))]
   [H: setTokenImage(imgId)]
   [H: setProperty("h.currentStage",stage+1)]
}; {}]

!!
@@ @Setup
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=true ; applyToSelected=false ; group=Generic ; tooltip= ; minWidth= ; 
[H: currentStage = getProperty("h.currentStage")]
[H: tokenImg = getTokenImage()]
[H: portraitImg = getTokenPortrait()]
[H: handoutImg = getTokenHandout()]
[H: hasInput = input("choice|Are you sure you want to rewrite the images to the current configuration?||LABEL|SPAN=TRUE",
"token_| "+tokenImg+"|Token Image|LABEL|ICON=TRUE ICONSIZE=100",
"portrait_| "+portraitImg+"|Portrait Image|LABEL|ICON=TRUE ICONSIZE=100",
"handout_| "+handoutImg+"|Handout Image|LABEL|ICON=TRUE ICONSIZE=100")]
[H, if(hasInput), code: {
   [H: setProperty("h.stage1",tokenImg)]
   [H: setProperty("h.stage2",portraitImg)]
   [H: setProperty("h.stage3",handoutImg)]
   [H: setProperty("h.currentStage",1)]
}; {}]

!!
@@ @d20
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=true ; group=Generic ; tooltip= ; minWidth= ; 
[h:Da=1d20]
[h:Mod=Roll_Modifiers]
[h:roll=Da+Mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls <i>1d20 + Mods</i>.</b></span><br>The total rolled is <b>{roll}</b>.<br> <small>({da}) d20 + {Mod}</small>.

!!
@@ @CLEAR_ALL
@PROPS@ fontColor=white ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=black ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
[h:status=input(
"Clearyn|y, n|Clear Conditions?|RADIO|ORIENT=h VALUE=String")]

[h:abort(status)]

[h,if(Clearyn=="y"):setAllStates(0); ""][macro('CharacterSheet@Lib:dcfiles'):'']

!!
@@ @Compelled
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=1 ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
/self

[if(getState("Compelled")): setState("Compelled",0); setState("Compelled",1)]

[macro('CharacterSheet@Lib:dcfiles'):'']
 [abort(0)] <!-- Suppress output text -->

!!
@@ @Controlled
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=2 ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
/self

[if(getState("Controlled")): setState("Controlled",0); setState("Controlled",1)]
[setState("Compelled", 0)]
[macro('CharacterSheet@Lib:dcfiles'):'']

 [abort(0)] <!-- Suppress output text -->

!!
@@ @Dazed
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=3 ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
/self

[if(getState("Dazed")): setState("Dazed",0); setState("Dazed",1)]

[macro('CharacterSheet@Lib:dcfiles'):'']
 [abort(0)] <!-- Suppress output text -->

!!
@@ @Debilitated
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=4 ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
/self

[if(getState("Debilitated")): setState("Debilitated",0); setState("Debilitated",1)]

[macro('CharacterSheet@Lib:dcfiles'):'']

 [abort(0)] <!-- Suppress output text -->

!!
@@ @Defenseless
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=5 ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
/self

[if(getState("Defenseless")): setState("Defenseless",0); setState("Defenseless",1)]
[setState("Vulnerable",0)]

[macro('CharacterSheet@Lib:dcfiles'):'']
 [abort(0)] <!-- Suppress output text -->

!!
@@ @Disabled
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=6 ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
/self

[if(getState("Disabled")): setState("Disabled",0); setState("Disabled",1)]

[macro('CharacterSheet@Lib:dcfiles'):'']
 [abort(0)] <!-- Suppress output text -->

!!
@@ @Fatigued
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=7 ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
/self

[if(getState("Fatigued")): setState("Fatigued",0); setState("Fatigued",1)]

[macro('CharacterSheet@Lib:dcfiles'):'']
 [abort(0)] <!-- Suppress output text -->

!!
@@ @Hindered
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=8 ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
/self

[if(getState("Hindered")): setState("Hindered",0); setState("Hindered",1)]

[macro('CharacterSheet@Lib:dcfiles'):'']
 [abort(0)] <!-- Suppress output text -->

!!
@@ @Immobile
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=9 ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
/self

[if(getState("Immobile")): setState("Immobile",0); setState("Immobile",1)]
[setState("Hindered",0)]

[macro('CharacterSheet@Lib:dcfiles'):'']
 [abort(0)] <!-- Suppress output text -->

!!
@@ @Impaired
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=10 ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
/self

[if(getState("Impaired")): setState("Impaired",0); setState("Impaired",1)]

[macro('CharacterSheet@Lib:dcfiles'):'']
 [abort(0)] <!-- Suppress output text -->

!!
@@ @Stunned
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=11 ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
/self

[if(getState("Stunned")): setState("Stunned",0); setState("Stunned",1)]
[setState("Dazed",0)]

[macro('CharacterSheet@Lib:dcfiles'):'']
 [abort(0)] <!-- Suppress output text -->

!!
@@ @Transformed
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=12 ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
/self

[if(getState("Transformed")): setState("Transformed",0); setState("Transformed",1)]

[macro('CharacterSheet@Lib:dcfiles'):'']
 [abort(0)] <!-- Suppress output text -->

!!
@@ @Unaware
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=13 ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
/self

[if(getState("Unaware")): setState("Unaware",0); setState("Unaware",1)]

[macro('CharacterSheet@Lib:dcfiles'):'']
 [abort(0)] <!-- Suppress output text -->

!!
@@ @Vulnerable
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=14 ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
/self

[if(getState("Vulnerable")): setState("Vulnerable",0); setState("Vulnerable",1)]

[macro('CharacterSheet@Lib:dcfiles'):'']
 [abort(0)] <!-- Suppress output text -->

!!
@@ @Weakened
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=15 ; color=default ; playerEditable=false ; applyToSelected=false ; group=States ; tooltip= ; minWidth= ; 
/self

[if(getState("Weakened")): setState("Weakened",0); setState("Weakened",1)]

[macro('CharacterSheet@Lib:dcfiles'):'']
 [abort(0)] <!-- Suppress output text -->

!!
@@ @ConditionsTable
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Tables ; tooltip= ; minWidth= ; 
[dialog("ConditionsTable","width=380; height=600; temporary=1"): {
<table bgcolor="#CCE8F2">
<tr  background="asset://8b1c6e24556bbf4a1b93f6ca490ed1d9" STYLE="background-repeat: no-repeat" bgcolor='#D32A2C'>
		<td ><span style="color:white"><b>Basic Conditions</td>
	</tr>
<tr>
<td colspan="7" style="background-color:black  ; margin:0px; padding:0px; height:0px"><HR width="100%" height="1%" align="center" noshade></td>
</tr>
	<tr bgcolor="white">
		<td >Compelled</td>
		<td >Target has only a Standard Action dictated by controlling character.</td>
	</tr>
	<tr>
		<td >Controlled</td>
		<td >Target has full actions, as dictated by controlling character.</td>
	</tr>
	<tr bgcolor="white">
		<td >Dazed</td>
		<td >Character has a single Standard Action.</td>
	</tr>
	<tr>
		<td >Debilitated</td>
		<td >One or more abilities is lowered below -5.</td>
	</tr>
	<tr bgcolor="white">
		<td >Defenseless</td>
		<td >Active Defenses are 0. Attacks can be routine or rolled as a Critical Hit.</td>
	</tr>
	<tr>
		<td >Disabled</td>
		<td >-5 Circumstance Penalty on checks.</td>
	</tr>
	<tr bgcolor="white">
		<td >Fatigued</td>
		<td >Hindered. Recover with an hour of rest.</td>
	</tr>
	<tr>
		<td >Hindered.</td>
		<td >-1 Speed.</td>
	</tr>
	<tr bgcolor="white">
		<td >Immobile</td>
		<td >No movement speed.</td>
	</tr>
	<tr>
		<td >Impaired</td>
		<td >-2 Circumstance Penalty on checks.</td>
	</tr>
	<tr bgcolor="white">
		<td >Stunned</td>
		<td >No Actions.</td>
	</tr>
	<tr>
		<td >Transformation</td>
		<td >The target becomes something else.</td>
	</tr>
	<tr bgcolor="white">
		<td >Unaware</td>
		<td >No Perception checks or actions. All targets have full concealment.</td>
	</tr>
	<tr>
		<td >Vulnerable</td>
		<td >Half defenses (round up).</td>
	</tr>
	<tr bgcolor="white">
		<td >Weakened</td>
		<td >Temp loss to a trait.</td>
	</tr>

	<tr  background="asset://8b1c6e24556bbf4a1b93f6ca490ed1d9" STYLE="background-repeat: no-repeat" bgcolor='#D32A2C'>
		<td ><span style="color:white"><b>Combined Conditions</td>
	</tr><tr>
<td colspan="7" style="background-color:black  ; margin:0px; padding:0px; height:0px"><HR width="100%" height="1%" align="center" noshade></td>
</tr>
	<tr bgcolor="white">
		<td >Asleep</td>
		<td >Defenseless, Stunned and Unaware. Hearing check with 3 degrees of success, shaking the character or an effect that requires a resistance check awakens char.</td>
	</tr>
	<tr>
		<td >Blind</td>
		<td >Cannot see. Hindered, visually unaware, and vulnerable (and impaired if vision is needed for the check).</td>
	</tr>
	<tr bgcolor="white">
		<td >Bound</td>
		<td >Char is defenseless, immobile and impaired.</td>
	</tr>
	<tr>
		<td >Deaf</td>
		<td >All targets have full auditory concealment. </td>
	</tr>
	<tr bgcolor="white">
		<td >Dying</td>
		<td >Incapacitated (defenseless, stunned and unaware. Make Fortitude DC 15 check each round. Three degrees of failure means death and two degrees of success stabilize the character.</td>
	</tr>
	<tr>
		<td >Entranced</td>
		<td >Stunned. Obvious threats break trance. Ally can break free with interaction skill check of DC 10 + Effect Rank.</td>
	</tr>

<tr bgcolor="white">
		<td >Exhausted</td>
		<td >Impared and hindered. Recover with an hour of rest.</td>
	</tr>

	<tr>
		<td >Incapacitated</td>
		<td >Defenseless, stunned and unaware. Usually prone.</td>
	</tr>
	<tr bgcolor="white">
		<td >Paralyzed</td>
		<td >Defenseless, immobile and physically stunned. Char is still aware and can take purely mental actions.</td>
	</tr>
	<tr>
		<td >Prone</td>
		<td >-5 penalty on close attacks. Opponents get +5 bonus to close attacks against the character. Ranged attacks get -5 due to &quot; cover&quot; . Being prone is &quot; hindered&quot; . Standing from prone is a move action.</td>
	</tr>
	<tr bgcolor="white">
		<td >Restrained</td>
		<td >Hindered and vulnerable. If restraints are anchored, immobile instead of hindered.</td>
	</tr>
	<tr>
		<td >Staggered</td>
		<td >Dazed and hindered.</td>
	</tr>
	<tr bgcolor="white">
		<td >Surprised</td>
		<td >Stunned, vulnerable.</td>
	</tr>
</table>
}]
[abort(0)]

!!
@@ @MaterialTable
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Tables ; tooltip= ; minWidth= ; 
[dialog("MaterialTable","width=200; height=600; temporary=1"): {
<table bgcolor="#CCE8F2">
	<tr  background="asset://8b1c6e24556bbf4a1b93f6ca490ed1d9" STYLE="background-repeat: no-repeat" bgcolor='#D32A2C'>
		<td ><span style="color:white"><b>Material</td>
		<td ><span style="color:white"><b>Toughness</td>
	</tr><tr>
<td colspan="7" style="background-color:black  ; margin:0px; padding:0px; height:0px"><HR width="100%" height="1%" align="center" noshade></td>
</tr>
	<tr bgcolor="white">
		<td >Paper</td>
		<td >0</td>
	</tr>
	<tr>
		<td >Soil</td>
		<td >0</td>
	</tr>
	<tr bgcolor="white">
		<td >Glass</td>
		<td >1</td>
	</tr>
	<tr>
		<td >Ice</td>
		<td >1</td>
	</tr>
	<tr bgcolor="white">
		<td >Rope</td>
		<td >1</td>
	</tr>
	<tr>
		<td >Wood</td>
		<td >3</td>
	</tr>
	<tr bgcolor="white">
		<td >Stone</td>
		<td >5</td>
	</tr>
	<tr>
		<td >Iron</td>
		<td >7</td>
	</tr>
	<tr bgcolor="white">
		<td >Reinforced Concrete</td>
		<td >8</td>
	</tr>
	<tr>
		<td >Steel</td>
		<td >9</td>
	</tr>
	<tr bgcolor="white">
		<td >Titanium</td>
		<td >15</td>
	</tr>
	<tr>
		<td >Prometheum</td>
		<td >20+</td>
	</tr>
	

	<tr  background="asset://8b1c6e24556bbf4a1b93f6ca490ed1d9" STYLE="background-repeat: no-repeat" bgcolor='#D32A2C'>
		<td ><span style="color:white"><b>Thickness</td>
		<td><span style="color:white"><b>Modifier</td>
	</tr><tr>
<td colspan="7" style="background-color:black  ; margin:0px; padding:0px; height:0px"><HR width="100%" height="1%" align="center" noshade></td>
</tr>
	<tr bgcolor="white">
		<td >1/64th inch</td>
		<td >-6</td>
	</tr>

	<tr>
		<td >1/32nd inch</td>
		<td >-5</td>
	</tr>

	<tr bgcolor="white">
		<td >1/16th inch</td>
		<td >-4</td>
	</tr>
	<tr>
		<td >1/8th inch</td>
		<td >-3</td>
	</tr>
	<tr bgcolor="white">
		<td >1/4 inch</td>
		<td >-2</td>
	</tr>

	<tr>
		<td >1/2 inch</td>
		<td >-1</td>
	</tr>

	<tr bgcolor="white">
		<td >1 inch</td>
		<td >+0</td>
	</tr>
	<tr>
		<td >2 inches</td>
		<td >+1</td>
	</tr>
	<tr>
		<td >6 inches</td>
		<td >+2</td>
	</tr>
	<tr bgcolor="white">
		<td >1 foot</td>
		<td >+3</td>
	</tr>
	<tr>
		<td >3 feet</td>
		<td >+4</td>
	</tr>
	<tr bgcolor="white">
		<td >6 feet</td>
		<td >+5</td>
	</tr>
	<tr>
		<td >15 feet</td>
		<td >+6</td>
	</tr>
	<tr bgcolor="white">
		<td >30 feet</td>
		<td >+7</td>
	</tr>
	<tr>
		<td >60 feet</td>
		<td >+8</td>
	</tr>
	<tr bgcolor="white">
		<td >120 feet</td>
		<td >+9</td>
	</tr>
	<tr>
		<td >250 feet</td>
		<td >+10</td>
	</tr>
	<tr bgcolor="white">
		<td >500 feet</td>
		<td >+11</td>
	</tr>
	<tr>
		<td >900 feet</td>
		<td >+12</td>
	</tr>
	<tr bgcolor="white">
		<td >1,800 feet</td>
		<td >+13</td>
	</tr>
	<tr>
		<td >1/2 mile</td>
		<td >+14</td>
	</tr>
	<tr bgcolor="white">
		<td >1 mile</td>
		<td >+15</td>
	</tr>
</table>

}]
[abort(0)]

!!
@@ @MeasurementsTable
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Tables ; tooltip= ; minWidth= ; 
[dialog("MeasurementsTable","width=400; height=600; temporary=1"): {

<table bgcolor="#CCE8F2">
	<tr  background="asset://8b1c6e24556bbf4a1b93f6ca490ed1d9" STYLE="background-repeat: no-repeat" bgcolor='#D32A2C'>
		<td ><span style="color:white"><b><center>Rank</td>
		<td ><span style="color:white"><b><center>Mass</td>
		<td ><span style="color:white"><b><center>Time</td>
		<td ><span style="color:white"><b><center>Distance</td>
		<td ><span style="color:white"><b><center>Volume</td>
	</tr><tr>
<td colspan="7" style="background-color:black  ; margin:0px; padding:0px; height:0px"><HR width="100%" height="1%" align="center" noshade></td>
</tr>
	<tr bgcolor="white">
		<td ><center>-5</td>
		<td ><center>1.5 lb.</td>
		<td ><center>1/8 second</td>
		<td ><center>6 inches</td>
		<td ><center>1/32 cft.</td>
	</tr>
	<tr>
		<td ><center>-4</td>
		<td ><center>3 lbs.</td>
		<td ><center>1/4 second</td>
		<td ><center>1 foot</td>
		<td ><center>1/16 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>-3</td>
		<td ><center>6 lbs.</td>
		<td ><center>1/2 second</td>
		<td ><center>3 feet</td>
		<td ><center>1/8 cft.</td>
	</tr>
	<tr>
		<td ><center>-2</td>
		<td ><center>12 lbs.</td>
		<td ><center>1 second</td>
		<td ><center>6 feet</td>
		<td ><center>1/4 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>-1</td>
		<td ><center>25 lbs.</td>
		<td ><center>3 seconds</td>
		<td ><center>15 feet</td>
		<td ><center>1/2 cft.</td>
	</tr>
	<tr>
		<td ><center>0</td>
		<td ><center>50 lbs.</td>
		<td ><center>6 seconds</td>
		<td ><center>30 feet</td>
		<td ><center>1 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>1</td>
		<td ><center>100 lbs.</td>
		<td ><center>12 seconds</td>
		<td ><center>60 feet</td>
		<td ><center>2 cft.</td>
	</tr>
	<tr>
		<td ><center>2</td>
		<td ><center>200 lbs.</td>
		<td ><center>30 seconds</td>
		<td ><center>120 feet</td>
		<td ><center>4 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>3</td>
		<td ><center>400 lbs.</td>
		<td ><center>1 minute</td>
		<td ><center>250 feet</td>
		<td ><center>8 cft.</td>
	</tr>
	<tr>
		<td ><center>4</td>
		<td ><center>800 lbs.</td>
		<td ><center>2 minutes</td>
		<td ><center>500 feet</td>
		<td ><center>15 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>5</td>
		<td ><center>1600 lbs.</td>
		<td ><center>4 minutes</td>
		<td ><center>900 feet</td>
		<td ><center>30 cft.</td>
	</tr>
	<tr>
		<td ><center>6</td>
		<td ><center>3200 lbs.</td>
		<td ><center>8 minutes</td>
		<td ><center>1800 feet</td>
		<td ><center>60 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>7</td>
		<td ><center>3 tons</td>
		<td ><center>15 minutes</td>
		<td ><center>1/2 mile</td>
		<td ><center>125 cft.</td>
	</tr>
	<tr>
		<td ><center>8</td>
		<td ><center>6 tons</td>
		<td ><center>30 minutes</td>
		<td ><center>1 mile</td>
		<td ><center>250 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>9</td>
		<td ><center>12 tons</td>
		<td ><center>1 hour</td>
		<td ><center>2 miles</td>
		<td ><center>500 cft.</td>
	</tr>
	<tr>
		<td ><center>10</td>
		<td ><center>25 tons</td>
		<td ><center>2 hours</td>
		<td ><center>4 miles</td>
		<td ><center>1,000 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>11</td>
		<td ><center>50 tons</td>
		<td ><center>4 hours</td>
		<td ><center>8 miles</td>
		<td ><center>2,000 cft.</td>
	</tr>
	<tr>
		<td ><center>12</td>
		<td ><center>100 tons</td>
		<td ><center>8 hours</td>
		<td ><center>16 miles</td>
		<td ><center>4,000 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>13</td>
		<td ><center>200 tons</td>
		<td ><center>16 hours</td>
		<td ><center>30 miles</td>
		<td ><center>8,000 cft.</td>
	</tr>
	<tr>
		<td ><center>14</td>
		<td ><center>400 tons</td>
		<td ><center>1 day</td>
		<td ><center>60 miles</td>
		<td ><center>16,000 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>15</td>
		<td ><center>800 tons</td>
		<td ><center>2 days</td>
		<td ><center>120 miles</td>
		<td ><center>32,000 cft.</td>
	</tr>
	<tr>
		<td ><center>16</td>
		<td ><center>1600 tons</td>
		<td ><center>4 days</td>
		<td ><center>250 miles</td>
		<td ><center>65,000 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>17</td>
		<td ><center>3.2 ktons</td>
		<td ><center>1 week</td>
		<td ><center>500 miles</td>
		<td ><center>125,000 cft.</td>
	</tr>
	<tr>
		<td ><center>18</td>
		<td ><center>6 ktons</td>
		<td ><center>2 weeks</td>
		<td ><center>1,000 miles</td>
		<td ><center>250,000 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>19</td>
		<td ><center>12 ktons</td>
		<td ><center>1 month</td>
		<td ><center>2,000 miles</td>
		<td ><center>500,000 cft.</td>
	</tr>
	<tr>
		<td ><center>20</td>
		<td ><center>25 ktons</td>
		<td ><center>2 months</td>
		<td ><center>4,000 miles</td>
		<td ><center>1 million cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>21</td>
		<td ><center>50 ktons</td>
		<td ><center>4 months</td>
		<td ><center>8,000 miles</td>
		<td ><center>2 million cft.</td>
	</tr>
	<tr>
		<td ><center>22</td>
		<td ><center>100 ktons</td>
		<td ><center>8 months</td>
		<td ><center>1,6000 miles</td>
		<td ><center>4 million cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>23</td>
		<td ><center>200 ktons</td>
		<td ><center>1.5 years</td>
		<td ><center>32,000 miles</td>
		<td ><center>8 million cft.</td>
	</tr>
	<tr>
		<td ><center>24</td>
		<td ><center>400 ktons</td>
		<td ><center>3 years</td>
		<td ><center>64,000 miles</td>
		<td ><center>15 million cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>25</td>
		<td ><center>800 ktons</td>
		<td ><center>6 years</td>
		<td ><center>125,000 miles</td>
		<td ><center>32 million cft.</td>
	</tr>
	<tr>
		<td ><center>26</td>
		<td ><center>1,600 ktons</td>
		<td ><center>12 years</td>
		<td ><center>250,000 miles</td>
		<td ><center>65 million cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>27</td>
		<td ><center>3,200 ktons</td>
		<td ><center>25 years</td>
		<td ><center>500,000 miles</td>
		<td ><center>125 million cft.</td>
	</tr>
	<tr>
		<td ><center>28</td>
		<td ><center>6,400 ktons</td>
		<td ><center>50 years</td>
		<td ><center>1 million miles</td>
		<td ><center>250 million cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>29</td>
		<td ><center>12,500 ktons</td>
		<td ><center>100 years</td>
		<td ><center>2 million miles</td>
		<td ><center>500 million cft.</td>
	</tr>
	<tr>
		<td ><center>30</td>
		<td ><center>25,000 ktons</td>
		<td ><center>200 years</td>
		<td ><center>4 million miles</td>
		<td ><center>1 billion cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>+1</td>
		<td ><center>x2</td>
		<td ><center>x2</td>
		<td ><center>x2</td>
		<td ><center>x2</td>
	</tr>
</table>

}]
[abort(0)]

!!
@@ @GMAreaDamage
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=GM ; tooltip= ; minWidth= ; 
[h:abort(isGM())]
[h:Da=1d20]
[h:DOD=Character_Dodge]

[h:status=input(
"Dc|#|Effect Rank?|TEXT"
)]

[h:resulta=-1*((Da+DOD)-(Dc+10))]
[h: margina=table("Margin",resulta)]
[h,switch(margina),code:
case 0: {
[h:result="Half Effect!"]
}; 
case 1: {
[h:result="Full Effect!"]
}; 
case 2: {
[h:result="Full Effect!"]
}; 
case 3: {
[h:result="Full Effect!"]
}; 
case 4: {
[h:result="Full Effect!"]
}]
<b>DODGE RESISTANCE</b><br>
[r:result]

[h:Db=1d20]
[h:TOUGH=Character_Toughness]

[h,if(result=="Full Effect!"),CODE:{
[h:resultb=-1*(((Db+TOUGH)-Hits)-(Dc+15))]
}; {
[h:resultb=-1*(((Db+TOUGH)-Hits)-(round(0.5*Dc)+15)))]
}]
[h,if(result=="Full Effect!"):Dc1=Dc; Dc1=round(0.5*Dc)]

[h: marginb=table("Margin",resultb)]
[h,switch(marginb),code:
case 0: {
[h:resultd="No damage taken!"]
}; 
case 1: {
[h:oldHits=getProperty('Hits')]
[h:newHits=oldHits+1]
[h:ID = getSelected()]
[h:setProperty('Hits', newHits,ID)]
[h:resultd="-1 penalty to further <b>Toughness</b> resistances...<br>(will become "+-1*Hits+")"]
}; 
case 2: {
[h:oldHits=getProperty('Hits')]
[h:newHits=oldHits+1]
[h:ID = getSelected()]
[h:setProperty('Hits', newHits,ID)]
[h:resultd="-1 penalty to further <b>Toughness</b> resistances...<br>(will become "+-1*Hits+")<br>You are <b>Dazed</b> until the end of your Next turn."]
[h:setState("Dazed",1)]
}; 
case 3: {
[h:oldHits=getProperty('Hits')]
[h:newHits=oldHits+1]
[h:ID = getSelected()]
[h:setProperty('Hits', newHits,ID)]
[h:resultd="-1 penalty to further <b>Toughness</b> resistances...<br>(will become "+-1*Hits+")<br>You are <b>Staggered</b> until you <i>Recover</i>.<br>If <b>Staggered</b> again, you are <i>Incapacitated</i>."]

[if(getState("Staggered")): setState("Incapacitated",1); setState("Staggered",1)]
[if(getState("Incapacitated")): setState("Staggered",0)]
[h:setState("Dazed",1)]
[h:setState("Hindered",1)]
}; 
case 4: {
[h:oldHits=getProperty('Hits')]
[h:newHits=oldHits+1]
[h:ID = getSelected()]
[h:setProperty('Hits', newHits,ID)]
[h:resultd="You are <b>Incapacitated</b> until you <i>Recover</i>."]
[h:setState("Staggered",0)]
[h:setState("Dazed",0)]
[h:setState("Hindered",0)]
[h:setState("Unaware",1)]
[h:setState("Stunned",1)]
[h:setState("Defenseless",1)]
[h: setState("Incapacitated",1)]
}]<br>=======================<br>
<b>TOUGHNESS RESISTANCE</b><br>
[r:resultd]

<br>

!!
@@ @GMCharacterSheet
@PROPS@ fontColor=blue ; autoExecute=true ; fontSize=1.00em ; sortBy=1 ; color=white ; playerEditable=false ; applyToSelected=true ; group=GM ; tooltip= ; minWidth= ; 
[h:abort(isGM())]
[h,if( isFrameVisible("GMCharacterSheet") ), code: {}; { [resetFrame("GMCharacterSheet")] } ]
[frame("GMCharacterSheet"): {

<title>GM Character Sheet</title>
<table bgcolor="#CCE8F2">

<tr  background="asset://8b1c6e24556bbf4a1b93f6ca490ed1d9" STYLE="background-repeat: no-repeat" bgcolor='#D32A2C'>
<td colspan="6" style="padding-top:1px; padding-bottom:1px" >
<span style="color:white">
<font size="3">
<b><span style="color:white">[r:macrolink(token.name,'Notes@Lib:dcfiles','all','','selected')] |
[r:macroLink('<font size="2">Refresh','GMCharacterSheet@Lib:dcfiles','all','','selected')]
</td>
</tr>

<tr>
<td colspan="7" style="background-color:black  ; margin:0px; padding:0px; height:0px"><HR width="100%" height="1%" align="center" noshade></td>
</tr>

 
	<tr background="asset://737bfa88b1a6718186d9faacd5b0d70c" STYLE="background-repeat: no-repeat" bgcolor='#CDE2F5'>
	</tr>

	<tr  bgcolor="white">
		<td style="padding-top:1px; padding-bottom:1px"><font size="3"><span style= "color:#1E90FF">[r:macroLink('Roll','GMd20@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="3"><span style= "color:#1E90FF">[r:macroLink('GM Roll','GMd20_CH@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="3"><span style= "color:#1E90FF">[r:macroLink('Measure','MeasurementsTable@Lib:dcfiles','all','','selected')]</td>
	</tr>
	<tr>
		<td style="padding-top:1px; padding-bottom:1px"><font size="3">[r:macroLink('Toughness','GMToughness@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"><center></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px" colspan=2><font size="3">[r:macroLink('Area DMG','GMAreaDamage@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
	</tr>
	<tr bgcolor="white">
		<td style="padding-top:1px; padding-bottom:1px"><font size="3"><span style= "color:#1E90FF">[r:macroLink('Initiative','GMInitiative@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="3"><span style= "color:#1E90FF">[r:macroLink('Hits','GMHits@Lib:dcfiles','all','','selected')]</td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td style="padding-top:1px; padding-bottom:1px"><font size="2"></td>
		<td ><font size="3"><span style= "color:#1E90FF">[r:macroLink('Materials','MaterialTable@Lib:dcfiles','all','','selected')]</td>
	</tr>

<tr>
<td colspan="7" cellspacing="0px" cellpadding="0px" style="background-color:black ; margin:0px; padding:0px; height:0px"><HR  width="100%" align="center" noshade></td>
</tr>
<tr background="asset://737bfa88b1a6718186d9faacd5b0d70c" STYLE="background-repeat: no-repeat" width="100%" bgcolor='#CDE2F5'>
	
<td colspan="6" style="padding-top:1px; padding-bottom:1px">
	
	<font size="3"><span style="color:black">
	
	[r:macroLink('<b>Conditions</b>','ConditionsTable@Lib:dcfiles','all','','selected')]</font>
	</td>
	<td style="padding-top:1px; padding-bottom:1px"><span style="color:black; font-size:8">		[r:macroLink('<b>Clear All</b>','CLEAR_ALL@Lib:dcfiles','all','','selected')]
	</span>
	</td>
</tr>

<tr>
<td colspan="7" style="padding-top:1px; padding-bottom:1px" bgcolor='white'><font size="2"><font size="2"><span style="color:#E6F1FA">
{if(getState("Compelled"), '<span style="color:#D2262B"><b>'+macroLink('Compelled','Compelled@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Compelled','Compelled@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Controlled"), '<span style="color:#D2262B"><b>'+macroLink('Controlled','Controlled@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Controlled','Controlled@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Dazed"), '<span style="color:#D2262B"><b>'+macroLink('Dazed','Dazed@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Dazed','Dazed@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Debilitated"), '<span style="color:#D2262B"><b>'+macroLink('Debilitated','Debilitated@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Debilitated','Debilitated@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Defenseless"), '<span style="color:#D2262B"><b>'+macroLink('Defenseless','Defenseless@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Defenseless','Defenseless@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Disabled"), '<span style="color:#D2262B"><b>'+macroLink('Disabled','Disabled@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Disabled','Disabled@Lib:dcfiles','all','','selected')+'</span>')}

{if(getState("Fatigued"), '<span style="color:#D2262B"><b>'+macroLink('Fatigued','Fatigued@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Fatigued','Fatigued@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Hindered"), '<span style="color:#D2262B"><b>'+macroLink('Hindered','Hindered@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Hindered','Hindered@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Immobile"), '<span style="color:#D2262B"><b>'+macroLink('Immobile','Immobile@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Immobile','Immobile@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Impaired"), '<span style="color:#D2262B"><b>'+macroLink('Impaired','Impaired@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Impaired','Impaired@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Stunned"), '<span style="color:#D2262B"><b>'+macroLink('Stunned','Stunned@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Stunned','Stunned@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Transformed"), '<span style="color:#D2262B"><b>'+macroLink('Transformed','Transformed@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Transformed','Transformed@Lib:dcfiles','all','','selected')+'</span>')}

{if(getState("Unaware"), '<span style="color:#D2262B"><b>'+macroLink('Unaware','Unaware@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Unaware','Unaware@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Vulnerable"), '<span style="color:#D2262B"><b>'+macroLink('Vulnerable','Vulnerable@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Vulnerable','Vulnerable@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Weakened"), '<span style="color:#D2262B"><b>'+macroLink('Weakened','Weakened@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Weakened','Weakened@Lib:dcfiles','all','','selected')+'</span>')}
</td>
</tr>

<tr>
<td colspan="7" style="padding-top:1px; padding-bottom:1px; background-color:white"><hr></td>
</tr>

<tr>
<td colspan="7" style="padding-top:1px; padding-bottom:6px"><font size="2"><span style="color:white">
{if(getState("Asleep"), '<span style="color:#D2262B"><b>'+macroLink('Asleep','Asleep@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Asleep','Asleep@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Blind"), '<span style="color:#D2262B"><b>'+macroLink('Blind','Blind@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Blind','Blind@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Bound"), '<span style="color:#D2262B"><b>'+macroLink('Bound','Bound@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Bound','Bound@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Deaf"), '<span style="color:#D2262B"><b>'+macroLink('Deaf','Deaf@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Deaf','Deaf@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Dying"), '<span style="color:#D2262B"><b>'+macroLink('Dying','Dying@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Dying','Dying@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Entranced"), '<span style="color:#D2262B"><b>'+macroLink('Entranced','Entranced@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Entranced','Entranced@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Exhausted"), '<span style="color:#D2262B"><b>'+macroLink('Exhausted','Exhausted@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Exhausted','Exhausted@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Incapacitated"), '<span style="color:#D2262B"><b>'+macroLink('Incapacitated','Incapacitated@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Incapacitated','Incapacitated@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Paralyzed"), '<span style="color:#D2262B"><b>'+macroLink('Paralyzed','Paralyzed@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Paralyzed','Paralyzed@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Prone"), '<span style="color:#D2262B"><b>'+macroLink('Prone','Prone@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Prone','Prone@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Restrained"), '<span style="color:#D2262B"><b>'+macroLink('Restrained','Restrained@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Restrained','Restrained@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Staggered"), '<span style="color:#D2262B"><b>'+macroLink('Staggered','Staggered@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Staggered','Staggered@Lib:dcfiles','all','','selected')+'</span>')}
|
{if(getState("Surprised"), '<span style="color:#D2262B"><b>'+macroLink('Surprised','Surprised@Lib:dcfiles','all','','selected')+'</b></span>',' <span style="color:gray">'+macroLink('Surprised','Surprised@Lib:dcfiles','all','','selected')+'</span>')}

<tr background="
asset://8b1c6e24556bbf4a1b93f6ca490ed1d9" STYLE="background-repeat: no-repeat" bgcolor='#D32A2C'>
<td><span style="color:#D32A2D">.</td></tr>
<tr>
<td colspan="7" style="background-color:black  ; margin:0px; padding:0px; height:0px"><HR width="100%" height="1%" align="center" noshade></td>
</tr>

</table>

}]

!!
@@ @GMHits
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=999 ; color=red ; playerEditable=true ; applyToSelected=false ; group=GM ; tooltip= ; minWidth= ; 
[h:abort(isGM())]
[h: Hitsa =Set_Value_for_Hits]
[h:Hits=abs(Hitsa)]
[macro('GMCharacterSheet@Lib:dcfiles'):'']

!!
@@ @GMINITPANE
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=red ; playerEditable=false ; applyToSelected=false ; group=GM ; tooltip= ; minWidth= ; 
[h:abort(isGM())]
[frame('Initiative'):{

<title>Initiative Pane</title>

<table width="100%">

<tr  background="asset://8b1c6e24556bbf4a1b93f6ca490ed1d9" STYLE="background-repeat: no-repeat" bgcolor='#D32A2C'>
<td><font size="2"><span style="color:white"><span style="color:#F9E6DD">[r:macrolink('Start Initiative','Start_Initiative@Lib:dcfiles','all','','selected')]</td>
<td><font size="2"><span style="color:white"><span style="color:#F9E6DD">[r:macrolink('Advance Initiative','Advance_Initiative@Lib:dcfiles','all','','selected')]</td>
<td><font size="2"><span style="color:white"><span style="color:#F9E6DD">[r:macrolink('End Initiative','End_Initiative@Lib:dcfiles','all','','selected')]</td>

</tr>
<tr>
<td colspan="7" style="background-color:black  ; margin:0px; padding:0px; height:0px"><HR width="100%" height="1%" align="center" noshade></td>
</tr>

}]

!!
@@ @GMInitiative
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=true ; group=GM ; tooltip= ; minWidth= ; 
[h:abort(isGM())]
[h:Da=1d20]
[h:TieA=Agility/100]
[h:TieB=Awareness/10000]
[h:TieC=(1d20*1d20)/10000000]
[h:GMinit=Init_Value]

[h:tie=sum(Da,GMInit,TieA,TieB,TieC)]

<span style="color: #c07c1e; font-weight: bold; ">Initiative:</span> <b>{token.init = tie}</b>

!!
@@ @GMToughness
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=1 ; color=default ; playerEditable=false ; applyToSelected=false ; group=GM ; tooltip= ; minWidth= ; 
[h:abort(isGM())]
[h:Da=1d20]
[h:TOUGH=Character_Toughness]

[h:status=input(
"Dc|#|Damage Rank?|TEXT"
)]

[h:resulta=-1*(((Da+TOUGH)-Hits)-(Dc+15))]
[h: margina=table("Margin",resulta)]
[h,switch(margina),code:
case 0: {
[h:result="No damage taken!"]
}; 
case 1: {
[h:oldHits=getProperty('Hits')]
[h:newHits=oldHits+1]
[h:ID = getSelected()]
[h:setProperty('Hits', newHits,ID)]
[h:result="-1 penalty to further <b>Toughness</b> resistances...<br>(will become "+-1*Hits+")"]
}; 
case 2: {
[h:oldHits=getProperty('Hits')]
[h:newHits=oldHits+1]
[h:ID = getSelected()]
[h:setProperty('Hits', newHits,ID)]
[h:result="-1 penalty to further <b>Toughness</b> resistances...<br>(will become "+-1*Hits+")<br>You are <b>Dazed</b> until the end of your Next turn."]
[h:setState("Dazed",1)]
}; 
case 3: {
[h:oldHits=getProperty('Hits')]
[h:newHits=oldHits+1]
[h:ID = getSelected()]
[h:setProperty('Hits', newHits,ID)]
[h:result="-1 penalty to further <b>Toughness</b> resistances...<br>(will become "+-1*Hits+")<br>You are <b>Staggered</b> until you <i>Recover</i>.<br>If <b>Staggered</b> again, you are <i>Incapacitated</i>."]

[if(getState("Staggered")): setState("Incapacitated",1); setState("Staggered",1)]
[if(getState("Incapacitated")): setState("Staggered",0)]
[h:setState("Dazed",1)]
[h:setState("Hindered",1)]
}; 
case 4: {
[h:oldHits=getProperty('Hits')]
[h:newHits=oldHits+1]
[h:ID = getSelected()]
[h:setProperty('Hits', newHits,ID)]
[h:result="You are <b>Incapacitated</b> until you <i>Recover</i>."]
[h:setState("Staggered",0)]
[h:setState("Dazed",0)]
[h:setState("Hindered",0)]
[h:setState("Unaware",1)]
[h:setState("Stunned",1)]
[h:setState("Defenseless",1)]
[h: setState("Incapacitated",1)]
}]
<b>TOUGHNESS RESISTANCE</b><br>
[r:result]
[macro('CharacterSheet@Lib:dcfiles'):'']

!!
@@ @GMd20
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=true ; applyToSelected=true ; group=GM ; tooltip= ; minWidth= ; 
[h:abort(isGM())]
[h:Da=1d20]
[h:Mod=Roll_Modifiers]
[h:roll=Da+Mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls <i>1d20 + Mods</i>.</b></span><br>The total rolled is <b>{roll}</b>.<br> <small>({da}) d20 + {Mod}</small>.

!!
@@ @GMd20_CH
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=true ; applyToSelected=true ; group=GM ; tooltip= ; minWidth= ; 
[abort(isGM())]
[h:Da=Roll]
[h:Mod=Roll_Modifiers]
[h:roll=Da+Mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> rolls <i>1d20 + Mods</i>.</b></span><br>The total rolled is <b>{roll}</b>.<br> <small>({da}) d20 + {Mod}</small>.

!!
@@ @GMMONSTERIZE
@PROPS@ fontColor=yellow ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=black ; playerEditable=false ; applyToSelected=true ; group=GMNPC ; tooltip= ; minWidth= ; 
[abort(isGM())]
[h:ID=getSelected()]
[h:monster=input(
"NAME|"+token.name+"|Tokens name|TEXT",
"PL|1|Tokens Power Level|TEXT",
"ARCH| Supporting Character, Custom, Battlesuit, Construct, Crime Fighter, Energy Controller, Gadgeteer, Marial Artist, Mimic, Mystic, Paragon, Powerhouse, Psionic, Speedster, Shapeshifter, Warrior, Weapon-master|Token Archtype|LIST|SELECT=1"
)]

[h:setName(NAME,ID)]

[MACRO('GM_KILLRANGEDATTACK@Lib:dcfiles'):'']
[MACRO('GM_KILLH2HDATTACK@Lib:dcfiles'):'']
[MACRO('GM_KILLAFFLICTIONATTACK@Lib:dcfiles'):'']

[h,switch(ARCH),code:

case 0:{
[MACRO('GM_SUPCHAR@Lib:dcfiles'):'']

}; 
case 1:{
[MACRO('GM_CUSTOM@Lib:dcfiles'):'']

}; 
case 2:{
[MACRO('GM_BATTLESUIT@Lib:dcfiles'):'']

}; 
case 3:{
[MACRO('GM_CONSTRUCT@Lib:dcfiles'):'']

}; 
case 4:{
[MACRO('GM_CRIMEFIGHTER@Lib:dcfiles'):'']

}; 
case 5:{
[MACRO('GM_ENERGYCONTROLLER@Lib:dcfiles'):'']

}; 
case 6:{
[MACRO('GM_GADGETEER@Lib:dcfiles'):'']

}; 
case 7:{
[MACRO('GM_MARTIALARTIST@Lib:dcfiles'):'']

}; 
case 8:{
[MACRO('GM_MIMIC@Lib:dcfiles'):'']

}; 
case 9:{
[MACRO('GM_MYSTIC@Lib:dcfiles'):'']

}; 
case 10:{
[MACRO('GM_PARAGON@Lib:dcfiles'):'']

}; 
case 11:{
[MACRO('GM_POWERHOUSE@Lib:dcfiles'):'']

}; 
case 12:{
[MACRO('GM_PSIONIC@Lib:dcfiles'):'']

}; 
case 13:{
[MACRO('GM_SPEEDSTER@Lib:dcfiles'):'']

}; 
case 14:{
[MACRO('GM_SHAPESHIFTER@Lib:dcfiles'):'']

}; 
case 15:{
[MACRO('GM_WARRIOR@Lib:dcfiles'):'']

}; 
case 16:{
[MACRO('GM_WEAPONMASTER@Lib:dcfiles'):'']

}]

!!
@@ @GM_BATTLESUIT
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=2 ; color=orange ; playerEditable=false ; applyToSelected=true ; group=GMNPC ; tooltip= ; minWidth=66 ; 
[h:ID=getSelected()]

[h:Power1="Ranged Attack"]
[h:Power2="H2H Attack"]

[h:magicNUM=max(1,floor(PL/2))]

[h:RANDp=roll(1, magicNUM)]
[h:RANDn=roll(1, magicNUM)]

[h:combat0=RANDp-RANDn]
[h:combat1=-1*combat0]

[h:setProperty("Strength", PL-1+1d4)]
[h:setProperty("Stamina", 1d4-1)]
[h:setProperty("Agility", 1d4-1)]
[h:setProperty("Dexterity", 1d4)]
[h:setProperty("Fighting", (PL*2)-Strength)]
[h:setProperty("Intellect", 1d4+3)]
[h:setProperty("Awareness", 1d4)]
[h:setProperty("Presence", 1d4-2)]

[h:setProperty("Dodge", PL-1+combat0)]
[h:setProperty("Parry", PL-1+combat0)]

[h:setProperty("Toughness", PL+1+combat1)]

[h:setProperty("Fortitude", PL+combat1)]
[h:setProperty("Will", PL+combat0)]

[h:setProperty("Initiative", Agility+1d4-1d4)]

[h:setProperty("Insight", 2+1d4+Awareness)]
[h:setProperty("Perception", 1+1d4+Awareness)]
[h:setProperty("Persuasion", 1+1d4+Presence)]
[h:setProperty("Technology", 5+1d4+Intellect)]

[h:setProperty("E1",4+1d4+Intellect)]
[h:setProperty("E1Name",  "Bus, Eng, Sci")]

[h:crita1=20]
[h:modinside1="Enter_Attack_Mod"]
[h:ranka1=PL-combat0]
[h:effecta1=PL-combat1+" vs. Toughness"]

[h:macroinside1="
[h:da1=1d20]
[h,if(da1>"+(crita1-1)+"):CRIT='<b>CRITICAL!</b><br>'; CRIT='']
[h:mod="+modinside1+"]
[h:roll=da1+"+ranka1+"+mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> uses Ranged Attack.</b></span>

<br>The total rolled is <b>{roll}</b>.<br>{CRIT}  <small>({da1}) d20 +"+ranka1+" + {mod}</small>.<br><i>The attack targets </i><b>Dodge</b>.<br>

<br><b>Effect: </b><i>"+effecta1+"</i>
"]
[h:macroprops1="applyToSelected=true; autoExecute=true; color=yellow; fontColor=Black; group=Powers and Effects; minWidth=100"]

[h:createMacro('Ranged Attack',macroinside1,macroprops1,"; ")]

[h:crita2=20]
[h:modinside2="Enter_Attack_Mod"]
[h:ranka2="Fighting"]
[h:effecta2="{Strength} vs. Toughness"]

[h:macroinside2="
[h:da2=1d20]
[h,if(da2>"+(crita2-1)+"):CRIT='<b>CRITICAL!</b><br>'; CRIT='']
[h:mod="+modinside2+"]
[h:roll=da2+Fighting+mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> uses Hand-to-Hand Attack.</b></span>

<br>The total rolled is <b>{roll}</b>.<br>{CRIT}  <small>({da2}) d20 +{Fighting} + {mod}</small>.<br><i>The attack targets </i><b>Parry</b>.<br>

<br><b>Effect: </b><i>"+effecta2+"</i>
"]
[h:macroprops2="applyToSelected=true; autoExecute=true; color=yellow; fontColor=Black; group=Powers and Effects; minWidth=100"]

[h:createMacro('H2H Attack',macroinside2,macroprops2,"; ")]

 [abort(0)] <!-- Suppress output text -->

!!
@@ @GM_CONSTRUCT
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=2 ; color=orange ; playerEditable=false ; applyToSelected=true ; group=GMNPC ; tooltip= ; minWidth=66 ; 
[h:ID=getSelected()]

[h:Power1="Ranged Attack"]
[h:Power2="H2H Attack"]

[h:magicNUM=max(1,floor(PL/2))]

[h:RANDp=roll(1, magicNUM)]
[h:RANDn=roll(1, magicNUM)]

[h:combat0=RANDp-RANDn]
[h:combat1=-1*combat0]

[h:setProperty("Strength", PL-1+1d4)]
[h:setProperty("Stamina", 0)]
[h:setProperty("Agility", 1d4)]
[h:setProperty("Dexterity", 1d4)]
[h:setProperty("Fighting", (PL*2)-Strength)]
[h:setProperty("Intellect", 1d4+3)]
[h:setProperty("Awareness", 1d4-1)]
[h:setProperty("Presence", 1d4-2)]

[h:setProperty("Dodge", PL+combat0)]
[h:setProperty("Parry", PL+combat0)]

[h:setProperty("Toughness", PL+combat1)]

[h:setProperty("Fortitude", PL+combat1)]
[h:setProperty("Will", PL+combat0)]

[h:setProperty("Initiative", Agility)]

[h:setProperty("Investigation", 2+1d4+Awareness)]
[h:setProperty("Perception", 2+1d4+Awareness)]
[h:setProperty("Persuasion", 2+1d4+Presence)]
[h:setProperty("Technology", 5+1d4+Intellect)]
[h:setProperty("Vehicles", 1+1d4+Dexterity)]

[h:setProperty("E1","No")]
[h:setProperty("E1Name","New Skill")]

[h:crita1=20]
[h:modinside1="Enter_Attack_Mod"]
[h:ranka1=PL-combat0]
[h:effecta1=PL-combat1+" vs. Toughness"]

[h:macroinside1="
[h:da1=1d20]
[h,if(da1>"+(crita1-1)+"):CRIT='<b>CRITICAL!</b><br>'; CRIT='']
[h:mod="+modinside1+"]
[h:roll=da1+"+ranka1+"+mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> uses Ranged Attack.</b></span>

<br>The total rolled is <b>{roll}</b>.<br>{CRIT}  <small>({da1}) d20 +"+ranka1+" + {mod}</small>.<br><i>The attack targets </i><b>Dodge</b>.<br>

<br><b>Effect: </b><i>"+effecta1+"</i>
"]
[h:macroprops1="applyToSelected=true; autoExecute=true; color=yellow; fontColor=Black; group=Powers and Effects; minWidth=100"]

[h:createMacro('Ranged Attack',macroinside1,macroprops1,"; ")]

[h:crita2=20]
[h:modinside2="Enter_Attack_Mod"]
[h:ranka2="Fighting"]
[h:effecta2="{Strength} vs. Toughness"]

[h:macroinside2="
[h:da2=1d20]
[h,if(da2>"+(crita2-1)+"):CRIT='<b>CRITICAL!</b><br>'; CRIT='']
[h:mod="+modinside2+"]
[h:roll=da2+Fighting+mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> uses Hand-to-Hand Attack.</b></span>

<br>The total rolled is <b>{roll}</b>.<br>{CRIT}  <small>({da2}) d20 +{Fighting} + {mod}</small>.<br><i>The attack targets </i><b>Parry</b>.<br>

<br><b>Effect: </b><i>"+effecta2+"</i>
"]
[h:macroprops2="applyToSelected=true; autoExecute=true; color=yellow; fontColor=Black; group=Powers and Effects; minWidth=100"]

[h:createMacro('H2H Attack',macroinside2,macroprops2,"; ")]

 [abort(0)] <!-- Suppress output text -->

!!
@@ @GM_CRIMEFIGHTER
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=2 ; color=orange ; playerEditable=false ; applyToSelected=true ; group=GMNPC ; tooltip= ; minWidth=66 ; 
[h:ID=getSelected()]

[h:Power1="Ranged Attack"]
[h:Power2="H2H Attack"]

[h:magicNUM=max(1,floor(PL/2))]

[h:RANDp=roll(1, magicNUM)]
[h:RANDn=roll(1, magicNUM)]

[h:combat0=RANDp-RANDn]
[h:combat1=-1*combat0]

[h:setProperty("Strength", PL-6+1d4)]
[h:setProperty("Stamina", 1d4)]
[h:setProperty("Agility", 2+1d4)]
[h:setProperty("Dexterity", 2+1d4)]
[h:setProperty("Fighting", (PL*2)-(Strength+2))]
[h:setProperty("Intellect", 1+1d4)]
[h:setProperty("Awareness", 1+1d4)]
[h:setProperty("Presence", 1+1d4)]

[h:setProperty("Dodge", PL+2+combat0)]
[h:setProperty("Parry", PL+2+combat0)]

[h:setProperty("Toughness", PL-2+combat1)]

[h:setProperty("Fortitude", PL+combat1)]
[h:setProperty("Will", PL+combat0)]

[h:setProperty("Initiative", 4+Agility)]

[h:setProperty("Acrobatics",4+Agility+1d4)]
[h:setProperty("Athletics",4+Strength+1d4)]
[h:setProperty("Deception",4+Presence+1d4)]
[h:setProperty("Insight",5+Awareness+1d4)]
[h:setProperty("Intimidation",6+Presence+1d4)]
[h:setProperty("Investigation",6+Intellect+1d4)]
[h:setProperty("Perception",4+Awareness+1d4)]

[h:setProperty("SleightofHand",3+Dexterity+1d4)]
[h:setProperty("Stealth",6+Agility+1d4)]
[h:setProperty("Technology",Intellect+1d4)]

[h:setProperty("Vehicles",2+Dexterity+1d4)]

[h:setProperty("E1",4+Intellect+1d4)]
[h:setProperty("E1Name","Choose")]

[h:crita1=20]

[h:modinside1="Enter_Attack_Mod"]
[h:ranka1=PL+4+combat0]
[h:effecta1=PL-4+combat1+" vs. Toughness"]

[h:macroinside1="
[h:da1=1d20]
[h,if(da1>"+(crita1-1)+"):CRIT='<b>CRITICAL!</b><br>'; CRIT='']
[h:mod="+modinside1+"]
[h:roll=da1+"+ranka1+"+mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> uses Ranged Attack.</b></span>

<br>The total rolled is <b>{roll}</b>.<br>{CRIT}  <small>({da1}) d20 +"+ranka1+" + {mod}</small>.<br><i>The attack targets </i><b>Dodge</b>.<br>

<br><b>Effect: </b><i>"+effecta1+"</i>
"]
[h:macroprops1="applyToSelected=true; autoExecute=true; color=yellow; fontColor=Black; group=Powers and Effects; minWidth=100"]

[h:createMacro('Ranged Attack',macroinside1,macroprops1,"; ")]

[h:crita2=20]
[h:modinside2="Enter_Attack_Mod"]
[h:ranka2="Fighting"]
[h:effecta2="{Strength+2} vs. Toughness"]

[h:macroinside2="
[h:da2=1d20]
[h,if(da2>"+(crita2-1)+"):CRIT='<b>CRITICAL!</b><br>'; CRIT='']
[h:mod="+modinside2+"]
[h:roll=da2+Fighting+mod]
<span bgcolor=#cccccc><b>{getPlayerName()}</b> uses Hand-to-Hand Attack.</b></span>

<br>The total rolled is <b>{roll}</b>.<br>{CRIT}  <small>({da2}) d20 +{Fighting} + {mod}</small>.<br><i>The attack targets </i><b>Parry</b>.<br>

<br><b>Effect: </b><i>"+effecta2+"</i>
"]
[h:macroprops2="applyToSelected=true; autoExecute=true; color=yellow; fontColor=Black; group=Powers and Effects; minWidth=100"]

[h:createMacro('H2H Attack',macroinside2,macroprops2,"; ")]

 [abort(0)] <!-- Suppress output text -->

!!
@@ @GM_CUSTOM
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=1 ; color=orange ; playerEditable=false ; applyToSelected=true ; group=GMNPC ; tooltip= ; minWidth=66 ; 
/self

[h:setProperty("Strength", Set_Strength)]
[h:setProperty("Stamina", Set_Stamina)]
[h:setProperty("Agility", Set_Agility)]
[h:setProperty("Dexterity", Set_Dexterity)]
[h:setProperty("Fighting", Set_Fighting)]
[h:setProperty("Intellect", Set_Intellect)]
[h:setProperty("Awareness", Set_Awareness)]
[h:setProperty("Presence", Set_Presence)]
[h:setProperty("Dodge", Set_Dodge)]
[h:setProperty("Parry", Set_Parry)]
[h:setProperty("Fortitude", Set_Fortitude)]
[h:setProperty("Toughness", Set_Toughness)]
[h:setProperty("Will", Set_Will)]
[h:setProperty("Initiative", Set_Initiative)]

[h:setProperty("Acrobatics", Set_Acrobatics)]
[h:setProperty("Athletics", Set_Athletics)]
[h:setProperty("Deception", Set_Deception)]
[h:setProperty("Insight", Set_Insight)]
[h:setProperty("Intimidation", Set_Intimidation)]
[h:setProperty("Investigation", Set_Investigation)]
[h:setProperty("Perception", Set_Perception)]
[h:setProperty("Persuasion", Set_Persuasion)]
[h:setProperty("SleightofHand", Set_SleightofHand)]
[h:setProperty("Stealth", Set_Stealth)]
[h:setProperty("Technology", Set_Technology)]
[h:setProperty("Treatment", Set_Treatment)]
[h:setProperty("Vehicles", Set_Vehicles)]

[h:setProperty("E1", Set_Expertise1)]
[h:setProperty("E1Name", Set_Expertise1_Name)]
[abort(isGM())]
 [abort(0)] <!-- Suppress output text -->

!!
@@ @GM_ENERGYCONTROLLER
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=2 ; color=orange ; playerEditable=false ; applyToSelected=true ; group=GMNPC ; tooltip= ; minWidth=66 ; 
/self

[h:setProperty("Strength", Set_Strength)]
[h:setProperty("Stamina", Set_Stamina)]
[h:setProperty("Agility", Set_Agility)]
[h:setProperty("Dexterity", Set_Dexterity)]
[h:setProperty("Fighting", Set_Fighting)]
[h:setProperty("Intellect", Set_Intellect)]
[h:setProperty("Awareness", Set_Awareness)]
[h:setProperty("Presence", Set_Presence)]
[h:setProperty("Dodge", Set_Dodge)]
[h:setProperty("Parry", Set_Parry)]
[h:setProperty("Fortitude", Set_Fortitude)]
[h:setProperty("Toughness", Set_Toughness)]
[h:setProperty("Will", Set_Will)]
[h:setProperty("Initiative", Set_Initiative)]

[h:setProperty("Acrobatics", Set_Acrobatics)]
[h:setProperty("Athletics", Set_Athletics)]
[h:setProperty("Deception", Set_Deception)]
[h:setProperty("Insight", Set_Insight)]
[h:setProperty("Intimidation", Set_Intimidation)]
[h:setProperty("Investigation", Set_Investigation)]
[h:setProperty("Perception", Set_Perception)]
[h:setProperty("Persuasion", Set_Persuasion)]
[h:setProperty("SleightofHand", Set_SleightofHand)]
[h:setProperty("Stealth", Set_Stealth)]
[h:setProperty("Technology", Set_Technology)]
[h:setProperty("Treatment", Set_Treatment)]
[h:setProperty("Vehicles", Set_Vehicles)]

[h:setProperty("Expertise-1", Set_Expertise1)]
[h:setProperty("E1Name", Set_Expertise1_Name)]

 [abort(0)] <!-- Suppress output text -->

!!
@@ @GM_GADGETEER
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=2 ; color=orange ; playerEditable=false ; applyToSelected=true ; group=GMNPC ; tooltip= ; minWidth=66 ; 
/self

[h:setProperty("Strength", Set_Strength)]
[h:setProperty("Stamina", Set_Stamina)]
[h:setProperty("Agility", Set_Agility)]
[h:setProperty("Dexterity", Set_Dexterity)]
[h:setProperty("Fighting", Set_Fighting)]
[h:setProperty("Intellect", Set_Intellect)]
[h:setProperty("Awareness", Set_Awareness)]
[h:setProperty("Presence", Set_Presence)]
[h:setProperty("Dodge", Set_Dodge)]
[h:setProperty("Parry", Set_Parry)]
[h:setProperty("Fortitude", Set_Fortitude)]
[h:setProperty("Toughness", Set_Toughness)]
[h:setProperty("Will", Set_Will)]
[h:setProperty("Initiative", Set_Initiative)]

[h:setProperty("Acrobatics", Set_Acrobatics)]
[h:setProperty("Athletics", Set_Athletics)]
[h:setProperty("Deception", Set_Deception)]
[h:setProperty("Insight", Set_Insight)]
[h:setProperty("Intimidation", Set_Intimidation)]
[h:setProperty("Investigation", Set_Investigation)]
[h:setProperty("Perception", Set_Perception)]
[h:setProperty("Persuasion", Set_Persuasion)]
[h:setProperty("SleightofHand", Set_SleightofHand)]
[h:setProperty("Stealth", Set_Stealth)]
[h:setProperty("Technology", Set_Technology)]
[h:setProperty("Treatment", Set_Treatment)]
[h:setProperty("Vehicles", Set_Vehicles)]

[h:setProperty("Expertise-1", Set_Expertise1)]
[h:setProperty("E1Name", Set_Expertise1_Name)]

 [abort(0)] <!-- Suppress output text -->

!!
@@ @GM_KILLAFFLICTIONATTACK
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=9999 ; color=yellow ; playerEditable=false ; applyToSelected=true ; group=GMNPC ; tooltip= ; minWidth= ; 
[abort(isGM())]
[h:ID=getSelected()]
[h:CLEAR=getMacroIndexes(Power3)]

[h,if(Power3==''),CODE:{}; {
[h:removeMacro(CLEAR,ID)]}]

!!
@@ @GM_KILLH2HDATTACK
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=9999 ; color=yellow ; playerEditable=false ; applyToSelected=true ; group=GMNPC ; tooltip= ; minWidth= ; 
[abort(isGM())]
[h:ID=getSelected()]

[h:CLEAR=getMacroIndexes(Power2)]

[h,if(Power2==''),CODE:{}; {
[h:removeMacro(CLEAR,ID)]}]

!!
@@ @GM_KILLRANGEDATTACK
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=9999 ; color=yellow ; playerEditable=false ; applyToSelected=true ; group=GMNPC ; tooltip= ; minWidth= ; 
[abort(isGM())]
[h:ID=getSelected()]
[h:CLEAR=getMacroIndexes(Power1)]

[h,if(Power1==''),CODE:{}; {
[h:removeMacro(CLEAR,ID)]}]

!!
@@ @GM_MARTIALARTIST
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=2 ; color=orange ; playerEditable=false ; applyToSelected=true ; group=GMNPC ; tooltip= ; minWidth=66 ; 
/self

[h:setProperty("Strength", Set_Strength)]
[h:setProperty("Stamina", Set_Stamina)]
[h:setProperty("Agility", Set_Agility)]
[h:setProperty("Dexterity", Set_Dexterity)]
[h:setProperty("Fighting", Set_Fighting)]
[h:setProperty("Intellect", Set_Intellect)]
[h:setProperty("Awareness", Set_Awareness)]
[h:setProperty("Presence", Set_Presence)]
[h:setProperty("Dodge", Set_Dodge)]
[h:setProperty("Parry", Set_Parry)]
[h:setProperty("Fortitude", Set_Fortitude)]
[h:setProperty("Toughness", Set_Toughness)]
[h:setProperty("Will", Set_Will)]
[h:setProperty("Initiative", Set_Initiative)]

[h:setProperty("Acrobatics", Set_Acrobatics)]
[h:setProperty("Athletics", Set_Athletics)]
[h:setProperty("Deception", Set_Deception)]
[h:setProperty("Insight", Set_Insight)]
[h:setProperty("Intimidation", Set_Intimidation)]
[h:setProperty("Investigation", Set_Investigation)]
[h:setProperty("Perception", Set_Perception)]
[h:setProperty("Persuasion", Set_Persuasion)]
[h:setProperty("SleightofHand", Set_SleightofHand)]
[h:setProperty("Stealth", Set_Stealth)]
[h:setProperty("Technology", Set_Technology)]
[h:setProperty("Treatment", Set_Treatment)]
[h:setProperty("Vehicles", Set_Vehicles)]

[h:setProperty("Expertise-1", Set_Expertise1)]
[h:setProperty("E1Name", Set_Expertise1_Name)]

 [abort(0)] <!-- Suppress output text -->

!!
@@ @GM_MIMIC
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=2 ; color=orange ; playerEditable=false ; applyToSelected=true ; group=GMNPC ; tooltip= ; minWidth=66 ; 
/self

[h:setProperty("Strength", Set_Strength)]
[h:setProperty("Stamina", Set_Stamina)]
[h:setProperty("Agility", Set_Agility)]
[h:setProperty("Dexterity", Set_Dexterity)]
[h:setProperty("Fighting", Set_Fighting)]
[h:setProperty("Intellect", Set_Intellect)]
[h:setProperty("Awareness", Set_Awareness)]
[h:setProperty("Presence", Set_Presence)]
[h:setProperty("Dodge", Set_Dodge)]
[h:setProperty("Parry", Set_Parry)]
[h:setProperty("Fortitude", Set_Fortitude)]
[h:setProperty("Toughness", Set_Toughness)]
[h:setProperty("Will", Set_Will)]
[h:setProperty("Initiative", Set_Initiative)]

[h:setProperty("Acrobatics", Set_Acrobatics)]
[h:setProperty("Athletics", Set_Athletics)]
[h:setProperty("Deception", Set_Deception)]
[h:setProperty("Insight", Set_Insight)]
[h:setProperty("Intimidation", Set_Intimidation)]
[h:setProperty("Investigation", Set_Investigation)]
[h:setProperty("Perception", Set_Perception)]
[h:setProperty("Persuasion", Set_Persuasion)]
[h:setProperty("SleightofHand", Set_SleightofHand)]
[h:setProperty("Stealth", Set_Stealth)]
[h:setProperty("Technology", Set_Technology)]
[h:setProperty("Treatment", Set_Treatment)]
[h:setProperty("Vehicles", Set_Vehicles)]

[h:setProperty("Expertise-1", Set_Expertise1)]
[h:setProperty("E1Name", Set_Expertise1_Name)]

 [abort(0)] <!-- Suppress output text -->

!!
@@ @GM_MYSTIC
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=2 ; color=orange ; playerEditable=false ; applyToSelected=true ; group=GMNPC ; tooltip= ; minWidth=66 ; 
/self

[h:setProperty("Strength", Set_Strength)]
[h:setProperty("Stamina", Set_Stamina)]
[h:setProperty("Agility", Set_Agility)]
[h:setProperty("Dexterity", Set_Dexterity)]
[h:setProperty("Fighting", Set_Fighting)]
[h:setProperty("Intellect", Set_Intellect)]
[h:setProperty("Awareness", Set_Awareness)]
[h:setProperty("Presence", Set_Presence)]
[h:setProperty("Dodge", Set_Dodge)]
[h:setProperty("Parry", Set_Parry)]
[h:setProperty("Fortitude", Set_Fortitude)]
[h:setProperty("Toughness", Set_Toughness)]
[h:setProperty("Will", Set_Will)]
[h:setProperty("Initiative", Set_Initiative)]

[h:setProperty("Acrobatics", Set_Acrobatics)]
[h:setProperty("Athletics", Set_Athletics)]
[h:setProperty("Deception", Set_Deception)]
[h:setProperty("Insight", Set_Insight)]
[h:setProperty("Intimidation", Set_Intimidation)]
[h:setProperty("Investigation", Set_Investigation)]
[h:setProperty("Perception", Set_Perception)]
[h:setProperty("Persuasion", Set_Persuasion)]
[h:setProperty("SleightofHand", Set_SleightofHand)]
[h:setProperty("Stealth", Set_Stealth)]
[h:setProperty("Technology", Set_Technology)]
[h:setProperty("Treatment", Set_Treatment)]
[h:setProperty("Vehicles", Set_Vehicles)]

[h:setProperty("Expertise-1", Set_Expertise1)]
[h:setProperty("E1Name", Set_Expertise1_Name)]

 [abort(0)] <!-- Suppress output text -->

!!
@@ @GM_PARAGON
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=2 ; color=orange ; playerEditable=false ; applyToSelected=true ; group=GMNPC ; tooltip= ; minWidth=66 ; 
/self

[h:setProperty("Strength", Set_Strength)]
[h:setProperty("Stamina", Set_Stamina)]
[h:setProperty("Agility", Set_Agility)]
[h:setProperty("Dexterity", Set_Dexterity)]
[h:setProperty("Fighting", Set_Fighting)]
[h:setProperty("Intellect", Set_Intellect)]
[h:setProperty("Awareness", Set_Awareness)]
[h:setProperty("Presence", Set_Presence)]
[h:setProperty("Dodge", Set_Dodge)]
[h:setProperty("Parry", Set_Parry)]
[h:setProperty("Fortitude", Set_Fortitude)]
[h:setProperty("Toughness", Set_Toughness)]
[h:setProperty("Will", Set_Will)]
[h:setProperty("Initiative", Set_Initiative)]

[h:setProperty("Acrobatics", Set_Acrobatics)]
[h:setProperty("Athletics", Set_Athletics)]
[h:setProperty("Deception", Set_Deception)]
[h:setProperty("Insight", Set_Insight)]
[h:setProperty("Intimidation", Set_Intimidation)]
[h:setProperty("Investigation", Set_Investigation)]
[h:setProperty("Perception", Set_Perception)]
[h:setProperty("Persuasion", Set_Persuasion)]
[h:setProperty("SleightofHand", Set_SleightofHand)]
[h:setProperty("Stealth", Set_Stealth)]
[h:setProperty("Technology", Set_Technology)]
[h:setProperty("Treatment", Set_Treatment)]
[h:setProperty("Vehicles", Set_Vehicles)]

[h:setProperty("Expertise-1", Set_Expertise1)]
[h:setProperty("E1Name", Set_Expertise1_Name)]

 [abort(0)] <!-- Suppress output text -->

!!
@@ @GM_POWERHOUSE
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=2 ; color=orange ; playerEditable=false ; applyToSelected=true ; group=GMNPC ; tooltip= ; minWidth=66 ; 
/self

[h:setProperty("Strength", Set_Strength)]
[h:setProperty("Stamina", Set_Stamina)]
[h:setProperty("Agility", Set_Agility)]
[h:setProperty("Dexterity", Set_Dexterity)]
[h:setProperty("Fighting", Set_Fighting)]
[h:setProperty("Intellect", Set_Intellect)]
[h:setProperty("Awareness", Set_Awareness)]
[h:setProperty("Presence", Set_Presence)]
[h:setProperty("Dodge", Set_Dodge)]
[h:setProperty("Parry", Set_Parry)]
[h:setProperty("Fortitude", Set_Fortitude)]
[h:setProperty("Toughness", Set_Toughness)]
[h:setProperty("Will", Set_Will)]
[h:setProperty("Initiative", Set_Initiative)]

[h:setProperty("Acrobatics", Set_Acrobatics)]
[h:setProperty("Athletics", Set_Athletics)]
[h:setProperty("Deception", Set_Deception)]
[h:setProperty("Insight", Set_Insight)]
[h:setProperty("Intimidation", Set_Intimidation)]
[h:setProperty("Investigation", Set_Investigation)]
[h:setProperty("Perception", Set_Perception)]
[h:setProperty("Persuasion", Set_Persuasion)]
[h:setProperty("SleightofHand", Set_SleightofHand)]
[h:setProperty("Stealth", Set_Stealth)]
[h:setProperty("Technology", Set_Technology)]
[h:setProperty("Treatment", Set_Treatment)]
[h:setProperty("Vehicles", Set_Vehicles)]

[h:setProperty("Expertise-1", Set_Expertise1)]
[h:setProperty("E1Name", Set_Expertise1_Name)]

 [abort(0)] <!-- Suppress output text -->

!!
@@ @GM_PSIONIC
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=2 ; color=orange ; playerEditable=false ; applyToSelected=true ; group=GMNPC ; tooltip= ; minWidth=66 ; 
/self

[h:setProperty("Strength", Set_Strength)]
[h:setProperty("Stamina", Set_Stamina)]
[h:setProperty("Agility", Set_Agility)]
[h:setProperty("Dexterity", Set_Dexterity)]
[h:setProperty("Fighting", Set_Fighting)]
[h:setProperty("Intellect", Set_Intellect)]
[h:setProperty("Awareness", Set_Awareness)]
[h:setProperty("Presence", Set_Presence)]
[h:setProperty("Dodge", Set_Dodge)]
[h:setProperty("Parry", Set_Parry)]
[h:setProperty("Fortitude", Set_Fortitude)]
[h:setProperty("Toughness", Set_Toughness)]
[h:setProperty("Will", Set_Will)]
[h:setProperty("Initiative", Set_Initiative)]

[h:setProperty("Acrobatics", Set_Acrobatics)]
[h:setProperty("Athletics", Set_Athletics)]
[h:setProperty("Deception", Set_Deception)]
[h:setProperty("Insight", Set_Insight)]
[h:setProperty("Intimidation", Set_Intimidation)]
[h:setProperty("Investigation", Set_Investigation)]
[h:setProperty("Perception", Set_Perception)]
[h:setProperty("Persuasion", Set_Persuasion)]
[h:setProperty("SleightofHand", Set_SleightofHand)]
[h:setProperty("Stealth", Set_Stealth)]
[h:setProperty("Technology", Set_Technology)]
[h:setProperty("Treatment", Set_Treatment)]
[h:setProperty("Vehicles", Set_Vehicles)]

[h:setProperty("Expertise-1", Set_Expertise1)]
[h:setProperty("E1Name", Set_Expertise1_Name)]

 [abort(0)] <!-- Suppress output text -->

!!
@@ @GM_SHAPESHIFTER
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=2 ; color=orange ; playerEditable=false ; applyToSelected=true ; group=GMNPC ; tooltip= ; minWidth=66 ; 
/self

[h:setProperty("Strength", Set_Strength)]
[h:setProperty("Stamina", Set_Stamina)]
[h:setProperty("Agility", Set_Agility)]
[h:setProperty("Dexterity", Set_Dexterity)]
[h:setProperty("Fighting", Set_Fighting)]
[h:setProperty("Intellect", Set_Intellect)]
[h:setProperty("Awareness", Set_Awareness)]
[h:setProperty("Presence", Set_Presence)]
[h:setProperty("Dodge", Set_Dodge)]
[h:setProperty("Parry", Set_Parry)]
[h:setProperty("Fortitude", Set_Fortitude)]
[h:setProperty("Toughness", Set_Toughness)]
[h:setProperty("Will", Set_Will)]
[h:setProperty("Initiative", Set_Initiative)]

[h:setProperty("Acrobatics", Set_Acrobatics)]
[h:setProperty("Athletics", Set_Athletics)]
[h:setProperty("Deception", Set_Deception)]
[h:setProperty("Insight", Set_Insight)]
[h:setProperty("Intimidation", Set_Intimidation)]
[h:setProperty("Investigation", Set_Investigation)]
[h:setProperty("Perception", Set_Perception)]
[h:setProperty("Persuasion", Set_Persuasion)]
[h:setProperty("SleightofHand", Set_SleightofHand)]
[h:setProperty("Stealth", Set_Stealth)]
[h:setProperty("Technology", Set_Technology)]
[h:setProperty("Treatment", Set_Treatment)]
[h:setProperty("Vehicles", Set_Vehicles)]

[h:setProperty("Expertise-1", Set_Expertise1)]
[h:setProperty("E1Name", Set_Expertise1_Name)]

 [abort(0)] <!-- Suppress output text -->

!!
@@ @GM_SPEEDSTER
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=2 ; color=orange ; playerEditable=false ; applyToSelected=true ; group=GMNPC ; tooltip= ; minWidth=66 ; 
/self

[h:setProperty("Strength", Set_Strength)]
[h:setProperty("Stamina", Set_Stamina)]
[h:setProperty("Agility", Set_Agility)]
[h:setProperty("Dexterity", Set_Dexterity)]
[h:setProperty("Fighting", Set_Fighting)]
[h:setProperty("Intellect", Set_Intellect)]
[h:setProperty("Awareness", Set_Awareness)]
[h:setProperty("Presence", Set_Presence)]
[h:setProperty("Dodge", Set_Dodge)]
[h:setProperty("Parry", Set_Parry)]
[h:setProperty("Fortitude", Set_Fortitude)]
[h:setProperty("Toughness", Set_Toughness)]
[h:setProperty("Will", Set_Will)]
[h:setProperty("Initiative", Set_Initiative)]

[h:setProperty("Acrobatics", Set_Acrobatics)]
[h:setProperty("Athletics", Set_Athletics)]
[h:setProperty("Deception", Set_Deception)]
[h:setProperty("Insight", Set_Insight)]
[h:setProperty("Intimidation", Set_Intimidation)]
[h:setProperty("Investigation", Set_Investigation)]
[h:setProperty("Perception", Set_Perception)]
[h:setProperty("Persuasion", Set_Persuasion)]
[h:setProperty("SleightofHand", Set_SleightofHand)]
[h:setProperty("Stealth", Set_Stealth)]
[h:setProperty("Technology", Set_Technology)]
[h:setProperty("Treatment", Set_Treatment)]
[h:setProperty("Vehicles", Set_Vehicles)]

[h:setProperty("Expertise-1", Set_Expertise1)]
[h:setProperty("E1Name", Set_Expertise1_Name)]

 [abort(0)] <!-- Suppress output text -->

!!
@@ @GM_WARRIOR
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=2 ; color=orange ; playerEditable=false ; applyToSelected=true ; group=GMNPC ; tooltip= ; minWidth=66 ; 
/self

[h:setProperty("Strength", Set_Strength)]
[h:setProperty("Stamina", Set_Stamina)]
[h:setProperty("Agility", Set_Agility)]
[h:setProperty("Dexterity", Set_Dexterity)]
[h:setProperty("Fighting", Set_Fighting)]
[h:setProperty("Intellect", Set_Intellect)]
[h:setProperty("Awareness", Set_Awareness)]
[h:setProperty("Presence", Set_Presence)]
[h:setProperty("Dodge", Set_Dodge)]
[h:setProperty("Parry", Set_Parry)]
[h:setProperty("Fortitude", Set_Fortitude)]
[h:setProperty("Toughness", Set_Toughness)]
[h:setProperty("Will", Set_Will)]
[h:setProperty("Initiative", Set_Initiative)]

[h:setProperty("Acrobatics", Set_Acrobatics)]
[h:setProperty("Athletics", Set_Athletics)]
[h:setProperty("Deception", Set_Deception)]
[h:setProperty("Insight", Set_Insight)]
[h:setProperty("Intimidation", Set_Intimidation)]
[h:setProperty("Investigation", Set_Investigation)]
[h:setProperty("Perception", Set_Perception)]
[h:setProperty("Persuasion", Set_Persuasion)]
[h:setProperty("SleightofHand", Set_SleightofHand)]
[h:setProperty("Stealth", Set_Stealth)]
[h:setProperty("Technology", Set_Technology)]
[h:setProperty("Treatment", Set_Treatment)]
[h:setProperty("Vehicles", Set_Vehicles)]

[h:setProperty("Expertise-1", Set_Expertise1)]
[h:setProperty("E1Name", Set_Expertise1_Name)]

 [abort(0)] <!-- Suppress output text -->

!!
@@ @GM_WEAPONMASTER
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=2 ; color=orange ; playerEditable=false ; applyToSelected=true ; group=GMNPC ; tooltip= ; minWidth=66 ; 
/self

[h:setProperty("Strength", Set_Strength)]
[h:setProperty("Stamina", Set_Stamina)]
[h:setProperty("Agility", Set_Agility)]
[h:setProperty("Dexterity", Set_Dexterity)]
[h:setProperty("Fighting", Set_Fighting)]
[h:setProperty("Intellect", Set_Intellect)]
[h:setProperty("Awareness", Set_Awareness)]
[h:setProperty("Presence", Set_Presence)]
[h:setProperty("Dodge", Set_Dodge)]
[h:setProperty("Parry", Set_Parry)]
[h:setProperty("Fortitude", Set_Fortitude)]
[h:setProperty("Toughness", Set_Toughness)]
[h:setProperty("Will", Set_Will)]
[h:setProperty("Initiative", Set_Initiative)]

[h:setProperty("Acrobatics", Set_Acrobatics)]
[h:setProperty("Athletics", Set_Athletics)]
[h:setProperty("Deception", Set_Deception)]
[h:setProperty("Insight", Set_Insight)]
[h:setProperty("Intimidation", Set_Intimidation)]
[h:setProperty("Investigation", Set_Investigation)]
[h:setProperty("Perception", Set_Perception)]
[h:setProperty("Persuasion", Set_Persuasion)]
[h:setProperty("SleightofHand", Set_SleightofHand)]
[h:setProperty("Stealth", Set_Stealth)]
[h:setProperty("Technology", Set_Technology)]
[h:setProperty("Treatment", Set_Treatment)]
[h:setProperty("Vehicles", Set_Vehicles)]

[h:setProperty("Expertise-1", Set_Expertise1)]
[h:setProperty("E1Name", Set_Expertise1_Name)]

 [abort(0)] <!-- Suppress output text -->

!!
@@ @GM_SUPCHAR
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=999 ; color=green ; playerEditable=false ; applyToSelected=false ; group=GMSUPCHARACTERS ; tooltip= ; minWidth= ; 


!!
@@ @XPower1
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=true ; group=Powers ; tooltip= ; minWidth= ; 
[h:status=input('safety|n,y|Are you certain you wish to delete '+Power1+'?|RADIO|ORIENT=H')]
[h:namekeeper=Power1]
[h:CLEAR=getMacroIndexes(Power1)]
[r,if(safety==0),CODE:{}; {
[h:removeMacro(CLEAR)]
[h:Power1=0]
<b>{namekeeper}</b> has been removed <br>from {token.name} by <i>{getPlayerName()}</i>.
}]

[macro('CharacterSheet@Lib:dcfiles'):'']

!!
@@ @XPower10
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=true ; group=Powers ; tooltip= ; minWidth= ; 
[h:status=input('safety|n,y|Are you certain you wish to delete '+Power10+'?|RADIO|ORIENT=H')]
[h:namekeeper=Power10]
[h:CLEAR=getMacroIndexes(Power10)]
[h,if(safety==0),CODE:{}; {
[h:removeMacro(CLEAR)]
[h:Power10=0]
<b>{namekeeper}</b> has been removed <br>from {token.name} by <i>{getPlayerName()}</i>.
}]

[macro('CharacterSheet@Lib:dcfiles'):'']

!!
@@ @XPower11
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=true ; group=Powers ; tooltip= ; minWidth= ; 
[h:status=input('safety|n,y|Are you certain you wish to delete '+Power11+'?|RADIO|ORIENT=H')]
[h:namekeeper=Power11]
[h:CLEAR=getMacroIndexes(Power11)]
[h,if(safety==0),CODE:{}; {
[h:removeMacro(CLEAR)]
[h:Power11='']
<b>{namekeeper}</b> has been removed <br>from {token.name} by <i>{getPlayerName()}</i>.
}]

[macro('CharacterSheet@Lib:dcfiles'):'']

!!
@@ @XPower12
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=true ; group=Powers ; tooltip= ; minWidth= ; 
[h:status=input('safety|n,y|Are you certain you wish to delete '+Power12+'?|RADIO|ORIENT=H')]
[h:namekeeper=Power12]
[h:CLEAR=getMacroIndexes(Power12)]
[h,if(safety==0),CODE:{}; {
[h:removeMacro(CLEAR)]
[h:Power12=0]
<b>{namekeeper}</b> has been removed <br>from {token.name} by <i>{getPlayerName()}</i>.
}]

[macro('CharacterSheet@Lib:dcfiles'):'']

!!
@@ @XPower13
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=true ; group=Powers ; tooltip= ; minWidth= ; 
[h:status=input('safety|n,y|Are you certain you wish to delete '+Power13+'?|RADIO|ORIENT=H')]
[h:namekeeper=Power13]
[h:CLEAR=getMacroIndexes(Power13)]
[h,if(safety==0),CODE:{}; {
[h:removeMacro(CLEAR)]
[h:Power13=0]
<b>{namekeeper}</b> has been removed <br>from {token.name} by <i>{getPlayerName()}</i>.
}]

[macro('CharacterSheet@Lib:dcfiles'):'']

!!
@@ @XPower14
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=true ; group=Powers ; tooltip= ; minWidth= ; 
[h:status=input('safety|n,y|Are you certain you wish to delete '+Power14+'?|RADIO|ORIENT=H')]
[h:namekeeper=Power14]
[h:CLEAR=getMacroIndexes(Power14)]
[h,if(safety==0),CODE:{}; {
[h:removeMacro(CLEAR)]
[h:Power14=0]
<b>{namekeeper}</b> has been removed <br>from {token.name} by <i>{getPlayerName()}</i>.
}]

[macro('CharacterSheet@Lib:dcfiles'):'']

!!
@@ @XPower15
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=true ; group=Powers ; tooltip= ; minWidth= ; 
[h:status=input('safety|n,y|Are you certain you wish to delete '+Power15+'?|RADIO|ORIENT=H')]
[h:namekeeper=Power15]
[h:CLEAR=getMacroIndexes(Power15)]
[h,if(safety==0),CODE:{}; {
[h:removeMacro(CLEAR)]
[h:Power15=0]
<b>{namekeeper}</b> has been removed <br>from {token.name} by <i>{getPlayerName()}</i>.
}]

[macro('CharacterSheet@Lib:dcfiles'):'']

!!
@@ @XPower16
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=true ; group=Powers ; tooltip= ; minWidth= ; 
[h:status=input('safety|n,y|Are you certain you wish to delete '+Power16+'?|RADIO|ORIENT=H')]
[h:namekeeper=Power16]
[h:CLEAR=getMacroIndexes(Power16)]
[h,if(safety==0),CODE:{}; {
[h:removeMacro(CLEAR)]
[h:Power16=0]
<b>{namekeeper}</b> has been removed <br>from {token.name} by <i>{getPlayerName()}</i>.
}]

[macro('CharacterSheet@Lib:dcfiles'):'']

!!
@@ @XPower17
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=true ; group=Powers ; tooltip= ; minWidth= ; 
[h:status=input('safety|n,y|Are you certain you wish to delete '+Power17+'?|RADIO|ORIENT=H')]
[h:namekeeper=Power17]
[h:CLEAR=getMacroIndexes(Power17)]
[h,if(safety==0),CODE:{}; {
[h:removeMacro(CLEAR)]
[h:Power17=0]
<b>{namekeeper}</b> has been removed <br>from {token.name} by <i>{getPlayerName()}</i>.
}]

[macro('CharacterSheet@Lib:dcfiles'):'']

!!
@@ @XPower18
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=true ; group=Powers ; tooltip= ; minWidth= ; 
[h:status=input('safety|n,y|Are you certain you wish to delete '+Power18+'?|RADIO|ORIENT=H')]
[h:namekeeper=Power18]
[h:CLEAR=getMacroIndexes(Power18)]
[h,if(safety==0),CODE:{}; {
[h:removeMacro(CLEAR)]
[h:Power18=0]
<b>{namekeeper}</b> has been removed <br>from {token.name} by <i>{getPlayerName()}</i>.
}]

[macro('CharacterSheet@Lib:dcfiles'):'']

!!
@@ @XPower2
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=true ; group=Powers ; tooltip= ; minWidth= ; 
[h:status=input('safety|n,y|Are you certain you wish to delete '+Power2+'?|RADIO|ORIENT=H')]
[h:namekeeper=Power2]
[h:CLEAR=getMacroIndexes(Power2)]
[h,if(safety==0),CODE:{}; {
[h:removeMacro(CLEAR)]
[h:Power2=0]
<b>{namekeeper}</b> has been removed <br>from {token.name} by <i>{getPlayerName()}</i>.
}]

[macro('CharacterSheet@Lib:dcfiles'):'']

!!
@@ @XPower3
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=true ; group=Powers ; tooltip= ; minWidth= ; 
[h:status=input('safety|n,y|Are you certain you wish to delete '+Power3+'?|RADIO|ORIENT=H')]
[h:namekeeper=Power3]
[h:CLEAR=getMacroIndexes(Power3)]
[h,if(safety==0),CODE:{}; {
[h:removeMacro(CLEAR)]
[h:Power3=0]
<b>{namekeeper}</b> has been removed <br>from {token.name} by <i>{getPlayerName()}</i>.
}]

[macro('CharacterSheet@Lib:dcfiles'):'']

!!
@@ @XPower4
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=true ; group=Powers ; tooltip= ; minWidth= ; 
[h:status=input('safety|n,y|Are you certain you wish to delete '+Power4+'?|RADIO|ORIENT=H')]
[h:namekeeper=Power4]
[h:CLEAR=getMacroIndexes(Power4)]
[h,if(safety==0),CODE:{}; {
[h:removeMacro(CLEAR)]
[h:Power4=0]
<b>{namekeeper}</b> has been removed <br>from {token.name} by <i>{getPlayerName()}</i>.
}]

[macro('CharacterSheet@Lib:dcfiles'):'']

!!
@@ @XPower5
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=true ; group=Powers ; tooltip= ; minWidth= ; 
[h:status=input('safety|n,y|Are you certain you wish to delete '+Power5+'?|RADIO|ORIENT=H')]
[h:namekeeper=Power5]
[h:CLEAR=getMacroIndexes(Power5)]
[h,if(safety==0),CODE:{''}; {
[h:Power5=0]
[h:removeMacro(CLEAR)]
<b>{namekeeper}</b> has been removed <br>from {token.name} by <i>{getPlayerName()}</i>.
}]

[macro('CharacterSheet@Lib:dcfiles'):'']

!!
@@ @XPower6
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=true ; group=Powers ; tooltip= ; minWidth= ; 
[h:status=input('safety|n,y|Are you certain you wish to delete '+Power6+'?|RADIO|ORIENT=H')]
[h:namekeeper=Power6]
[h:CLEAR=getMacroIndexes(Power6)]
[h,if(safety==0),CODE:{}; {
[h:removeMacro(CLEAR)]
[h:Power6=0]
<b>{namekeeper}</b> has been removed <br>from {token.name} by <i>{getPlayerName()}</i>.
}]

[macro('CharacterSheet@Lib:dcfiles'):'']

!!
@@ @XPower7
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=true ; group=Powers ; tooltip= ; minWidth= ; 
[h:status=input('safety|n,y|Are you certain you wish to delete '+Power7+'?|RADIO|ORIENT=H')]
[h:namekeeper=Power7]
[h:CLEAR=getMacroIndexes(Power7)]
[h,if(safety==0),CODE:{}; {
[h:removeMacro(CLEAR)]
[h:Power7=0]
<b>{namekeeper}</b> has been removed <br>from {token.name} by <i>{getPlayerName()}</i>.
}]

[macro('CharacterSheet@Lib:dcfiles'):'']

!!
@@ @XPower8
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=true ; group=Powers ; tooltip= ; minWidth= ; 
[h:status=input('safety|n,y|Are you certain you wish to delete '+Power8+'?|RADIO|ORIENT=H')]
[h:namekeeper=Power8]
[h:CLEAR=getMacroIndexes(Power8)]
[h,if(safety==0),CODE:{}; {
[h:removeMacro(CLEAR)]
[h:Power8=0]
<b>{namekeeper}</b> has been removed <br>from {token.name} by <i>{getPlayerName()}</i>.
}]

[macro('CharacterSheet@Lib:dcfiles'):'']

!!
@@ @XPower9
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=true ; group=Powers ; tooltip= ; minWidth= ; 
[h:status=input('safety|n,y|Are you certain you wish to delete '+Power9+'?|RADIO|ORIENT=H')]
[h:namekeeper=Power9]
[h:CLEAR=getMacroIndexes(Power9)]
[h,if(safety==0),CODE:{}; {
[h:removeMacro(CLEAR)]
[h:Power9=0]
<b>{namekeeper}</b> has been removed <br>from {token.name} by <i>{getPlayerName()}</i>.
}]

[macro('CharacterSheet@Lib:dcfiles'):'']

!!