@@ @onCampaignLoad
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet ; tooltip= ; minWidth= ; 
[h:defineFunction("pause", "pause@"+getMacroLocation(), 1, 0 ) ] 
[h:defineFunction("die100", "die100@"+getMacroLocation(), 0, 0 ) ]
[h:defineFunction("CharSheet", "CharSheet@"+getMacroLocation(), 0, 0)]
[h:defineFunction("StatsSheet","StatsSheet@"+getMacroLocation(), 0, 0)]
[h:defineFunction("SkillsSheet","SkillsSheet@"+getMacroLocation(), 0, 0)]
[h:defineFunction("PowersSheet","PowersSheet@"+getMacroLocation(), 0, 0)]
[h:defineFunction("MuseSheet","MuseSheet@"+getMacroLocation(), 0, 0)]
[h:defineFunction("CombatSheet","CombatSheet@"+getMacroLocation(), 0, 0)]
[h:defineFunction("RecalcTopSheet","RecalcTopSheet@"+getMacroLocation(), 0, 0)]
[h:defineFunction("RecalcBottomSheet","RecalcBottomSheet@"+getMacroLocation(), 0, 0)]
[h: selectedCount=listCount(getSelected())]
[frame("Sheet"):{
<html>
<link rel="onChangeSelection" type="macro" href="[r: macroLinkText('SheetLoad@this', 'none','fromClick','selected')]"></link>
<head><title>Character Sheet</title></head>
<body>
			<table width="100%">
				<tr>
					<td align="center"><image src='[r: tableImage("Icons",1,300)]' border="0" align="middle"></image><br>
						<font size = "5"><b>Loaded<br>Please select a token you own</b></font>
					</td>
				</tr>
			</table>
		}
	]
</body>
</html>
}]

!!
@@ @AptitudesDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
<table width="100%" cellpadding="0" border="1" bgcolor="white">
<table border="0" cellpadding="2" width="100%">

	<tr bgcolor="[r: table(PageColor,2)]">
		<td  valign="middle" colspan="2">&nbsp; &nbsp; <font color="white"><b>APTITUDES</b></font>
		</td>
		<td  align="right" colspan="2"><a href='[r:macroLinkText("AptitudesUpdateDialog@this","none","", currentToken())]'><image src='[r: tableImage("Buttons", 5)]' border="0" align="middle"></image></a>&nbsp; 
		</td>		
	</tr>[h: num = 1]
[h: abilityList = "COG,COO,INT,REF,SAV,SOM,WIL"]
[foreach(abl, abilityList,""),code:{

[if(roll.count == 0||roll.count==4),code:{<tr>}; {}]
		<td>
			<table width="100%">
				[h:jsonData=json.set("{}","targetNumber",getProperty(abl)*3,"mods",0,"rollerName",getName(currentToken()),"rollTitle",strformat("default %s Aptitude check",abl))]
				<tr><td bgcolor="[r: table(PageColor,2)]" color="white" align="center" width="100%"><font color="white"><b><a href='[r:macroLinkText("die100@this","all",jsonData, currentToken())]'>[r: table("Aptitudes",num)]</a></b>
					</td>
				</tr>
				<tr>
		[h: jsonData = json.append("[]",abl,strformat(" %s Aptitude check",abl),"Aptitude")]	<td align="center" width="100%" bgcolor="[r: table(PageColor,3)]"><font color="black"><a href='[r:macroLinkText("Entry@this","none",jsonData, currentToken())]'><b>[r: getProperty(abl)]</b></font></a>
					</td>
				</tr>
			</table>
		</td>

[if(roll.count == 3||roll.count==7),code:{</tr>}; {}]
[h: num = num+1]
}]
				</tr>
			</table>
		</td>
	</tr>
</table>

!!
@@ @MuseAptitudesDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
<table width="100%" cellpadding="0" border="1" bgcolor="white">
<table border="0" cellpadding="2" width="100%">

	<tr bgcolor="[r: table(PageColor,2)]">
		<td  valign="middle" colspan="2">&nbsp; &nbsp; <font color="white"><b>MUSE APTITUDES</b></font>
		</td>
		<td  align="right" colspan="2"><a href='[r:macroLinkText("MuseAptitudesUpdateDialog@this","none","", currentToken())]'><image src='[r: tableImage("Buttons", 5)]' border="0" align="middle"></image></a>&nbsp; 
		</td>		
	</tr>[h: num = 1]
[h: abilityList = "COG,COO,INT,REF,SAV,SOM,WIL"]
[foreach(abl, abilityList,""),code:{
  [h:museAbl = abl+"_Muse"]
  [if(roll.count == 0||roll.count==4),code:{<tr>}; {}]
		<td>
			<table width="100%">
				[h:jsonData=json.set("{}","targetNumber",getProperty(museAbl)*3,"mods",0,"rollerName",getName(currentToken()),"rollTitle",strformat("default %s Muse Aptitude check",museAbl),"useWounds",0,"useTrauma",0,"useArmorPenalty",0)]
				<tr>
          <td bgcolor="[r: table(PageColor,2)]" color="white" align="center" width="100%">
            <font color="white"><b><a href='[r:macroLinkText("die100@this","all",jsonData, currentToken())]'>[r: table("Aptitudes",num)]</a></b>
					</td>
				</tr>
				<tr>
        [h: jsonData = json.append("[]",museAbl,strformat(" %s Muse Aptitude check",museAbl),"MuseAptitude")]	
          <td align="center" width="100%" bgcolor="[r: table(PageColor,3)]">
            <font color="black"><a href='[r:macroLinkText("Entry@this","none",jsonData, currentToken())]'><b>[r: getProperty(museAbl)]</b></font></a>
					</td>
				</tr>
			</table>
		</td>

[if(roll.count == 3||roll.count==7),code:{</tr>}; {}]
[h: num = num+1]
}]
				</tr>
			</table>
		</td>
	</tr>
</table>

!!
@@ @StatsDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
<table width="100%" cellpadding="0" border="1" bgcolor="white">
<table border="0" cellpadding="2" width="100%">

	<tr bgcolor="[r: table(PageColor,2)]">
		<td  valign="middle" colspan="2">&nbsp; &nbsp; <font color="white"><b>STATS</b></font>
		</td>
		<td  align="right" colspan="3"><a href='[r:macroLinkText("StatsUpdateDialog@this","none","", currentToken())]'><image src='[r: tableImage("Buttons", 5)]' border="0" align="middle"></image></a>&nbsp; 
		</td>		
	</tr>
  <tr>
    <td>
			<table width="100%">
				[h:jsonData=json.set("{}","rollerName",getName(currentToken()))]
				<tr>
          <td bgcolor="[r: table(PageColor,2)]" color="white" align="center" width="100%">
            <font color="white"><b><a href='[r:macroLinkText("UseMoxie@this","all",jsonData,currentToken())]'>[r: strformat("MOX (%s)",getProperty("MOX_base"))]</a></b></font>
					</td>
				</tr>
				<tr>
          [h: jsonData = json.append("[]","MOX",getProperty("MOX"),"Moxie",getName(currentToken()))]	
          <td align="center" width="100%" bgcolor="[r: table(PageColor,3)]">
            <font color="black"><a href='[r:macroLinkText("Entry@this","none",jsonData, currentToken())]'><b>[r: getProperty("MOX")]</b></font></a>
					</td>
				</tr>
			</table>
		</td>
    [h: statList = "TT,LUC,IR,WT,DUR,DR,INIT,SPD,DB"]    
    [h: num = 2]
    [foreach(stat, statList,""),code:{

    [if(roll.count==4),code:{<tr>}; {}]
		<td>
			<table width="100%">
				[h:jsonData=json.append("[]",stat)]
				<tr>
          <td bgcolor="[r: table(PageColor,2)]" color="white" align="center" width="100%">
            <font color="white"><b><a href='[r:macroLinkText("StatsInfoDisplay@this","none",jsonData, currentToken())]'>[r: table("Stats",num)]</a></b></font>
					</td>
				</tr>
				<tr>
          <td align="center" width="100%" bgcolor="[r: table(PageColor,3)]">
            <font color="black"><b>[r: getProperty(stat)]</b></font>
					</td>
				</tr>
			</table>
		</td>

    [if(roll.count == 4||roll.count==9),code:{</tr>}; {}]
    [h: num = num+1]
    }]
				</tr>
			</table>
		</td>
	</tr>
</table>

!!
@@ @MuseStatsDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
<table width="100%" cellpadding="0" border="1" bgcolor="white">
<table border="0" cellpadding="2" width="100%">

	<tr bgcolor="[r: table(PageColor,2)]">
		<td  valign="middle" colspan="2">&nbsp; &nbsp; <font color="white"><b>MUSE STATS</b></font>
		</td>
		<td  align="right" colspan="3"><a href='[r:macroLinkText("MuseStatsUpdateDialog@this","none","", currentToken())]'><image src='[r: tableImage("Buttons", 5)]' border="0" align="middle"></image></a>&nbsp; 
		</td>		
	</tr>
  <tr>
    [h: statList = "TT_Muse,LUC_Muse,IR_Muse"]    
    [h: num = 2]
    [foreach(stat, statList,""),code:{

    [if(roll.count==4),code:{<tr>}; {}]
		<td>
			<table width="100%">
				[h:jsonData=json.append("[]",stat)]
				<tr>
          <td bgcolor="[r: table(PageColor,2)]" color="white" align="center" width="100%">
            <font color="white"><b><a href='[r:macroLinkText("MuseStatsInfoDisplay@this","none",jsonData, currentToken())]'>[r: table("Stats",num)]</a></b></font>
					</td>
				</tr>
				<tr>
          <td align="center" width="100%" bgcolor="[r: table(PageColor,3)]">
            <font color="black"><b>[r: getProperty(stat)]</b></font>
					</td>
				</tr>
			</table>
		</td>

    [if(roll.count == 4||roll.count==9),code:{</tr>}; {}]
    [h: num = num+1]
    }]
				</tr>
			</table>
		</td>
	</tr>
</table>

!!
@@ @DamageStressDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
<table width="100%" cellpadding="0" border="1" bgcolor="white">
<table border="0" cellpadding="2" width="100%">

	<tr bgcolor="[r: table(PageColor,2)]">
		<td  valign="middle" colspan="2">&nbsp; &nbsp; <font color="white"><b><a href='[r:macroLinkText("DerangementDisorderInfoDisplay@this","none","",currentToken())]'>DAMAGE & STRESS</a></b></font>
		</td>
		<td  align="right" colspan="2"><a href='[r:macroLinkText("DamageStressUpdateDialog@this","none","", currentToken())]'><image src='[r: tableImage("Buttons", 5)]' border="0" align="middle"></image></a>&nbsp; 
		</td>		
	</tr>[h: num = 1]
[h: statList = "DAMAGE,WOUNDS,STRESS,TRAUMA"]
[foreach(stat, statList,""),code:{

[if(roll.count == 0||roll.count==5),code:{<tr>}; {}]
		<td>
			<table width="100%">
				[h:jsonData=json.append("[]",stat)]
				<tr>
          <td bgcolor="[r: table(PageColor,2)]" color="white" align="center" width="100%">
            <font color="white"><b><a href='[r:macroLinkText("DamageStressInfoDisplay@this","none",jsonData, currentToken())]'>[r: table("DamageStress",num)]</a></b>
					</td>
				</tr>
				<tr>
          <td align="center" width="100%" bgcolor="[r: table(PageColor,3)]">
            [h:jsonData=json.append("[]",stat)]
            <font color="black"><a href='[r:macroLinkText("DSUpdate@this","all",jsonData,currentToken())]'><b>[r: getProperty(stat)]</b></font></a>
					</td>
				</tr>
			</table>
		</td>

[if(roll.count == 4||roll.count==9),code:{</tr>}; {}]
[h: num = num+1]
}]
				</tr>
			</table>
		</td>
	</tr>
</table>

!!
@@ @RepDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
<table width="100%" cellpadding="0" border="1" bgcolor="white">
<table border="0" cellpadding="2" width="100%">

	<tr bgcolor="[r: table(PageColor,2)]">
		<td valign="middle" colspan="2">
      &nbsp; &nbsp; <font color="white"><b><a href='[r:macroLinkText("ReputationInfoDisplay@this","none","",currentToken())]'>REPUTATION</a></b></font>
		</td>
		<td align="right" colspan="2"><a href='[r:macroLinkText("RepUpdateDialog@this","none","", currentToken())]'><image src='[r: tableImage("Buttons", 5)]' border="0" align="middle"></image></a>&nbsp; 
		</td>		
	</tr>[h: num = 1]
[h: statList = "A-Rep,c-Rep,e-Rep,f-Rep,g-Rep,i-Rep,r-Rep"]
[foreach(stat, statList,""),code:{

[if(roll.count == 0||roll.count==4),code:{<tr>}; {}]
		<td>
			<table width="100%">
				<tr>
          [h:jsonData=json.set("{}","repName",stat,"repFavors",getProperty(stat+"_favors"),"rollerName",getName(currentToken()))]
          <td bgcolor="[r: table(PageColor,2)]" color="white" align="center" width="100%">
            <font color="white"><b><a href='[r:macroLinkText("UseFavor@this","all",jsonData, currentToken())]'>[r: table("Rep",num)]</a></b>
					</td>
				</tr>
				<tr>
          [h: jsonData = json.append("[]",stat,getProperty(stat),"Rep", getName(currentToken()))]	
          <td align="center" width="100%" bgcolor="[r: table(PageColor,3)]">
            <font color="black"><a href='[r:macroLinkText("Entry@this","none",jsonData, currentToken())]'><b>[r: getProperty(stat)]</b></font></a>
					</td>
				</tr>
			</table>
		</td>

[if(roll.count == 3||roll.count==7),code:{</tr>}; {}]
[h: num = num+1]
}]
				</tr>
			</table>
		</td>
	</tr>
</table>

!!
@@ @EgoTraitsDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
<table border="0" cellpadding="2" width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td valign="middle">&nbsp; &nbsp; <font color="white"><b>EGO TRAITS</b></font>
		</td>
		<td width="5%">
			<a href='[r:macroLinkText("EgoTraitsShowUpdate@this","none","",currentToken())]'><image src='[r: tableImage("OpenClose", getProperty("EgoTraitsShow"))]' border="0" align="middle"></image></a>&nbsp; 
		</td>
	</tr>
[if(EgoTraitsShow),code:
{
</table>
<table border="0" cellpadding="2" width="100%">
	[h: color = table(PageColor,4)]
  [h,if(json.isEmpty(EgoTraits)): propList = ""; propList = json.fields(EgoTraits)]
  [h: propList=listSort(propList,"A")]
  [foreach(prop, propList, ""), code: 
  {
	<tr bgcolor="[r: color]">
		<td width="100%">
      [h: propDetails = json.get(EgoTraits, prop)]
      [h: jsonData = json.append("[]", prop, json.get(propDetails, 0))]<font color="black"><a href='[r:macroLinkText("EgoTraitsUpdateDisplay@this","none",jsonData,currentToken())]'>[r: prop]</a></font>
		</td>
	</tr>
  [h: colorcheck = table(PageColor,4)]
  [h, if(color == colorcheck): color = "white"; color = colorcheck]
  }]
	<tr bgcolor="[r:table(PageColor,3)]">
		<td>
			<b><center><font color="black">[h: jsonData = json.append("[]", "New Ego Trait", encode(""))]<a href='[r:macroLinkText("EgoTraitsUpdateDialog@this","none",jsonData,currentToken())]'>Add New Ego Trait</a></font></center></b>
		</td>
	</tr>
</table>
}
; 
{</table>}
]

!!
@@ @PsiSleightsDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
<table border="0" cellpadding="2" width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td valign="middle">&nbsp; &nbsp; <font color="white"><b>PSI SLEIGHTS</b></font>
		</td>
		<td width="5%">
			<a href='[r:macroLinkText("PsiSleightsShowUpdate@this","none","",currentToken())]'><image src='[r: tableImage("OpenClose", getProperty("PsiSleightsShow"))]' border="0" align="middle"></image></a>&nbsp; 
		</td>
	</tr>
[if(PsiSleightsShow),code:
{
</table>
<table border="0" cellpadding="2" width="100%">
	[h: color = table(PageColor,4)]
  [h,if(json.isEmpty(PsiSleights)): propList = ""; propList = json.fields(PsiSleights)]
  [h: propList=listSort(propList,"A")]
  [foreach(prop, propList, ""), code: 
  {
	<tr bgcolor="[r: color]">
    [h: propDetails = json.get(PsiSleights, prop)]
    <td width="10%" align="center">
      [h: jsonData = json.append("[]", getName(currentToken()), prop, json.get(propDetails, 0), json.get(propDetails,1), json.get(propDetails,2))]
      <a href='[r:macroLinkText("PsiSleightsUse@this","none",jsonData,currentToken())]'>use</a>
    </td>
		<td width="80%">
      [h: jsonData = json.append("[]", prop, json.get(propDetails, 0), json.get(propDetails, 1), json.get(propDetails, 2))]
      <font color="black"><a href='[r:macroLinkText("PsiSleightsUpdateDisplay@this","none",jsonData,currentToken())]'>[r: prop]</a></font>
		</td>
	</tr>
  [h: colorcheck = table(PageColor,4)]
  [h, if(color == colorcheck): color = "white"; color = colorcheck]
  }]
	<tr bgcolor="[r:table(PageColor,3)]">
		<td colspan="2">
			<b><center><font color="black">[h: jsonData = json.append("[]", "New Psi Sleight", encode(""), "0", "DV")]<a href='[r:macroLinkText("PsiSleightsUpdateDialog@this","none",jsonData,currentToken())]'>Add Psi Sleight Trait</a></font></center></b>
		</td>
	</tr>
</table>
}
; 
{</table>}
]

!!
@@ @GearDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
<table border="0" cellpadding="2" width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td valign="middle">&nbsp; &nbsp; <font color="white"><b>GEAR</b></font>
		</td>
		<td width="5%">
			<a href='[r:macroLinkText("GearShowUpdate@this","none","",currentToken())]'><image src='[r: tableImage("OpenClose", getProperty("GearShow"))]' border="0" align="middle"></image></a>&nbsp; 
		</td>
	</tr>
[if(GearShow),code:
{
</table>
<table border="0" cellpadding="2" width="100%">
	[h: color = table(PageColor,4)]
  [h,if(json.isEmpty(Gear)): propList = ""; propList = json.fields(Gear)]
  [h: propList=listSort(propList,"A")]
  [foreach(prop, propList, ""), code: 
  {
	<tr bgcolor="[r: color]">
		<td width="100%">
      [h: propDetails = json.get(Gear, prop)]
      [h: jsonData = json.append("[]", prop, json.get(propDetails, 0))]<font color="black"><a href='[r:macroLinkText("GearUpdateDisplay@this","none",jsonData,currentToken())]'>[r: prop]</a></font>
		</td>
	</tr>
  [h: colorcheck = table(PageColor,4)]
  [h, if(color == colorcheck): color = "white"; color = colorcheck]
  }]
	<tr bgcolor="[r:table(PageColor,3)]">
		<td>
			<b><center><font color="black">[h: jsonData = json.append("[]", "New Gear", encode(""))]<a href='[r:macroLinkText("GearUpdateDialog@this","none",jsonData,currentToken())]'>Add Gear</a></font></center></b>
		</td>
	</tr>
</table>
}
; 
{</table>}
]

!!
@@ @MorphTraitsDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
<table border="0" cellpadding="2" width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td valign="middle">&nbsp; &nbsp; <font color="white"><b>MORPH TRAITS</b></font>
		</td>
		<td width="5%">
			<a href='[r:macroLinkText("MorphTraitsShowUpdate@this","none","",currentToken())]'><image src='[r: tableImage("OpenClose", getProperty("MorphTraitsShow"))]' border="0" align="middle"></image></a>&nbsp; 
		</td>
	</tr>
[if(MorphTraitsShow),code:
{
</table>
<table border="0" cellpadding="2" width="100%">
	[h: color = table(PageColor,4)]
  [h,if(json.isEmpty(MorphTraits)): propList = ""; propList = json.fields(MorphTraits)]
  [h: propList=listSort(propList,"A")]
  [foreach(prop, propList, ""), code: 
  {
	<tr bgcolor="[r: color]">
		<td width="100%">
      [h: propDetails = json.get(MorphTraits, prop)]
      [h: jsonData = json.append("[]", prop, json.get(propDetails, 0))]<font color="black"><a href='[r:macroLinkText("MorphTraitsUpdateDisplay@this","none",jsonData,currentToken())]'>[r: prop]</a></font>
		</td>
	</tr>
  [h: colorcheck = table(PageColor,4)]
  [h, if(color == colorcheck): color = "white"; color = colorcheck]
  }]
	<tr bgcolor="[r:table(PageColor,3)]">
		<td>
			<b><center><font color="black">[h: jsonData = json.append("[]", "New Morph Trait", encode(""))]<a href='[r:macroLinkText("MorphTraitsUpdateDialog@this","none",jsonData,currentToken())]'>Add New Morph Trait</a></font></center></b>
		</td>
	</tr>
</table>
}
; 
{</table>}
]

!!
@@ @ImplantsEnhancementsDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
<table border="0" cellpadding="2" width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td valign="middle">&nbsp; &nbsp; <font color="white"><b>IMPLANTS & ENHANCEMENTS</b></font>
		</td>
		<td width="5%">
			<a href='[r:macroLinkText("ImplantsEnhancementsShowUpdate@this","none","",currentToken())]'><image src='[r: tableImage("OpenClose", getProperty("ImplantsEnhancementsShow"))]' border="0" align="middle"></image></a>&nbsp; 
		</td>
	</tr>
[if(ImplantsEnhancementsShow),code:
{
</table>
<table border="0" cellpadding="2" width="100%">
	[h: color = table(PageColor,4)]
  [h,if(json.isEmpty(ImplantsEnhancements)): propList = ""; propList = json.fields(ImplantsEnhancements)]
  [h: propList=listSort(propList,"A")]
  [foreach(prop, propList, ""), code: 
  {
	<tr bgcolor="[r: color]">
		<td width="100%">
      [h: propDetails = json.get(ImplantsEnhancements, prop)]
      [h: jsonData = json.append("[]", prop, json.get(propDetails, 0))]<font color="black"><a href='[r:macroLinkText("ImplantsEnhancementsUpdateDisplay@this","none",jsonData,currentToken())]'>[r: prop]</a></font>
		</td>
	</tr>
  [h: colorcheck = table(PageColor,4)]
  [h, if(color == colorcheck): color = "white"; color = colorcheck]
  }]
	<tr bgcolor="[r:table(PageColor,3)]">
		<td>
			<b><center><font color="black">[h: jsonData = json.append("[]", "New Implant or Enhancement", encode(""))]<a href='[r:macroLinkText("ImplantsEnhancementsUpdateDialog@this","none",jsonData,currentToken())]'>Add New Implant or Enhancement</a></font></center></b>
		</td>
	</tr>
</table>
}
; 
{</table>}
]

!!
@@ @CombatDefenseDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
[h: frayArray = json.get(ActiveSkills,"Fray")]
[h: frayRating = json.get(frayArray, 0) + json.get(frayArray, 1)]
[h: fraySpec = json.get(frayArray, 4)]
[h: freeArray = json.get(ActiveSkills,"Freerunning")]
[h: freeRating = json.get(freeArray, 0) + json.get(freeArray, 1)]
[h: freeSpec = json.get(freeArray, 4)]
[h: bladeArray = json.get(ActiveSkills,"Blades")]
[h: bladeRating = json.get(bladeArray, 0) + json.get(bladeArray, 1)]
[h: bladeSpec = json.get(bladeArray, 4)]
[h: clubArray = json.get(ActiveSkills,"Clubs")]
[h: clubRating = json.get(clubArray, 0) + json.get(clubArray, 1)]
[h: clubSpec = json.get(clubArray, 4)]
[h: unarmedArray = json.get(ActiveSkills,"Unarmed Combat")]
[h: unarmedRating = json.get(unarmedArray, 0) + json.get(unarmedArray, 1)]
[h: unarmedSpec = json.get(unarmedArray, 4)]

<!-- Loop through all ActiveSkills looking for Exotic Melee -->
[h: tmpArray = json.fields(ActiveSkills, "json")]
[h: exoticArray = "[]"]
[h,foreach(tmp,tmpArray,""), code:
  {
    [h,if(indexOf(tmp,"Exotic Melee:") != -1): exoticArray = json.append(exoticArray,json.append("[]",tmp,json.get(ActiveSkills,tmp))); ""]
  }
]

<table border="0" cellpadding="0" width="100%">
	<tr bgcolor="[r: table(PageColor,2)]" align="center">
    <td colspan="4"> 
      <font color="white"><b>DEFENSES</b></font>
    </td>
    <td width="5%">
			<a href='[r:macroLinkText("DefenseShowUpdate@this","none","",currentToken())]'><image src='[r: tableImage("OpenClose", getProperty("DefenseShow"))]' border="0" align="middle"></image></a>&nbsp; 
		</td>
  </tr>
  
[if(DefenseShow),code:
{
  
[h: useColor = "white")]
[h,if(useColor == "white"): useColor = table(PageColor,4); useColor = "white"]  
  <tr bgcolor="[r: useColor]">
    <td valign="middle">
      &nbsp; &nbsp;<b>ARMOR</b>
		</td>
		<td align="center" width="15%">
			<b>Energy</b>
		</td>
    <td align="center" width="15%">
			<b>Kinetic</b>
		</td>
		<td align="center" width="15%">
			<b>Penalty</b>
		</td>
  </tr> 
[h,if(useColor == "white"): useColor = table(PageColor,4); useColor = "white"]  
  <tr bgcolor="[r: useColor]">
    <td valign="middle">
      &nbsp; &nbsp;<a href='[r:macroLinkText("EditArmor@this","none","",currentToken())]'>(edit)</a>
		</td>
		<td align="center" width="15%">
			[r: Armor_Energy]
		</td>
    <td align="center" width="15%">
			[r: Armor_Kinetic]
		</td>
		<td align="center" width="15%">
			[r: Armor_Penalty]
		</td>
  </tr>  
[h,if(useColor == "white"): useColor = table(PageColor,4); useColor = "white"]  
  <tr bgcolor="[r: useColor]" align="center">
    <td colspan="4">
      <b>SKILLS</b>
    </td>
  </tr>
[h,if(useColor == "white"): useColor = table(PageColor,4); useColor = "white"]  
  <tr bgcolor="[r: useColor]">
    <td valign="middle">
      &nbsp; &nbsp; <b>NAME</b>
		</td>
		<td align="center" width="15%">
			<b>Spec.</b>
		</td>
    <td align="center" width="15%">
			<b>Aptitude</b>
		</td>
		<td align="right" width="15%">
			<b>Total</b>&nbsp;
		</td>
  </tr>
[h,if(useColor == "white"): useColor = table(PageColor,4); useColor = "white"]  
  <tr bgcolor="[r: useColor]">
    <td valign="middle">
      &nbsp; &nbsp; <a href='[r:macroLinkText("DefenseCheck@this","all",json.set("{}","skillName","Fray"),currentToken())]'>Fray</a>
		</td>
    <td align="center" width="15%">
			[r,if(length(fraySpec) > 0): fraySpec; "None"]
		</td>
    <td align="center" width="15%">
			<a href='[r:macroLinkText("DefenseCheck@this","all",json.set("{}","skillName","Fray","useApt",1),currentToken())]'>REF [r: REF]</a>
		</td>
		<td align="right" width="15%">
			<a href='[r:macroLinkText("Entry@this","none", json.append("[]","Fray",0,"Defense"), currentToken())]'>+[r: frayRating]</a>&nbsp;
		</td>
  </tr>
[h,if(useColor == "white"): useColor = table(PageColor,4); useColor = "white"]    
  <tr bgcolor="[r: useColor]">
    <td valign="middle">
      &nbsp; &nbsp; <a href='[r:macroLinkText("DefenseCheck@this","all",json.set("{}","skillName","Freerunning"),currentToken())]'>Freerunning</a>
		</td>
    <td align="center" width="15%">
			[r,if(length(freeSpec) > 0): freeSpec; "None"]
		</td>
    <td align="center" width="15%">
			<a href='[r:macroLinkText("DefenseCheck@this","all",json.set("{}","skillName","Freerunning","useApt",1),currentToken())]'>SOM [r: SOM]</a>
		</td>
		<td align="right" width="15%">
			<a href='[r:macroLinkText("Entry@this","none", json.append("[]","Freerunning",0,"Defense"), currentToken())]'>+[r: freeRating]</a>&nbsp;
		</td>
  </tr>
[h,if(useColor == "white"): useColor = table(PageColor,4); useColor = "white"]      
  <tr bgcolor="[r: useColor]">
    <td valign="middle">
      &nbsp; &nbsp; <a href='[r:macroLinkText("DefenseCheck@this","all",json.set("{}","skillName","Blades"),currentToken())]'>Blades</a>
		</td>
    <td align="center" width="15%">
			[r,if(length(bladeSpec) > 0): bladeSpec; "None"]
		</td>
    <td align="center" width="15%">
			<a href='[r:macroLinkText("DefenseCheck@this","all",json.set("{}","skillName","Blades","useApt",1),currentToken())]'>SOM [r: SOM]</a>
		</td>
		<td align="right" width="15%">
			<a href='[r:macroLinkText("Entry@this","none", json.append("[]","Blades",0,"Defense"), currentToken())]'>+[r: bladeRating]</a>&nbsp;
		</td>    
  </tr>
[h,if(useColor == "white"): useColor = table(PageColor,4); useColor = "white"]      
  <tr bgcolor="[r: useColor]">
    <td valign="middle">
      &nbsp; &nbsp; <a href='[r:macroLinkText("DefenseCheck@this","all",json.set("{}","skillName","Clubs"),currentToken())]'>Clubs</a>
		</td>
    <td align="center" width="15%">
			[r,if(length(clubSpec) > 0): clubSpec; "None"]
		</td>
    <td align="center" width="15%">
			<a href='[r:macroLinkText("DefenseCheck@this","all",json.set("{}","skillName","Clubs","useApt",1),currentToken())]'>SOM [r: SOM]</a>
		</td>
		<td align="right" width="15%">
			<a href='[r:macroLinkText("Entry@this","none", json.append("[]","Clubs",0,"Defense"), currentToken())]'>+[r: clubRating]</a>&nbsp;
		</td>
  </tr>
[h,if(useColor == "white"): useColor = table(PageColor,4); useColor = "white"]   
  <tr bgcolor="[r: useColor]">
    <td valign="middle">
      &nbsp; &nbsp; <a href='[r:macroLinkText("DefenseCheck@this","all",json.set("{}","skillName","Unarmed Combat"),currentToken())]'>Unarmed Combat</a>
		</td>
    <td align="center" width="15%">
			[r,if(length(unarmedSpec) > 0): unarmedSpec; "None"]
		</td>
    <td align="center" width="15%">
			<a href='[r:macroLinkText("DefenseCheck@this","all",json.set("{}","skillName","Unarmed Combat","useApt",1),currentToken())]'>SOM [r: SOM]</a>
		</td>
		<td align="right" width="15%">
			<a href='[r:macroLinkText("Entry@this","none", json.append("[]","Unarmed Combat",0,"Defense"), currentToken())]'>+[r: unarmedRating]</a>&nbsp;
		</td>    
  </tr>
[foreach(tmp2,exoticArray,""), code:
  {
  [h,if(useColor == "white"): useColor = table(PageColor,4); useColor = "white"]
  [h: loopSpec = json.get(json.get(tmp2,1),4)]
  <tr bgcolor="[r: useColor]">
    <td valign="middle">
      &nbsp; &nbsp; <a href='[r:macroLinkText("DefenseCheck@this","all",json.set("{}","skillName",json.get(tmp2,0)),currentToken())]'>[r: json.get(tmp2,0)]</a>
		</td>
    <td align="center" width="15%">
			[r,if(length(loopSpec) > 0): loopSpec; "None"]
		</td>
    <td align="center" width="15%">
			<a href='[r:macroLinkText("DefenseCheck@this","all",json.set("{}","skillName",json.get(tmp2,0),"useApt",1),currentToken())]'>SOM [r: SOM]</a>
		</td>
		<td align="right" width="15%">
			<a href='[r:macroLinkText("Entry@this","none", json.append("[]",json.get(tmp2,0),0,"Defense"), currentToken())]'>+[r: json.get(json.get(tmp2,1),0) + json.get(json.get(tmp2,1),1)]</a>&nbsp;
		</td>
  </tr>
  }
]
[h,if(useColor == "white"): useColor = table(PageColor,4); useColor = "white"]
  <tr bgcolor="[r: useColor]" align="center">
    <td colspan="4">
      <b>PSI DEFENSE</b>
    </td> 
  </tr>
[h,if(useColor == "white"): useColor = table(PageColor,4); useColor = "white"]
  <tr bgcolor="[r: useColor]">
    <td valign="middle">
      &nbsp; &nbsp; <a href='[r:macroLinkText("OtherDefenseCheck@this","all",json.set("{}","otherDefense","Psi"),currentToken())]'>WIL ([r: WIL])</a>
		</td>
    <td align="center" width="45%" colspan="3">
			<a href='[r:macroLinkText("Entry@this","none", json.append("[]","Psi",0,"OtherDefense"), currentToken())]'>[r: WIL * 2] (x2)</a>
		</td>
  </tr>
[h,if(useColor == "white"): useColor = table(PageColor,4); useColor = "white"]
  <tr bgcolor="[r: useColor]" align="center">
    [h:jsonData=json.append("[]","SHOCK DAMAGE")]
    <td colspan="4">
      <a href='[r:macroLinkText("DamageStressInfoDisplay@this","none",jsonData, currentToken())]'><b>SHOCK DEFENSE</b></a> (DUR - Damage + Energy Armor)
    </td> 
  </tr>
[h,if(useColor == "white"): useColor = table(PageColor,4); useColor = "white"]
  <tr bgcolor="[r: useColor]">
    <td valign="middle">
      &nbsp; &nbsp; <a href='[r:macroLinkText("OtherDefenseCheck@this","all",json.set("{}","otherDefense","Shock"),currentToken())]'>DUR ([r: DUR])</a>
		</td>
    <td align="center" width="45%" colspan="3">
			<a href='[r:macroLinkText("Entry@this","none", json.append("[]","Shock",0,"OtherDefense"), currentToken())]'>[r: DUR - DAMAGE + Armor_Energy]</a>
		</td>
  </tr>  
[h,if(useColor == "white"): useColor = table(PageColor,4); useColor = "white"]
  <tr bgcolor="[r: useColor]" align="center">
    <td colspan="4">
      <b>WOUNDS suffered from same hit: 1 = knockdown, 2 = unconscious</b>
    </td> 
  </tr> 
[h,if(useColor == "white"): useColor = table(PageColor,4); useColor = "white"]   
  <tr bgcolor="[r: useColor]">
    <td valign="middle">
      &nbsp; &nbsp; <a href='[r:macroLinkText("OtherDefenseCheck@this","all",json.set("{}","otherDefense","SOM x 3"),currentToken())]'>SOM x 3</a>
		</td>
    <td align="center" width="45%" colspan="3">
			<a href='[r:macroLinkText("Entry@this","none", json.append("[]","SOM x 3",0,"OtherDefense"), currentToken())]'>[r: SOM * 3]</a>
		</td>
  </tr>  
[h,if(useColor == "white"): useColor = table(PageColor,4); useColor = "white"]
  <tr bgcolor="[r: useColor]" align="center">
    <td colspan="4">
      <b>Wound Threshold (WT)</b> = [r: WT]&nbsp; &nbsp; &nbsp; &nbsp; <b>Death Rating (DR)</b> = [r: DR]
    </td> 
  </tr>   
</table>  
};
{</table>} 
]

!!
@@ @WeaponDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
[h: color = table(PageColor,4)]
[h,if(json.isEmpty(Weapons)): propList = ""; propList = json.fields(Weapons)]
[foreach(prop, propList, ""), code: 
{
  [h: jsonWeap = json.get(Weapons,prop)]
  [h, if(color == "white"): color = table(PageColor,4); color = "white"]
  <tr bgcolor="[r: color]">
    <td align="left">
      [h: jsonData = json.append("[]", prop, json.get(jsonWeap, 7))]
      &nbsp; <font color="black"><a href='[r:macroLinkText("WeaponDescriptionDisplay@this","none",jsonData,currentToken())]'><b>[r: prop]</b></a></font>
    </td>
    <td align="center">
      [r: json.get(jsonWeap,0)]
    </td>
    <td align="center">
      [r: json.get(jsonWeap,1)]
    </td>		
    <td align="center">
      [r: json.toList(json.get(jsonWeap,2),"/")]
    </td>
    <td align="center">
      <a href='[r:macroLinkText("WeaponReload@this","all",prop,currentToken())]'>[r: json.get(jsonWeap,3) + "/" + json.get(jsonWeap,4)]</a>
    </td>
    <td align="center">
      [h:jsonData=json.set("{}","weapName",prop)]
      <a href='[r:macroLinkText("WeaponCheck@this","all", jsonData, currentToken())]'><image src='[r: tableImage("Buttons", 2)]' border="0"></image></a>
      [h: jsonData = json.append("[]",prop,0,"Weapon")]
      <a href='[r:macroLinkText("Entry@this","none", jsonData, currentToken())]'><image src='[r: tableImage("Buttons", 1)]' border="0"></image></a>
      <a href='[r:macroLinkText("WeaponUpdateDialog@this","none", prop, currentToken())]'><image src='[r: tableImage("Buttons", 13)]' border="0"></image></a>      
    </td>
  </tr>
}]
!!
@@ @WeaponReload
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
  [h: weapName = macro.args]
  [h: jsonWeap = json.get(Weapons,weapName)]
  [h: currAmmo = json.get(jsonWeap,3)]
  [h: maxAmmo = json.get(jsonWeap,4)]
  [h,if(maxAmmo==0): input(".|"+weapName+" has no ammo to reload or adjust!||LABEL|SPAN=TRUE")]
  [h,if(maxAmmo==0): abort(0)]
  
  [h:choice = input(
      strformat(".|Weapon: %s||LABEL|SPAN=TRUE ",weapName),
      strformat(".|Ammo: %s / %s||LABEL|SPAN=TRUE ",currAmmo,maxAmmo),
      "pick|Reload (Complex Action),Reload (Quick Action), Change ammo manually|Choose Option|RADIO",
      "manualAmmo|0|Manual ammo adjust|TEXT|"
  )]
  [h:abort(choice)]
  
  [h,switch(pick),code:
    case 0:
    {
      [h: currAmmo = maxAmmo]
      [h: outStr = "uses a Complex Action to reload "]
    };
    case 1: 
    {
      [h: currAmmo = maxAmmo]
      [h: outStr = "uses a Simple Action to reload "]
    };
    case 2:
    {
      [h,if(manualAmmo <= 0 || isNumber(manualAmmo) != 1): input(".|Entered amount for manual ammo adjustment is invalid!||LABEL|SPAN=TRUE")]
      [h,if(manualAmmo <= 0 || isNumber(manualAmmo) != 1): abort(0)]
      [h: currAmmo = manualAmmo]
      [h: outStr = "manually adjusts the ammo to be " + manualAmmo + " in "]
    }
  ]
  [h: jsonWeap = json.set(jsonWeap,3,currAmmo)]
  [h: Weapons = json.set(Weapons,weapName,jsonWeap)]
  
  [h: pName = getName(currentToken())]
  <p><span bgcolor=#cccccc><b>{pName}</b> {outStr}{weapName}.</span>
  [h: RecalcBottomSheet("Combat")]
  [h, macro("SheetLoad@this"):""]
!!
@@ @WeaponDisplayTop
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
<table border="0" cellpadding="0" width="100%"   bgcolor="[r:table(PageColor,3)]">
  <tr bgcolor="[r:table(PageColor,2)]">
    <td></td><td></td><td></td><td></td><td></td>
    <td align="right">
      <a href='[r:macroLinkText("WeaponShowUpdate@this","none","",currentToken())]'><image src='[r: tableImage("OpenClose", getProperty("WeaponShow"))]' border="0" align="middle"></image></a>&nbsp; 
    </td>
  </tr>
  <tr bgcolor="[r:table(PageColor,2)]">
    <th>
      &nbsp; <font color="white">WEAPONS</font>
    </th>
    <th>
      <font color="white">AP</font>
    </th>
    <th>
      <font color="white">DV</font>
    </th>
    <th>
      <font color="white">Firing Mode</font>
    </th>
    <th>
      <font color="white">Ammo</font>
    </th>
    <th>
      <font color="white">Actions</font>
    </th>
  </tr>
[if(WeaponShow),code:{
  [r, macro("WeaponDisplay@this"):""]
  <tr>
    <td colspan="6" align="center">
      <a href='[r:macroLinkText("WeaponUpdateDialogNew@this","none","",currentToken())]'><b><font color="black">Add New Weapon</font></b></a>
    </td>
  </tr>
}; {}]
</table>

!!
@@ @KnowSkillsDisplayBottom
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
[h: skill = json.get(macro.args,0)]
[h: color = json.get(macro.args,1)]
<tr bgcolor="[r: color]">
  [h: base = json.get(json.get(KnowledgeSkills,skill),0)]
  [h: bonus =  json.get(json.get(KnowledgeSkills,skill),1)]
  [h: aptitude = json.get(json.get(KnowledgeSkills,skill),2)]
  [h: default = json.get(json.get(KnowledgeSkills,skill),3)]
  [h: spec = json.get(json.get(KnowledgeSkills,skill),4)]
  [h,if(length(spec)==0): specText = "no";specText = "yes"]
  [h: knowTotal = base+bonus]
  <td align="left">
    [h: jsonData=json.set("{}","name",skill,"base",knowTotal,"modifier",0)]
    [h: info=json.append("[]",skill,json.get(json.get(KnowledgeSkills,skill),2))]
    <font color="black"><a href='[r:macroLinkText("KnowSkillsInfoDisplay@this","none",info, currentToken())]'>[r: skill]</a></font>
  </td>
  <td align="center" width="15%">
    [h: specData=json.set("{}","specName",spec,"knowName",skill)]
    <font color="black"><a href='[r:macroLinkText("KnowSpecUpdate@this","none", specData, currentToken())]'>[r: specText]</a></font>
  </td>
  <td align="left" width="15%">
    [h: jsonData = json.append("[]",aptitude,strformat(" %s Aptitude check",aptitude),"Aptitude")]	
    [h,if(default): outputter = "<font color='black'><a href='"+macroLinkText("Entry@this","none",jsonData, currentToken())+"'>"+aptitude+"</font></a>"; outputter = "<font color='black'>"+aptitude+"</font>"]
    {outputter}
  </td>
  <td width="15%" align="right">
    [h: jsonData = json.append("[]",skill,knowTotal,"KnowSkill",strformat(" %s skill check",skill),spec)]
    (<font color="black"><a href='[r:macroLinkText("Entry@this","none", jsonData, currentToken())]'>+[r: knowTotal]</a></font>)
  </td>

</tr>
[h: colorcheck = table(PageColor,4)]
[h: macro.return = if(color == colorcheck,"white", colorcheck)]

!!
@@ @MuseSkillsDisplayBottom
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
[h: skill = json.get(macro.args,0)]
[h: color = json.get(macro.args,1)]
<tr bgcolor="[r: color]">
  [h: base = json.get(json.get(MuseSkills,skill),0)]
  [h: bonus =  json.get(json.get(MuseSkills,skill),1)]
  [h: aptitude = json.get(json.get(MuseSkills,skill),2)]
  [h: aptAbbr = substring(aptitude,0,length(aptitude) - 5)]
  [h: default = json.get(json.get(MuseSkills,skill),3)]
  [h: spec = json.get(json.get(MuseSkills,skill),4)]
  [h,if(length(spec)==0): specText = "no";specText = "yes"]
  [h: museSkillTotal = base+bonus]
  <td align="left">
    [h: jsonData=json.set("{}","name",skill,"base",museSkillTotal,"modifier",0)]
    [h: info=json.append("[]",skill,json.get(json.get(MuseSkills,skill),2))]
    <font color="black"><a href='[r:macroLinkText("MuseSkillsInfoDisplay@this","none",info, currentToken())]'>[r: skill]</a></font>
  </td>
  <td align="center" width="15%">
    [h: specData=json.set("{}","specName",spec,"museName",skill)]
    <font color="black"><a href='[r:macroLinkText("MuseSpecUpdate@this","none", specData, currentToken())]'>[r: specText]</a></font>
  </td>
  <td align="left" width="15%">
    [h: jsonData = json.append("[]",aptitude,strformat(" %s Muse Aptitude check",aptAbbr),"MuseAptitude")]	
    [h,if(default): outputter = "<font color='black'><a href='"+macroLinkText("Entry@this","none",jsonData, currentToken())+"'>"+aptAbbr+"</font></a>"; outputter = "<font color='black'>"+aptAbbr+"</font>"]
    {outputter}
  </td>
  <td width="15%" align="right">
    [h: jsonData = json.append("[]",skill,museSkillTotal,"MuseSkill",strformat(" %s Muse skill check",skill),spec)]
    (<font color="black"><a href='[r:macroLinkText("Entry@this","none", jsonData, currentToken())]'>+[r: museSkillTotal]</a></font>)
  </td>

</tr>
[h: colorcheck = table(PageColor,4)]
[h: macro.return = if(color == colorcheck,"white", colorcheck)]

!!
@@ @ActiveSkillsDisplayBottom
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
[h: skill = json.get(macro.args,0)]
[h: color = json.get(macro.args,1)]
<tr bgcolor="[r: color]">
  [h: base = json.get(json.get(ActiveSkills,skill),0)]
  [h: bonus =  json.get(json.get(ActiveSkills,skill),1)]
  [h: aptitude = json.get(json.get(ActiveSkills,skill),2)]
  [h: default = json.get(json.get(ActiveSkills,skill),3)]
  [h: spec = json.get(json.get(ActiveSkills,skill),4)]
  [h,if(length(spec)==0): specText = "no";specText = "yes"]
  [h: activeTotal = base+bonus]
  <td align="left">
    [h: jsonData=json.set("{}","name",skill,"base",activeTotal,"modifier",0)]
    [h: info=json.append("[]",skill,json.get(json.get(ActiveSkills,skill),2))]
    <font color="black"><a href='[r:macroLinkText("ActiveSkillsInfoDisplay@this","none",info, currentToken())]'>[r: skill]</a></font>
  </td>
  <td align="center" width="15%">
    [h: specData=json.set("{}","specName",spec,"activeName",skill)]
    <font color="black"><a href='[r:macroLinkText("ActiveSpecUpdate@this","none", specData, currentToken())]'>[r: specText]</a></font>
  </td>
  <td align="left" width="15%">
    [h: jsonData = json.append("[]",aptitude,strformat(" %s Aptitude check",aptitude),"Aptitude")]	
    [h,if(default): outputter = "<font color='black'><a href='"+macroLinkText("Entry@this","none",jsonData, currentToken())+"'>"+aptitude+"</font></a>"; outputter = "<font color='black'>"+aptitude+"</font>"]
    {outputter}
  </td>
  <td width="15%" align="right">
    [h: jsonData = json.append("[]",skill,activeTotal,"ActiveSkill",strformat(" %s skill check",skill),spec)]
    (<font color="black"><a href='[r:macroLinkText("Entry@this","none", jsonData, currentToken())]'>+[r: activeTotal]</a></font>)
  </td>

</tr>
[h: colorcheck = table(PageColor,4)]
[h: macro.return = if(color == colorcheck,"white", colorcheck)]

!!
@@ @KnowSkillsDisplayTop
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
<table border="0" cellpadding="2" width="100%" bgcolor="white">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td valign="middle">&nbsp; &nbsp; <font color="white"><a href='[r:macroLinkText("KnowSkillsUpdateDialog@this","none","", currentToken())]'><b>KNOW. SKILLS</b></a></font>
		</td>
		<td align="center" width="15%" color="white">
			<b>Spec.</b>
		</td>
    <td align="left" width="15%" color="white">
			<b>Aptitude</b>
		</td>
		<td align="right" width="15%" color="white">
			<b>Total</b>
		</td>
	</tr>
  [h,if(json.isEmpty(KnowledgeSkills)): skillListunsort = ""; skillListunsort = json.fields(KnowledgeSkills)]
  [h: skillList = listsort(skillListunsort, "A")]
  [h: color = table(PageColor,4)]
  [foreach(skill, skillList, ""), code: 
  {
    [h: skillDetails = json.get(KnowledgeSkills, skill)]
    [h: skillBase = json.get(skillDetails,0)]
    [h: skillBonus = json.get(skillDetails,1)]
    [if(skillBonus==0&&skillBase==0), code: {}; 
    {
      [h: jsonData = json.append("[]", skill,color)]
      [r, macro("KnowSkillsDisplayBottom@this"):jsonData]
      [h: color = macro.return]
    }]
  }]
</table>

!!
@@ @ActiveSkillsDisplayTop
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
<table border="0" cellpadding="2" width="100%" bgcolor="white">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td valign="middle">&nbsp; &nbsp; <font color="white"><a href='[r:macroLinkText("ActiveSkillsUpdateDialog@this","none","", currentToken())]'><b>ACTIVE SKILLS</b></a></font>
		</td>
		<td align="center" width="15%" color="white">
			<b>Spec.</b>
		</td>
    <td align="left" width="15%" color="white">
			<b>Aptitude</b>
		</td>
		<td align="right" width="15%" color="white">
			<b>Total</b>
		</td>
	</tr>
  [h,if(json.isEmpty(ActiveSkills)): skillListunsort = ""; skillListunsort = json.fields(ActiveSkills)]
  [h: skillList = listsort(skillListunsort, "A")]
  [h: color = table(PageColor,4)]
  [foreach(skill, skillList, ""), code: 
  {
    [h: skillDetails = json.get(ActiveSkills, skill)]
    [h: skillBase = json.get(skillDetails,0)]
    [h: skillBonus = json.get(skillDetails,1)]
    [if(skillBonus==0&&skillBase==0), code: {}; 
    {
      [h: jsonData = json.append("[]", skill,color)]
      [r, macro("ActiveSkillsDisplayBottom@this"):jsonData]
      [h: color = macro.return]
    }]
  }]
</table>

!!
@@ @MuseSkillsDisplayTop
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet Display ; tooltip= ; minWidth= ; 
<table border="0" cellpadding="2" width="100%" bgcolor="white">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td valign="middle">&nbsp; &nbsp; <font color="white"><a href='[r:macroLinkText("MuseSkillsUpdateDialog@this","none","", currentToken())]'><b>MUSE SKILLS</b></a></font>
		</td>
		<td align="center" width="15%" color="white">
			<b>Spec.</b>
		</td>
    <td align="left" width="15%" color="white">
			<b>Aptitude</b>
		</td>
		<td align="right" width="15%" color="white">
			<b>Total</b>
		</td>
	</tr>
  [h,if(json.isEmpty(MuseSkills)): skillListunsort = ""; skillListunsort = json.fields(MuseSkills)]
  [h: skillList = listsort(skillListunsort, "A")]
  [h: color = table(PageColor,4)]
  [foreach(skill, skillList, ""), code: 
  {
    [h: skillDetails = json.get(MuseSkills, skill)]
    [h: skillBase = json.get(skillDetails,0)]
    [h: skillBonus = json.get(skillDetails,1)]
    [if(skillBonus==0&&skillBase==0), code: {}; 
    {
      [h: jsonData = json.append("[]", skill,color)]
      [r, macro("MuseSkillsDisplayBottom@this"):jsonData]
      [h: color = macro.return]
    }]
  }]
</table>

!!
@@ @AptitudeEntry
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
<head>
<title>Aptitude Check</title>
<meta name="input" content="true">
</head>
<body>
[h: jsonData = json.append("[]",json.get(macro.args,0),strformat(" %s Aptitude check",json.get(macro.args,0)),"Aptitude")]
<link rel='onChangeSelection' type='macro' href='[r: macroLinkText("Entry@this", "none", jsonData, currentToken())]'></link>
<form method="json" name="SkillCheck" action="[r:macroLinkText('EntryType@Lib:MnM', 'none', '', currentToken())]">

<table width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td color="white">
			<center><b>[r: strformat("%s (%d)",json.get(macro.args,0),getProperty(json.get(macro.args,0)))]</center>
		</td>
	</tr>
</table>
<table width="100%" bgcolor="white">
	<tr>
		<td>
			<b>Pre-made Target Numbers:</b>
		</td>
		<td align="left">
      <select name="targetNumber" selected="">
        <option value='0'>Custom</option>
        <option value='[r: getProperty(json.get(macro.args,0)) * 3]'>Aptitude x 3</option>
        <option value='[r: getProperty(json.get(macro.args,0)) * 2]'>Aptitude x 2</option>
        <option value='[r: getProperty(json.get(macro.args,0))]'>Aptitude</option>
			</select>
		</td>
	</tr>
  <tr>
		<td>
			<b>Custom Target Number:</b>
		</td>
		<td align="left">
			<input type="text" name="secondaryTargetNumber" value="" size="5"></input>
		</td>
	</tr>
	<tr>
		<td>
			Teamwork:
		</td>
		<td align="left">
			<select name="teamWork" selected="">
        <option value='0'>None</option>
        <option value='1'>One</option>
        <option value='2'>Two</option>
        <option value='3'>Three</option>
			</select>
		</td>
	</tr>
	<tr>
		<td>
			<b>Modifier:</b>
		</td>
		<td align="left">
			<input type="text" name="mods" value="" size="5"></input>
		</td>
	</tr>
</table>
[h: targList = getSelectedNames(", ")]
[h,if(length(targList) > 0): targString='<table width="100%"><tr bgcolor='+table(PageColor,4)+'>Targets:&nbsp;'+targList+'</tr></table>';targString = ""]
[h,if(length(targList) > 0): targText = '<br><b>Targets:</b> ';targText = ""]
{targString}
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,3)]">
		<td align="left">
			Private: <input type="checkbox" name="Output" value="Private"></input>
		</td>
		<td alignt="right">
			Hide Roll: <input type="checkbox" name="hideRoll" value="1"></input>
		</td>
	</tr>
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,4)]">
		<td align="center">
			<input type="hidden" name="rollTitle" value="[r: json.get(macro.args,1)]"></input>	
      <input type="hidden" name="rollerName" value="[r: getName(currentToken())]"></input>
			<input type="hidden" name="ExeMacro" value="die100"></input>
      <input type="hidden" name="extraText" value="[r: targText + targList]"></input>
			<input type='submit' name='Roll' value='Roll'></input>
		</td>
	</tr>
</table>
</form>
</body>
</html>

!!
@@ @RollEntry
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
<head>
<title>Custom d100 Roll</title>
<meta name="input" content="true">
</head>
<body>
[h: jsonData = json.append("[]"," Custom d100 Roll",0,"Roll")]
<link rel='onChangeSelection' type='macro' href='[r: macroLinkText("Entry@this", "none", jsonData, currentToken())]'></link>
<form method="json" name="RollCheck" action="[r:macroLinkText('EntryType@Lib:MnM', 'none', '', currentToken())]">

<table width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td color="white">
			<center><b>Custom d100 Roll</b></center>
		</td>
	</tr>
</table>
<table width="100%" bgcolor="white">
  <tr>
		<td>
			<b>Custom Target Number:</b>
		</td>
		<td align="left">
			<input type="text" name="targetNumber" value="" size="5"></input>
		</td>
	</tr>
	<tr>
		<td>
			<b>Modifier:</b>
		</td>
		<td align="left">
			<input type="text" name="mods" value="" size="5"></input>
		</td>
	</tr>
</table>
[h: targList = getSelectedNames(", ")]
[h,if(length(targList) > 0): targString='<table width="100%"><tr bgcolor='+table(PageColor,4)+'>Targets:&nbsp;'+targList+'</tr></table>';targString = ""]
[h,if(length(targList) > 0): targText = '<br><b>Targets:</b> ';targText = ""]
{targString}
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,3)]">
		<td align="left">
			Private: <input type="checkbox" name="Output" value="Private"></input>
		</td>
		<td alignt="right">
			Hide Roll: <input type="checkbox" name="hideRoll" value="1"></input>
		</td>
	</tr>
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,4)]">
		<td align="center">
			<input type="hidden" name="rollTitle" value="[r: json.get(macro.args,0)]"></input>	
      <input type="hidden" name="rollerName" value="[r: getName(currentToken())]"></input>
			<input type="hidden" name="ExeMacro" value="die100"></input>
      <input type="hidden" name="useWounds" value="0"></input>
      <input type="hidden" name="useTrauma" value="0"></input>
      <input type="hidden" name="useArmorPenalty" value="0"></input>
      <input type="hidden" name="extraText" value="[r: targText + targList]"></input>
			<input type='submit' name='Roll' value='Roll'></input>
		</td>
	</tr>
</table>
</form>
</body>
</html>

!!
@@ @ScatterEntry
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
<head>
<title>Scatter Roll</title>
<meta name="input" content="true">
</head>
<body>
[h: jsonData = json.append("[]"," Scatter Roll",0,"Scatter")]
<link rel='onChangeSelection' type='macro' href='[r: macroLinkText("Entry@this", "none", jsonData, currentToken())]'></link>
<form method="json" name="ScatterCheck" action="[r:macroLinkText('EntryType@Lib:MnM', 'none', '', currentToken())]">

<table width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td color="white">
			<center><b>Scatter Roll</b></center>
		</td>
	</tr>
</table>
<table width="100%" bgcolor="white">
	<tr>
		<td>
			<b>Attack Roll MoF:</b>
		</td>
		<td align="left">
			<input type="text" name="MoF" value="" size="5"></input>
		</td>
	</tr>
</table>
[h: targList = getSelectedNames(", ")]
[h,if(length(targList) > 0): targString='<table width="100%"><tr bgcolor='+table(PageColor,4)+'>Targets:&nbsp;'+targList+'</tr></table>';targString = ""]
[h,if(length(targList) > 0): targText = '<br><b>Targets:</b> ';targText = ""]
{targString}
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,3)]">
		<td align="left">
			Private: <input type="checkbox" name="Output" value="Private"></input>
		</td>
	</tr>
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,4)]">
		<td align="center">
			<input type="hidden" name="rollTitle" value="[r: json.get(macro.args,0)]"></input>	
      <input type="hidden" name="rollerName" value="[r: getName(currentToken())]"></input>
			<input type="hidden" name="ExeMacro" value="die10"></input>
      <input type="hidden" name="extraText" value="[r: targText + targList]"></input>
			<input type='submit' name='Roll' value='Roll'></input>
		</td>
	</tr>
</table>
</form>
</body>
</html>

!!
@@ @MuseAptitudeEntry
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
<head>
<title>Muse Aptitude Check</title>
<meta name="input" content="true">
</head>
<body>
[h: jsonData = json.append("[]",json.get(macro.args,0),strformat(" %s Muse Aptitude check",json.get(macro.args,0)),"MuseAptitude")]
<link rel='onChangeSelection' type='macro' href='[r: macroLinkText("Entry@this", "none", jsonData, currentToken())]'></link>
<form method="json" name="MuseAptitudeCheck" action="[r:macroLinkText('EntryType@Lib:MnM', 'none', '', currentToken())]">

<table width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td color="white">
			<center><b>[r: strformat("%s (%d)",json.get(macro.args,0),getProperty(json.get(macro.args,0)))]</center>
		</td>
	</tr>
</table>
<table width="100%" bgcolor="white">
	<tr>
		<td>
			<b>Pre-made Target Numbers:</b>
		</td>
		<td align="left">
      <select name="targetNumber" selected="">
        <option value='0'>Custom</option>
        <option value='[r: getProperty(json.get(macro.args,0)) * 3]'>Aptitude x 3</option>
        <option value='[r: getProperty(json.get(macro.args,0)) * 2]'>Aptitude x 2</option>
        <option value='[r: getProperty(json.get(macro.args,0))]'>Aptitude</option>
			</select>
		</td>
	</tr>
  <tr>
		<td>
			<b>Custom Target Number:</b>
		</td>
		<td align="left">
			<input type="text" name="secondaryTargetNumber" value="" size="5"></input>
		</td>
	</tr>
	<tr>
		<td>
			Teamwork:
		</td>
		<td align="left">
			<select name="teamWork" selected="">
        <option value='0'>None</option>
        <option value='1'>One</option>
        <option value='2'>Two</option>
        <option value='3'>Three</option>
			</select>
		</td>
	</tr>
	<tr>
		<td>
			<b>Modifier:</b>
		</td>
		<td align="left">
			<input type="text" name="mods" value="" size="5"></input>
		</td>
	</tr>
</table>
[h: targList = getSelectedNames(", ")]
[h,if(length(targList) > 0): targString='<table width="100%"><tr bgcolor='+table(PageColor,4)+'>Targets:&nbsp;'+targList+'</tr></table>';targString = ""]
[h,if(length(targList) > 0): targText = '<br><b>Targets:</b> ';targText = ""]
{targString}
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,3)]">
		<td align="left">
			Private: <input type="checkbox" name="Output" value="Private"></input>
		</td>
		<td alignt="right">
			Hide Roll: <input type="checkbox" name="hideRoll" value="1"></input>
		</td>
	</tr>
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,4)]">
		<td align="center">
			<input type="hidden" name="rollTitle" value="[r: json.get(macro.args,1)]"></input>	
      <input type="hidden" name="rollerName" value="[r: getName(currentToken())]"></input>
      <input type="hidden" name="useWounds" value="0"></input>
      <input type="hidden" name="useTrauma" value="0"></input>
      <input type="hidden" name="useArmorPenalty" value="0"></input>
			<input type="hidden" name="ExeMacro" value="die100"></input>
      <input type="hidden" name="extraText" value="[r: targText + targList]"></input>
			<input type='submit' name='Roll' value='Roll'></input>
		</td>
	</tr>
</table>
</form>
</body>
</html>

!!
@@ @MoxieEntry
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
[h,if(MOX==0): input(".|You do not have any Moxie to spend!||LABEL|SPAN=TRUE")]
[h,if(MOX==0): abort(0)]

<head>
<title>Moxie Usage</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="MoxieEntry" action="[r:macroLinkText('EntryType@Lib:MnM', 'none', '', currentToken())]">

<table width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td color="white">
			<center><b>MOX ([r: MOX + " / " + MOX_base])</center>
		</td>
	</tr>
</table>
<table width="100%" bgcolor="white">
  <tr>
		<td>
			<b>Pick one Option:</b>
		</td>
		<td align="left">
      <INPUT TYPE=RADIO NAME="moxOption" VALUE="1" CHECKED>Ignore all negative modifiers that apply to a test. The Moxie point must be spent before dice are rolled.<BR>
      <INPUT TYPE=RADIO NAME="moxOption" VALUE="2"        >Flip-flop a d100 roll result. For example, an 83 would become a 38.<BR>
      <INPUT TYPE=RADIO NAME="moxOption" VALUE="3"        >Upgrade a success, making it a critical success, as if you rolled doubles. You must succeed in the test before you spend the Moxie point.<BR>
      <INPUT TYPE=RADIO NAME="moxOption" VALUE="4"        >Ignore a critical failure, treating it as a regular failure instead.<BR>
      <INPUT TYPE=RADIO NAME="moxOption" VALUE="5"        >Go first in an Action Phase.
		</td>
	</tr>
	<tr>	
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,4)]">
		<td align="center">	
      <input type="hidden" name="rollerName" value="[r: json.get(macro.args,3)]"></input>
			<input type="hidden" name="ExeMacro" value="UseMoxie"></input>
			<input type='submit' name='Roll' value='Pick'></input>
		</td>
	</tr>
</table>
</form>
</body>
</html>

!!
@@ @RepEntry
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
[h:repNamer = json.get(macro.args,0)]
[h:repValuer = json.get(macro.args,1)]
[h,if(repValuer==0): input(".|You do not have any "+repNamer+" to burn!||LABEL|SPAN=TRUE")]
[h,if(repValuer==0): abort(0)]
[h,switch(repNamer):
  case "A-Rep": networkName = "Networking: Autonomists";
  case "c-Rep": networkName = "Networking: Hypercorps";
  case "e-Rep": networkName = "Networking: Ecologists";
  case "f-Rep": networkName = "Networking: Media";
  case "g-Rep": networkName = "Networking: Criminals";
  case "i-Rep": networkName = "Networking: Firewall";
  case "r-Rep": networkName = "Networking: Scientists"
]
[h,if(repNamer=="A-Rep"): repNamer = "@-Rep"]

<head>
<title>Reputation Burn</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="RepCheck" action="[r:macroLinkText('EntryType@Lib:MnM', 'none', '', currentToken())]">

<table width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td color="white">
			<center><b>[r: repNamer] Burn ([r: repValuer])</center>
		</td>
	</tr>
</table>
<table width="100%" bgcolor="white">
	<tr>
		<td>
			<b>Pick one:</b>
		</td>
		<td>
			<input type="radio" name="burnChoice" value="1" checked="checked">Get a bonus on a [r: networkName] test (max of +30).</input><br>
      <input type="radio" name="burnChoice" value="2">Get a Favor before it has refreshed.</input>
		</td>
	</tr>
	<tr>
		<td>
			<b># to burn for Networking:</b>
		</td>
		<td>
			<input type="text" name="choiceOneValue" value="" size="5"></input>
		</td>
	</tr>
  <tr>
		<td>
			<b># to burn for a Favor:</b>
		</td>
		<td>
			<input type="radio" name="choiceTwoValue" value="0" checked="checked">Trivial Favor (Cost 0)</input><br>
      <input type="radio" name="choiceTwoValue" value="1">Low Favor (Cost 1)</input><br>
      <input type="radio" name="choiceTwoValue" value="5">Moderate Favor (Cost 5)</input><br>
      <input type="radio" name="choiceTwoValue" value="10">High Favor (Cost 10)</input><br>
      <input type="radio" name="choiceTwoValue" value="20">Scarce Favor (Cost 20)</input>
		</td>
	</tr>
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,4)]">
		<td align="center">
			<input type="hidden" name="repName" value="[r: json.get(macro.args,0)]"></input>					
      <input type="hidden" name="repValue" value="[r: json.get(macro.args,1)]"></input>
      <input type="hidden" name="rollerName" value="[r: json.get(macro.args,3)]"></input>
      <input type="hidden" name="networkName" value="[r: networkName]"></input>
			<input type="hidden" name="ExeMacro" value="BurnRep"></input>
			<input type='submit' name='Done' value='Done'></input>
		</td>
	</tr>
</table>
</form>
</body>
</html>

!!
@@ @WeaponCheck
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
[h: argz = macro.args]
[h: weapUseFM = json.get(argz, "weapUseFM")]
[h,if(json.contains(argz,"useApt")):useApt = json.get(argz, "useApt");useApt = 0]
[h,if(json.contains(argz,"useSpec")):useSpec = json.get(argz, "useSpec");useSpec = 1]
[h,if(json.contains(argz,"useLaser")):useLaser = json.get(argz, "useLaser");useLaser = 1]
[h,if(json.contains(argz,"yesDialog")):yesDialog = json.get(argz, "yesDialog");yesDialog = 0]
[h,if(json.contains(argz,"mods")):useMod = json.get(argz, "mods");useMod = 0]
[h,if(json.contains(argz,"targList")):targList = json.get(argz, "targList");targList = ""]
[h,if(json.contains(argz,"hideRoll")):hideRoll = json.get(argz, "hideRoll");hideRoll = 0]
[h,if(json.contains(argz,"modsDV")):useModDV = json.get(argz, "modsDV");useModDV = 0]

[h: weapName = json.get(argz,"weapName")]
[h: weapJson = json.get(Weapons,weapName)]
[h: weapAP = json.get(weapJson,0)]
[h: weapDV = json.get(weapJson,1)]
[h: weapFM = json.get(weapJson,2)]
[h: weapCurrAmmo = json.get(weapJson,3)]
[h: weapMaxAmmo = json.get(weapJson,4)]
[h: weapSkill = json.get(weapJson,5)]
[h: weapText = json.get(weapJson,6)]
[h,if(useSpec): weapSpec = json.get(weapJson,8); weapSpec = 0]
[h,if(useLaser): weapLaser = json.get(weapJson,9); weapLaser = 0]

[h: skillJson = json.get(ActiveSkills,weapSkill)]
[h: skillBase = json.get(skillJson,0)]
[h: skillMod = json.get(skillJson,1)]
[h: skillApt = json.get(skillJson,2)]
[h: skillDefApt = json.get(skillJson,3)]
[h: skillSpec = json.get(skillJson,4)]

[h,if(skillDefApt): myApt = getProperty(skillApt); myApt = -1]
[h,if(myApt > skillBase + skillMod || useApt): useTN = myApt; useTN = skillBase + skillMod]
[h,if(json.isEmpty(weapFM) || length(weapUseFM) > 0): weapFMvalue = ""; weapFMvalue = json.get(weapFM,0)]
[h,if(length(weapUseFM) > 0): weapFmvalue = weapUseFM]
[h,if(length(weapFMvalue) <= 0): weapFMTxt = ""; weapFMTxt = "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color='#FF00FF'>Mode</font> = <b>" + weapFMvalue + "</b>"]
[h,switch(weapFMvalue):
  case "SS": usedAmmo = 1;
  case "SA": usedAmmo = 1;
  case "BF": usedAmmo = 3;
  case "FA": usedAmmo = 10;
  default: usedAmmo = 0
]
[h,if(usedAmmo > weapCurrAmmo): input(".|You do not have enough ammo to use "+weapFMvalue+" Firing Mode for this weapon! RELOAD!||LABEL|SPAN=TRUE")]
[h,if(usedAmmo > weapCurrAmmo): abort(0)]
[h: useAmmo = weapCurrAmmo - usedAmmo]
[h,if(usedAmmo != 0): weapFMTxt = weapFMTxt + strformat("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color='#FF00FF'>Ammo</font> = <b>%s/%s</b>",useAmmo,weapMaxAmmo)]

[h,if(length(weapText) > 0): weapText = "<br><b>Special:</b> "+weapText]
[h,if(length(targList) <= 0): targList = getSelectedNames(", ")]
[h,if(length(targList) > 0): weapText = "<br><b>Targets:</b> " + targList + weapText]
[h,if(length(weapFMTxt) > 0): weapText = weapFMTxt + weapText]


[h: jsonData=json.set("{}",
                      "targetNumber",useTN,
                      "mods",useMod,
                      "rollerName",getName(currentToken()),
                      "rollTitle",strformat("%s%s%s Weapon check",if(yesDialog,"","default "),weapName,if(useApt," (Aptitude based)","")),
                      "useSpec", weapSpec,
                      "useLaser", weapLaser,
                      "specName", skillSpec,
                      "extraText", weapText,
                      "weapCheck", 1,
                      "weapDV", weapDV,
                      "weapAP", weapAP,
                      "modsDV", useModDV,
                      "hideRoll", hideRoll
                      )]
[evalMacro('[macro("die100@"+LibFunction): jsonData]')]
[h: weapJson = json.set(weapJson,3,useAmmo)]
[h: Weapons = json.set(Weapons,weapName,weapJson)]
[h: RecalcBottomSheet("Combat")]
[h, macro("SheetLoad@Lib:MnM"):""]

!!
@@ @DefenseCheck
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
[h: argz = macro.args]
[h: skillName = json.get(argz,"skillName")]
[h,if(json.contains(argz,"useApt")):useApt = json.get(argz, "useApt");useApt = 0]
[h,if(json.contains(argz,"useSpec")):useSpec = json.get(argz, "useSpec");useSpec = 0]
[h,if(json.contains(argz,"yesDialog")):yesDialog = json.get(argz, "yesDialog");yesDialog = 0]
[h,if(json.contains(argz,"mods")):useMod = json.get(argz, "mods");useMod = 0]
[h,if(json.contains(argz,"targList")):targList = json.get(argz, "targList");targList = ""]
[h,if(json.contains(argz,"hideRoll")):hideRoll = json.get(argz, "hideRoll");hideRoll = 0]
[h,if(json.contains(argz,"halfSkill")):halfSkill = json.get(argz, "halfSkill");halfSkill = 0]

[h: skillJson = json.get(ActiveSkills,skillName)]
[h: skillBase = json.get(skillJson,0)]
[h: skillMod = json.get(skillJson,1)]
[h: skillApt = json.get(skillJson,2)]
[h: skillDefApt = json.get(skillJson,3)]
[h: skillSpec = json.get(skillJson,4)]

[h,if(skillDefApt): myApt = getProperty(skillApt); myApt = 0]
[h,if(useApt): useTN = myApt; useTN = skillBase + skillMod]
[h,if(halfSkill): useTN = floor(useTN / 2)]

[h,if(length(targList) <= 0): targList = getSelectedNames(", ")]
[h,if(length(targList) > 0): extraText = "<br><b>Targets:</b> " + targList; extraText = ""]

[h: jsonData=json.set("{}",
                      "targetNumber",useTN,
                      "mods",useMod,
                      "rollerName",getName(currentToken()),
                      "rollTitle",strformat("%s%s%s%s Defense check",if(yesDialog,"","default "),skillName,if(useApt," (Aptitude based)",""),if(halfSkill," (halved)","")),
                      "useSpec", useSpec,
                      "specName", skillSpec,
                      "extraText", extraText,
                      "weapCheck", 0,
                      "hideRoll", hideRoll
                      )]
[evalMacro('[macro("die100@"+LibFunction): jsonData]')]

!!
@@ @OtherDefenseCheck
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
[h: argz = macro.args]
[h: otherDefense = json.get(argz,"otherDefense")]
[h,if(json.contains(argz,"yesDialog")):yesDialog = json.get(argz, "yesDialog");yesDialog = 0]
[h,if(json.contains(argz,"mods")):useMod = json.get(argz, "mods");useMod = 0]
[h,if(json.contains(argz,"targList")):targList = json.get(argz, "targList");targList = ""]
[h,if(json.contains(argz,"hideRoll")):hideRoll = json.get(argz, "hideRoll");hideRoll = 0]

[h,switch(otherDefense):
  case "Psi": useTN = WIL * 2;
  case "SOM x 3": useTN = SOM * 3;
  default: useTN = DUR - DAMAGE + Armor_Energy
]

[h,if(length(targList) <= 0): targList = getSelectedNames(", ")]
[h,if(length(targList) > 0): extraText = "<br><b>Targets:</b> " + targList; extraText = ""]

[h: jsonData=json.set("{}",
                      "targetNumber",useTN,
                      "mods",useMod,
                      "rollerName",getName(currentToken()),
                      "rollTitle",strformat("%s%s Defense check",if(yesDialog,"","default "),otherDefense),
                      "extraText", extraText,
                      "hideRoll", hideRoll
                      )]
[evalMacro('[macro("die100@"+LibFunction): jsonData]')]

!!
@@ @Entry
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
[H, macro("EntrySize@this"):""]
[H: sizeSettings = json.get(macro.return, json.get(macro.args, 2))]

[H: Width = listget(sizeSettings, 0)+0]
[H: Height = listget(sizeSettings, 1)+0]

[R, dialog("EntryWindow", "temp=1; closebutton=0; width=" + Width + "; height=" + Height):

	{
		[r, macro(json.get(macro.args,2)+"Entry@this"):macro.args]
	}
]

!!
@@ @EntrySize
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
[macro.return = json.set("",

"Attack", "405, 256",
"Damage", "365, 204",
"Resistance", "365, 204",
"Skill", "305, 223",
"Ability", "305, 196",
"Aptitude", "305, 235",
"Roll", "305, 185",
"Initiative", "305, 146",
"Area","305, 150",
"Moxie", "305, 320",
"Rep", "520, 270",
"KnowSkill", "305, 210",
"ActiveSkill", "305, 210",
"MuseAptitude", "305, 235",
"MuseSkill", "305, 185",
"Weapon", "405, 255",
"Defense", "405, 210",
"OtherDefense", "405, 160",
"Scatter", "305, 160"

)]

!!
@@ @EntryType
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
[h: checkLink=macroLinkText(json.get(macro.args,"ExeMacro")+"@this", if(json.get(macro.args, "Output") == "Private", if(isGM() == 1, "gm", "gm-self"), "all"), macro.args, currentToken())]
[execLink(checkLink)]

!!
@@ @KnowSkillEntry
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
[h: skill = json.get(macro.args,0)]
[h: base = json.get(json.get(KnowledgeSkills,skill),0)]
[h: bonus =  json.get(json.get(KnowledgeSkills,skill),1)]
[h: spec = json.get(json.get(KnowledgeSkills,skill),4)]
[h: specValue = json.get(macro.args,4)]
<head>
<title>Knowledge Skill Check</title>
<meta name="input" content="true">
</head>
<body>
[h: jsonData = json.append("[]",skill,base+bonus,"KnowSkill",strformat(" %s skill check",skill),spec)]
<link rel='onChangeSelection' type='macro' href='[r: macroLinkText("Entry@this", "none", jsonData, currentToken())]'></link>
<form method="json" name="KnowSkillCheck" action="[r:macroLinkText('EntryType@Lib:MnM', 'none', '', currentToken())]">

<table width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td color="white">
			<center><b>[r: strformat("%s (%d)",json.get(macro.args,0),json.get(macro.args,1))]</center>
		</td>
	</tr>
</table>
<table width="100%" bgcolor="white">
	<tr>
		<td>
			Teamwork:
		</td>
		<td align="left">
			<select name="teamWork" selected="">
        <option value='0'>None</option>
        <option value='1'>One</option>
        <option value='2'>Two</option>
        <option value='3'>Three</option>
			</select>
		</td>
	</tr>
  <tr>
		<td>
			<b>Modifier:</b>
		</td>
		<td align="left">
			<input type="text" name="mods" value="" size="5"></input>
		</td>
	</tr>
  [h,if(length(specValue)==0): specRow = "";specRow = '<tr><td>Use Specialization ('+specValue+'):</td><td align="left"><input type="checkbox" name="useSpec" value="1"></input></td></tr>']
  {specRow}
</table>
[h: targList = getSelectedNames(", ")]
[h,if(length(targList) > 0): targString='<table width="100%"><tr bgcolor='+table(PageColor,4)+'>Targets:&nbsp;'+targList+'</tr></table>';targString = ""]
[h,if(length(targList) > 0): targText = '<br><b>Targets:</b> ';targText = ""]
{targString}
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,3)]">
		<td align="left">
			Private: <input type="checkbox" name="Output" value="Private"></input>
		</td>
		<td alignt="right">
			Hide Roll: <input type="checkbox" name="hideRoll" value="1"]></input>
		</td>
	</tr>
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,4)]">
		<td align="center">
			<input type="hidden" name="rollTitle" value="[r: json.get(macro.args,3)]"></input>					
			<input type="hidden" name="ExeMacro" value="die100"></input>
      <input type="hidden" name="targetNumber" value="[r: json.get(macro.args,1)]"></input>
      <input type="hidden" name="rollerName" value="[r: getName(currentToken())]"></input>
      <input type="hidden" name="specName" value="[r: specValue]"></input>
      <input type="hidden" name="extraText" value="[r: targText + targList]"></input>
			<input type='submit' name='Roll' value='Roll'></input>
		</td>
	</tr>
</table>
</form>
</body>
</html>

!!
@@ @ActiveSkillEntry
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
[h: skill = json.get(macro.args,0)]
[h: base = json.get(json.get(ActiveSkills,skill),0)]
[h: bonus =  json.get(json.get(ActiveSkills,skill),1)]
[h: spec = json.get(json.get(ActiveSkills,skill),4)]
[h: specValue = json.get(macro.args,4)]
<head>
<title>Active Skill Check</title>
<meta name="input" content="true">
</head>
<body>
[h: jsonData = json.append("[]",skill,base+bonus,"ActiveSkill",strformat(" %s skill check",skill),spec)]
<link rel='onChangeSelection' type='macro' href='[r: macroLinkText("Entry@this", "none", jsonData, currentToken())]'></link>
<form method="json" name="ActiveSkillCheck" action="[r:macroLinkText('EntryType@Lib:MnM', 'none', '', currentToken())]">

<table width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td color="white">
			<center><b>[r: strformat("%s (%d)",json.get(macro.args,0),json.get(macro.args,1))]</center>
		</td>
	</tr>
</table>
<table width="100%" bgcolor="white">
	<tr>
		<td>
			Teamwork:
		</td>
		<td align="left">
			<select name="teamWork" selected="">
        <option value='0'>None</option>
        <option value='1'>One</option>
        <option value='2'>Two</option>
        <option value='3'>Three</option>
			</select>
		</td>
	</tr>
  <tr>
		<td>
			<b>Modifier:</b>
		</td>
		<td align="left">
			<input type="text" name="mods" value="" size="5"></input>
		</td>
	</tr>
  <tr>
		<td>
			<b>Halve Skill?</b>
		</td>
		<td align="left">
			<input type="checkbox" name="halveSkill" value="1"></input>
		</td>
	</tr>
  [h,if(length(specValue)==0): specRow = "";specRow = '<tr><td>Use Specialization ('+specValue+'):</td><td align="left"><input type="checkbox" name="useSpec" value="1"></input></td></tr>']
  {specRow}
</table>
[h: targList = getSelectedNames(", ")]
[h,if(length(targList) > 0): targString='<table width="100%"><tr bgcolor='+table(PageColor,4)+'>Targets:&nbsp;'+targList+'</tr></table>';targString = ""]
[h,if(length(targList) > 0): targText = '<br><b>Targets:</b> ';targText = ""]
{targString}
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,3)]">
		<td align="left">
			Private: <input type="checkbox" name="Output" value="Private"></input>
		</td>
		<td alignt="right">
			Hide Roll: <input type="checkbox" name="hideRoll" value="1"]></input>
		</td>
	</tr>
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,4)]">
		<td align="center">
			<input type="hidden" name="rollTitle" value="[r: json.get(macro.args,3)]"></input>					
			<input type="hidden" name="ExeMacro" value="die100"></input>
      <input type="hidden" name="targetNumber" value="[r: json.get(macro.args,1)]"></input>
      <input type="hidden" name="rollerName" value="[r: getName(currentToken())]"></input>
      <input type="hidden" name="specName" value="[r: specValue]"></input>
      <input type="hidden" name="extraText" value="[r: targText + targList]"></input>
			<input type='submit' name='Roll' value='Roll'></input>
		</td>
	</tr>
</table>
</form>
</body>
</html>

!!
@@ @MuseSkillEntry
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
[h: skill = json.get(macro.args,0)]
[h: base = json.get(json.get(MuseSkills,skill),0)]
[h: bonus =  json.get(json.get(MuseSkills,skill),1)]
[h: spec = json.get(json.get(MuseSkills,skill),4)]
[h: specValue = json.get(macro.args,4)]
<head>
<title>Muse Skill Check</title>
<meta name="input" content="true">
</head>
<body>
[h: jsonData = json.append("[]",skill,base+bonus,"MuseSkill",strformat(" %s Muse skill check",skill),spec)]
<link rel='onChangeSelection' type='macro' href='[r: macroLinkText("Entry@this", "none", jsonData, currentToken())]'></link>
<form method="json" name="MuseSkillCheck" action="[r:macroLinkText('EntryType@Lib:MnM', 'none', '', currentToken())]">

<table width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td color="white">
			<center><b>[r: strformat("%s (%d)",json.get(macro.args,0),json.get(macro.args,1))]</center>
		</td>
	</tr>
</table>
<table width="100%" bgcolor="white">
	<tr>
		<td>
			Teamwork:
		</td>
		<td align="left">
			<select name="teamWork" selected="">
        <option value='0'>None</option>
        <option value='1'>One</option>
        <option value='2'>Two</option>
        <option value='3'>Three</option>
			</select>
		</td>
	</tr>
  <tr>
		<td>
			<b>Modifier:</b>
		</td>
		<td align="left">
			<input type="text" name="mods" value="" size="5"></input>
		</td>
	</tr>
  [h,if(length(specValue)==0): specRow = "";specRow = '<tr><td>Use Specialization ('+specValue+'):</td><td align="left"><input type="checkbox" name="useSpec" value="1"></input></td></tr>']
  {specRow}
</table>
[h: targList = getSelectedNames(", ")]
[h,if(length(targList) > 0): targString='<table width="100%"><tr bgcolor='+table(PageColor,4)+'>Targets:&nbsp;'+targList+'</tr></table>';targString = ""]
[h,if(length(targList) > 0): targText = '<br><b>Targets:</b> ';targText = ""]
{targString}
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,3)]">
		<td align="left">
			Private: <input type="checkbox" name="Output" value="Private"></input>
		</td>
		<td alignt="right">
			Hide Roll: <input type="checkbox" name="hideRoll" value="1"]></input>
		</td>
	</tr>
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,4)]">
		<td align="center">
			<input type="hidden" name="rollTitle" value="[r: json.get(macro.args,3)]"></input>					
			<input type="hidden" name="ExeMacro" value="die100"></input>
      <input type="hidden" name="targetNumber" value="[r: json.get(macro.args,1)]"></input>
      <input type="hidden" name="rollerName" value="[r: getName(currentToken())]"></input>
      <input type="hidden" name="specName" value="[r: specValue]"></input>
      <input type="hidden" name="useWounds" value="0"></input>
      <input type="hidden" name="useTrauma" value="0"></input>
      <input type="hidden" name="useArmorPenalty" value="0"></input>
      <input type="hidden" name="extraText" value="[r: targText + targList]"></input>
			<input type='submit' name='Roll' value='Roll'></input>
		</td>
	</tr>
</table>
</form>
</body>
</html>

!!
@@ @DDInfoDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=c ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
[h: info=json.get(macro.args,0)]
[frame("Derangements and Disorders"): {
<html>
<head>
<title>Derangements & Disorders Display</title>
</head>
<body bgcolor="white">
<table width="100%" height="100%" cellpadding="2" align="center" border="0" bgcolor="white">
	<tr bgcolor="[r: table(PageColor,2)]" color="white">
		<td align="left" width="20">
		</td>
		<td align="left">
      <font size="5"><b>[r: info]</b></font>
		</td>
    <td align="right">
		</td>
	</tr>
	<tr>	
		<td></td>
		<td colspan="2" aligh="left">[r, macro(info+"@this"):""]</td>
	</tr>
</table>
</body>
</html>
}]

!!
@@ @KnowSkillsInfoDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=z ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
[h: skill=json.get(macro.args,0)]
[h: ability=json.get(macro.args,1)]

<!-- Skills that can have multiple fields get a prefix -->
[h: skill = if(startsWith(skill, "Academics"),"Academics",skill)]
[h: skill = if(startsWith(skill, "Art"),"Art",skill)]
[h: skill = if(startsWith(skill, "Interest"),"Interest",skill)]
[h: skill = if(startsWith(skill, "Language"),"Language",skill)]
[h: skill = if(startsWith(skill, "Profession"),"Profession",skill)]

[frame("KnowledgeSkills"): {
<html>
<head>
<title>[r: skill] Info</title>
</head>
<body bgcolor="white">
<table border="0" cellpadding="0" width="100%" height="50%">
	<tr bgcolor="[r: table(PageColor,2)]"  color="white" valign="middle">
		<td><font size="5">
<center><b>[r: skill]</b> ([r: ability])</center><p>
		</font></td>
	</tr>
</table>
[r, macro(skill+"@this"):""]
</body>
</html>
}]

!!
@@ @ActiveSkillsInfoDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=z ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
[h: skill=json.get(macro.args,0)]
[h: ability=json.get(macro.args,1)]

<!-- Skills that can have multiple fields get a prefix -->
[h: skill = if(startsWith(skill, "Exotic Melee"),"Exotic Melee",skill)]
[h: skill = if(startsWith(skill, "Exotic Ranged"),"Exotic Ranged",skill)]
[h: skill = if(startsWith(skill, "Hardware"),"Hardware",skill)]
[h: skill = if(startsWith(skill, "Medicine"),"Medicine",skill)]
[h: skill = if(startsWith(skill, "Networking"),"Networking",skill)]
[h: skill = if(startsWith(skill, "Pilot"),"Pilot",skill)]

[frame("ActiveSkills"): {
<html>
<head>
<title>[r: skill] Info</title>
</head>
<body bgcolor="white">
<table border="0" cellpadding="0" width="100%" height="50%">
	<tr bgcolor="[r: table(PageColor,2)]"  color="white" valign="middle">
		<td><font size="5">
<center><b>[r: skill]</b> ([r: ability])</center><p>
		</font></td>
	</tr>
</table>
[r, macro(skill+"@this"):""]
</body>
</html>
}]

!!
@@ @MuseSkillsInfoDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=z ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
[h: skill=json.get(macro.args,0)]
[h: ability=json.get(macro.args,1)]
[h: ability = substring(ability,0,length(ability) - 5)]

<!-- Skills that can have multiple fields get a prefix -->
[h: skill = if(startsWith(skill, "Academics"),"Academics",skill)]
[h: skill = if(startsWith(skill, "Art"),"Art",skill)]
[h: skill = if(startsWith(skill, "Interest"),"Interest",skill)]
[h: skill = if(startsWith(skill, "Language"),"Language",skill)]
[h: skill = if(startsWith(skill, "Profession"),"Profession",skill)]
[h: skill = if(startsWith(skill, "Exotic Melee"),"Exotic Melee",skill)]
[h: skill = if(startsWith(skill, "Exotic Ranged"),"Exotic Ranged",skill)]
[h: skill = if(startsWith(skill, "Hardware"),"Hardware",skill)]
[h: skill = if(startsWith(skill, "Medicine"),"Medicine",skill)]
[h: skill = if(startsWith(skill, "Networking"),"Networking",skill)]
[h: skill = if(startsWith(skill, "Pilot"),"Pilot",skill)]

[frame("MuseSkills"): {
<html>
<head>
<title>[r: skill] Info</title>
</head>
<body bgcolor="white">
<table border="0" cellpadding="0" width="100%" height="50%">
	<tr bgcolor="[r: table(PageColor,2)]"  color="white" valign="middle">
		<td><font size="5">
<center><b>[r: skill]</b> ([r: ability])</center><p>
		</font></td>
	</tr>
</table>
[r, macro(skill+"@this"):""]
</body>
</html>
}]

!!
@@ @StatsInfoDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=z ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
[h: statShort=json.get(macro.args,0)]

[h,switch(statShort):
  case "TT": statLong = "Trauma Threshold";
  case "LUC": statLong = "Lucidity";
  case "IR": statLong = "Insanity Rating";
  case "WT": statLong = "Wound Threshold";
  case "DUR": statLong = "Durability";
  case "DR": statLong = "Death Rating";
  case "INIT": statLong = "Initiative";
  case "SPD": statLong = "Speed";
  case "DB": statLong = "Damage Bonus";
  default: statLong = ""
]

[frame("StatsInfo"): {
<html>
<head>
<title>[r: statLong] Info</title>
</head>
<body bgcolor="white">
<table border="0" cellpadding="0" width="100%" height="50%">
	<tr bgcolor="[r: table(PageColor,2)]"  color="white" valign="middle">
		<td><font size="5">
      <center><b>[r: statLong]</b> ([r: statShort])</center><p>
		</font></td>
	</tr>
</table>
[r, macro(statShort+"@this"):""]
</body>
</html>
}]

!!
@@ @MuseStatsInfoDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=z ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
[h: statShort=json.get(macro.args,0)]

[h,switch(statShort):
  case "TT_Muse": statLong = "Trauma Threshold";
  case "LUC_Muse": statLong = "Lucidity";
  case "IR_Muse": statLong = "Insanity Rating";
  default: statLong = ""
]

[h,switch(statShort):
  case "TT_Muse": statAbbrev = "TT";
  case "LUC_Muse": statAbbrev = "LUC";
  case "IR_Muse": statAbbrev = "IR";
  default: statAbbrev = ""
]

[frame("StatsInfo"): {
<html>
<head>
<title>[r: statLong] Info</title>
</head>
<body bgcolor="white">
<table border="0" cellpadding="0" width="100%" height="50%">
	<tr bgcolor="[r: table(PageColor,2)]"  color="white" valign="middle">
		<td><font size="5">
      <center><b>[r: statLong]</b> ([r: statShort])</center><p>
		</font></td>
	</tr>
</table>
[r, macro(statAbbrev+"@this"):""]
</body>
</html>
}]

!!
@@ @DamageStressInfoDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=z ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
[h: nameShort=json.get(macro.args,0)]

[frame("DamageStressInfo"): {
<html>
<head>
<title>[r: nameShort] Info</title>
</head>
<body bgcolor="white">
<table border="0" cellpadding="0" width="100%" height="50%">
	<tr bgcolor="[r: table(PageColor,2)]"  color="white" valign="middle">
		<td><font size="5">
      <center><b>[r: nameShort]</b></center><p>
		</font></td>
	</tr>
</table>
[r, macro(nameShort+"@this"):""]
</body>
</html>
}]

!!
@@ @DerangementDisorderInfoDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=z ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
[frame("DD"): {
<html>
<head>
<title>Derangement & Disorder Info</title>
</head>
<body bgcolor="white">
  <table border="0" cellpadding="0" width="100%" height="50%">
    <tr bgcolor="[r: table(PageColor,2)]"  color="white" valign="middle">
      <td><font size="5">
        <center><b>Derangements & Disorders</b></center><p>
      </font></td>
    </tr>
  </table>
  <h1>DERANGEMENTS</h1>
  Derangements are temporary mental conditions that result from traumas. Derangements are measured as Minor, Moderate, or Major. The gamemaster and player should cooperate in choosing which derangement to apply, as appropriate to the scenario and character personality.
  <p>
  Derangements last for 1d10 / 2 hours (round down) or until the character receives psychiatric help, whichever comes first. At the gamemasters discretion, a derangement may last longer if the character has not been distanced from the source of the stress or if they remain embroiled in other stress-inducing situations.
  <p>
  Derangement effects are meant to be roleplayed.  The player should incorporate the derangement into their characters words and actions. If the gamemaster does not feel the player is stressing the effects enough, they can emphasize them. If the gamemaster feels it is appropriate, they may also call for additional modifiers or tests for certain actions.
  <h2>ANXIETY (MINOR)</h2>
  You suffer a panic attack, exhibiting the physiological conditions of fear and worry: sweatiness, racing heart, trembling, shortness of breath, headaches, and so on.
  <h2>AVOIDANCE (MINOR)</h2>
  You are psychologically incapable of dealing with the source of the stress or some circumstance related to it, so you avoid it-even covering your ears, curling up in a ball, or shutting off your sensors if you have to.
  <h2>DIZZINESS (MINOR)</h2>
  The stress makes you light-headed and disoriented.
  <h2>ECHOLALIA (MINOR)</h2>
  You involuntarily repeat words and phrases spoken by others.
  <h2>FIXATION (MINOR)</h2>
  You become fixated on something that you did wrong or some circumstance that led to your stress. You obsess over it, repeating the behavior, trying to fix it, running scenarios through your head and out loud, and so on.
  <h2>HUNGER (MINOR)</h2>
  You are suddenly consumed by an irrational yet overwhelming desire to eat something-perhaps even something unusual.
  <h2>INDECISIVENESS (MINOR)</h2>
  You are flustered by the cause of your stress, finding it difficult to make choices or select courses of action.
  <h2>LOGORRHOEA (MINOR)</h2>
  Your response to the trauma is to engage in excessive talking and babbling. You don't shut up.
  <h2>NAUSEA (MINOR)</h2>
  The stress sickens you, forcing you to fight down queasiness.
  <h2>CHILLS (MODERATE)</h2>
  Your body temperature rises, making you feel cold, and shivering sets in. You just can't get warm.
  <h2>CONFUSION (MODERATE)</h2>
  The trauma scrambles your concentration, making you forget what you're doing, mix up simple tasks, and falter over easy decisions.
  <h2>ECHOPRAXIA (MODERATE)</h2>
  You involuntarily repeat and mimic the actions of others around you.
  <h2>MOOD SWINGS (MODERATE)</h2>
  You lose control of your emotions. You switch from ecstasy to tears and back to rage without warning.
  <h2>MUTE (MODERATE)</h2>
  The trauma shocks you into speechlessness and a complete inability to effectively communicate.
  <h2>NARCISSISM (MODERATE)</h2>
  In the wake of the mental shock, all you can think about is yourself. You cease caring about those around you.
  <h2>PANIC (MODERATE)</h2>
  You are overwhelmed by fear or anxiety and immediately seek to distance yourself from the cause of the stress.
  <h2>TREMORS (MODERATE)</h2>
  You shake violently, making it difficult to hold things or stay still.
  <h2>BLACKOUT (MAJOR)</h2>
  You operate on auto-pilot in a temporary fugue state. Later, you will be incapable of recalling what happened during this period. (Synthetic shells and infomorphs may call up memory records from storage.)
  <h2>FRENZY (MAJOR)</h2>
  You have a major freak out over the source of the stress and attack it.
  <h2>HALLUCINATIONS (MAJOR)</h2>
  You see, hear, or otherwise sense things that aren't really there.
  <h2>HYSTERIA (MAJOR)</h2>
  You lose control, panicking over the source of the stress. This typically results in an emotional outburst of crying, laughing, or irrational fear.
  <h2>IRRATIONALITY (MAJOR)</h2>
  You are so jarred by the stress that your capacity for logical judgment breaks down. You are angered by imaginary offenses, hold unreasonable expectations, or otherwise accept things with unconvincing evidence.
  <h2>PARALYSIS (MAJOR)</h2>
  You are so shocked by the trauma that you are effectively frozen, incapable of making decisions or taking action.
  <h2>PSYCHOSOMATIC CRIPPLING (MAJOR)</h2>
  The trauma overwhelms you, impairing some part of your physical functioning. You suffer from an inexplicable blindness, deafness, or phantom pain or are suddenly incapable of using a limb or other extremity.
  <h1>DISORDERS</h1>
  Disorders reflect more permanent madness. In this case, "permanent" does not necessarily mean forever, but the condition is ongoing until the character receives lengthy and effective psychiatric help. Disorders are inflicted whenever a character accumulates 4 traumas.  The gamemaster and player should choose a disorder that fits the situation and character.
  <p>
  Disorders are not always "active"-they may remain dormant until triggered by certain conditions.  While it is certainly possible to act under a disorder, it represents a severe impairment to a persons ability to maintain normal relationships and do a job successfully. Disorders should not be glamorized as cute roleplaying quirks. They represent the best attempts of a damaged psyche to deal with a world that has failed it in some way.  Additionally, people in many habitats, particularly those in the inner system, still regard disorders as a mark of social stigma and may react negatively towards impaired characters.
  <p>
  Characters that acquire disorders over the course of their adventures may get rid of them in one of two ways, either through in-game attempts to treat them (p. 215) or by buying them off as they would a negative trait (see  Gaining/Losing Traits, p. 153).
  <h2>ADDICTION</h2>
  Addiction as a disorder can refer to any sort of addictive behavior focused toward a particular behavior or substance, to the point where the user is unable to function without the addiction but is also severely impaired due to the effects of the addiction. It is marked by a desire on the part of the subject to seek help or reduce the use of the addicting substance/act, but also by the subject spending large amounts of time in pursuit of their addiction to the exclusion of other activities. This is a step up from the Addiction negative trait on p. 148-this is much more of a crippling behavior that compensates for spending time away from the addiction. Addictions are typically related to the trauma that caused the disorder (VR or drug addictions are encouraged).
  <p>
  <b>Suggested Game Effects:</b> The addict functions in only two states: under the influence of their addiction or in withdrawal. Additionally, they spend large amounts of time away from their other responsibilities in pursuit of their addiction.
  <h2>ATAVISM</h2>
  Atavism is a disorder that mainly affects uplifts. It results in them regressing to an earlier un- or partially uplifted state. They may exhibit behaviors more closely in line with their more animalistic forbears, or they may lose some of their uplift benefits such as the ability for abstract reasoning or speech.  
  <p>
  <b>Suggested Game Effects:</b>  The player and gamemaster should discuss how much of the uplifts nature is lost and adjust game penalties accordingly. It is important to note that other uplifts view atavistic uplifts with something akin to horror and will usually have nothing to do with them.
  <h2>ATTENTION DEFICIT HYPERACTIVITY DISORDER (ADHD)</h2>
  This disorder manifests as a marked inability to focus on any one task for an extended period of time, and also an inability to notice details in most situations.  Sufferers may find themselves starting multiple tasks, beginning a new one after only a cursory attempt at the prior task. ADHD suffers may also have a manic edge that manifests as confidence in their ability to get a given job done, even though they will quickly lose all interest in it.
  <p>
  <b>Suggested Game Effects:</b> Perception and related skill penalties. Increased difficulty modifiers to task actions, particularly as the action drags on.
  <h2>AUTOPHAGY</h2>
  This is a disorder that usually only occurs among uplifted octopi. It is a form of anxiety disorder characterized by self-cannibalism of the limbs. Subjects afflicted with autophagy will, under stress, begin to consume their limbs if at all possible, causing themselves potentially serious harm.
  <p>
  <b>Suggested Game Effects:</b>  Anytime an uplifted octopus with this disorder is placed in a stressful situation they must make a successful WIL x 3 Test or begin to consume one of their limbs.
  <h2>BIPOLAR DISORDER</h2>
  Bipolar disorder is also called manic depression. It is similar to depression except for the fact that the periods of depression are interrupted by brief (a matter of days at most) periods of mania where the subject feels inexplicably "up" about everything with heightened energy and a general disregard for consequences. The depressive stages are similar in all ways to depression. The manic stages are dangerous since the subject will take risks, spend wildly, and generally engage in behavior without much in the way of forethought or potential long term consequences.
  <p>
  <b>Suggested Game Effects:</b>  Similar to depression, but when manic the character must make a WIL x 3 Test to not do some action that may be potentially risky.  They will also try to convince others to go along with the idea.
  <h2>BODY DYSMORPHIA</h2>
  Subjects afflicted with this disorder believe that they are so unspeakably hideous that they are unable to interact with others or function normally for fear of ridicule and humiliation at their appearance. They tend to be very secretive and reluctant to seek help because they are afraid others will think them vain-or they may feel too embarrassed to do so. Ironically, BDD is often misunderstood as a vanity-driven obsession, whereas it is quite the opposite; people with BDD believe themselves to be irrevocably ugly or defective. A similar disorder, gender identity disorder, where the patient is upset with their entire sexual biology, often precipitates BDD-like feelings. Gender identity disorder is directed specifically at external sexually dimorphic features, which are in constant conflict with the patients internal psychiatric gender.
  <p>
  <b>Suggested Game Effects:</b> Because of the nature of Eclipse Phase and the ability to swap out and modify a body, this is a fairly common disorder. It is suggested that characters with this suffer increased or prolonged resleeving penalties since they are unable to fully adjust to the reality of their new morph.
  <h2>BORDERLINE PERSONALITY DISORDER</h2>
  This disorder is marked by a general inability to fully experience ones self any longer. Emotional states are variable and often marked by extremes and acting out. Simply put, the subject feels like they are losing their sense of self and seeks constant reassurance from others around them, yet is not fully able to act in an appropriate way. They may also engage in impulsive behaviors in an attempt to experience some sort of feeling. In extreme cases, there may be suicidal thoughts or attempts.
  <p>
  <b>Suggested Game Effects:</b> The character needs to be around others and will not be left alone, however they also are not quite able to relate to others in a normal way and may also take risks or make impulsive decisions.
  <h2>DEPRESSION</h2>
  Clinical depression is characterized by intense feelings of hopelessness and worthlessness. Subjects usually report feeling as though nothing they do matters and no one would care anyway, so they are disinclined to 
  attempt much in the way of anything. The character is depressed and finds it difficult to be motivated to do much of anything. Even simple acts such as eating and bathing can seem to be monumental tasks.
  <p>
  <b>Suggested Game Effect:</b> Depressives often lack the will to take any sort of action, often to the point of requiring a WIL x 3 Test to engage in sustained activity.
  <h2>FUGUE</h2>
  The character enters into a fugue state where they display little attention to external stimuli.  They will still function physiologically but refrain from speaking and stare off into the distance, unable to focus on events around them. Unlike catatonia, a person in a fugue state will walk around if lead about by a helper, but is otherwise unresponsive. The fugue state is usually a persistent state, but it can be an occasional state that is triggered by some sort of external stimuli similar to the original trauma that triggered the disorder.
  <p>
  <b>Suggested Game Effects:</b> Characters in a fugue state are totally non-responsive to most stimuli around them. They will not even defend themselves if attacked and will usually attempt to curl into a fetal position if physically assaulted.
  <h2>GENERAL ANXIETY DISORDER (GAD)</h2>
  GAD results in severe feelings of anxiety about nearly everything the character comes into contact with. Even simple tasks represent the potential for failure on a catastrophic scale and should be avoided or minimized. Additionally, negative outcomes for any action are always assumed to be the only possible outcomes.
  <p>
  <b>Suggested Game Effects:</b>  A character with GAD will be almost entirely useless unless convinced otherwise, and then only for a short period of time. Another character can attempt to use a relevant social skill to coax the GAD character into doing what is required of them. If the character with the disorder fails at the task, however, all future attempts to coax them will suffer a cumulative 10 penalty.
  <h2>HYPOCHONDRIA</h2>
  Hypochondriacs suffer from a delusion that they are sick in ways that they are not. They will create disorders that they believe they suffer from, usually to get the attention of others. Often hypochondriacs will inflict harm on themselves or even ingest substances that will aid in producing symptoms similar to the disorder they believe they have. These attempts to simulate symptoms can and will cause actual harm to hypochondriacs.
  <p>
  <b>Possible Game Effects:</b> A subject that is hypochondriac will often behave as though they are under the effects of some other disorder or physical malady.  This can be consistent over time or can be different and ever changing. They will react with hostility to claims that they are faking or not actually ill.
  <h2>IMPULSE CONTROL DISORDER</h2>
  Subjects have a certain act or belief that they must engage in a certain activity that comes into their mind.  This can be kleptomania, pyromania, sexual exhibitionism, etc. They feel a sense of building anxiety whenever they are prevented from engaging in this behavior for an extended period (usually several times a day to weekly, depending on the impulse) and will often attempt to engage in this behavior at inconvenient or inappropriate times. This is different from OCD in the sense that OCD is usually a single contained behavior that must be engaged in to reduce anxiety. Impulse control disorder is a variety of behaviors and can be virtually any sort of highly  inappropriate action.
  <p>
  <b>Suggested Game Effects:</b> Similar to OCD, if the character does not engage in the behavior they will grow increasingly disturbed and suffer penalties to all actions until they are able to engage in the compulsion that alleviates their anxiety.
  <h2>INSOMNIA</h2>
  Insomniacs find themselves unable to sleep, or unable to sleep for an extended period of time. This is most often due to anxiety about their lives or as a result of depression and the accompanying negative thought patterns. This is not the sort of sleeplessness that is brought about as a result of normal stress but rather a near total inability to find rest in sleep when it is desired.  Insomniacs may find themselves nodding off at inopportune times, but never for long, and never enough to gain any restful sleep. As a result, they are frequently lethargic and inattentive as their lack of sleep robs them of their edge and eventually any semblance of alertness.   Additionally, insomniacs are frequently irritable due to being on edge and unable to rest.
  <p>
  <b>Suggested Game Effects:</b> Due to the lack of meaningful sleep, insomniacs should suffer from blanket penalties to perception-related tasks or anything requiring concentration or prolonged fine motor abilities.
  <h2>MEGALOMANIA</h2>
  A megalomaniac believes themselves to be the single most important person in the universe. Nothing is more important than the megalomaniac and everything around them must be done according to their whim. Failure to comply with the dictates of a megalomaniac can often result in rages or actual physical assaults by the subject.
  <p>
  <b>Suggested Game Effects:</b>  A character that has megalomania will demand attention and has difficulty in nearly any social situation. Additionally, they may be provoked to violence if they think they are being slighted.
  <h2>MULTIPLE PERSONALITY DISORDER</h2>
  This is the development of a separate, distinct personality from the original or control personality.  The personalities may or may not be aware of each other and "conscious" during the actions of the other personality. Usually there is some sort of trigger that results in the emergence of the non-control personality.  Most subjects have only a single extra personality, but it is not unheard of to have several personalities.  It is important to note that these are distinct individual personalities and not just crude caricatures of the Dr. Jekyll/Mr. Hyde sort. Each personality sees itself as a distinct person with their own wants, needs, and motivations.  Additionally, they are usually unaware of the experiences of the others, though there is some basic information sharing (such as language and core skill sets).
  <p>
  <b>Suggested Game Effects:</b> When the player is under the effects of another personality, they should be treated as an NPC. In some rare cases the player and the gamemaster can work out the second personality and allow the player to roleplay this. This does not however constitute an entire new character that can be "turned on" at will.
  <h2>OBSESSIVE COMPULSIVE DISORDER (OCD)</h2>
  Subjects with OCD are marked by intrusive or inappropriate thoughts or impulses that cause acute anxiety if a particular obsession or compulsion is not engaged in to alleviate them. These obsessions and compulsions can be nearly any sort of behavior that must be immediately engaged in to keep the rising anxiety at bay. Players and gamemasters are encouraged to come up with a behavior that is suitable.  Examples of common behaviors include repetitive tics (touching every finger of each hand to another part of the body, tapping the right foot twenty times), pathological behaviors such as gambling or eating, or a mental ritual that must be completed (reciting a 
  book passage).
  <p>
  <b>Suggested Game Effects:</b> If the character does not engage in the behavior they will grow increasingly disturbed and suffer penalties to all actions until they are able to engage in the compulsion that alleviates their anxiety.
  <h2>POST TRAUMATIC STRESS DISORDER (PTSD)</h2>
  PTSD occurs as a result of being exposed to either a single incident or a series of incidents where the sufferer had their own life, or saw the lives of others, threatened with death. These incidents are often marked by an inability on the part of the victim, either real or perceived, to do anything to alter the outcomes.  As a result, they develop an acute anxiety and fixation on these incidents to the point where they lose sleep, become irritated or easily angered, or are depressed over feelings that they lack control in their own lives.
  <p>
  <b>Suggested Game Effects:</b> Penalties to task actions, also treat situations similar to the initial episodes that caused the disorder as a phobia.
  <h2>SCHIZOPHRENIA</h2>
  While schizophrenia is generally acknowledged as a genetic disorder that has an onset in early adulthood, it also seems to develop in a number of egos that undergo frequent morph changes. It has been theorized that this is due to some sort of repetitive error in the download process. Regardless, it remains a rare, yet persistent danger of dying and being brought back. Schizophrenia is a psychotic disorder where the subject loses their ability to discern reality from unreality. This can involve delusions, hallucinations (often in support of the delusions), and fragmented or disorganized speech. The subject will not be aware of these behaviors and will perceive themselves as functioning normally, often to the point of becoming paranoid that others are somehow involved in a grand deception.
  <p>
  <b>Suggested Game Effects:</b> Schizophrenia represents a total break from reality. A character that is schizophrenic may see and hear things and act on those delusions and hallucinations while seeing attempts by their friends to stop or explain to them as part of a wider conspiracy. Adding to this is the difficulty of communicating coherently. Characters that have become schizophrenic are only marginally functional and only for short periods of time until they have the disorder treated.
  <h1>OPTIONAL EXTRA DISORDERS</h1>
  <h2>Intermittent Explosive Disorder (IED)</h2>
  The person suffering IED has frequent and often unpredictable episodes of extreme anger or physical outbursts that are disproportionate to the situation. Between episodes, there is typically no evidence of violence or physical threat.
  <p>
  <b>Suggested Game Effects:</b> Roll WIL x 3 (or harder, depending on situation) to resist going off a handle whenever there is any provocation, whether real or imagined.
</body>
</html>
}]

!!
@@ @Anxiety
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
(MINOR)<br>
You suffer a panic attack, exhibiting the physiological conditions of fear and worry: sweatiness, racing heart, trembling, shortness of breath, headaches, and so on.

!!
@@ @Avoidance
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
(MINOR)<br>
You are psychologically incapable of dealing with the source of the stress or some circumstance related to it, so you avoid it-even covering your ears, curling up in a ball, or shutting off your sensors if you have to.

!!
@@ @Dizziness
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
(MINOR)<br>
The stress makes you light-headed and disoriented.

!!
@@ @Echolalia
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
(MINOR)<br>
You involuntarily repeat words and phrases spoken by others.

!!
@@ @Fixation
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
(MINOR)<br>
You become fixated on something that you did wrong or some circumstance that led to your stress. You obsess over it, repeating the behavior, trying to fix it, running scenarios through your head and out loud, and so on.

!!
@@ @Hunger
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
(MINOR)<br>
You are suddenly consumed by an irrational yet overwhelming desire to eat something-perhaps even something unusual.

!!
@@ @Indecisiveness
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
(MINOR)<br>
You are flustered by the cause of your stress, finding it difficult to make choices or select courses of action.

!!
@@ @Logorrhoea
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
(MINOR)<br>
Your response to the trauma is to engage in excessive talking and babbling. You don't shut up.

!!
@@ @Nausea
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
(MINOR)<br>
The stress sickens you, forcing you to fight down queasiness.

!!
@@ @Chills
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
(MODERATE)<br>
Your body temperature rises, making you feel cold, and shivering sets in. You just can't get warm.

!!
@@ @Confusion
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
(MODERATE)<br>
The trauma scrambles your concentration, making you forget what you're doing, mix up simple tasks, and falter over easy decisions.

!!
@@ @Echopraxia
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
(MODERATE)<br>
You involuntarily repeat and mimic the actions of others around you.

!!
@@ @Mood Swings
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
(MODERATE)<br>
You lose control of your emotions. You switch from ecstasy to tears and back to rage without warning.

!!
@@ @Mute
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
(MODERATE)<br>
The trauma shocks you into speechlessness and a complete inability to effectively communicate.

!!
@@ @Narcissism
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
(MODERATE)<br>
In the wake of the mental shock, all you can think about is yourself. You cease caring about those around you.

!!
@@ @Panic
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
(MODERATE)<br>
You are overwhelmed by fear or anxiety and immediately seek to distance yourself from the cause of the stress.

!!
@@ @Tremors
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
(MODERATE)<br>
You shake violently, making it difficult to hold things or stay still.

!!
@@ @Blackout
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
(MAJOR)<br>
You operate on auto-pilot in a temporary fugue state. Later, you will be incapable of recalling what happened during this period. (Synthetic shells and infomorphs may call up memory records from storage.)

!!
@@ @Frenzy
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
(MAJOR)<br>
You have a major freak out over the source of the stress and attack it.

!!
@@ @Hallucinations
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
(MAJOR)<br>
You see, hear, or otherwise sense things that aren't really there.

!!
@@ @Hysteria
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
(MAJOR)<br>
You lose control, panicking over the source of the stress. This typically results in an emotional outburst of crying, laughing, or irrational fear.

!!
@@ @Irrationality
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
(MAJOR)<br>
You are so jarred by the stress that your capacity for logical judgment breaks down. You are angered by imaginary offenses, hold unreasonable expectations, or otherwise accept things with unconvincing evidence.

!!
@@ @Paralysis
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
(MAJOR)<br>
You are so shocked by the trauma that you are effectively frozen, incapable of making decisions or taking action.

!!
@@ @Psychosomatic Crippling
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
(MAJOR)<br>
The trauma overwhelms you, impairing some part of your physical functioning. You suffer from an inexplicable blindness, deafness, or phantom pain or are suddenly incapable of using a limb or other extremity.

!!
@@ @Addiction
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
Addiction as a disorder can refer to any sort of addictive behavior focused toward a particular behavior or substance, to the point where the user is unable to function without the addiction but is also severely impaired due to the effects of the addiction. It is marked by a desire on the part of the subject to seek help or reduce the use of the addicting substance/act, but also by the subject spending large amounts of time in pursuit of their addiction to the exclusion of other activities. This is a step up from the Addiction negative trait on p. 148-this is much more of a crippling behavior that compensates for spending time away from the addiction. Addictions are typically related to the trauma that caused the disorder (VR or drug addictions are encouraged).
<p>
<b>Suggested Game Effects:</b> The addict functions in only two states: under the influence of their addiction or in withdrawal. Additionally, they spend large amounts of time away from their other responsibilities in pursuit of their addiction.

!!
@@ @Atavism
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
Atavism is a disorder that mainly affects uplifts. It results in them regressing to an earlier un- or partially uplifted state. They may exhibit behaviors more closely in line with their more animalistic forbears, or they may lose some of their uplift benefits such as the ability for abstract reasoning or speech.  
<p>
<b>Suggested Game Effects:</b>  The player and gamemaster should discuss how much of the uplifts nature is lost and adjust game penalties accordingly. It is important to note that other uplifts view atavistic uplifts with something akin to horror and will usually have nothing to do with them.

!!
@@ @Attention Deficit Hyperactivity Disorder
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
This disorder manifests as a marked inability to focus on any one task for an extended period of time, and also an inability to notice details in most situations.  Sufferers may find themselves starting multiple tasks, beginning a new one after only a cursory attempt at the prior task. ADHD suffers may also have a manic edge that manifests as confidence in their ability to get a given job done, even though they will quickly lose all interest in it.
<p>
<b>Suggested Game Effects:</b> Perception and related skill penalties. Increased difficulty modifiers to task actions, particularly as the action drags on.

!!
@@ @Autophagy
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
This is a disorder that usually only occurs among uplifted octopi. It is a form of anxiety disorder characterized by self-cannibalism of the limbs. Subjects afflicted with autophagy will, under stress, begin to consume their limbs if at all possible, causing themselves potentially serious harm.
<p>
<b>Suggested Game Effects:</b>  Anytime an uplifted octopus with this disorder is placed in a stressful situation they must make a successful WIL x 3 Test or begin to consume one of their limbs.

!!
@@ @Bipolar Disorder
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
Bipolar disorder is also called manic depression. It is similar to depression except for the fact that the periods of depression are interrupted by brief (a matter of days at most) periods of mania where the subject feels inexplicably "up" about everything with heightened energy and a general disregard for consequences. The depressive stages are similar in all ways to depression. The manic stages are dangerous since the subject will take risks, spend wildly, and generally engage in behavior without much in the way of forethought or potential long term consequences.
<p>
<b>Suggested Game Effects:</b>  Similar to depression, but when manic the character must make a WIL x 3 Test to not do some action that may be potentially risky.  They will also try to convince others to go along with the idea.

!!
@@ @Body Dysmorphia
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
Subjects afflicted with this disorder believe that they are so unspeakably hideous that they are unable to interact with others or function normally for fear of ridicule and humiliation at their appearance. They tend to be very secretive and reluctant to seek help because they are afraid others will think them vain-or they may feel too embarrassed to do so. Ironically, BDD is often misunderstood as a vanity-driven obsession, whereas it is quite the opposite; people with BDD believe themselves to be irrevocably ugly or defective. A similar disorder, gender identity disorder, where the patient is upset with their entire sexual biology, often precipitates BDD-like feelings. Gender identity disorder is directed specifically at external sexually dimorphic features, which are in constant conflict with the patients internal psychiatric gender.
<p>
<b>Suggested Game Effects:</b> Because of the nature of Eclipse Phase and the ability to swap out and modify a body, this is a fairly common disorder. It is suggested that characters with this suffer increased or prolonged resleeving penalties since they are unable to fully adjust to the reality of their new morph.

!!
@@ @Borderline Personality Disorder
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
This disorder is marked by a general inability to fully experience ones self any longer. Emotional states are variable and often marked by extremes and acting out. Simply put, the subject feels like they are losing their sense of self and seeks constant reassurance from others around them, yet is not fully able to act in an appropriate way. They may also engage in impulsive behaviors in an attempt to experience some sort of feeling. In extreme cases, there may be suicidal thoughts or attempts.
<p>
<b>Suggested Game Effects:</b> The character needs to be around others and will not be left alone, however they also are not quite able to relate to others in a normal way and may also take risks or make impulsive decisions.

!!
@@ @Depression
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
Clinical depression is characterized by intense feelings of hopelessness and worthlessness. Subjects usually report feeling as though nothing they do matters and no one would care anyway, so they are disinclined to 
attempt much in the way of anything. The character is depressed and finds it difficult to be motivated to do much of anything. Even simple acts such as eating and bathing can seem to be monumental tasks.
<p>
<b>Suggested Game Effect:</b> Depressives often lack the will to take any sort of action, often to the point of requiring a WIL x 3 Test to engage in sustained activity.

!!
@@ @Fugue
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
The character enters into a fugue state where they display little attention to external stimuli.  They will still function physiologically but refrain from speaking and stare off into the distance, unable to focus on events around them. Unlike catatonia, a person in a fugue state will walk around if lead about by a helper, but is otherwise unresponsive. The fugue state is usually a persistent state, but it can be an occasional state that is triggered by some sort of external stimuli similar to the original trauma that triggered the disorder.
<p>
<b>Suggested Game Effects:</b> Characters in a fugue state are totally non-responsive to most stimuli around them. They will not even defend themselves if attacked and will usually attempt to curl into a fetal position if physically assaulted.

!!
@@ @General Anxiety Disorder
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
GAD results in severe feelings of anxiety about nearly everything the character comes into contact with. Even simple tasks represent the potential for failure on a catastrophic scale and should be avoided or minimized. Additionally, negative outcomes for any action are always assumed to be the only possible outcomes.
<p>
<b>Suggested Game Effects:</b>  A character with GAD will be almost entirely useless unless convinced otherwise, and then only for a short period of time. Another character can attempt to use a relevant social skill to coax the GAD character into doing what is required of them. If the character with the disorder fails at the task, however, all future attempts to coax them will suffer a cumulative 10 penalty.

!!
@@ @Hypochondria
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
Hypochondriacs suffer from a delusion that they are sick in ways that they are not. They will create disorders that they believe they suffer from, usually to get the attention of others. Often hypochondriacs will inflict harm on themselves or even ingest substances that will aid in producing symptoms similar to the disorder they believe they have. These attempts to simulate symptoms can and will cause actual harm to hypochondriacs.
<p>
<b>Possible Game Effects:</b> A subject that is hypochondriac will often behave as though they are under the effects of some other disorder or physical malady.  This can be consistent over time or can be different and ever changing. They will react with hostility to claims that they are faking or not actually ill.

!!
@@ @Impulse Control Disorder
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
Subjects have a certain act or belief that they must engage in a certain activity that comes into their mind.  This can be kleptomania, pyromania, sexual exhibitionism, etc. They feel a sense of building anxiety whenever they are prevented from engaging in this behavior for an extended period (usually several times a day to weekly, depending on the impulse) and will often attempt to engage in this behavior at inconvenient or inappropriate times. This is different from OCD in the sense that OCD is usually a single contained behavior that must be engaged in to reduce anxiety. Impulse control disorder is a variety of behaviors and can be virtually any sort of highly  inappropriate action.
<p>
<b>Suggested Game Effects:</b> Similar to OCD, if the character does not engage in the behavior they will grow increasingly disturbed and suffer penalties to all actions until they are able to engage in the compulsion that alleviates their anxiety.

!!
@@ @Insomnia
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
Insomniacs find themselves unable to sleep, or unable to sleep for an extended period of time. This is most often due to anxiety about their lives or as a result of depression and the accompanying negative thought patterns. This is not the sort of sleeplessness that is brought about as a result of normal stress but rather a near total inability to find rest in sleep when it is desired.  Insomniacs may find themselves nodding off at inopportune times, but never for long, and never enough to gain any restful sleep. As a result, they are frequently lethargic and inattentive as their lack of sleep robs them of their edge and eventually any semblance of alertness.   Additionally, insomniacs are frequently irritable due to being on edge and unable to rest.
<p>
<b>Suggested Game Effects:</b> Due to the lack of meaningful sleep, insomniacs should suffer from blanket penalties to perception-related tasks or anything requiring concentration or prolonged fine motor abilities.

!!
@@ @Intermittent Explosive Disorder
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
The person suffering IED has frequent and often unpredictable episodes of extreme anger or physical outbursts that are disproportionate to the situation. Between episodes, there is typically no evidence of violence or physical threat.
<p>
<b>Suggested Game Effects:</b> Roll WIL x 3 (or harder, depending on situation) to resist going off a handle whenever there is any provocation, whether real or imagined.
!!
@@ @Megalomania
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
A megalomaniac believes themselves to be the single most important person in the universe. Nothing is more important than the megalomaniac and everything around them must be done according to their whim. Failure to comply with the dictates of a megalomaniac can often result in rages or actual physical assaults by the subject.
<p>
<b>Suggested Game Effects:</b>  A character that has megalomania will demand attention and has difficulty in nearly any social situation. Additionally, they may be provoked to violence if they think they are being slighted.

!!
@@ @Multiple Personality Disorder
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
This is the development of a separate, distinct personality from the original or control personality.  The personalities may or may not be aware of each other and "conscious" during the actions of the other personality. Usually there is some sort of trigger that results in the emergence of the non-control personality.  Most subjects have only a single extra personality, but it is not unheard of to have several personalities.  It is important to note that these are distinct individual personalities and not just crude caricatures of the Dr. Jekyll/Mr. Hyde sort. Each personality sees itself as a distinct person with their own wants, needs, and motivations.  Additionally, they are usually unaware of the experiences of the others, though there is some basic information sharing (such as language and core skill sets).
<p>
<b>Suggested Game Effects:</b> When the player is under the effects of another personality, they should be treated as an NPC. In some rare cases the player and the gamemaster can work out the second personality and allow the player to roleplay this. This does not however constitute an entire new character that can be "turned on" at will.

!!
@@ @Obsessive Compulsive Disorder
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
Subjects with OCD are marked by intrusive or inappropriate thoughts or impulses that cause acute anxiety if a particular obsession or compulsion is not engaged in to alleviate them. These obsessions and compulsions can be nearly any sort of behavior that must be immediately engaged in to keep the rising anxiety at bay. Players and gamemasters are encouraged to come up with a behavior that is suitable.  Examples of common behaviors include repetitive tics (touching every finger of each hand to another part of the body, tapping the right foot twenty times), pathological behaviors such as gambling or eating, or a mental ritual that must be completed (reciting a 
book passage).
<p>
<b>Suggested Game Effects:</b> If the character does not engage in the behavior they will grow increasingly disturbed and suffer penalties to all actions until they are able to engage in the compulsion that alleviates their anxiety.

!!
@@ @Post Traumatic Stress Disorder
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
PTSD occurs as a result of being exposed to either a single incident or a series of incidents where the sufferer had their own life, or saw the lives of others, threatened with death. These incidents are often marked by an inability on the part of the victim, either real or perceived, to do anything to alter the outcomes.  As a result, they develop an acute anxiety and fixation on these incidents to the point where they lose sleep, become irritated or easily angered, or are depressed over feelings that they lack control in their own lives.
<p>
<b>Suggested Game Effects:</b> Penalties to task actions, also treat situations similar to the initial episodes that caused the disorder as a phobia.

!!
@@ @Schizophrenia
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
While schizophrenia is generally acknowledged as a genetic disorder that has an onset in early adulthood, it also seems to develop in a number of egos that undergo frequent morph changes. It has been theorized that this is due to some sort of repetitive error in the download process. Regardless, it remains a rare, yet persistent danger of dying and being brought back. Schizophrenia is a psychotic disorder where the subject loses their ability to discern reality from unreality. This can involve delusions, hallucinations (often in support of the delusions), and fragmented or disorganized speech. The subject will not be aware of these behaviors and will perceive themselves as functioning normally, often to the point of becoming paranoid that others are somehow involved in a grand deception.
<p>
<b>Suggested Game Effects:</b> Schizophrenia represents a total break from reality. A character that is schizophrenic may see and hear things and act on those delusions and hallucinations while seeing attempts by their friends to stop or explain to them as part of a wider conspiracy. Adding to this is the difficulty of communicating coherently. Characters that have become schizophrenic are only marginally functional and only for short periods of time until they have the disorder treated.

!!
@@ @ReputationInfoDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=z ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
[frame("ReputationInfoDisplay"): {
<html>
<head>
<title>Reputation Tables and Info</title>
</head>
<body>
  <table bgcolor="[r: table(PageColor,4)]">
    <tr>
      <td colspan="4" style="background-color:'[r: table(PageColor,2)]'  ; margin:0px; padding:0px; height:0px">
        <center><h2><span style="color:white">Reputation Networks</span></h2></center>
      </td>
    </tr>
    <tr>
      <td colspan="4" style="background-color:'[r: table(PageColor,3)]'  ; margin:0px; padding:0px; height:0px"><img src='[r: tblImage("Icons",10,5)]' border="0"></img></td>
    </tr>
    <tr bgcolor='[r: table(PageColor,2)]'>
      <td><b><span style="color:white">Network Name</td>
      <td><b><span style="color:white">Rep Name</td>
      <td><b><span style="color:white">Networking Field</td>
      <td><b><span style="color:white">Factions and Others</td>
    </tr>
    <tr bgcolor="white">
      <td>The Circle-A List</td>
      <td>@-Rep</td>
      <td>Autonomists</td>
      <td>anarchists, Barsoomians, Extropians, Titanian, and scum</td>
    </tr>
    <tr>
      <td>CivicNet</td>
      <td>c-Rep</td>
      <td>Hypercorps</td>
      <td>hypercorps, Jovians, Lunars, Martians, Venusians</td>
    </tr>
    <tr bgcolor="white">
      <td>EcoWave</td>
      <td>e-Rep</td>
      <td>Ecologists</td>
      <td>nano-ecologists, preservationists, and reclaimers</td>
    </tr>
    <tr>
      <td>Fame</td>
      <td>f-Rep</td>
      <td>Media</td>
      <td>socialites (also artists, glitterati, and media)</td>
    </tr>
    <tr bgcolor="white">
      <td>Guanxi</td>
      <td>g-Rep</td>
      <td>Criminals</td>
      <td>criminals</td>
    </tr>
    <tr>		
      <td>The Eye</td>
      <td>i-Rep</td>
      <td>Firewall</td>
      <td>Firewall</td>
    </tr>
    <tr bgcolor="white">
      <td>Research Network Associates</td>
      <td>r-Rep</td>
      <td>Scientists</td>
      <td>argonauts (also technologists, researchers, and scientists)</td>
    </tr>
  </table>
  <br>
  <table bgcolor="[r: table(PageColor,4)]">
    <tr>
      <td valign="top">
        <table bgcolor="[r: table(PageColor,4)]">
          <tr>
            <td colspan="2" style="background-color:'[r: table(PageColor,2)]'  ; margin:0px; padding:0px; height:0px">
              <center><h2><span style="color:white">Networking Skill modifiers</span></h2></center>
            </td>
          </tr>
          <tr>
            <td colspan="2" style="background-color:'[r: table(PageColor,3)]'  ; margin:0px; padding:0px; height:0px"><img src='[r: tblImage("Icons",10,5)]' border="0"></img></td>
          </tr>
          <tr bgcolor='[r: table(PageColor,2)]'>
            <td><b><span style="color:white">Situation</td>
            <td><b><span style="color:white">Modifier</td>
          </tr>
          <tr bgcolor="white">
            <td>Favor level exceeds Rep level</td>
            <td>-10 per level</td>
          </tr>
          <tr>
            <td>Rep level exceeds Favor level</td>
            <td>+10 per level</td>
          </tr>
          <tr bgcolor="white">
            <td>Keeping quiet</td>
            <td>-Variable (p. 288)</td>
          </tr>
          <tr>
            <td>Burning Rep</td>
            <td>+Rep amount burned</td>
          </tr>
          <tr bgcolor="white">
            <td>Paying extra</td>
            <td>+10 per level</td>
          </tr>
        </table>
      </td>
      <td valign="top">
        <table bgcolor="[r: table(PageColor,4)]">
          <tr>
            <td colspan="2" style="background-color:'[r: table(PageColor,2)]'  ; margin:0px; padding:0px; height:0px">
              <center><h2><span style="color:white">Reputation levels</span></h2></center>
            </td>
          </tr>
          <tr>
            <td colspan="2" style="background-color:'[r: table(PageColor,3)]'  ; margin:0px; padding:0px; height:0px"><img src='[r: tblImage("Icons",10,5)]' border="0"></img></td>
          </tr>
          <tr bgcolor='[r: table(PageColor,2)]'>
            <td><b><span style="color:white">Reputation Score</td>
            <td><b><span style="color:white">Reputation Level</td>
          </tr>
          <tr bgcolor="white">
            <td>0-19</td>
            <td>Level 1</td>
          </tr>
          <tr>
            <td>20-39</td>
            <td>Level 2</td>
          </tr>
          <tr bgcolor="white">
            <td>40-59</td>
            <td>Level 3</td>
          </tr>
          <tr>
            <td>60-79</td>
            <td>Level 4</td>
          </tr>
          <tr bgcolor="white">
            <td>80-99</td>
            <td>Level 5</td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
  <br>
  <table bgcolor="[r: table(PageColor,4)]">
    <tr>
      <td valign="top">
        <table bgcolor="[r: table(PageColor,4)]">
          <tr>
            <td colspan="4" style="background-color:'[r: table(PageColor,2)]'  ; margin:0px; padding:0px; height:0px">
              <center><h2><span style="color:white">Favors</span></h2></center>
            </td>
          </tr>
          <tr>
            <td colspan="4" style="background-color:'[r: table(PageColor,3)]'  ; margin:0px; padding:0px; height:0px"><img src='[r: tblImage("Icons",10,5)]' border="0"></img></td>
          </tr>
          <tr bgcolor='[r: table(PageColor,2)]'>
            <td><b><span style="color:white">Favor Level</td>
            <td><b><span style="color:white">Timeframe</td>
            <td><b><span style="color:white">Burning Rep cost</td>
            <td><b><span style="color:white">Refresh Rate</td>
          </tr>
          <tr bgcolor="white">
            <td>1 (Trivial)</td>
            <td>1 minute</td>
            <td>0</td>
            <td>1 hour</td>
          </tr>
          <tr>
            <td>2 (Low)</td>
            <td>30 minutes</td>
            <td>1</td>
            <td>1 day</td>
          </tr>
          <tr bgcolor="white">
            <td>3 (Moderate)</td>
            <td>1 hour</td>
            <td>5</td>
            <td>1 week</td>
          </tr>
          <tr>
            <td>4 (High)</td>
            <td>1 day</td>
            <td>10</td>
            <td>1 month</td>
          </tr>
          <tr bgcolor="white">
            <td>5 (Scarce)</td>
            <td>3 days</td>
            <td>20</td>
            <td>3 months</td>
          </tr>
        </table>
      </td>
      <td valign="top">
        <table bgcolor="[r: table(PageColor,4)]">
          <tr>
            <td colspan="2" style="background-color:'[r: table(PageColor,2)]'  ; margin:0px; padding:0px; height:0px">
              <center><h2><span style="color:white">Acquire/Unload Goods</span></h2></center>
            </td>
          </tr>
          <tr>
            <td colspan="2" style="background-color:'[r: table(PageColor,3)]'  ; margin:0px; padding:0px; height:0px"><img src='[r: tblImage("Icons",10,5)]' border="0"></img></td>
          </tr>
          <tr bgcolor='[r: table(PageColor,2)]'>
            <td><b><span style="color:white">Level</td>
            <td><b><span style="color:white">Service</td>
          </tr>
          <tr bgcolor="white">
            <td>1</td>
            <td>Acquire/unload item with an expense of Trivial.</td>
          </tr>
          <tr>
            <td>2</td>
            <td>Acquire/unload item with an expense of Low.</td>
          </tr>
          <tr bgcolor="white">
            <td>3</td>
            <td>Acquire/unload item with an expense of Moderate.</td>
          </tr>
          <tr>
            <td>4</td>
            <td>Acquire/unload item with an expense of High.</td>
          </tr>
          <tr bgcolor="white">
            <td>5</td>
            <td>Acquire/unload item with an expense of Expensive.</td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
  <br>
  <table bgcolor="[r: table(PageColor,4)]">
    <tr>
      <td valign="top">
        <table bgcolor="[r: table(PageColor,4)]">
          <tr>
            <td colspan="2" style="background-color:'[r: table(PageColor,2)]'  ; margin:0px; padding:0px; height:0px">
              <center><h2><span style="color:white">Acquire Services</span></h2></center>
            </td>
          </tr>
          <tr>
            <td colspan="2" style="background-color:'[r: table(PageColor,3)]'  ; margin:0px; padding:0px; height:0px"><img src='[r: tblImage("Icons",10,5)]' border="0"></img></td>
          </tr>
          <tr bgcolor='[r: table(PageColor,2)]'>
            <td><b><span style="color:white">Level</td>
            <td><b><span style="color:white">Service</td>
          </tr>
          <tr bgcolor="white">
            <td>1</td>
            <td><b>Trivial favor:</b> Get someone to perform services for 15 minutes. Move a chair. Browbeat someone. Catch a ride. Research someone online. Borrow 50 credits. Other Trivial cost services.</td>
          </tr>
          <tr>
            <td>2</td>
            <td><b>Minor favor:</b> Get someone to perform services for an hour. Move to a new cubicle. Rough someone up. Loan a vehicle. Provide an alibi. Healing vat rental. Minor hacking assistance. Basic legal or police assistance. Borrow 250 credits. Other Low cost services.</td>
          </tr>
          <tr bgcolor="white">
            <td>3</td>
            <td><b>Moderate favor:</b>  Get someone to perform services for a day. Move to a habitat in the same cluster. Serious beating. Lookout. Short-distance egocast. Short shuttle trip (under 50,000 km). Minor psychosurgery. Uploading. Reservations at the best restaurant ever. Major legal representation or police favors. Borrow 1,000 credits. Other Moderate cost services</td>
          </tr>
          <tr>
            <td>4</td>
            <td><b>Major favor:</b> Get someone to perform services for a month. Move a body. Homicide. Getaway shuttle pilot. Industrial sabotage. Large-volume shipping contract on bulk freighter. Medium-distance egocast. Mid-range shuttle trip (50,000-150,000 km). Moderate psychosurgery. Resleeving. Get out of jail free. Borrow 5,000 credits. Other High cost services.</td>
          </tr>
          <tr bgcolor="white">
            <td>5</td>
            <td><b>Partnership:</b> Get someone to perform services for a year. Move dismembered body. Mass murder. Major embezzlement. Acts of terrorism. Relocate a mid-size asteroid. Long-distance egocast. Long-range shuttle trip (150,000 km or more). Borrow 20,000 credits. Other Expensive cost services.</td>
          </tr>
        </table>
      </td>
      <td valign="top">
        <table bgcolor="[r: table(PageColor,4)]">
          <tr>
            <td colspan="2" style="background-color:'[r: table(PageColor,2)]'  ; margin:0px; padding:0px; height:0px">
              <center><h2><span style="color:white">Acquire Information</span></h2></center>
            </td>
          </tr>
          <tr>
            <td colspan="2" style="background-color:'[r: table(PageColor,3)]'  ; margin:0px; padding:0px; height:0px"><img src='[r: tblImage("Icons",10,5)]' border="0"></img></td>
          </tr>
          <tr bgcolor='[r: table(PageColor,2)]'>
            <td><b><span style="color:white">Level</td>
            <td><b><span style="color:white">Service</td>
          </tr>
          <tr bgcolor="white">
            <td>1</td>
            <td><b>Common Information:</b> Where to eat. What biz a certain hypercorp is in. Who is in charge.</td>
          </tr>
          <tr>
            <td>2</td>
            <td><b>Public Information:</b> Make gray market connections. Where the "bad neighborhood" is. Obscure public database info. Who is the local crime syndicate. Public hypercorp news.</td>
          </tr>
          <tr bgcolor="white">
            <td>3</td>
            <td><b>Private Information:</b> Make black market connections. Where an unlisted hypercorp facility is. Who is a cop. Who is a crime syndicate member. Where someone hangs out. Internal hypercorp news. Who is sleeping with whom.</td>
          </tr>
          <tr>
            <td>4</td>
            <td><b>Secret Information:</b> Make exotic black market connections. Where a secret corp facility is. Where someone is hiding out. Secret hypercorp projects. Who is cheating on whom.</td>
          </tr>
          <tr bgcolor="white">
            <td>5</td>
            <td><b>Top Secret Intel:</b> Where a top secret black-budget lab is. Illegal hypercorp projects. Scandalous data. Blackmail material.</td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
  
</body>
</html>
}]

!!
@@ @Academics
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Field, Knowledge
<p>
<b>Linked Aptitude:</b> COG
<p>
<b>What it is:</b> Academics covers any sort of specialized non-applied knowledge you can only get through intensive education. Most theoretical and applied sciences, social sciences, transhumanities, etc. are covered by this skill. Most of the other skills listed in this chapter could also be taken as an Academics field, reflecting a working theoretical knowledge of the skill-for example, Academics: Armorer or Academics: Interrogation.
<p>
<b>When you use it:</b> Academics is used when a character wishes to call upon a specific body of knowledge. For example, Academics: Chemistry could be used to identify a particular substance, understand an unusual chemical reaction, or determine what elements are needed to nanofabricate something that requires exotic materials. At the gamemaster's discretion, some Academics-related tests might not be defaultable, given that only someone who has been educated in that subject is likely to be able to tackle it.
<p>
<b>Sample Fields:</b> Archeology, Astrobiology, Astronomy, Astrophysics, Astrosociology, Biochemistry, Biology, Botany, Computer Science, Cryptography, Economics, Engineering, Genetics, Geology, Linguistics, Mathematics, Memetics, Nanotechnology, Old Earth History, Physics, Political Science, Psychology, Sociology, Xeno-archeology, Xenolinguistics, Zoology
<p>
<b>Specializations:</b> As appropriate to the field

!!
@@ @Art
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Field, Knowledge
<p>
<b>Linked Aptitude:</b> INT
<p>
<b>What it is:</b> Art confers the ability to create and evaluate artistic endeavors. This is a particularly useful skill in Eclipse Phase, especially in the post-scarcity economies where creativity and vision can be a key component to a character's reputation.
<p>
<b>When you use it:</b> The Art skill can be used to either create a new work of art or to duplicate an existing piece of art in the hopes of passing it off as your own. The skill can also determine the approximate value of a piece of art either on the open market, for monetary exchange systems, or in terms of reputation for the artist.
<p>
<b>Sample Fields:</b> Architecture, Criticism, Dance, Drama, Drawing, Painting, Performance, Sculpture, Simulspace Design, Singing, Speech, Writing
<p>
<b>Specializations:</b> As appropriate to the field

!!
@@ @Interest
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Field, Knowledge
<p>
<b>Linked Aptitude:</b> COG
<p>
<b>What it is:</b> Interest includes just about any topic that captures your attention that isn't covered by another skill. This includes hobbies, obsessions, causes, pastimes, and other recreational pursuits.
<p>
<b>When you use it:</b> Use the Interest skill whenever you need to recall or use knowledge related to the particular interest in question.
<p>
<b>Sample Fields:</b> Ancient Sports, Celebrity Gossip, Conspiracies, Factor Trivia, Gambling, Hypercorp Politics, Lunar Habitats, Martian Beers, Old Earth Nation-States, Reclaimer Blogs, Science Fiction, Scum Drug Dealers, Spaceship Models, Triad Economics, Underground XP
<p>
<b>Specializations:</b> As appropriate to the field

!!
@@ @Language
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Field, Knowledge
<p>
<b>Linked Aptitude:</b> INT
<p>
<b>What it is:</b> Language covers the speaking and reading of languages other than the player's native tongue. A speaker is considered fluent at a skill level of 50; anything above this indicates further refinement in technical vocabulary, accents, and knowledge of dialects.
<p>
<b>When you use it:</b> Use the Language skill whenever you want to speak, understand, or read something in a language at which you are skilled. Most speaking and reading comprehension tests can be considered Simple Success Tests if your skill is over 50, unless the gamemaster rules the subject is sufficiently complex that a non-native speaker would have trouble understanding it.
<p>
<b>Sample Fields:</b> Arabic, Cantonese, English, French, Hindi, Japanese, Mandarin, Portuguese, Russian, Spanish
<p>
<b>Specializations:</b> As appropriate to the field, representing dialects, technical jargon, and subcultural slang

!!
@@ @Animal Handling
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Social
<p>
<b>Linked Aptitude:</b> SAV
<p>
<b>What it is:</b> Skilled animal handlers are able to train and control a wide variety of natural and transgenic animals, including partial uplifts. Though many animal species went extinct during the Fall, a few ark and zoo habitats keep some species alive, and many others can be resurrected from genetic samples. Exotic animals are considered a sign of prestige among the hypercorp elites, and guard animals are occasionally used to protect high-security installations. Likewise, many habitats and settlements employ small armies of partially uplifted, genetically modified, and behavior-controlled creatures for sanitation or other purposes. Many new and strange breeds of animal are created daily to serve a variety of roles.
<p>
<b>When you use it:</b> Animal Handling is used whenever you are trying to manipulate an animal, whether your intent is to calm it down, keep it from attacking, intimidate it, acquire its trust, or goad it into attacking. Your Margin of Success determines how effective you are at convincing the creature. At the gamemasters discretion, modifiers may be applied to the test. Likewise, winning an animal over may sometimes take time and so could be handled as a Task Action with a timeframe of five minutes or more.
<p>
<b>Specializations:</b> Per animal species (dogs, horses, smart rats, etc.)
<h2>Training Animals</h2>
Training animals is a time-consuming task requiring repeated efforts and rewards to reinforce the trained behavior. Treat this as a Task Action with a timeframe of one day to one month, depending on the complexity of the action. Apply modifiers to this test based on the relative intelligence of the animal being trained, how domestic it is, and the complexity of the task.
<p>
Once an animal has been trained, commanding it is treated as a Simple Success Test (see p. 118) except for unusual or stressful situations, in which case the trainer receives a +30 modifier on their Animal Handling Tests when convincing the animal to complete the trained action.

!!
@@ @Beam Weapons
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Combat
<p>
<b>Linked Aptitude:</b> COO
<p>
<b>What it is:</b> The Beam Weapons skill covers the usage and maintenance of standard coherent beam energy weapons such as lasers, particle beam weapons, plasma rifles, and microwave weapons (p. 338).
<p>
<b>When you use it:</b> A player uses their Beam Weapons skill whenever attacking with a beam weapon in combat (p. 191). Beam Weapons may also be used for tests involving maintenance of the weapon, but not for repairing or modifying the weapon (that would be Hardware: Armorer skill).
<p>
<b>Specializations:</b> Lasers, Microwave Weapons, Particle Beam Weapons, Plasma Rifles

!!
@@ @Blades
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Combat
<p>
<b>Linked Aptitude:</b> SOM
<p>
<b>What it is:</b> The Blades skill covers the usage and maintenance of standard bladed weapons (p. 334).
<p>
<b>When you use it:</b> A player uses their Blades skill whenever attacking with a blade weapon in melee combat (p. 191). Blades may also be used for tests involving maintenance of the weapon, but not for repairing or modifying the weapon (that would be Hardware: Armorer skill). This skill is used for blade weapons implanted in the body at the end of an appendage (hands, forearms, feet, octomorph arms, etc.), but the Exotic Melee Weapon skill is used for blades implanted in other parts of the body.
<p>
<b>Specializations:</b> Axes, Implant Blades, Knives, Swords

!!
@@ @Climbing
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Physical
<p>
<b>Linked Aptitude:</b> SOM
<p>
<b>What it is:</b> Climbing is the skill of ascending and descending sheer surfaces with or without the aid of specialized equipment.
<p>
<b>When you use it:</b> This skill is used whenever a character wishes to scale a climbable surface. For heights greater than one story, climbing is handled as a Task Action with a timeframe equivalent to one meter per Combat Turn. For rappelling, the timeframe for descent is 50 meters per Action Turn. Climbing gear (Grip Pads, p. 305; Traction Pads, p. 317; Spindle Climber, p. 333) provides appropriate modifiers.
<p>
<b>Specializations:</b> Assisted, Freehand, Rappelling

!!
@@ @Clubs
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Combat
<p>
<b>Linked Aptitude:</b> SOM
<p>
<b>What it is:</b> The Clubs skill covers the usage and maintenance of standard blunt melee weapons such as batons or sticks (see Clubs, p. 334).
<p>
<b>When you use it:</b> Players use their Clubs skill whenever they want to attack with a blunt weapon in melee combat (p. 191). The Clubs skill may also be used for tests involving maintenance of the weapon, but not for repairing or modifying the weapon (that would be Hardware: Armorer skill).
<p>
<b>Specializations:</b> Batons, Hammers, Staffs

!!
@@ @Control
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Mental, Psi
<p>
<b>Linked Aptitude:</b> WIL (no defaulting)
<p>
<b>What it is:</b> Control is the use of psi to manipulate individuals or actively penetrate their mental processes. This skill is only available to characters with the Psi trait, (p. 147).
<p>
<b>When you use it:</b> Use Control when taking a psionic tour through a foreign ego - messing around included. See Psi, p. 220
<p>
<b>Specializations:</b> By sleight

!!
@@ @Deception
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Social
<p>
<b>Linked Aptitude:</b> SAV
<p>
<b>What it is:</b> Deception is your ability to act, bluff, con, fast talk, lie, misrepresent, and pretend. Accomplished users of deception are able to convince anyone of nearly anything. This skill does not include using a physical disguise or passing yourself off as another person (the Disguise and Impersonate skills cover those areas).
<p>
<b>When you use it:</b> Use this skill whenever you want to deceive someone with words or gestures. A successful skill test means that you have passed off your deception convincingly. At the gamemasters discretion, someone who is actively alert for signs of deception may make an Opposed Test using the Kinesics skill.
<p>
<b>Specializations:</b> Acting, Bluffing, Fast Talk

!!
@@ @Demolitions
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Technical
<p>
<b>Linked Aptitude:</b> COG (no defaulting)
<p>
<b>What it is:</b> Demolitions covers the use of controlled explosives.
<p>
<b>When you use it:</b> Use it when making, placing, and disarming explosives and explosive devices. see Demolitions, p. 197
<p>
<b>Specializations:</b> Commercial Explosives, Disarming, Improvised Explosives

!!
@@ @Disguise
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Physical
<p>
<b>Linked Aptitude:</b> INT
<p>
<b>What it is:</b> Disguise is the art of physically altering your appearance so that you look like someone else. This includes both the use of props (wigs, contacts, skin pigments) and the altering of subtle physical 
characteristics (gait, posture, poise).
<p>
<b>When you use it:</b> Use Disguise to fool someone into thinking you are someone you are not. This can be used to hide your identity or to make yourself look like someone in particular. When used against someone who knows your true look or the appearance of the person you are imitating, this is handled as an Opposed Test against Perception or Investigation.
<p>
<b>Specializations:</b> Cosmetic, Theatrical

!!
@@ @Exotic Melee Weapon
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Field, Active, Combat
<p>
<b>Linked Aptitude:</b> SOM
<p>
<b>What it is:</b> The Exotic Melee Weapon skill covers the use and maintenance of all melee weapons not covered by the Clubs or Blades skills (see p. 334).
<p>
<b>When you use it:</b> Use the Exotic Melee Weapon skill when attacking someone with an exotic melee weapon in melee combat (see p. 191).
<p>
<b>Sample Fields:</b> Morning Star, Spear, Whip
<p>
<b>Specializations:</b> N/A

!!
@@ @Exotic Ranged Weapon
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Field, Active, Combat
<p>
<b>Linked Aptitude:</b> COO
<p>
<b>What it is:</b> Exotic Ranged Weapon skill includes the use and maintenance of all ranged weapons not covered by the Beam, Kinetic, Seeker, Spray, or Throwing Weapons skills.
<p>
<b>When you use it:</b> Use this skill whenever attacking with an exotic ranged weapon in ranged combat (see p. 191).
<p>
<b>Sample Fields:</b> Blowgun, Crossbow, Slingshot
<p>
<b>Specializations:</b> N/A

!!
@@ @Flight
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Physical
<p>
<b>Linked Aptitude:</b> SOM
<p>
<b>What it is:</b> Flight is the skill of using your body to fly. This skill is used when sleeved in or jamming a winged or otherwise flight-capable morph (manual and remote-control flight are handled using Pilot skill).
<p>
<b>When you use it:</b> Use this skill whenever you need to make an aerial maneuver, land in difficult conditions, maintain your course in steep winds, or otherwise keep from crashing or falling.
<p>
<b>Specializations:</b> Diving, Landing, Takeoff, specific maneuvers

!!
@@ @Fray
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Combat
<p>
<b>Linked Aptitude:</b> REF
<p>
<b>What it is:</b> Fray is the ability to get out of the way of incoming attacks, debris, or inconvenient passers-by. Characters that have a high Fray score are able to react quicker than others when dodging or maneuvering.
<p>
<b>When you use it:</b> Whenever a character is physically attacked by an opponent in melee combat, roll Fray to avoid getting hit (see Step 2: Declare Defense, p. 191). Fray may also be used to dodge other events that may harm the character, such as avoiding a charging vehicle or jumping out of the way of a collapsing stack of crates.
<p>
<b>Specializations:</b> Blades, Clubs, Full Defense, Unarmed

!!
@@ @Free Fall
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Physical
<p>
<b>Linked Aptitude:</b> REF
<p>
<b>What it is:</b> Free Fall is about moving in free-fall and microgravity environments.
<p>
<b>When you use it:</b> Use whenever you need to maneuver in a zero-g situation, such as propelling yourself across a large open space or making sure you do not accidentally send yourself spinning off into space. Free Fall is also used when moving with spacesuit maneuvering jets and when parachuting.
<p>
<b>Specializations:</b> Microgravity, Parachuting, Vacsuits

!!
@@ @Freerunning
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Physical
<p>
<b>Linked Aptitude:</b> SOM
<p>
<b>What it is:</b> Freerunning is part running, part gymnastics. It is about moving fast, maneuvering over/under/around/through obstacles, and placing your body where it needs to go. Freerunning/parkour is a popular pastime in habitats where open space is limited.
<p>
<b>When you use it:</b> Use Freerunning whenever you need to overcome an obstacle via movement, such as hurdling a railing, rolling across the hood of a car, jumping across a pit, or swinging around a pole. Freerunning is also used for sprinting (p. 191) and full defense against attacks (p. 198).
<p>
<b>Specializations:</b> Balance, Gymnastics, Jumping, Running

!!
@@ @Gunnery
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Combat
<p>
<b>Linked Aptitude:</b> INT
<p>
<b>What it is:</b> Gunnery skill covers the use and maintenance of large, vehicular, or non-portable weapons systems. Firing these weapons is more like playing a video game than firing a gun.
<p>
<b>When you use it:</b> Use Gunnery when attacking with a vehicle-mounted weapon or weapon emplacement in ranged combat (p. 191).
<p>
<b>Specializations:</b> Artillery, Missiles

!!
@@ @Hardware
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Field, Active, Technical
<p>
<b>Linked Aptitude:</b> COG
<p>
<b>What it is:</b> This skill encompasses the ability to build, repair, physically hack, and upgrade equipment of a specific type.
<p>
<b>When you use it:</b> Hardware is primarily used to repair devices, vehicles, habitat systems, or synthetic morphs. See Building, Repairing, and Modifying below.
<p>
<b>Sample Fields:</b> Aerospace (all air and space vehicles), Armorer (armor and weapons), Electronics (all computerized devices), Groundcraft, Implants, Industrial (habitat, factory, and life support systems), Nautical (watercraft and submarines), Robotics (synthetic morphs).
<p>
<b>Specializations:</b> As appropriate to the field.
<h2>Building</h2>
Creating an item from scratch is handled as a Task Action with a timeframe determined by the gamemaster. The timeframe should be set according to the complexity of the object and could range from an hour (constructing a set of shelves) to days (assembling a robot from spare parts) or even months (building a house). Numerous factors may apply modifiers to the test, such as the use of entoptic blueprints/help manuals (+20) or poor working conditions (-10 to -30). Tools are also a factor, perhaps making the job easier (superior tools +10 to +30), more difficult (poor or inadequate tools, -10 to -30), or even impossible (lack of required tools).
<h2>Repairing</h2>
Damaged items may be repaired in a similar manner. See the rules for Synthmorph and Object Repair, p. 208.
<h2>Modifying</h2>
Altering an objects design and function follows the same basic rules as build and repair, above. The timeframe is determined by the gamemaster as appropriate to the modification.

!!
@@ @Impersonation
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Social
<p>
<b>Linked Aptitude:</b> SAV
<p>
<b>What it is:</b> Impersonation is the skill of trying to pass yourself off as someone else in social situations, including virtual ones. This includes copying mannerisms and speech patterns and using accumulated information to convince others that you are that person. In a universe where appearance is highly variable, the question of identity is largely one of both trust and picking up on behavioral quirks and verbal cues to recognize a given individual.
<p>
<b>When you use it:</b> Sometimes it is fun to pretend you are someone else, and sometimes it is profitable or lifesaving. Use this skill whenever you attempt to convince someone that you are actually someone else through some sort of social or online interaction. Forks use this skill when passing themselves off as their alpha ego. Impersonate is handled as an Opposed Test against the Kinesics skill.
<p>
<b>Specializations:</b> Avatar, Face-to-Face, Verbal

!!
@@ @Infiltration
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Physical
<p>
<b>Linked Aptitude:</b> COO
<p>
<b>What it is:</b> The art of escaping detection.
<p>
<b>When you use it:</b> Use Infiltration whenever you need to physically hide or move with stealth to avoid someone sensing you, whether you are hiding behind a tree, sneaking past a guard, or blending into a crowd. Infiltration can also be used to follow people (shadowing) without them detecting you. Infiltration is an Opposed Test against the Perception of whom -ever you are hiding from. The gamemaster may wish to roll such tests in secret so the player does not know whether they have succeeded or failed.
<p>
<b>Specializations:</b> Blending In, Hiding, Shadowing, Sneaking

!!
@@ @Infosec
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Technical
<p>
<b>Linked Aptitude:</b> COG (no defaulting)
<p>
<b>What it is:</b> Infosec is short for "information security." It encompasses training in electronic intrusion and counterintrusion techniques as well as encryption and decryption.
<p>
<b>When you use it:</b> Infosec is used both for hacking into electronic devices and mesh networks and for protecting them. See The Mesh chapter, p. 234, for more details.
<p>
<b>Specializations:</b> Brute-Force Hacking, Decryption, Probing, Security, Sniffing, Spoofing

!!
@@ @Interfacing
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Technical
<p>
<b>Linked Aptitude:</b> COG
<p>
<b>What it is:</b> Interfacing is about using computerized electronic devices and software.
<p>
<b>When you use it:</b> Use Interfacing to understand an electronic device you are not familiar with, use a program according to its normal operating param-eters, manipulate electronic files of various types (including images, video, XP, and audio files), scan for wireless devices, and otherwise interact with and command your ecto, muse, and other computerized devices. Some Interfacing actions may be Task Actions with a timeframe determined by the gamemaster. For more detail, see The Mesh chapter, p. 234.
<p>
<b>Specializations:</b> Forgery, Scanning, Stealthing, by program

!!
@@ @Intimidation
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Social
<p>
<b>Linked Aptitude:</b> SAV
<p>
<b>What it is:</b> Intimidation is convincing someone to do what you want based on direct threats (implied or actual) or sheer force of personality.
<p>
<b>When you use it:</b> Use Intimidation to scare someone into submission, browbeat them into getting your way, command them to follow your orders, or berate them into giving up information. Influence is handled as an Opposed Test, pitted against the targets WIL+WIL+SAV.
<p>
<b>Specializations:</b> Interrogation, Physical, Verbal

!!
@@ @Investigation
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Mental
<p>
<b>Linked Aptitude:</b> INT
<p>
<b>What it is:</b> Investigation is the art of analyzing evidence, piecing together clues, solving mysteries, and making logical deductions from groups of facts. Investigation differs from Perception in that it is the conscious search for clues or pieces of a puzzle.
<p>
<b>When you use it:</b> Use Investigation to draw conclusions from assorted details. For example, Investigation could be used to determine the likely sequence of events at a crime scene, determine a possible social connection between two people, or deduce how an enemy made their escape. Investigation is a great way to provide clues to players, especially when the subject matter is something their character might know well but the player does not.
<p>
<b>Specializations:</b> Evidence Analysis, Logical Deduc -tions, Physical Investigation, Physical Tracking

!!
@@ @Kinesics
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Social
<p>
<b>Linked Aptitude:</b> SAV
<p>
<b>What it is:</b> Kinesics is the art of empathy and non-vocal communication.
<p>
<b>When you use it:</b> Use Kinesics to read body language, tells, social cues, and other subconscious indicators. It can also be used to emote more effectively. Kinesics is used defensively whenever someone is trying to deceive you; make an Opposed Test against that persons Deception or Impersonation skill.
<p>
Though synthetic morphs are also designed to emote, reading them is not as easy. Apply a 30 modifier when judging a synthetic morph inhabited by a character or AGI. Likewise, standard AIs are also difficult to read; apply a 60 modifier when judging a synthetic morph or pod operated by an AI.
<p>
<b>Specializations:</b> Judge Intent, Nonvocal Communication
<h2>Judging Emotions and Intentions</h2>
Transhumans are empathic beings and so you can attempt to gauge the demeanor and/or intent of someone you are dealing with by rolling a Kinesics Test. This attempt to read someone is far from exact, however, and it is easy to misjudge. The gamemaster should make this test in secret and only allow a hint if successful - it is not possible to read someone with absolute certainty. If the person being judged is intentionally trying to deceive the character, this should be an Opposed Test against their Deception skill.
<h2>Nonvocal Communication</h2>
Experts in Kinesics can effectively communicate with each other simply by posture, stances, gestures, demeanors, and looks. Such communication is necessarily limited in the amount of information it can convey, but feelings, attitudes, affirmation/negation, and simple concepts may be passed. To effectively communicate complex concepts, the gamemaster may require successful Kinesics Tests from both parties, applying modifiers as appropriate.

!!
@@ @Kinetic Weapons
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Combat
<p>
<b>Linked Aptitude:</b> COO
<p>
<b>What it is:</b> Kinetic Weapons covers the use and maintenance of standard kinetic projectile weapons like firearms and railguns (p. 335).
<p>
<b>When you use it:</b> Use this skill whenever attacking with a kinetic weapon in ranged combat (p. 191).
<p>
<b>Specializations:</b> Assault Rifles, Machine Guns, Pistols, Sniper Rifles, Submachine Guns

!!
@@ @Medicine
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Field, Active, Technical
<p>
<b>Linked Aptitude:</b> COG
<p>
<b>What it is:</b> Medicine is the applied care and maintenance of biological beings and life.
<p>
<b>When you use it:</b> Use Medicine whenever you need to apply medical care beyond the immediate help provided by first responders. This includes conducting physical exams, diagnosing ailments, treating problems and illnesses, surgery, using biotech and nanotech medical tools, and long-term care. See Healing and Repair, p. 208.
<p>
<b>Sample Fields:</b> Biosculpting, Exotic Biomorphs, Gene Therapy, General Practice, Implant Surgery, Nanomedicine, Paramedic, Pods, Psychiatry, Remote Surgery, Trauma Surgery, Uplifts (by type), Veterinary
<p>
<b>Specializations:</b> As appropriate to the field

!!
@@ @Navigation
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Mental
<p>
<b>Linked Aptitude:</b> INT
<p>
<b>What it is:</b> Navigation is the art of finding your way, whether using AR maps, a compass, the stars, or an astrogation AI.
<p>
<b>When you use it:</b> Use Navigation whenever you need to plot out a course, determine a direction, or otherwise keep from getting lost.
<p>
<b>Specializations:</b> Astrogation, Map Making, Map Reading

!!
@@ @Networking
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Field, Active, Social
<p>
<b>Linked Aptitude:</b> SAV
<p>
<b>What it is:</b> Networking is your skill at working your contacts, trading favors, and keeping your finger on the pulse of a particular faction or cultural grouping.
<p>
<b>When you use it:</b> Use Networking to gather information or call on services using your Reputation (see Reputation and Social Networks, p. 285).
<p>
<b>Sample Fields:</b> Autonomists (@-rep), Criminals (g-rep), Ecologists (e-rep), Firewall (i-rep), Hypercorps (c-rep), Media (f-rep), Scientists (r-rep). At the gamemasters discretion, this list can be expanded to other (sub) cultural groupings.
<p>
<b>Specializations:</b> As appropriate to the field

!!
@@ @Palming
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Physical
<p>
<b>Linked Aptitude:</b> COO
<p>
<b>What it is:</b> Palming is the skill of handling items quickly and nimbly without others noticing. Palming is not only about dexterous manipulation of objects but also relies heavily on obfuscation, timing, and misdirection.
<p>
<b>When you use it:</b> Use Palming any time you are trying to conceal an item on your person, shoplift, pick a pocket, surreptitiously discard something, or perform a magic trick. Palming is an Opposed Test against the Perception of any onlookers. The gamemaster may wish to make this roll secretly.
<p>
<b>Specializations:</b> Pickpocketing, Shoplifting, Tricks

!!
@@ @Perception
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Mental
<p>
<b>Linked Aptitude:</b> INT
<p>
<b>What it is:</b> Perception is the use of your physical senses (including cybernetic) and awareness of the physical world around you. Perception differs from Investigation in that it is noticing things by chance, rather than actively searching for something.
<p>
<b>When you use it:</b> Use Perception whenever you want to take a detailed account of your surroundings (see Detailed Perception, p. 190). Perception can also be considered an Automatic Action (see Basic Perception, p. 190) and so the gamemaster may call for a Perception Test to determine if you notice something; it is recommended that such tests be rolled secretly by the gamemaster. Perception is also used as an Opposed Test whenever someone around you is trying to be sneaky with Infiltration or Palming.
<p>
<b>Specializations:</b> Aural, Olfactory, Tactile, Taste, Visual

!!
@@ @Persuasion
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Social
<p>
<b>Linked Aptitude:</b> SAV
<p>
<b>What it is:</b> Persuasion is the art of convincing someone to do what you want through the use of words and gestures. This does not include persuasion through threats or force (that is covered by Intimidation) or by lying (covered by Deception).
<p>
<b>When you use it:</b> Use Persuasion any time you are trying to bargain with, convince, or manipulate someone. This can include motivating your subordinates or peers to take action, seducing a companion, winning a political debate, or negotiating a contract, among other things. Persuasion is handled as an Opposed Test against the targets WIL + WIL + SAV when one person is simply trying to win over another. If both parties are trying to convince each other, make it an Opposed Test between Persuasion skills.
<p>
<b>Specializations:</b> Diplomacy, Morale Boosting, Negotiating, Seduction

!!
@@ @Pilot
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Field, Active, Vehicle
<p>
<b>Linked Aptitude:</b> REF
<p>
<b>What it is:</b> Pilot is your skill at driving/flying a vehicle of a particular type.
<p>
<b>When you use it:</b> You use Pilot skill whenever you need to maneuver, control, or avoid crashing a vehicle, whether you are in the pilots seat, remote controlling a robot, or directly jamming a vehicle with VR. Each 
vehicle has a Handling modifier that applies to this test, along with other situational modifiers (see Bots, Synthmorphs, and Vehicles, p. 195).
<p>
<b>Sample Fields:</b> Aircraft, Anthroform (walkers), Exotic Vehicle, Groundcraft (wheeled or tracked), Spacecraft, Watercraft
<p>
<b>Specializations:</b> As appropriate to the field

!!
@@ @Programming
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Technical
<p>
<b>Linked Aptitude:</b> COG (no defaulting)
<p>
<b>What it is:</b> Programming is your talent at writing and modifying software code.
<p>
<b>When you use it:</b> Use Programming to write new programs, modify or patch existing software, break copy protection, find or introduce exploitable flaws, write viruses or worms, design virtual settings, and so on. See  The Mesh chapter, p. 234. Programming is also applied when using nanofabrication devices.
<p>
<b>Specializations:</b> AI Code, Malware, Nanofabrication, Piracy, Simulspace Code
<h2>Nanofabrication</h2>
Nanofabrication is use of Programming skill to create objects using a cornucopia machine, fabber, or maker (see Nanofabricators, p. 327). If you have appropriate blueprints and raw materials, most uses of a nanofabricator can be treated as a Simple Success Test, p. 118. If you wish to create an item for which you do not have blueprints or the proper raw materials, however, or you wish to alter an items design, then a Nanofabrication Test is called for. See Nanofabrication, p. 284.
<p>
<b>Specializations:</b> Art, Clothing, Electronics, Food, Forgery, Weapons

!!
@@ @Protocol
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Social
<p>
<b>Linked Aptitude:</b> SAV
<p>
<b>What it is:</b> Protocol is the art of making a good impression in social settings. This includes keeping up with the latest memes, trends, gossip, interests and habits of various (sub)cultural groups.
<p>
<b>When you use it:</b> Use Protocol whenever you need to choose your words carefully, determine who is the appropriate person to speak to, impress someone with your grasp of customs, or otherwise fit into a specific social/cultural grouping. Part etiquette, part streetwise, Protocol allows you to navigate treacherous social waters and put people at ease. If the character is dealing with a suspicious or hostile audience, make this an Opposed Test against the targets WIL + WIL + SAV.
<p>
<b>Specializations:</b> Anarchist, Brinker, Criminal, Factor, Hypercorp, Infomorph, Mercurial, Reclaimer, Pres-ervationist, Scum, Ultimate
<h2>Negating Social Gaffes</h2>
Sometimes a player will make a mistake that their character never would, whether thats failing to stand in the presence of hypercorp royalty, confusing a gang leader for a peon, or accidentally insulting someones heritage. In cases like this, the player may make a Protocol Test for the appropriate field in order to negate the gaffe. If successful, the character never actually screwed up or at least managed to cover their tracks without ruffling any feathers.

!!
@@ @Psi Assault
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Mental, Psi
<p>
<b>Linked Aptitude:</b> WIL (no defaulting)
<p>
<b>What it is:</b> Psi Assault is the skill of damaging another egos mind. It can only be purchased by characters with the Psi trait (p. 147).
<p>
<b>When you use it:</b> Use Psi Assault when attacking another egos mind in psi combat.
<p>
<b>Specializations:</b> By sleight

!!
@@ @Psychosurgery
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Technical
<p>
<b>Linked Aptitude:</b> INT
<p>
<b>What it is:</b> Psychosurgery is the use of machine-aided psychological techniques to repair, damage, or manipulate the psyche.
<p>
<b>When you use it:</b> Use Psychosurgery to attempt the tricky process of editing someones mind (see Psychosurgery, p. 229). Psychosurgery can be used beneficially to help patients who remember their deaths, feel disconnected after remorphing, or have experienced other sorts of mental traumas. This skill may also be used to interrogate, torture, or otherwise mess with captive minds in a VR environment.
<p>
<b>Specializations:</b> Memory Manipulation, Personality Editing, Psychotherapy

!!
@@ @Research
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Technical
<p>
<b>Linked Aptitude:</b> COG
<p>
<b>What it is:</b> Research is the skill for looking up infor-mation on the mesh: searching, sifting, mining, and interpreting data. This includes knowing where to look, what links to follow, and how to optimize your queries.
<p>
<b>When you use it:</b> Use the Research skill whenever you need to look up the answer to a question, find databases, search archives, or track down anything online. Research is typically a Task Action with the timeframe and difficulty modifier determined by the gamemaster. See Online Research, p. 249.
<p>
<b>Specializations:</b> Tracking, by information type

!!
@@ @Scrounging
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Mental
<p>
<b>Linked Aptitude:</b> INT
<p>
<b>What it is:</b> Scrounging is your ability to find things, particularly things of use or value that are concealed, buried, or hard to find. This includes knowing where to look and what to look for. Scrounging differs from both Perception and Investigation in that it is about finding items hidden among others, and in most cases about finding something in particular (food, valuables, etc.).
<p>
<b>When you use it:</b> Use Scrounging to dumpster-dive a meal, search ruins for relics, find bargains at a bazaar, forage berries in the forest, locate a spacesuit in an abandoned ship, etc. Scrounging is typically handled as a Task Action with a timeframe and difficulty modifier determined by the gamemaster.
<p>
<b>Specializations:</b> Bazaars, Forests, Habitats, Ruins

!!
@@ @Seeker Weapons
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Combat
<p>
<b>Linked Aptitude:</b> COO
<p>
<b>What it is:</b> Seeker Weapons covers the use and main-tenance of seeker launchers and seeker missiles (p. 340).
<p>
<b>When you use it:</b> Use this skill when attacking with a seeker in ranged combat (p. 191).
<p>
<b>Specializations:</b> Armband, Pistol, Rifle, Underbarrel

!!
@@ @Sense
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Mental, Psi
<p>
<b>Linked Aptitude:</b> INT (no defaulting)
<p>
<b>What it is:</b> Sense is the use of psi to scan egos. Only characters with the Psi trait (p. 147) may purchase this skill.
<p>
<b>When you use it:</b> see Psi, p. 220.
<p>
<b>Specializations:</b> By sleight

!!
@@ @Spray Weapons
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Combat
<p>
<b>Linked Aptitude:</b> COO
<p>
<b>What it is:</b> The Spray Weapons skill covers the use and maintenance of cone-effect ranged weapons (see Spray Weapons, p. 340).
<p>
<b>When you use it:</b> A player uses their Spray Weapons skill whenever they are attacking with a spray weapon in ranged combat (p. 191).
<p>
<b>Specializations:</b> Buzzer, Freezer, Shard, Shredder, Torch

!!
@@ @Swimming
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Physical
<p>
<b>Linked Aptitude:</b> SOM
<p>
<b>What it is:</b> Swimming is the art of moving and not drowning within fluids. It includes floating, surface swimming, snorkeling, diving, and related equipment use.
<p>
<b>When you use it:</b> Use Swimming whenever you need to move and survive in water or another liquid environment. Swimming in a non-threatening environment can be handled as a Simple Success Test. Swimming over a long distance could be handled as a Task Action. Diving off a cliff into a lake, preventing yourself from being swept away in a raging river current, or making sure you have set a proper gas mix for a deep-sea dive, among other things, requires a Success Test.
<p>
<b>Specializations:</b> Diving, Freestyle, Underwater Diving

!!
@@ @Throwing Weapons
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Combat
<p>
<b>Linked Aptitude:</b> COO
<p>
<b>What it is:</b> Throwing Weapons skill covers the use and maintenance of standard throwing weapons, like grenades (p. 340).
<p>
<b>When you use it:</b> Use Throwing Weapons skill whenever you are attacking with a throwing weapon in ranged combat (p. 191).
<p>
<b>Specializations:</b> Grenades, Knives, Rocks

!!
@@ @Unarmed Combat
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Active, Combat
<p>
<b>Linked Aptitude:</b> SOM
<p>
<b>What it is:</b> Unarmed Combat is your ability to attack and defend without using weapons.
<p>
<b>When you use it:</b> Use Unarmed Combat whenever you want to attack someone with your fists, feet, elbows, knees, or other body parts in melee combat (p. 191).
<p>
<b>Specializations:</b> Implant Weaponry, Kick, Punch, Subdual

!!
@@ @TT
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<p>
The Trauma Threshold determines if you suffer a trauma (mental wound) each time you take stress (see Mental Health, p. 209). A higher Trauma Threshold means that your mental state is more resilient against experiences that might inflict psychiatric disorders or other serious mental instabilities.
<p>
Trauma Threshold is calculated by dividing Lucidity by 5 (rounding up).

!!
@@ @LUC
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<p>
Lucidity is similar to Durability, except that it measures mental health and state of mind rather than physical well-being. Your Lucidity determines how much stress (mental damage) you can take before you are incapacitated or driven insane (see Mental Health, p. 209).
<p>
Lucidity is unlimited, but generally ranges from 20 to 60 for baseline unmodified humans. Lucidity is determined by your Willpower aptitude x 2.

!!
@@ @IR
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<p>
Your Insanity Rating is the total amount of stress your mind can take before you go permanently insane and are lost for good. Insanity Rating equals LUC x 2.

!!
@@ @WT
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<p>
A Wound Threshold is used to determine if you receive a wound each time you take physical damage (see Physical Health, p. 206). The higher the Wound Threshold, the more resistant to serious injury you are.
<p>
Wound Threshold is calculated by dividing Durability by 5 (rounding up).

!!
@@ @DUR
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<p>
Durability is your morph's physical health (or structural integrity in the case of synthetic shells, or system integrity in the case of infomorphs). It determines the amount of damage your morph can take before you are incapacitated or killed (see Physical Health, p. 206).
<p>
Durability is unlimited, though the range for base-line (unmodified) humans tends to fall between 20 and 60. Your Durability stat is determined by your morph.

!!
@@ @DR
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<p>
Death Rating is the total amount of damage your morph can take before it is killed or destroyed beyond repair. Death Rating is equal to DUR x 1.5 for biomorphs and DUR x 2 for synthmorphs.

!!
@@ @INIT
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<p>
Your character's Initiative stat helps determine when they act in relation to other characters during the Action Turn (see Initiative, p. 188). Your Initiative stat is equal to your character's Intuition (INT) + Reflexes (REF) aptitudes divided by 5 (rounded up). Certain implants and other factors may modify this score.

!!
@@ @SPD
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<p>
The Speed stat determines how often your character gets to act in an Action Turn (see Initiative, p. 188). All characters start with a Speed stat of 1, meaning they act once per turn. Certain implants and other advantages may boost this up to a maximum of 4.

!!
@@ @DB
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<p>
The Damage Bonus stat quantifies how much extra oomph your character is able to give their melee and thrown weapons attacks. Damage Bonus is determined by dividing your Somatics (SOM) aptitude by 10 and rounding down.

!!
@@ @SHOCK DAMAGE
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<p align='justify'>
Shock weapons use high-voltage electrical jolts to physically stun and incapacitate targets. Shock weapons are particularly effective against biomorphs and pods, even when heavily armored. Synthmorphs, bots, and vehicles are immune to shock weapon effects.
</p><p align='justify'>
A biomorph struck with a shock weapon must make a DUR + Energy Armor Test (using their current DUR score, reduced by damage they have taken). If they fail, they immediately lose neuromuscular control, fall down, and are incapacitated for 1 Action Turn per 10 full points of MoF (minimum of 3 Action Turns). During this time they are stunned and incapable of taking any action, possibly convulsing, suffering vertigo, nausea, etc. After this period, they may act but they remain stunned and shaken, suffering a -30 modifier to all actions. This modifier reduces by 10 per minute (so -20 after 1 minute, -10 after 2 minutes, and no modifier after 3 minutes). Many shock weapons also inflict DV, which is handled as normal.
</p><p align='justify'>
A biomorph that succeeds the DUR Test is still shocked but not incapacitated. They suffer half the listed DV and suffer a -30 modifier until the end of the next Action Turn. This modifier reduces by 10 per Action Turn. Modifiers from additional shocks are not cumulative, but will boost the modifier back to its maximum value.
</p>

!!
@@ @DAMAGE
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Damage Points</b>
<p>
Any physical harm that befalls your character is measured in damage points. These points are cumulative, and are recorded on your character sheet. Damage points are characterized as fatigue, stun, bruises, bumps, sprains, minor cuts, and similar hurts that, while painful, do not significantly impair or threaten your character's life unless they accumulate to a significant amount. Any source of harm that inflicts a large amount of damage points at once, however, is likely to have a more severe effect (see Wounds).
<p>
Damage points may be reduced by rest, medical care, and/or repair (see Healing and Repair, p. 208).
<p>
<b>Damage Types</b>
<p>
Physical damage comes in three forms: Energy, Kinetic, and Psi.
<p>
<b>Energy Damage</b>
<p>
Energy damage includes lasers, plasma guns, fire, electrocution, explosions, and others sources of damaging energy.
<p>
<b>Kinetic Damage</b>
<p>
Kinetic damage is caused by projectiles and other objects moving at great speeds that disperse their energy into the target upon impact. Kinetic attacks include slug-throwers, flechette weapons, knives, and punches.
<p>
<b>Psi Damage</b>
<p>
Psi damage is caused by offensive psi sleights like Psychic Stab (p. 228).

!!
@@ @WOUNDS
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
Wounds represent more grievous injuries: bad cuts and hemorrhaging, fractures and breaks, mangled limbs, and other serious damage that impairs your ability to function and may lead to death or long-term damage.
<p>
Any time your character sustains damage, compare the amount inflicted (after it has been reduced by armor) to your Wound Threshold. If the modified DV equals or exceeds your Wound Threshold, you have suffered a wound. If the inflicted damage is double your Wound Threshold, you suffer 2 wounds; if triple your Wound Threshold, you suffer 3 wounds; and so on.
<p>
Wounds are cumulative and must be marked on your character sheet.
<p>
<b>Wound Effects</b>
<p>
Each wound applies a cumulative -10 modifier to actions and -1 to Initiative. A character with 3 wounds, for example, suffers -30 to all actions and -3 to Initiative.
<p>
Some traits, morphs, implants, drugs, and psi allow a character to ignore wound modifiers. These effects are cumulative, though a maximum of 3 wounds worth of modifiers may be negated (-30 to actions and -3 to Initiative). 
<p>
<b>Knockdown:</b> Any time a character takes a wound, they must make an immediate SOM x 3 Test. Wound modifiers apply. If they fail, they are knocked down and must expend a Quick Action to get back up. Bots and vehicles must make a Pilot Test to avoid crashing.
<p>
<b>Unconsciousness:</b> Any time a character receives 2 or more wounds at once (from the same attack), they must also make an immediate SOM x 3 Test; wound modifiers again apply. If they fail, they have been knocked unconscious (until they are awoken or heal). Bots and vehicles that take 2 or more wounds at once automatically crash (see Crashing, p. 196).
<p>
<b>Bleeding:</b> Any biomorph character who has suffered a wound and who takes damage that exceeds their Durability is in danger of bleeding to death. They incur 1 additional damage point per Action Turn (20 per minute) until they receive medical care or die.

!!
@@ @STRESS
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Stress Points</b>
<p>
Stress points represent fractures in your ego's integrity, cracks in the mental image of yourself. This mental damage is experienced as cerebral shocks, disorientation, cognitive disconnects, synaptic misfires, or an undermining of the intellectual faculties. On their own, these stress points do not significantly impair your character's functioning, but if allowed to accumulate they can have severe repercussions. Additionally, any source that inflicts a large amount of stress points at once is likely to have a more severe impact (see Trauma, p. 209).
<p>
Stress points may be reduced by long-term rest, psychiatric care, and/or psychosurgery (p. 215).
<p>
<b>Lucidity and Stress</b>
<p>
Your Lucidity stat benchmarks your character's mental stability. If you build up an amount of stress points equal to or greater than your Lucidity score, your character's ego immediately suffers a mental breakdown. You effectively go into shock and remain in a catatonic state until your stress points are reduced to a level below your Lucidity stat. Accumulated stress points will overwhelm egos housed inside synthetic shells or infomorphs just as they will biological brains-the mental software effectively seizes up, incapable of functioning until it is debugged.

!!
@@ @TRAUMA
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
Mental trauma is more severe than stress points. Traumas represent severe mental shocks, a crumbling of personality/self, delirium, paradigm shifts, and other serious cognitive malfunctions. Traumas impair your character's functioning and may result in temporary derangements or permanent disorders.
<p>
If your character receives a number of stress points at once that equals or exceeds their Trauma Threshold, they have suffered a trauma. If the inflicted stress points are double or triple the Trauma Threshold, they suffer 2 or 3 traumas, respectively, and so on. Traumas are cumulative and must be recorded on your character sheet.
<p>
<b>Trauma Effects</b>
<p>
Each trauma applies a cumulative -10 modifier to all of the character's actions and -1 to Initiative. A character with 2 traumas, for example, suffers -20 to all actions and -2 Initiative. These modifiers are also cumulative with wound modifiers.
<p>
<b>Disorientation:</b>  Any time a character suffers a trauma, they must make an immediate WIL x 3 Test. Trauma modifiers apply. If they fail, they are temporarily stunned and disoriented and must expend a Complex Action to regain their wits.
<p>
<b>Derangements and Disorders:</b> Any time a character is hit with a trauma, they suffer a temporary derangement (see Derangements). The first trauma inflicts a minor derangement. If a second trauma is applied, the first derangement is either upgraded from minor to a moderate derangement or else a second minor derangement is applied (gamemaster's discretion). Likewise, a third trauma may upgrade that derangement from moderate to major or else inflict a new minor. It is generally recommended that derangements be upgraded in potency, especially when result from the same set of ongoing circumstances. In the case of traumas that result from distinctly separate situations and sources, separate derangements may be applied.
<p>
<b>Disorder:</b> When four or more traumas have been inflicted on a character, a major derangement is upgraded to a disorder. Disorders represent long-lasting psychological afflictions that typically require weeks or even months of psychotherapy and/or psychosurgery to remedy (see Disorders, p. 211).

!!
@@ @Profession
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Info ; tooltip= ; minWidth= ; 
<b>Type:</b> Field, Knowledge
<p>
<b>Linked Aptitude:</b> COG
<p>
<b>What it is:</b> Profession skills indicate training in a profession practiced in Eclipse Phase. This can indicate either formal training or informal, on-the-job type training and includes both legal and extralegal trades.
<p>
<b>When you use it:</b> Use Profession to perform work-related tasks for a specific trade (i.e. mining, balancing accounts, designing a security system, etc.) or to reference specialized knowledge that someone trained in that profession might have.
<p>
<b>Sample Fields:</b> Accounting, Appraisal, Asteroid Prospecting, Banking, Cool Hunting, Con Schemes, Distribution, Forensics, Lab Technician, Mining, Police Procedures, Psychotherapy, Security Ops, Smuggling Tricks, Social Engineering, Squad Tactics, Viral Marketing, XP Production
<p>
<b>Specializations:</b> As appropriate to the field

!!
@@ @EgoTraitsShowUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[if(getProperty("EgoTraitsShow")): setProperty("EgoTraitsShow",0); setProperty("EgoTraitsShow",1)]
[h: RecalcBottomSheet("Powers")]
[r, macro("SheetLoad@this"):macro.args]

!!
@@ @PsiSleightsShowUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[if(getProperty("PsiSleightsShow")): setProperty("PsiSleightsShow",0); setProperty("PsiSleightsShow",1)]
[h: RecalcBottomSheet("Powers")]
[r, macro("SheetLoad@this"):macro.args]

!!
@@ @GearShowUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[if(getProperty("GearShow")): setProperty("GearShow",0); setProperty("GearShow",1)]
[h: RecalcBottomSheet("Powers")]
[r, macro("SheetLoad@this"):macro.args]

!!
@@ @MorphTraitsShowUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[if(getProperty("MorphTraitsShow")): setProperty("MorphTraitsShow",0); setProperty("MorphTraitsShow",1)]
[h: RecalcBottomSheet("Powers")]
[r, macro("SheetLoad@this"):macro.args]

!!
@@ @DefenseShowUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[if(getProperty("DefenseShow")): setProperty("DefenseShow",0); setProperty("DefenseShow",1)]
[h: RecalcBottomSheet("Combat")]
[r, macro("SheetLoad@this"):macro.args]

!!
@@ @ImplantsEnhancementsShowUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[if(getProperty("ImplantsEnhancementsShow")): setProperty("ImplantsEnhancementsShow",0); setProperty("ImplantsEnhancementsShow",1)]
[h: RecalcBottomSheet("Powers")]
[r, macro("SheetLoad@this"):macro.args]

!!
@@ @EgoTraitsUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[h: text = json.get(macro.args, "Text")]
[h: text = encode(text)]
[h: jsonData = json.append("[]",text)]
[h: EgoTraits = json.set(EgoTraits, json.get(macro.args, "Name"), jsonData)]
[if(json.get(macro.args, "Deletecheck")=="1"), code:{[h: EgoTraits = json.remove(EgoTraits, json.get(macro.args, "Name"))]}; {}]
[if(json.get(macro.args, "Name") != json.get(macro.args, "overwrite")),code:{[h: EgoTraits = json.remove(EgoTraits, json.get(macro.args, "overwrite"))]}; {}]
[h: RecalcBottomSheet("Powers")]
[h, macro("SheetLoad@this"):""]
Ego Traits Updated

!!
@@ @PsiSleightsUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[h: text = json.get(macro.args, "Text")]
[h: text = encode(text)]
[h: jsonData = json.append("[]",text, json.get(macro.args,"Strain"), json.get(macro.args,"StrainType"))]
[h: PsiSleights = json.set(PsiSleights, json.get(macro.args, "Name"), jsonData)]
[if(json.get(macro.args, "Deletecheck")=="1"), code:{[h: PsiSleights = json.remove(PsiSleights, json.get(macro.args, "Name"))]}; {}]
[if(json.get(macro.args, "Name") != json.get(macro.args, "overwrite")),code:{[h: PsiSleights = json.remove(PsiSleights, json.get(macro.args, "overwrite"))]}; {}]
[h: RecalcBottomSheet("Powers")]
[h, macro("SheetLoad@this"):""]
Psi Sleights Updated

!!
@@ @GearUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[h: text = json.get(macro.args, "Text")]
[h: text = encode(text)]
[h: jsonData = json.append("[]",text)]
[h: Gear = json.set(Gear, json.get(macro.args, "Name"), jsonData)]
[if(json.get(macro.args, "Deletecheck")=="1"), code:{[h: Gear = json.remove(Gear, json.get(macro.args, "Name"))]}; {}]
[if(json.get(macro.args, "Name") != json.get(macro.args, "overwrite")),code:{[h: Gear = json.remove(Gear, json.get(macro.args, "overwrite"))]}; {}]
[h: RecalcBottomSheet("Powers")]
[h, macro("SheetLoad@this"):""]
Gear Updated

!!
@@ @MorphTraitsUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[h: text = json.get(macro.args, "Text")]
[h: text = encode(text)]
[h: jsonData = json.append("[]",text)]
[h: MorphTraits = json.set(MorphTraits, json.get(macro.args, "Name"), jsonData)]
[if(json.get(macro.args, "Deletecheck")=="1"), code:{[h: MorphTraits = json.remove(MorphTraits, json.get(macro.args, "Name"))]}; {}]
[if(json.get(macro.args, "Name") != json.get(macro.args, "overwrite")),code:{[h: MorphTraits = json.remove(MorphTraits, json.get(macro.args, "overwrite"))]}; {}]
[h: RecalcBottomSheet("Powers")]
[h, macro("SheetLoad@this"):""]
Morph Traits Updated

!!
@@ @ImplantsEnhancementsUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[h: text = json.get(macro.args, "Text")]
[h: text = encode(text)]
[h: jsonData = json.append("[]",text)]
[h: ImplantsEnhancements = json.set(ImplantsEnhancements, json.get(macro.args, "Name"), jsonData)]
[if(json.get(macro.args, "Deletecheck")=="1"), code:{[h: ImplantsEnhancements = json.remove(ImplantsEnhancements, json.get(macro.args, "Name"))]}; {}]
[if(json.get(macro.args, "Name") != json.get(macro.args, "overwrite")),code:{[h: ImplantsEnhancements = json.remove(ImplantsEnhancements, json.get(macro.args, "overwrite"))]}; {}]
[h: RecalcBottomSheet("Powers")]
[h, macro("SheetLoad@this"):""]
Implants & Enhancements Updated

!!
@@ @DDUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[h,if(json.contains(macro.args,"Clear All")),CODE:
{
  [h,if(json.isEmpty(DandD)): ""; DandD = "[]"]
};{
  [h: data = json.remove(macro.args, "Submit")]
  [h: dataFields = json.fields(data,"json")]
  [h,if(json.equals(DandD,dataFields)): ""; DandD = dataFields]
}]
[h: RecalcTopSheet()]
[h, macro("SheetLoad@Lib:MnM"):""]

!!
@@ @RezPointsUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[h: status = input("rez|"+RezPoints+"|Rez Points")]
[h: abort(status)]
[h,if(isNumber(rez) != 1): abort(0)]
[h,if(rez < 0): abort(0)]
[h: RezPoints = rez]
[h: RecalcTopSheet()]
[h, macro("SheetLoad@this"):""]
[h: outputter = strformat("<span bgcolor=#cccccc>%s updated Rez Points to: <b>%d</b> !!</span>",getName(currentToken()),RezPoints)]
{outputter}

!!
@@ @DSUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[h: argName = json.get(macro.args,0)]
[if(argName == "DAMAGE" || argName == "STRESS"),code:
  {
    [h: status = input("val|0|"+argName+" Points taken")]
    [h: abort(status)]
    [h,if(isNumber(val) != 1): abort(0)]
    [h,if(val < 1): abort(0)]
    [h: setProperty(argName, getProperty(argName) + val)]
    [h: RecalcBottomSheet("Combat")]
    [h, macro("SheetLoad@this"):""]
    [h: outputter = strformat("<span bgcolor=#cccccc>%s took %s points: <b>%d</b> !! (new total: %d)</span>",getName(currentToken()),argName,val,getProperty(argName))]
    {outputter}
  };
  {
    [h: setProperty(argName, getProperty(argName) + 1)]
    [h: RecalcBottomSheet("Combat")]
    [h, macro("SheetLoad@this"):""]
    [h: outputter = strformat("<span bgcolor=#cccccc>%s took 1 %s !! (new total: %d)</span>",getName(currentToken()),argName,getProperty(argName))]
    {outputter}
  }
]

!!
@@ @WeaponShowUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[if(getProperty("WeaponShow")): setProperty("WeaponShow",0); setProperty("WeaponShow",1)]
[h: RecalcBottomSheet("Combat")]
[r, macro("SheetLoad@this"):macro.args]

!!
@@ @WeaponUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[h: delete = json.get(macro.args, "delete")]
[h: weapName = json.get(macro.args, "weapName")]
[if (delete == 1), code:
{
  [h: Weapons = json.remove(Weapons,weapName)]
};{
  [h: weapAP = json.get(macro.args, "weapAP")]
  [h: weapDV = json.get(macro.args, "weapDV")]
  [h: weapFModes1 = json.get(macro.args, "weapFModes1")]
  [h: weapFModes2 = json.get(macro.args, "weapFModes2")]
  [h: weapFModes3 = json.get(macro.args, "weapFModes3")]
  [h: weapAmmo = json.get(macro.args, "weapAmmo")]
  [h: weapCurrAmmo = json.get(macro.args, "weapCurrAmmo")]
  [h: weapSkill = json.get(macro.args, "weapSkill")]
  [h: weapExotic = json.get(macro.args, "weapExotic")]
  [h: weapText = json.get(macro.args, "weapText")]
  [h: weapDesc = json.get(macro.args, "weapDesc")]
  [h: weapSpec = json.get(macro.args, "weapSpec")]
  [h,if(weapSpec == ""): weapSpec = 0]
  [h: weapLaser = json.get(macro.args, "weapLaser")]
  [h,if(weapLaser == ""): weapLaser = 0]

  [h: jsonFModes = "[]"]
  [h,if(weapFModes1 != "none"): jsonFModes = json.append(jsonFModes, weapFModes1); jsonFModes = jsonFModes]
  [h,if(weapFModes2 != "none"): jsonFModes = json.append(jsonFModes, weapFModes2); jsonFModes = jsonFModes]
  [h,if(weapFModes3 != "none"): jsonFModes = json.append(jsonFModes, weapFModes3); jsonFModes = jsonFModes]
  [h,if(startsWith(weapSkill, "Exotic")): weapSkill = weapSkill + ": " + weapExotic; weapSkill = weapSkill]
  [h: jsonWeap = json.append("[]", weapAP, weapDV, jsonFModes, if(weapCurrAmmo == -1,weapAmmo,weapCurrAmmo), weapAmmo, weapSkill, weapText, encode(weapDesc), weapSpec, weapLaser)]
  [h: Weapons = json.set(Weapons,weapName,jsonWeap)]
}]

[h: RecalcBottomSheet("Combat")]
[h, macro("SheetLoad@Lib:MnM"):""]
New Weapon Added

!!
@@ @KnowSkillsUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[foreach(tempAbility, json.fields(KnowledgeSkills), ""), code: {
  [h: propDelete = json.get(macro.args, tempAbility+"Delete")]
  [h, if(propDelete!=""), code: 
  {
    [h: KnowledgeSkills = json.remove(KnowledgeSkills,tempAbility)]
  };{
    [h: propBase = json.get(macro.args, tempAbility+"Base")]
    [h: propBonus = json.get(macro.args, tempAbility+"Bonus")]
    [h: propAptitude = json.get(macro.args, tempAbility+"Aptitude")]
    [h: propSpec = json.get(macro.args, tempAbility+"Spec")]
    [h: propData = json.append("[]", propBase, propBonus, propAptitude, 1, propSpec)]
    [h: KnowledgeSkills = json.set(KnowledgeSkills, tempAbility, propData)]
  }]
}]

[h: newKnow = json.get(macro.args, "newAcademics")]
[if(newKnow == ""),code:{}; {
  [h: name = "Academics: "+newKnow]
  [h: propBase = json.get(macro.args, "newAcademicsBase")]
  [h: propBonus = json.get(macro.args, "newAcademicsBonus")]
  [h: propSpec = json.get(macro.args, "newAcademicsSpec")]
  [h: propData = json.append("[]", propBase, propBonus, "COG", 1, propSpec)]
  [h: KnowledgeSkills = json.set(KnowledgeSkills, name, propData)]
}]
[h: newKnow = json.get(macro.args, "newArt")]
[if(newKnow == ""),code:{}; {
  [h: name = "Art: "+newKnow]
  [h: propBase = json.get(macro.args, "newArtBase")]
  [h: propBonus = json.get(macro.args, "newArtBonus")]
  [h: propSpec = json.get(macro.args, "newArtSpec")]
  [h: propData = json.append("[]", propBase, propBonus, "INT", 1, propSpec)]
  [h: KnowledgeSkills = json.set(KnowledgeSkills, name, propData)]
}]
[h: newKnow = json.get(macro.args, "newInterest")]
[if(newKnow == ""),code:{}; {
  [h: name = "Interest: "+newKnow]
  [h: propBase = json.get(macro.args, "newInterestBase")]
  [h: propBonus = json.get(macro.args, "newInterestBonus")]
  [h: propSpec = json.get(macro.args, "newInterestSpec")]
  [h: propData = json.append("[]", propBase, propBonus,"COG", 1, propSpec)]
  [h: KnowledgeSkills = json.set(KnowledgeSkills, name, propData)]
}]
[h: newKnow = json.get(macro.args, "newLanguage")]
[if(newKnow == ""),code:{}; {
  [h: name = "Language: "+newKnow]
  [h: propBase = json.get(macro.args, "newLanguageBase")]
  [h: propBonus = json.get(macro.args, "newLanguageBonus")]
  [h: propSpec = json.get(macro.args, "newLanguageSpec")]
  [h: propData = json.append("[]", propBase, propBonus,"INT", 1, propSpec)]
  [h: KnowledgeSkills = json.set(KnowledgeSkills, name, propData)]
}]
[h: newKnow = json.get(macro.args, "newProfession")]
[if(newKnow == ""),code:{}; {
  [h: name = "Profession: "+newKnow]
  [h: propBase = json.get(macro.args, "newProfessionBase")]
  [h: propBonus = json.get(macro.args, "newProfessionBonus")]
  [h: propSpec = json.get(macro.args, "newProfessionSpec")]
  [h: propData = json.append("[]", propBase, propBonus,"COG", 1, propSpec)]
  [h: KnowledgeSkills = json.set(KnowledgeSkills, name, propData)]
}]

[h: RecalcBottomSheet("Skills")]
[h, macro("SheetLoad@Lib:MnM"):""]
Knowledge Skills Updated

!!
@@ @ActiveSkillsUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[foreach(tempAbility, json.fields(ActiveSkills), ""), code: {
  [h: propDelete = json.get(macro.args, tempAbility+"Delete")]
  [h, if(propDelete!=""), code: 
  {
    [h: ActiveSkills = json.remove(ActiveSkills,tempAbility)]
  };{
    [h: propBase = json.get(macro.args, tempAbility+"Base")]
    [h: propBonus = json.get(macro.args, tempAbility+"Bonus")]
    [h: propAptitude = json.get(macro.args, tempAbility+"Aptitude")]
    [h: propDefault = json.get(macro.args, tempAbility+"Default")]
    [h: propSpec = json.get(macro.args, tempAbility+"Spec")]
    [h: propData = json.append("[]", propBase, propBonus, propAptitude, propDefault, propSpec)]
    [h: ActiveSkills = json.set(ActiveSkills, tempAbility, propData)]
  }]
}]

[h: newActive = json.get(macro.args, "newExoticMelee")]
[if(newActive == ""),code:{}; {
  [h: name = "Exotic Melee: "+newActive]
  [h: propBase = json.get(macro.args, "newExoticMeleeBase")]
  [h: propBonus = json.get(macro.args, "newExoticMeleeBonus")]
  [h: propSpec = json.get(macro.args, "newExoticMeleeSpec")]
  [h: propData = json.append("[]", propBase, propBonus, "SOM", 1, propSpec)]
  [h: ActiveSkills = json.set(ActiveSkills, name, propData)]
}]
[h: newActive = json.get(macro.args, "newExoticRanged")]
[if(newActive == ""),code:{}; {
  [h: name = "Exotic Ranged: "+newActive]
  [h: propBase = json.get(macro.args, "newExoticRangedBase")]
  [h: propBonus = json.get(macro.args, "newExoticRangedBonus")]
  [h: propSpec = json.get(macro.args, "newExoticRangedSpec")]
  [h: propData = json.append("[]", propBase, propBonus, "COO", 1, propSpec)]
  [h: ActiveSkills = json.set(ActiveSkills, name, propData)]
}]
[h: newActive = json.get(macro.args, "newHardware")]
[if(newActive == ""),code:{}; {
  [h: name = "Hardware: "+newActive]
  [h: propBase = json.get(macro.args, "newHardwareBase")]
  [h: propBonus = json.get(macro.args, "newHardwareBonus")]
  [h: propSpec = json.get(macro.args, "newHardwareSpec")]
  [h: propData = json.append("[]", propBase, propBonus,"COG", 1, propSpec)]
  [h: ActiveSkills = json.set(ActiveSkills, name, propData)]
}]
[h: newActive = json.get(macro.args, "newMedicine")]
[if(newActive == ""),code:{}; {
  [h: name = "Medicine: "+newActive]
  [h: propBase = json.get(macro.args, "newMedicineBase")]
  [h: propBonus = json.get(macro.args, "newMedicineBonus")]
  [h: propSpec = json.get(macro.args, "newMedicineSpec")]
  [h: propData = json.append("[]", propBase, propBonus,"COG", 1, propSpec)]
  [h: ActiveSkills = json.set(ActiveSkills, name, propData)]
}]
[h: newActive = json.get(macro.args, "newNetworking")]
[if(newActive == ""),code:{}; {
  [h: name = "Networking: "+newActive]
  [h: propBase = json.get(macro.args, "newNetworkingBase")]
  [h: propBonus = json.get(macro.args, "newNetworkingBonus")]
  [h: propSpec = json.get(macro.args, "newNetworkingSpec")]
  [h: propData = json.append("[]", propBase, propBonus,"SAV", 1, propSpec)]
  [h: ActiveSkills = json.set(ActiveSkills, name, propData)]
}]
[h: newActive = json.get(macro.args, "newPilot")]
[if(newActive == ""),code:{}; {
  [h: name = "Pilot: "+newActive]
  [h: propBase = json.get(macro.args, "newPilotBase")]
  [h: propBonus = json.get(macro.args, "newPilotBonus")]
  [h: propSpec = json.get(macro.args, "newPilotSpec")]
  [h: propData = json.append("[]", propBase, propBonus,"REF", 1, propSpec)]
  [h: ActiveSkills = json.set(ActiveSkills, name, propData)]
}]

[h: RecalcBottomSheet("Skills")]
[h, macro("SheetLoad@Lib:MnM"):""]
Active Skills Updated

!!
@@ @MuseSkillsUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[foreach(tempAbility, json.fields(MuseSkills), ""), code: {
  [h: propDelete = json.get(macro.args, tempAbility+"Delete")]
  [h, if(propDelete!=""), code: 
  {
    [h: MuseSkills = json.remove(MuseSkills,tempAbility)]
  };{
    [h: propBase = json.get(macro.args, tempAbility+"Base")]
    [h: propBonus = json.get(macro.args, tempAbility+"Bonus")]
    [h: propAptitude = json.get(macro.args, tempAbility+"Aptitude")]
    [h: propDefault = json.get(macro.args, tempAbility+"Default")]
    [h: propSpec = json.get(macro.args, tempAbility+"Spec")]
    [h: propData = json.append("[]", propBase, propBonus, propAptitude, propDefault, propSpec)]
    [h: MuseSkills = json.set(MuseSkills, tempAbility, propData)]
  }]
}]

[h: newActive = json.get(macro.args, "newExoticMelee")]
[if(newActive == ""),code:{}; {
  [h: name = "Exotic Melee: "+newActive]
  [h: propBase = json.get(macro.args, "newExoticMeleeBase")]
  [h: propBonus = json.get(macro.args, "newExoticMeleeBonus")]
  [h: propSpec = json.get(macro.args, "newExoticMeleeSpec")]
  [h: propData = json.append("[]", propBase, propBonus, "SOM_Muse", 1, propSpec)]
  [h: MuseSkills = json.set(MuseSkills, name, propData)]
}]
[h: newActive = json.get(macro.args, "newExoticRanged")]
[if(newActive == ""),code:{}; {
  [h: name = "Exotic Ranged: "+newActive]
  [h: propBase = json.get(macro.args, "newExoticRangedBase")]
  [h: propBonus = json.get(macro.args, "newExoticRangedBonus")]
  [h: propSpec = json.get(macro.args, "newExoticRangedSpec")]
  [h: propData = json.append("[]", propBase, propBonus, "COO_Muse", 1, propSpec)]
  [h: MuseSkills = json.set(MuseSkills, name, propData)]
}]
[h: newActive = json.get(macro.args, "newHardware")]
[if(newActive == ""),code:{}; {
  [h: name = "Hardware: "+newActive]
  [h: propBase = json.get(macro.args, "newHardwareBase")]
  [h: propBonus = json.get(macro.args, "newHardwareBonus")]
  [h: propSpec = json.get(macro.args, "newHardwareSpec")]
  [h: propData = json.append("[]", propBase, propBonus,"COG_Muse", 1, propSpec)]
  [h: MuseSkills = json.set(MuseSkills, name, propData)]
}]
[h: newActive = json.get(macro.args, "newMedicine")]
[if(newActive == ""),code:{}; {
  [h: name = "Medicine: "+newActive]
  [h: propBase = json.get(macro.args, "newMedicineBase")]
  [h: propBonus = json.get(macro.args, "newMedicineBonus")]
  [h: propSpec = json.get(macro.args, "newMedicineSpec")]
  [h: propData = json.append("[]", propBase, propBonus,"COG_Muse", 1, propSpec)]
  [h: MuseSkills = json.set(MuseSkills, name, propData)]
}]
[h: newActive = json.get(macro.args, "newNetworking")]
[if(newActive == ""),code:{}; {
  [h: name = "Networking: "+newActive]
  [h: propBase = json.get(macro.args, "newNetworkingBase")]
  [h: propBonus = json.get(macro.args, "newNetworkingBonus")]
  [h: propSpec = json.get(macro.args, "newNetworkingSpec")]
  [h: propData = json.append("[]", propBase, propBonus,"SAV_Muse", 1, propSpec)]
  [h: MuseSkills = json.set(MuseSkills, name, propData)]
}]
[h: newActive = json.get(macro.args, "newPilot")]
[if(newActive == ""),code:{}; {
  [h: name = "Pilot: "+newActive]
  [h: propBase = json.get(macro.args, "newPilotBase")]
  [h: propBonus = json.get(macro.args, "newPilotBonus")]
  [h: propSpec = json.get(macro.args, "newPilotSpec")]
  [h: propData = json.append("[]", propBase, propBonus,"REF_Muse", 1, propSpec)]
  [h: MuseSkills = json.set(MuseSkills, name, propData)]
}]
[h: newKnow = json.get(macro.args, "newAcademics")]
[if(newKnow == ""),code:{}; {
  [h: name = "Academics: "+newKnow]
  [h: propBase = json.get(macro.args, "newAcademicsBase")]
  [h: propBonus = json.get(macro.args, "newAcademicsBonus")]
  [h: propSpec = json.get(macro.args, "newAcademicsSpec")]
  [h: propData = json.append("[]", propBase, propBonus, "COG_Muse", 1, propSpec)]
  [h: MuseSkills = json.set(MuseSkills, name, propData)]
}]
[h: newKnow = json.get(macro.args, "newArt")]
[if(newKnow == ""),code:{}; {
  [h: name = "Art: "+newKnow]
  [h: propBase = json.get(macro.args, "newArtBase")]
  [h: propBonus = json.get(macro.args, "newArtBonus")]
  [h: propSpec = json.get(macro.args, "newArtSpec")]
  [h: propData = json.append("[]", propBase, propBonus, "INT_Muse", 1, propSpec)]
  [h: MuseSkills = json.set(MuseSkills, name, propData)]
}]
[h: newKnow = json.get(macro.args, "newInterest")]
[if(newKnow == ""),code:{}; {
  [h: name = "Interest: "+newKnow]
  [h: propBase = json.get(macro.args, "newInterestBase")]
  [h: propBonus = json.get(macro.args, "newInterestBonus")]
  [h: propSpec = json.get(macro.args, "newInterestSpec")]
  [h: propData = json.append("[]", propBase, propBonus,"COG_Muse", 1, propSpec)]
  [h: MuseSkills = json.set(MuseSkills, name, propData)]
}]
[h: newKnow = json.get(macro.args, "newLanguage")]
[if(newKnow == ""),code:{}; {
  [h: name = "Language: "+newKnow]
  [h: propBase = json.get(macro.args, "newLanguageBase")]
  [h: propBonus = json.get(macro.args, "newLanguageBonus")]
  [h: propSpec = json.get(macro.args, "newLanguageSpec")]
  [h: propData = json.append("[]", propBase, propBonus,"INT_Muse", 1, propSpec)]
  [h: MuseSkills = json.set(MuseSkills, name, propData)]
}]
[h: newKnow = json.get(macro.args, "newProfession")]
[if(newKnow == ""),code:{}; {
  [h: name = "Profession: "+newKnow]
  [h: propBase = json.get(macro.args, "newProfessionBase")]
  [h: propBonus = json.get(macro.args, "newProfessionBonus")]
  [h: propSpec = json.get(macro.args, "newProfessionSpec")]
  [h: propData = json.append("[]", propBase, propBonus,"COG_Muse", 1, propSpec)]
  [h: MuseSkills = json.set(MuseSkills, name, propData)]
}]

[h: RecalcBottomSheet("Muse")]
[h, macro("SheetLoad@Lib:MnM"):""]
Muse Skills Updated

!!
@@ @AptitudesUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[h: setProperty("COG", json.get(macro.args, "COG"))]
[h: setProperty("COO", json.get(macro.args, "COO"))]
[h: setProperty("INT", json.get(macro.args, "INT"))]
[h: setProperty("REF", json.get(macro.args, "REF"))]
[h: setProperty("SAV", json.get(macro.args, "SAV"))]
[h: setProperty("SOM", json.get(macro.args, "SOM"))]
[h: setProperty("WIL", json.get(macro.args, "WIL"))]
[h: RecalcBottomSheet("Stats")]
[h, macro("SheetLoad@this"):""]
Aptitudes Updated

!!
@@ @MuseAptitudesUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[h: setProperty("COG_Muse", json.get(macro.args, "COG_Muse"))]
[h: setProperty("COO_Muse", json.get(macro.args, "COO_Muse"))]
[h: setProperty("INT_Muse", json.get(macro.args, "INT_Muse"))]
[h: setProperty("REF_Muse", json.get(macro.args, "REF_Muse"))]
[h: setProperty("SAV_Muse", json.get(macro.args, "SAV_Muse"))]
[h: setProperty("SOM_Muse", json.get(macro.args, "SOM_Muse"))]
[h: setProperty("WIL_Muse", json.get(macro.args, "WIL_Muse"))]
[h: RecalcBottomSheet("Muse")]
[h, macro("SheetLoad@this"):""]
Muse Aptitudes Updated

!!
@@ @StatsUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[h: setProperty("MOX", json.get(macro.args, "MOX"))]
[h: setProperty("MOX_base", json.get(macro.args, "MOX_base"))]
[h: setProperty("TT", json.get(macro.args, "TT"))]
[h: setProperty("LUC", json.get(macro.args, "LUC"))]
[h: setProperty("IR", json.get(macro.args, "IR"))]
[h: setProperty("WT", json.get(macro.args, "WT"))]
[h: setProperty("DUR", json.get(macro.args, "DUR"))]
[h: setProperty("DR", json.get(macro.args, "DR"))]
[h: setProperty("INIT", json.get(macro.args, "INIT"))]
[h: setProperty("SPD", json.get(macro.args, "SPD"))]
[h: setProperty("DB", json.get(macro.args, "DB"))]
[h: RecalcBottomSheet("Stats")]
[h, macro("SheetLoad@this"):""]
Stats Updated

!!
@@ @MuseStatsUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[h: setProperty("TT_Muse", json.get(macro.args, "TT_Muse"))]
[h: setProperty("LUC_Muse", json.get(macro.args, "LUC_Muse"))]
[h: setProperty("IR_Muse", json.get(macro.args, "IR_Muse"))]
[h: RecalcBottomSheet("Muse")]
[h, macro("SheetLoad@this"):""]
Muse Stats Updated

!!
@@ @DamageStressUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[h: setProperty("DAMAGE", json.get(macro.args, "DAMAGE"))]
[h: setProperty("WOUNDS", json.get(macro.args, "WOUNDS"))]
[h: setProperty("STRESS", json.get(macro.args, "STRESS"))]
[h: setProperty("TRAUMA", json.get(macro.args, "TRAUMA"))]
[h: RecalcBottomSheet("Combat")]
[h, macro("SheetLoad@this"):""]
Damage & Stress Updated

!!
@@ @RepUpdate
@PROPS@ fontColor=black ; autoExecute=false ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Update ; tooltip= ; minWidth= ; 
[h: setProperty("A-Rep", json.get(macro.args, "A-Rep"))]
[h: setProperty("c-Rep", json.get(macro.args, "c-Rep"))]
[h: setProperty("e-Rep", json.get(macro.args, "e-Rep"))]
[h: setProperty("f-Rep", json.get(macro.args, "f-Rep"))]
[h: setProperty("g-Rep", json.get(macro.args, "g-Rep"))]
[h: setProperty("i-Rep", json.get(macro.args, "i-Rep"))]
[h: setProperty("r-Rep", json.get(macro.args, "r-Rep"))]
[h: RecalcBottomSheet("Stats")]
[h, macro("SheetLoad@this"):""]
Reputation Updated

!!
@@ @EgoTraitsUpdateDialog
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[dialog("EgoTraits", "temporary=0; input=1; noframe=0"): 
{
[h: name = json.get(macro.args, 0)]
[h: text = json.get(macro.args, 1)]
[h: text = decode(text)]
[h: text = replace(text,"<","&#x3C;")]
[h: text = replace(text,">","&#x3E;")]
<html>
  <head>
    <title>Ego Traits Update</title>
    <meta name="input" content="true">
  </head>
  <body>
    <form method="json" name="EgoTraitsUpdate" action="[r:macroLinkText('EgoTraitsUpdate@Lib:MnM', 'none', '', currentToken())]">
      <table>
        <tr>
          <td valign="top" align="center">
            <label for="Name"><b>Ego Trait Name and Level: </b></label><br><input type="text" name="Name" value="[r: name]"></input>
          </td>
        </tr>
        <tr>
          <td valign="top">
            <textarea name="Text" value="[r: text]" rows="10" cols="50">[r: text]</textarea>
          </td>
        </tr>
        <tr>
          <td align="center">
            Delete this Ego Trait? <input type="checkbox" name="Deletecheck" value="1"></input>
          </td>
        </tr>
        <tr>
          <td align="center">
            <input type='hidden' name='overwrite' value='[r: overwrite =  json.get(macro.args, 0)]'></input>
            <input type='submit' name='Submit' value='Submit'></input>
          </td>
        </tr>
      </table> 
    </form>
</body></html>
}]

!!
@@ @PsiSleightsUpdateDialog
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[dialog("PsiSleights", "temporary=0; input=1; noframe=0"): 
{
[h: name = json.get(macro.args, 0)]
[h: text = json.get(macro.args, 1)]
[h: strainValue = json.get(macro.args, 2)]
[h: strainValueType = json.get(macro.args, 3)]
[h: text = decode(text)]
[h: text = replace(text,"<","&#x3C;")]
[h: text = replace(text,">","&#x3E;")]
<html>
  <head>
    <title>Psi Sleights Update</title>
    <meta name="input" content="true">
  </head>
  <body>
    <form method="json" name="PsiSleightsUpdate" action="[r:macroLinkText('PsiSleightsUpdate@Lib:MnM', 'none', '', currentToken())]">
      <table>
        <tr>
          <td valign="top" align="center" colspan="2">
            <label for="Name"><b>Psi Sleight Name and Level: </b></label><br><input type="text" name="Name" value="[r: name]"></input>
          </td>
        </tr>
        <tr>
          <td valign="top" align="center" width="50%">
            <b>Strain: </b><br/>
            <input type="text" name="Strain" value="[r: strainValue]"></input>
          </td>
          <td valign="top" align="center" width="50%">
            <b>Strain Type:</b><br/>
            <select name="StrainType">
                <option value="DV"[r,if(strainValueType == "DV"): " selected"]>DV</option>
                <option value="SV"[r,if(strainValueType == "SV"): " selected"]>SV</option>
            </select>
          </td>
        </tr>
        <tr>
          <td valign="top" colspan="2">
            <textarea name="Text" value="[r: text]" rows="10" cols="50">[r: text]</textarea>
          </td>
        </tr>
        <tr>
          <td align="center" colspan="2">
            Delete this Psi Sleight? <input type="checkbox" name="Deletecheck" value="1"></input>
          </td>
        </tr>
        <tr>
          <td align="center" colspan="2">
            <input type='hidden' name='overwrite' value='[r: overwrite =  json.get(macro.args, 0)]'></input>
            <input type='submit' name='Submit' value='Submit'></input>
          </td>
        </tr>
      </table> 
    </form>
</body></html>
}]

!!
@@ @GearUpdateDialog
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[dialog("Gear", "temporary=0; input=1; noframe=0"): 
{
[h: name = json.get(macro.args, 0)]
[h: text = json.get(macro.args, 1)]
[h: text = decode(text)]
[h: text = replace(text,"<","&#x3C;")]
[h: text = replace(text,">","&#x3E;")]
<html>
  <head>
    <title>Gear Update</title>
    <meta name="input" content="true">
  </head>
  <body>
    <form method="json" name="GearUpdate" action="[r:macroLinkText('GearUpdate@Lib:MnM', 'none', '', currentToken())]">
      <table>
        <tr>
          <td valign="top" align="center">
            <label for="Name"><b>Gear Name and Level: </b></label><br><input type="text" name="Name" value="[r: name]"></input>
          </td>
        </tr>
        <tr>
          <td valign="top">
            <textarea name="Text" value="[r: text]" rows="10" cols="50">[r: text]</textarea>
          </td>
        </tr>
        <tr>
          <td align="center">
            Delete this Gear? <input type="checkbox" name="Deletecheck" value="1"></input>
          </td>
        </tr>
        <tr>
          <td align="center">
            <input type='hidden' name='overwrite' value='[r: overwrite =  json.get(macro.args, 0)]'></input>
            <input type='submit' name='Submit' value='Submit'></input>
          </td>
        </tr>
      </table> 
    </form>
</body></html>
}]

!!
@@ @MorphTraitsUpdateDialog
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[dialog("MorphTraits", "temporary=0; input=1; noframe=0"): 
{
[h: name = json.get(macro.args, 0)]
[h: text = json.get(macro.args, 1)]
[h: text = decode(text)]
[h: text = replace(text,"<","&#x3C;")]
[h: text = replace(text,">","&#x3E;")]
<html>
  <head>
    <title>Morph Traits Update</title>
    <meta name="input" content="true">
  </head>
  <body>
    <form method="json" name="MorphTraitsUpdate" action="[r:macroLinkText('MorphTraitsUpdate@Lib:MnM', 'none', '', currentToken())]">
      <table>
        <tr>
          <td valign="top" align="center">
            <label for="Name"><b>Morph Trait Name and Level: </b></label><br><input type="text" name="Name" value="[r: name]"></input>
          </td>
        </tr>
        <tr>
          <td valign="top">
            <textarea name="Text" value="[r: text]" rows="10" cols="50">[r: text]</textarea>
          </td>
        </tr>
        <tr>
          <td align="center">
            Delete this Morph Trait? <input type="checkbox" name="Deletecheck" value="1"></input>
          </td>
        </tr>
        <tr>
          <td align="center">
            <input type='hidden' name='overwrite' value='[r: overwrite =  json.get(macro.args, 0)]'></input>
            <input type='submit' name='Submit' value='Submit'></input>
          </td>
        </tr>
      </table> 
    </form>
</body></html>
}]

!!
@@ @ImplantsEnhancementsUpdateDialog
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[dialog("ImplantsEnhancements", "temporary=0; input=1; noframe=0"): 
{
[h: name = json.get(macro.args, 0)]
[h: text = json.get(macro.args, 1)]
[h: text = decode(text)]
[h: text = replace(text,"<","&#x3C;")]
[h: text = replace(text,">","&#x3E;")]
<html>
  <head>
    <title>Implants & Enhancements Update</title>
    <meta name="input" content="true">
  </head>
  <body>
    <form method="json" name="ImplantsEnhancementsUpdate" action="[r:macroLinkText('ImplantsEnhancementsUpdate@Lib:MnM', 'none', '', currentToken())]">
      <table>
        <tr>
          <td valign="top" align="center">
            <label for="Name"><b>Implant or Enhancement Name: </b></label><br><input type="text" name="Name" value="[r: name]"></input>
          </td>
        </tr>
        <tr>
          <td valign="top">
            <textarea name="Text" value="[r: text]" rows="10" cols="50">[r: text]</textarea>
          </td>
        </tr>
        <tr>
          <td align="center">
            Delete this Implant or Enhancement? <input type="checkbox" name="Deletecheck" value="1"></input>
          </td>
        </tr>
        <tr>
          <td align="center">
            <input type='hidden' name='overwrite' value='[r: overwrite = json.get(macro.args, 0)]'></input>
            <input type='submit' name='Submit' value='Submit'></input>
          </td>
        </tr>
      </table> 
    </form>
</body></html>
}]

!!
@@ @ColorUpdate
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[h: number = 0]
[h, if(PageColor == "Bright Green"): number = 1; number = number]
[h, if(PageColor == "Dark Blue"): number = 2; number = number]
[h, if(PageColor == "Dark Orange"): number = 3; number = number]
[h, if(PageColor == "Light Blue"): number = 4; number = number]
[h, if(PageColor == "Light Orange"): number = 5; number = number]
[h, if(PageColor == "Maroon"): number = 6; number = number]
[h, if(PageColor == "Olive Green"): number = 7; number = number]
[h, if(PageColor == "Purple"): number = 8; number = number]
[h, if(PageColor == "Red"): number = 9; number = number]
[h, if(PageColor == "Teal Blue"): number = 10; number = number]

[h: status = input(
"PageColor|Gray,Bright Green,Dark Blue,Dark Orange,Light Blue,Light Orange,Maroon,Olive Green,Purple,Red,Teal Blue|Choose Sheet Color|LIST|VALUE=STRING SELECT="+number
)]
[h: abort(status)]

[h: RecalcBottomSheet("Stats")]
[h: RecalcBottomSheet("Skills")]
[h: RecalcBottomSheet("Powers")]
[h: RecalcBottomSheet("Muse")]
[h: RecalcBottomSheet("Combat")]
[h: RecalcTopSheet()]
[r, macro("SheetLoad@this"):macro.args]

!!
@@ @DDUpdateDialog
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[dialog("Derangements & Disorders", "width=643; height=570; temporary=0; input=1; noframe=0"): {

<html>
<head>
<title>Derangements & Disorders</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="DDUpdate" action="[r:macroLinkText('DDUpdate@Lib:MnM', 'none', '', currentToken())]">
<table>
<tr bgcolor="[r: table(PageColor,2)]" color="white">
<td colspan="3"><center>
<b>Derangements</b></center>
</td>
</tr>
[h:theList = json.append("[]","Anxiety","Avoidance","Dizziness","Echolalia","Fixation","Hunger","Indecisiveness","Logorrhoea","Nausea","Chills","Confusion","Echopraxia","Mood Swings","Mute","Narcissism","Panic","Tremors","Blackout","Frenzy","Hallucinations","Hysteria","Irrationality","Paralysis","Psychosomatic Crippling")]
[h: columncheck = 1]
[r, foreach(item, theList, ""),code:{
[r, if(columncheck > 1):""; "<tr>"]
<td>
<input type="checkbox" name="[r: item]" value="1" [r: if(json.contains(DandD,item),"CHECKED","")]> <font color="black"><a href='[r:macroLinkText("DDInfoDisplay@this","none",item,currentToken())]'>[r: item]</a></font></input>
</td>
[r, if(columncheck < 3):""; "</tr>"]
[h: columncheck = if(columncheck == 3, 1, columncheck+1)]

}]
<tr bgcolor="[r: table(PageColor,2)]" color="white">
<td colspan="3" ><center>
<b>Disorders</b></center>
</td>
</tr>
[h:theList = json.append("[]","Addiction","Atavism","Attention Deficit Hyperactivity Disorder","Autophagy","Bipolar Disorder","Body Dysmorphia","Borderline Personality Disorder","Depression","Fugue","General Anxiety Disorder","Hypochondria","Impulse Control Disorder","Insomnia","Megalomania","Multiple Personality Disorder","Obsessive Compulsive Disorder","Post Traumatic Stress Disorder","Schizophrenia")]
[h: columncheck = 1]
[r, foreach(item, theList, ""),code:{
[r, if(columncheck > 1):""; "<tr>"]
<td>
<input type="checkbox" name="[r: item]" value="1" [r: if(json.contains(DandD,item),"CHECKED","")]> <font color="black"><a href='[r:macroLinkText("DDInfoDisplay@this","none",item,currentToken())]'>[r: item]</a></font></input>
</td>
[r, if(columncheck < 3):""; "</tr>"]
[h: columncheck = if(columncheck == 3, 1, columncheck+1)]
}]

<tr bgcolor="[r: table(PageColor,2)]" color="white">
<td colspan="3" ><center>
<b>Optional Extra Disorders</b></center>
</td>
</tr>
[h:theList = json.append("[]","Intermittent Explosive Disorder")]
[h: columncheck = 1]
[r, foreach(item, theList, ""),code:{
[r, if(columncheck > 1):""; "<tr>"]
<td>
<input type="checkbox" name="[r: item]" value="1" [r: if(json.contains(DandD,item),"CHECKED","")]> <font color="black"><a href='[r:macroLinkText("DDInfoDisplay@this","none",item,currentToken())]'>[r: item]</a></font></input>
</td>
[r, if(columncheck < 3):""; "</tr>"]
[h: columncheck = if(columncheck == 3, 1, columncheck+1)]
}]

<tr>
<td colspan="3"><hr><center>
<input type="checkbox" name="Clear All" value="1"> Clear All</input></center
</td>
</tr>
<tr>
<td align="center" colspan="3"><hr>
<input type='submit' name='Submit' value='Submit'></input>
</td>
</tr>
</table>
</form>
</body>
</html>
} ]

!!
@@ @WeaponUpdateDialog
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[h: weapName = macro.args]
[h: weapJson = json.get(Weapons, weapName)]
[h: weapDesc = json.get(weapJson, 7)]
[h: weapDesc = decode(weapDesc)]
[h: weapDesc = replace(weapDesc,"<","&#x3C;")]
[h: weapDesc = replace(weapDesc,">","&#x3E;")]
[h: weapFModes = json.get(weapJson, 2)]
[h: fm1 = json.append("[]"," selected","","","","")]
[h: fm2 = json.append("[]"," selected","","","","")]
[h: fm3 = json.append("[]"," selected","","","","")]
[h: loop = 1]
[foreach(fm, weapFModes, ""), code: 
{
  [h,switch(fm):
    case "SS": tmpJson = json.append("[]",""," selected","","",""); 
    case "SA": tmpJson = json.append("[]","",""," selected","",""); 
    case "BF": tmpJson = json.append("[]","","",""," selected",""); 
    case "FA": tmpJson = json.append("[]","","","",""," selected")
  ]
  [h,switch(loop):
    case 1: fm1 = tmpJson;
    case 2: fm2 = tmpJson;
    case 3: fm3 = tmpJson
  ]
  [h: loop = loop + 1]
}]
[h: weaponSkill = json.get(weapJson,5)]
[h: exoticText = ""]
[h,switch(weaponSkill):
    case "Beam Weapons": tmpJson = json.append("[]"," selected","","","","","","","","","",""); 
    case "Blades": tmpJson = json.append("[]",""," selected","","","","","","","","",""); 
    case "Clubs": tmpJson = json.append("[]","",""," selected","","","","","","","",""); 
    case "Gunnery": tmpJson = json.append("[]","","","","",""," selected","","","","","");
    case "Kinetic Weapons": tmpJson = json.append("[]","","","","","",""," selected","","","","");
    case "Seeker Weapons": tmpJson = json.append("[]","","","","","","",""," selected","","","");
    case "Spray Weapons": tmpJson = json.append("[]","","","","","","","",""," selected","","");
    case "Throwing Weapons": tmpJson = json.append("[]","","","","","","","","",""," selected","");
    case "Unarmed Combat": tmpJson = json.append("[]","","","","","","","","","",""," selected");
    default: exoticText = substring(weaponSkill,indexOf(weaponSkill,":")+2)
]
[h,if(startsWith(weaponSkill,"Exotic Melee")): tmpJson = json.append("[]","","",""," selected","","","","","","","")]
[h,if(startsWith(weaponSkill,"Exotic Ranged")): tmpJson = json.append("[]","","","","","selected","","","","","","")]
[h: ws = tmpJson]

[dialog("Edit Weapon", "temporary=0; height=520; width=400; input=1; noframe=0"): 
{
<html>
<head>
<title>Edit Weapon: {weapName}</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="Edit Weapon" action="[r:macroLinkText('WeaponUpdate@Lib:MnM', 'none', '', currentToken())]">
  <table width="100%" valign="top">
    <tr>
      <td>
        <b>Name: </b> <input type="text" name="weapName" value="[r: weapName]"></input>
      </td>
      <td align="center">		
        Delete? <input type="checkbox" name="delete" value="1"></input>
      </td>
    </tr>
  </table>
  <table width="100%" >
    <tr>
      <td>
        AP: <input type="text" name="weapAP" value="[r: json.get(weapJson,0)]" size="3"></input>
        DV (#/formula/spc): <input type="text" name="weapDV" value="[r: json.get(weapJson,1)]" size="15"></input>
      </td>
    </tr>
    <tr>
      <td>
        Ammo: <input type="text" name="weapAmmo" value="[r: json.get(weapJson,4)]" size="3"></input>
        Have Spec? <input type="checkbox" name="weapSpec" value="1"[r,if(json.get(weapJson,8)): ' checked="checked"';""]></input>
        Have Laser Sight/Smartlink? <input type="checkbox" name="weapLaser" value="1"[r,if(json.get(weapJson,9)): ' checked="checked"';""]></input>
        <hr>
      </td>
    </tr>
    <tr>
      <td>
        Firing Modes (pick none for all if not applicable)
      </td>
    </tr>
    <tr>
      <td>
        (First slot is used for default attacks)
      </td>
    </tr>
    <tr>
      <td>
        1st: <select name="weapFModes1">
          <option value="none"[r: json.get(fm1, 0)]>None</option>
          <option value="SS"[r: json.get(fm1, 1)]>SS</option>
          <option value="SA"[r: json.get(fm1, 2)]>SA</option>
          <option value="BF"[r: json.get(fm1, 3)]>BF</option>
          <option value="FA"[r: json.get(fm1, 4)]>FA</option>
        </select>
        2nd: <select name="weapFModes2">
          <option value="none"[r: json.get(fm2, 0)]>None</option>
          <option value="SS"[r: json.get(fm2, 1)]>SS</option>
          <option value="SA"[r: json.get(fm2, 2)]>SA</option>
          <option value="BF"[r: json.get(fm2, 3)]>BF</option>
          <option value="FA"[r: json.get(fm2, 4)]>FA</option>
        </select>
        3rd: <select name="weapFModes3">
          <option value="none"[r: json.get(fm3, 0)]>None</option>
          <option value="SS"[r: json.get(fm3, 1)]>SS</option>
          <option value="SA"[r: json.get(fm3, 2)]>SA</option>
          <option value="BF"[r: json.get(fm3, 3)]>BF</option>
          <option value="FA"[r: json.get(fm3, 4)]>FA</option>
        </select>
      </td>
    </tr>	
    <tr>
      <td>
        Skill (Exotic has text entry)
      </td>
    </tr>
    <tr>
      <td>
        <select name="weapSkill">
          <option value="Beam Weapons"[r: json.get(ws, 0)]>Beam Weapons</option>
          <option value="Blades"[r: json.get(ws, 1)]>Blades</option>
          <option value="Clubs"[r: json.get(ws, 2)]>Clubs</option>
          <option value="Exotic Melee"[r: json.get(ws, 3)]>Exotic Melee</option>
          <option value="Exotic Ranged"[r: json.get(ws, 4)]>Exotic Ranged</option>
          <option value="Gunnery"[r: json.get(ws, 5)]>Gunnery</option>
          <option value="Kinetic Weapons"[r: json.get(ws, 6)]>Kinetic Weapons</option>
          <option value="Seeker Weapons"[r: json.get(ws, 7)]>Seeker Weapons</option>
          <option value="Spray Weapons"[r: json.get(ws, 8)]>Spray Weapons</option>
          <option value="Throwing Weapons"[r: json.get(ws, 9)]>Throwing Weapons</option>
          <option value="Unarmed Combat"[r: json.get(ws, 10)]>Unarmed Combat</option>
        </select>
        <input type="text" name="weapExotic" value="[r: exoticText]"></input>
        <hr>
      </td>
    </tr>
    <tr>
      <td>
        Text to print with attack:
      </td>
    </tr>
    <tr>
      <td>
        <input type="text" name="weapText" value="[r: json.get(weapJson,6)]" size="50"></input>
      </td>
    </tr>
    <tr>
      <td>
        Description: 
      </td>
    </tr>
    <tr>
      <td>
        <textarea name="weapDesc" value="[r: weapDesc]" rows="10" cols="50">[r: weapDesc]</textarea>
      </td>
    </tr>
    <tr>
      <td align="center">
        <input type='hidden' name='weapCurrAmmo' value="[r: json.get(weapJson,3)]"></input>
        <input type='submit' name='Submit' value='Submit'></input>
      </td>
    </tr>
  </table>
</form>
</body>
</html>
}]

!!
@@ @WeaponUpdateDialogNew
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[dialog("New Weapon", "temporary=0; height=500; width=400; input=1; noframe=0"): 
{
<html>
<head>
<title>New Weapon</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="New Weapon" action="[r:macroLinkText('WeaponUpdate@Lib:MnM', 'none', '', currentToken())]">
  <table width="100%" valign="top">
    <tr>
      <td>
        <b>Name: </b> <input type="text" name="weapName" value="New Weapon"></input>
      </td>
    </tr>
  </table>
  <table width="100%" >
    <tr>
      <td>
        AP: <input type="text" name="weapAP" value="0" size="3"></input>
        DV (#/formula/spc): <input type="text" name="weapDV" value="0" size="15"></input>
      </td>
    </tr>
    <tr>
      <td>
        Ammo: <input type="text" name="weapAmmo" value="0" size="3"></input>
        Have Spec? <input type="checkbox" name="weapSpec" value="1"></input>
        Have Laser Sight/Smartlink? <input type="checkbox" name="weapLaser" value="1"></input>
        <hr>
      </td>
    </tr>
    <tr>
      <td>
        Firing Modes (pick none for all if not applicable)
      </td>
    </tr>
    <tr>
      <td>
        (First slot is used for default attacks)
      </td>
    </tr>
    <tr>
      <td>
        1st: <select name="weapFModes1">
          <option value="none" selected="selected">None</option>
          <option value="SS">SS</option>
          <option value="SA">SA</option>
          <option value="BF">BF</option>
          <option value="FA">FA</option>
        </select>
        2nd: <select name="weapFModes2">
          <option value="none" selected="selected">None</option>
          <option value="SS">SS</option>
          <option value="SA">SA</option>
          <option value="BF">BF</option>
          <option value="FA">FA</option>
        </select>
        3rd: <select name="weapFModes3">
          <option value="none" selected="selected">None</option>
          <option value="SS">SS</option>
          <option value="SA">SA</option>
          <option value="BF">BF</option>
          <option value="FA">FA</option>
        </select>
      </td>
    </tr>	
    <tr>
      <td>
        Skill (Exotic has text entry)
      </td>
    </tr>
    <tr>
      <td>
        <select name="weapSkill">
          <option value="Beam Weapons" selected="selected">Beam Weapons</option>
          <option value="Blades">Blades</option>
          <option value="Clubs">Clubs</option>
          <option value="Exotic Melee">Exotic Melee</option>
          <option value="Exotic Ranged">Exotic Ranged</option>
          <option value="Gunnery">Gunnery</option>
          <option value="Kinetic Weapons">Kinetic Weapons</option>
          <option value="Seeker Weapons">Seeker Weapons</option>
          <option value="Spray Weapons">Spray Weapons</option>
          <option value="Throwing Weapons">Throwing Weapons</option>
          <option value="Unarmed Combat">Unarmed Combat</option>
        </select>
        <input type="text" name="weapExotic" value=""></input>
        <hr>
      </td>
    </tr>
    <tr>
      <td>
        Text to print with attack:
      </td>
    </tr>
    <tr>
      <td>
        <input type="text" name="weapText" value="" size="50"></input>
      </td>
    </tr>
    <tr>
      <td>
        Description (html supported): 
      </td>
    </tr>
    <tr>
      <td>
        <textarea name="weapDesc" value="" rows="10" cols="50"></textarea>
      </td>
    </tr>
    <tr>
      <td align="center">
        <input type='hidden' name='weapCurrAmmo' value="-1"></input>
        <input type='submit' name='Submit' value='Submit'></input>
      </td>
    </tr>
  </table>
</form>
</body>
</html>
}]

!!
@@ @KnowSkillsUpdateDialog
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[dialog("Knowledge Skills Update", "width=550; height=400; temporary=0; input=1; noframe=0; closebutton=0"): {
<html>
<head>
<title>Knowledge Skills Update</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="KnowSkillsUpdate" action="[r:macroLinkText('KnowSkillsUpdate@Lib:MnM', 'none', '', currentToken())]">
  <table>
  [h: color = "#ededed"]
  [h: propListunsort = json.fields(KnowledgeSkills)]
  [h: propList = listsort(propListunsort, "A")]

  [foreach(tempAbility, propList, ""), code: {
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>[r: tempAbility]</b></label>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="[r: tempAbility+"Base"]" value="[r: json.get(json.get(KnowledgeSkills, tempAbility), 0)]" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="[r: tempAbility+"Bonus"]" value="[r: json.get(json.get(KnowledgeSkills, tempAbility), 1)]" size="2"></input>
        <input type="hidden" name="[r: tempAbility+"Aptitude"]" value="[r: json.get(json.get(KnowledgeSkills, tempAbility), 2)]"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="[r: tempAbility+"Spec"]" value="[r: json.get(json.get(KnowledgeSkills, tempAbility), 4)]" size="10"></input>
      </td>
      <td>
        <label for="del">Delete: </label><input type="checkbox" name="[r: tempAbility+"Delete"]" value="1"></input>
      </td>
    </tr>
    [h: color=if(color=="#ededed","white","#ededed")]
  }]
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Academics: </b></label><input type="text" name="newAcademics" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newAcademicsBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newAcademicsBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newAcademicsSpec" value="" size="10"></input>
      </td>
    </tr>
    [h: color=if(color=="#ededed","white","#ededed")]
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Art: </b></label><input type="text" name="newArt" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newArtBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newArtBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newArtSpec" value="" size="10"></input>
      </td>
    </tr>
    [h: color=if(color=="#ededed","white","#ededed")]
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Interest: </b></label><input type="text" name="newInterest" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newInterestBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newInterestBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newInterestSpec" value="" size="10"></input>
      </td>
    </tr>
    [h: color=if(color=="#ededed","white","#ededed")]
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Language: </b></label><input type="text" name="newLanguage" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newLanguageBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newLanguageBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newLanguageSpec" value="" size="10"></input>
      </td>
    </tr>
    [h: color=if(color=="#ededed","white","#ededed")]
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Profession: </b></label><input type="text" name="newProfession" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newProfessionBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newProfessionBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newProfessionSpec" value="" size="10"></input>
      </td>
    </tr>

    <tr>
      <td align="center" colspan="4">
        <input type='submit' name='Submit' value='Submit'></input>
      </td>
    </tr>
  </table> 
</form>
</body>
</html>
} ]

!!
@@ @ActiveSkillsUpdateDialog
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[dialog("Active Skills Update", "width=550; height=400; temporary=0; input=1; noframe=0; closebutton=0"): {
<html>
<head>
<title>Active Skills Update</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="ActiveSkillsUpdate" action="[r:macroLinkText('ActiveSkillsUpdate@Lib:MnM', 'none', '', currentToken())]">
  <table>
  [h: color = "#ededed"]
  [h: propListunsort = json.fields(ActiveSkills)]
  [h: propList = listsort(propListunsort, "A")]

  [foreach(tempAbility, propList, ""), code: {
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>[r: tempAbility]</b></label>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="[r: tempAbility+"Base"]" value="[r: json.get(json.get(ActiveSkills, tempAbility), 0)]" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="[r: tempAbility+"Bonus"]" value="[r: json.get(json.get(ActiveSkills, tempAbility), 1)]" size="2"></input>
        <input type="hidden" name="[r: tempAbility+"Aptitude"]" value="[r: json.get(json.get(ActiveSkills, tempAbility), 2)]"></input>
        <input type="hidden" name="[r: tempAbility+"Default"]" value="[r: json.get(json.get(ActiveSkills, tempAbility), 3)]"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="[r: tempAbility+"Spec"]" value="[r: json.get(json.get(ActiveSkills, tempAbility), 4)]" size="10"></input>
      </td>
      [h: tmpStr = tempAbility + "Delete"]
      [h,if(indexOf(tempAbility,":")==-1): delStr = ""; delStr = '<td><label for="del">Delete: </label><input type="checkbox" name="'+tmpStr+'" value="1"></input></td>']
      [r: delStr]
    </tr>
    [h: color=if(color=="#ededed","white","#ededed")]
  }]
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Exotic Melee: </b></label><input type="text" name="newExoticMelee" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newExoticMeleeBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newExoticMeleeBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newExoticMeleeSpec" value="" size="10"></input>
      </td>
    </tr>
    [h: color=if(color=="#ededed","white","#ededed")]
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Exotic Ranged: </b></label><input type="text" name="newExoticRanged" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newExoticRangedBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newExoticRangedBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newExoticRangedSpec" value="" size="10"></input>
      </td>
    </tr>
    [h: color=if(color=="#ededed","white","#ededed")]
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Hardware: </b></label><input type="text" name="newHardware" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newHardwareBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newHardwareBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newHardwareSpec" value="" size="10"></input>
      </td>
    </tr>
    [h: color=if(color=="#ededed","white","#ededed")]
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Medicine: </b></label><input type="text" name="newMedicine" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newMedicineBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newMedicineBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newMedicineSpec" value="" size="10"></input>
      </td>
    </tr>
    [h: color=if(color=="#ededed","white","#ededed")]
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Networking: </b></label><input type="text" name="newNetworking" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newNetworkingBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newNetworkingBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newNetworkingSpec" value="" size="10"></input>
      </td>
    </tr>
    [h: color=if(color=="#ededed","white","#ededed")]
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Pilot: </b></label><input type="text" name="newPilot" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newPilotBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newPilotBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newPilotSpec" value="" size="10"></input>
      </td>
    </tr>

    <tr>
      <td align="center" colspan="4">
        <input type='submit' name='Submit' value='Submit'></input>
      </td>
    </tr>
  </table> 
</form>
</body>
</html>
} ]

!!
@@ @MuseSkillsUpdateDialog
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[dialog("Muse Skills Update", "width=550; height=400; temporary=0; input=1; noframe=0; closebutton=0"): {
<html>
<head>
<title>Muse Skills Update</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="MuseSkillsUpdate" action="[r:macroLinkText('MuseSkillsUpdate@Lib:MnM', 'none', '', currentToken())]">
  <table>
  [h: color = "#ededed"]
  [h: propListunsort = json.fields(MuseSkills)]
  [h: propList = listsort(propListunsort, "A")]

  [foreach(tempAbility, propList, ""), code: {
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>[r: tempAbility]</b></label>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="[r: tempAbility+"Base"]" value="[r: json.get(json.get(MuseSkills, tempAbility), 0)]" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="[r: tempAbility+"Bonus"]" value="[r: json.get(json.get(MuseSkills, tempAbility), 1)]" size="2"></input>
        <input type="hidden" name="[r: tempAbility+"Aptitude"]" value="[r: json.get(json.get(MuseSkills, tempAbility), 2)]"></input>
        <input type="hidden" name="[r: tempAbility+"Default"]" value="[r: json.get(json.get(MuseSkills, tempAbility), 3)]"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="[r: tempAbility+"Spec"]" value="[r: json.get(json.get(MuseSkills, tempAbility), 4)]" size="10"></input>
      </td>
      [h: tmpStr = tempAbility + "Delete"]
      [h,if(indexOf(tempAbility,":")==-1): delStr = ""; delStr = '<td><label for="del">Delete: </label><input type="checkbox" name="'+tmpStr+'" value="1"></input></td>']
      [r: delStr]
    </tr>
    [h: color=if(color=="#ededed","white","#ededed")]
  }]
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Academics: </b></label><input type="text" name="newAcademics" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newAcademicsBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newAcademicsBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newAcademicsSpec" value="" size="10"></input>
      </td>
    </tr>
    [h: color=if(color=="#ededed","white","#ededed")]
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Art: </b></label><input type="text" name="newArt" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newArtBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newArtBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newArtSpec" value="" size="10"></input>
      </td>
    </tr>
    [h: color=if(color=="#ededed","white","#ededed")]
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Interest: </b></label><input type="text" name="newInterest" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newInterestBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newInterestBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newInterestSpec" value="" size="10"></input>
      </td>
    </tr>
    [h: color=if(color=="#ededed","white","#ededed")]
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Language: </b></label><input type="text" name="newLanguage" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newLanguageBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newLanguageBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newLanguageSpec" value="" size="10"></input>
      </td>
    </tr>
    [h: color=if(color=="#ededed","white","#ededed")]
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Profession: </b></label><input type="text" name="newProfession" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newProfessionBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newProfessionBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newProfessionSpec" value="" size="10"></input>
      </td>
    </tr>
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Exotic Melee: </b></label><input type="text" name="newExoticMelee" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newExoticMeleeBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newExoticMeleeBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newExoticMeleeSpec" value="" size="10"></input>
      </td>
    </tr>
    [h: color=if(color=="#ededed","white","#ededed")]
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Exotic Ranged: </b></label><input type="text" name="newExoticRanged" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newExoticRangedBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newExoticRangedBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newExoticRangedSpec" value="" size="10"></input>
      </td>
    </tr>
    [h: color=if(color=="#ededed","white","#ededed")]
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Hardware: </b></label><input type="text" name="newHardware" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newHardwareBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newHardwareBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newHardwareSpec" value="" size="10"></input>
      </td>
    </tr>
    [h: color=if(color=="#ededed","white","#ededed")]
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Medicine: </b></label><input type="text" name="newMedicine" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newMedicineBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newMedicineBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newMedicineSpec" value="" size="10"></input>
      </td>
    </tr>
    [h: color=if(color=="#ededed","white","#ededed")]
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Networking: </b></label><input type="text" name="newNetworking" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newNetworkingBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newNetworkingBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newNetworkingSpec" value="" size="10"></input>
      </td>
    </tr>
    [h: color=if(color=="#ededed","white","#ededed")]
    <tr bgcolor="[r: color]">
      <td>
        <label for="Name"><b>Pilot: </b></label><input type="text" name="newPilot" value="" size="8"></input>
      </td>
      <td>
        <label for="Base">Base: </label><input type="text" name="newPilotBase" value="0" size="2"></input>
      </td>
      <td>
        <label for="Bonus">Bonus: </label><input type="text" name="newPilotBonus" value="0" size="2"></input>
      </td>
      <td>
        <label for="Spec">Spec.: </label><input type="text" name="newPilotSpec" value="" size="10"></input>
      </td>
    </tr>

    <tr>
      <td align="center" colspan="4">
        <input type='submit' name='Submit' value='Submit'></input>
      </td>
    </tr>
  </table> 
</form>
</body>
</html>
} ]

!!
@@ @AptitudesUpdateDialog
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[dialog("Aptitudes Update", "temporary=0; height=200; width=270; input=1; noframe=0"): {
<html>
<head>
<title>Aptitudes Update</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="AptitudesUpdate" action="[r:macroLinkText('AptitudesUpdate@Lib:MnM', 'none', '', currentToken())]">
<table>
	<tr>
		<td bgcolor="black" valign="middle" colspan="7">&nbsp; &nbsp; <font color="white"><b>APTITUDES</b></font>
		</td>
	</tr>
	<tr>
		<td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>COG</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="COG" value="[r: getProperty("COG")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>COO</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="COO" value="[r: getProperty("COO")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>INT</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="INT" value="[r: getProperty("INT")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>REF</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="REF" value="[r: getProperty("REF")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>SAV</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="SAV" value="[r: getProperty("SAV")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>SOM</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="SOM" value="[r: getProperty("SOM")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>WIL</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="WIL" value="[r: getProperty("WIL")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
	</tr>
<tr>
<td align="center" colspan="8">
<input type='submit' name='Submit' value='Submit'></input>
</td>
</tr>
</table> 
</form>
</body>
</html>
} ]

!!
@@ @MuseAptitudesUpdateDialog
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[dialog("Muse Aptitudes Update", "temporary=0; height=200; width=270; input=1; noframe=0"): {
<html>
<head>
<title>Muse Aptitudes Update</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="MuseAptitudesUpdate" action="[r:macroLinkText('MuseAptitudesUpdate@Lib:MnM', 'none', '', currentToken())]">
<table>
	<tr>
		<td bgcolor="black" valign="middle" colspan="7">&nbsp; &nbsp; <font color="white"><b>Muse APTITUDES</b></font>
		</td>
	</tr>
	<tr>
		<td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>COG</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="COG_Muse" value="[r: getProperty("COG_Muse")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>COO</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="COO_Muse" value="[r: getProperty("COO_Muse")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>INT</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="INT_Muse" value="[r: getProperty("INT_Muse")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>REF</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="REF_Muse" value="[r: getProperty("REF_Muse")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>SAV</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="SAV_Muse" value="[r: getProperty("SAV_Muse")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>SOM</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="SOM_Muse" value="[r: getProperty("SOM_Muse")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>WIL</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="WIL_Muse" value="[r: getProperty("WIL_Muse")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
	</tr>
<tr>
<td align="center" colspan="8">
<input type='submit' name='Submit' value='Submit'></input>
</td>
</tr>
</table> 
</form>
</body>
</html>
} ]

!!
@@ @StatsUpdateDialog
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[dialog("Stats Update", "temporary=1; height=200; width=440; input=1; noframe=0"): {
<html>
<head>
<title>Stats Update</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="StatsUpdate" action="[r:macroLinkText('StatsUpdate@Lib:MnM', 'none', '', currentToken())]">
<table>
	<tr>
		<td bgcolor="black" valign="middle" colspan="11">&nbsp; &nbsp; <font color="white"><b>STATS</b></font>
		</td>
	</tr>
	<tr>
		<td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>MOX</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="MOX" value="[r: getProperty("MOX")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>Base MOX</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="MOX_base" value="[r: getProperty("MOX_base")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>TT</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="TT" value="[r: getProperty("TT")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>LUC</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="LUC" value="[r: getProperty("LUC")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>IR</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="IR" value="[r: getProperty("IR")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>WT</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="WT" value="[r: getProperty("WT")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>DUR</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="DUR" value="[r: getProperty("DUR")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>DR</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="DR" value="[r: getProperty("DR")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>INIT</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="INIT" value="[r: getProperty("INIT")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>SPD</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="SPD" value="[r: getProperty("SPD")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>DB</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="DB" value="[r: getProperty("DB")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
	</tr>
<tr>
<td align="center" colspan="11">
<input type='submit' name='Submit' value='Submit'></input>
</td>
</tr>
</table> 
</form>
</body>
</html>
} ]

!!
@@ @MuseStatsUpdateDialog
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[dialog("Muse Stats Update", "temporary=1; height=200; width=175; input=1; noframe=0"): {
<html>
<head>
<title>Muse Stats Update</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="MuseStatsUpdate" action="[r:macroLinkText('MuseStatsUpdate@Lib:MnM', 'none', '', currentToken())]">
<table>
	<tr>
		<td bgcolor="black" valign="middle" colspan="11">&nbsp; &nbsp; <font color="white"><b>MUSE STATS</b></font>
		</td>
	</tr>
	<tr>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>TT</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="TT_Muse" value="[r: getProperty("TT_Muse")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>LUC</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="LUC_Muse" value="[r: getProperty("LUC_Muse")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>IR</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="IR_Muse" value="[r: getProperty("IR_Muse")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
	</tr>
<tr>
<td align="center" colspan="11">
<input type='submit' name='Submit' value='Submit'></input>
</td>
</tr>
</table> 
</form>
</body>
</html>
} ]

!!
@@ @DamageStressUpdateDialog
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[dialog("Stats Update", "temporary=1; height=250; width=265; input=1; noframe=0"): {
<html>
<head>
<title>Damage & Stress Update</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="DamageStressUpdate" action="[r:macroLinkText('DamageStressUpdate@Lib:MnM', 'none', '', currentToken())]">
<table>
	<tr>
		<td bgcolor="black" valign="middle" colspan="10">&nbsp; &nbsp; <font color="white"><b>DAMAGE & STRESS</b></font>
		</td>
	</tr>
	<tr>
		<td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>DAMAGE</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="DAMAGE" value="[r: getProperty("DAMAGE")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>WOUNDS</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="WOUNDS" value="[r: getProperty("WOUNDS")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>STRESS</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="STRESS" value="[r: getProperty("STRESS")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>TRAUMA</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="TRAUMA" value="[r: getProperty("TRAUMA")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
	</tr>
<tr>
<td align="center" colspan="4">
<input type='submit' name='Submit' value='Submit'></input>
</td>
</tr>
</table> 
</form>
</body>
</html>
} ]

!!
@@ @RepUpdateDialog
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Dialog ; tooltip= ; minWidth= ; 
[dialog("Reputation Update", "temporary=0; height=200; width=335; input=1; noframe=0"): {
<html>
<head>
<title>Reputation Update</title>
<meta name="input" content="true">
</head>
<body>
<form method="json" name="StatsUpdate" action="[r:macroLinkText('RepUpdate@Lib:MnM', 'none', '', currentToken())]">
<table>
	<tr>
		<td bgcolor="black" valign="middle" colspan="8">&nbsp; &nbsp; <font color="white"><b>REPUTATION</b></font>
		</td>
	</tr>
	<tr>
		<td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>@-Rep</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="A-Rep" value="[r: getProperty("A-Rep")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>c-Rep</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="c-Rep" value="[r: getProperty("c-Rep")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>e-Rep</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="e-Rep" value="[r: getProperty("e-Rep")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>f-Rep</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="f-Rep" value="[r: getProperty("f-Rep")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>g-Rep</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="g-Rep" value="[r: getProperty("g-Rep")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>i-Rep</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="i-Rep" value="[r: getProperty("i-Rep")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
    <td>
			<table width="100%">
				<tr>
					<td bgcolor="black" color="white" align="center" width="100%"><b>r-Rep</b>
					</td>
				</tr>
				<tr>
					<td align="center" width="100%"><b><input type="text" name="r-Rep" value="[r: getProperty("r-Rep")]" size="2"></input></b>
					</td>
				</tr>
			</table>
		</td>
	</tr>
<tr>
<td align="center" colspan="8">
<input type='submit' name='Submit' value='Submit'></input>
</td>
</tr>
</table> 
</form>
</body>
</html>
} ]

!!
@@ @EgoTraitsUpdateDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Display ; tooltip= ; minWidth= ; 
[dialog("EgoTraits", "temporary=0; input=1; noframe=0"): {
<html>
  <head>
    <title>Ego Traits Display</title>
  </head>
  <body>
    <table width="100%" height="100%" cellpadding="2" align="center" border="0" bgcolor="white">
      <tr bgcolor="[r: table(PageColor,2)]" color="white">
        <td align="center" width="98%">
          <font size="5"><b>[r: json.get(macro.args, 0)]</b></font>
        </td>
        <td align="right" width="1%">
          <font color="white"><a href="[r: macroLinkText("EgoTraitsUpdateDialog@this", "none", macro.args, currentToken())]"><image src="[r: tableImage("Buttons",5)]" border="0"></image></a></font>
        </td>
      </tr>
      <tr>	
        <td colspan="2">[r: decode(json.get(macro.args,1))]</td>
      </tr>
    </table>
  </body>
</html>
}]

!!
@@ @PsiSleightsUpdateDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Display ; tooltip= ; minWidth= ; 
[dialog("PsiSleights", "temporary=0; input=1; noframe=0"): {
<html>
  <head>
    <title>Psi Sleights Display</title>
  </head>
  <body>
    <table width="100%" height="100%" cellpadding="2" align="center" border="0" bgcolor="white">
      <tr bgcolor="[r: table(PageColor,2)]" color="white">
        <td align="center" width="98%">
          <font size="5"><b>[r: json.get(macro.args, 0)]</b></font>
        </td>
        <td align="right" width="1%">
          <font color="white"><a href="[r: macroLinkText("PsiSleightsUpdateDialog@this", "none", macro.args, currentToken())]"><image src="[r: tableImage("Buttons",5)]" border="0"></image></a></font>
        </td>
      </tr>
      <tr>	
        <td colspan="2">[r: decode(json.get(macro.args,1))]</td>
      </tr>
    </table>
  </body>
</html>
}]

!!
@@ @GearUpdateDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Display ; tooltip= ; minWidth= ; 
[dialog("Gear", "temporary=0; input=1; noframe=0"): {
<html>
  <head>
    <title>Gear Display</title>
  </head>
  <body>
    <table width="100%" height="100%" cellpadding="2" align="center" border="0" bgcolor="white">
      <tr bgcolor="[r: table(PageColor,2)]" color="white">
        <td align="center" width="98%">
          <font size="5"><b>[r: json.get(macro.args, 0)]</b></font>
        </td>
        <td align="right" width="1%">
          <font color="white"><a href="[r: macroLinkText("GearUpdateDialog@this", "none", macro.args, currentToken())]"><image src="[r: tableImage("Buttons",5)]" border="0"></image></a></font>
        </td>
      </tr>
      <tr>	
        <td colspan="2">[r: decode(json.get(macro.args,1))]</td>
      </tr>
    </table>
  </body>
</html>
}]

!!
@@ @MorphTraitsUpdateDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Display ; tooltip= ; minWidth= ; 
[dialog("MorphTraits", "temporary=0; input=1; noframe=0"): {
<html>
  <head>
    <title>Morph Traits Display</title>
  </head>
  <body>
    <table width="100%" height="100%" cellpadding="2" align="center" border="0" bgcolor="white">
      <tr bgcolor="[r: table(PageColor,2)]" color="white">
        <td align="center" width="98%">
          <font size="5"><b>[r: json.get(macro.args, 0)]</b></font>
        </td>
        <td align="right" width="1%">
          <font color="white"><a href="[r: macroLinkText("MorphTraitsUpdateDialog@this", "none", macro.args, currentToken())]"><image src="[r: tableImage("Buttons",5)]" border="0"></image></a></font>
        </td>
      </tr>
      <tr>	
        <td colspan="2">[r: decode(json.get(macro.args,1))]</td>
      </tr>
    </table>
  </body>
</html>
}]

!!
@@ @ImplantsEnhancementsUpdateDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Display ; tooltip= ; minWidth= ; 
[dialog("ImplantsEnhancements", "temporary=0; input=1; noframe=0"): {
<html>
  <head>
    <title>Implants & Enhancements Display</title>
  </head>
  <body>
    <table width="100%" height="100%" cellpadding="2" align="center" border="0" bgcolor="white">
      <tr bgcolor="[r: table(PageColor,2)]" color="white">
        <td align="center" width="98%">
          <font size="5"><b>[r: json.get(macro.args, 0)]</b></font>
        </td>
        <td align="right" width="1%">
          <font color="white"><a href="[r: macroLinkText("ImplantsEnhancementsUpdateDialog@this", "none", macro.args, currentToken())]"><image src="[r: tableImage("Buttons",5)]" border="0"></image></a></font>
        </td>
      </tr>
      <tr>	
        <td colspan="2">[r: decode(json.get(macro.args,1))]</td>
      </tr>
    </table>
  </body>
</html>
}]

!!
@@ @WeaponDescriptionDisplay
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Display ; tooltip= ; minWidth= ; 
[dialog("Weapons", "temporary=0; input=1; noframe=0"): {
<html>
  <head>
    <title>Weapon Display</title>
  </head>
  <body>
    <table width="100%" height="100%" cellpadding="2" align="center" border="0" bgcolor="white">
      <tr bgcolor="[r: table(PageColor,2)]" color="white">
        <td align="center" width="98%">
          <font size="5"><b>[r: json.get(macro.args, 0)]</b></font>
        </td>
      </tr>
      <tr>	
        <td colspan="2">[r: decode(json.get(macro.args,1))]</td>
      </tr>
    </table>
  </body>
</html>
}]

!!
@@ @WeaponEntry
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Attack ; tooltip= ; minWidth= ; 
[h: weapName = json.get(macro.args,0)]
[h: weapJson = json.get(Weapons,weapName)]
[h: weapAP = json.get(weapJson,0)]
[h: weapDV = json.get(weapJson,1)]
[h: weapFM = json.get(weapJson,2)]
[h: weapCurrAmmo = json.get(weapJson,3)]
[h: weapMaxAmmo = json.get(weapJson,4)]
[h: weapSkill = json.get(weapJson,5)]
[h: weapText = json.get(weapJson,6)]
[h: weapSpec = json.get(weapJson,8)]
[h: weapLaser = json.get(weapJson,9)]

[h: skillJson = json.get(ActiveSkills,weapSkill)]
[h: skillBase = json.get(skillJson,0)]
[h: skillMod = json.get(skillJson,1)]
[h: skillApt = json.get(skillJson,2)]
[h: skillDefApt = json.get(skillJson,3)]
[h: skillSpec = json.get(skillJson,4)]

<head>
<title>Weapon Attack</title>
<meta name="input" content="true">
</head>
<body>      
[h: jsonData = json.append("[]",weapName,0,"Weapon")]
<link rel='onChangeSelection' type='macro' href='[r: macroLinkText("Entry@this", "none", jsonData, currentToken())]'></link>
<form method="json" name="WeaponCheck" action="[r:macroLinkText('EntryType@Lib:MnM', 'none', '', currentToken())]">

<table width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td color="white">
			<center><b>[r: weapName] ([r: weapSkill])</center>
		</td>
	</tr>
</table>
<table width="100%" bgcolor="white">
  [h: fmSelect = ""]
  [h,foreach(tmpFM,weapFM,""): fmSelect = fmSelect + strformat('<option value="%s">%s</option>',tmpFM,tmpFM)]
  [h,if(json.isEmpty(weapFM)): fmRow = ""; fmRow = strformat('<tr><td><b>Firing Mode: </b></td><td align="left"><select name="weapUseFM" selected="">%s</select></td></tr>',fmSelect)]
  {fmRow}
  <tr>
		<td>
			<b>Skill Modifier:</b>
		</td>
		<td align="left">
			<input type="text" name="mods" value="" size="5"></input>
		</td>
	</tr>
  <tr>
		<td>
			<b>DV Modifier:</b>
		</td>
		<td align="left">
			<input type="text" name="modsDV" value="" size="5"></input>
		</td>
	</tr>
  [h,if(weapSpec): specRow = '<tr><td>Use Specialization ('+skillSpec+'):</td><td align="left"><input type="checkbox" name="useSpec" value="1" checked="checked"></input></td></tr>'; specRow = ""]
  {specRow}
  [h,if(weapLaser): laserRow = '<tr><td>Use Laser Sight/Smartlink:</td><td align="left"><input type="checkbox" name="useLaser" value="1" checked="checked"></input></td></tr>'; laserRow = ""]
  {laserRow}
  <tr>
    <td>
      Use Aptitude ([r: skillApt] = [r: getProperty(skillApt)]):
    </td>
    <td align="left">
      <input type="checkbox" name="useApt" value="1"></input>
    </td>
  </tr>
</table>
[h: targList = getSelectedNames(", ")]
[h,if(length(targList) > 0): targString='<table width="100%"><tr bgcolor='+table(PageColor,4)+'>Targets:&nbsp;'+targList+'</tr></table>';targString = ""]
{targString}
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,3)]">
		<td align="left">
			Private: <input type="checkbox" name="Output" value="Private"></input>
		</td>
		<td alignt="right">
			Hide Roll: <input type="checkbox" name="hideRoll" value="1"]></input>
		</td>
	</tr>
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,4)]">
		<td align="center">
      <input type="hidden" name="yesDialog" value="1"></input>
			<input type="hidden" name="ExeMacro" value="WeaponCheck"></input>
      <input type="hidden" name="targList" value="[r: targList]"></input>
      <input type="hidden" name="weapName" value="[r: weapName]"></input>
			<input type='submit' name='Roll' value='Roll'></input>
		</td>
	</tr>
</table>
</form>
</body>
</html>

!!
@@ @DefenseEntry
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
[h: argz = macro.args]
[h: skillName = json.get(argz,0)]
[h: skillJson = json.get(ActiveSkills,skillName)]
[h: skillBase = json.get(skillJson,0)]
[h: skillMod = json.get(skillJson,1)]
[h: skillApt = json.get(skillJson,2)]
[h: skillDefApt = json.get(skillJson,3)]
[h: skillSpec = json.get(skillJson,4)]

<head>
<title>Defense Check</title>
<meta name="input" content="true">
</head>
<body>      
<link rel='onChangeSelection' type='macro' href='[r: macroLinkText("Entry@this", "none", json.append("[]",skillName,0,"Defense"), currentToken())]'></link>
<form method="json" name="DefenseEntry" action="[r:macroLinkText('EntryType@Lib:MnM', 'none', '', currentToken())]">

<table width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td color="white">
			<center><b>[r: skillName] ([r: skillBase + skillMod])</center>
		</td>
	</tr>
</table>
<table width="100%" bgcolor="white">
  <tr>
		<td>
			<b>Modifier:</b>
		</td>
		<td align="left">
			<input type="text" name="mods" value="" size="5"></input>
		</td>
	</tr>
  [h,if(length(skillSpec) > 0): specRow = '<tr><td>Use Specialization ('+skillSpec+'):</td><td align="left"><input type="checkbox" name="useSpec" value="1" checked="checked"></input></td></tr>'; specRow = ""]
  {specRow}
  <tr>
    <td>
      Use Aptitude ([r: skillApt] = [r: getProperty(skillApt)]):
    </td>
    <td align="left">
      <input type="checkbox" name="useApt" value="1"></input>
    </td>
  </tr>
  <tr>
    <td>
      Halve Skill?
    </td>
    <td align="left">
      <input type="checkbox" name="halfSkill" value="1"></input>
    </td>
  </tr>
</table>
[h: targList = getSelectedNames(", ")]
[h,if(length(targList) > 0): targString='<table width="100%"><tr bgcolor='+table(PageColor,4)+'>Targets:&nbsp;'+targList+'</tr></table>';targString = ""]
{targString}
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,3)]">
		<td align="left">
			Private: <input type="checkbox" name="Output" value="Private"></input>
		</td>
		<td alignt="right">
			Hide Roll: <input type="checkbox" name="hideRoll" value="1"]></input>
		</td>
	</tr>
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,4)]">
		<td align="center">
      <input type="hidden" name="yesDialog" value="1"></input>
			<input type="hidden" name="ExeMacro" value="DefenseCheck"></input>
      <input type="hidden" name="targList" value="[r: targList]"></input>
      <input type="hidden" name="skillName" value="[r: skillName]"></input>
			<input type='submit' name='Roll' value='Roll'></input>
		</td>
	</tr>
</table>
</form>
</body>
</html>

!!
@@ @OtherDefenseEntry
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Alpha ; tooltip= ; minWidth= ; 
[h: argz = macro.args]
[h: otherDefense = json.get(argz,0)]
[h,switch(otherDefense):
  case "Psi": useTN = WIL * 2;
  case "SOM x 3": useTN = SOM * 3;
  default: useTN = DUR - DAMAGE + Armor_Energy
]

<head>
<title>Other Defense Check</title>
<meta name="input" content="true">
</head>
<body>      
<link rel='onChangeSelection' type='macro' href='[r: macroLinkText("Entry@this", "none", json.append("[]",otherDefense,0,"OtherDefense"), currentToken())]'></link>
<form method="json" name="OtherDefenseEntry" action="[r:macroLinkText('EntryType@Lib:MnM', 'none', '', currentToken())]">

<table width="100%">
	<tr bgcolor="[r: table(PageColor,2)]">
		<td color="white">
			<center><b>[r: otherDefense] ([r: useTN])</center>
		</td>
	</tr>
</table>
<table width="100%" bgcolor="white">
  <tr>
		<td>
			<b>Modifier:</b>
		</td>
		<td align="left">
			<input type="text" name="mods" value="" size="5"></input>
		</td>
	</tr>
</table>
[h: targList = getSelectedNames(", ")]
[h,if(length(targList) > 0): targString='<table width="100%"><tr bgcolor='+table(PageColor,4)+'>Targets:&nbsp;'+targList+'</tr></table>';targString = ""]
[h,if(length(targList) > 0): targText = '<br><b>Targets:</b> ';targText = ""]
{targString}
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,3)]">
		<td align="left">
			Private: <input type="checkbox" name="Output" value="Private"></input>
		</td>
		<td alignt="right">
			Hide Roll: <input type="checkbox" name="hideRoll" value="1"]></input>
		</td>
	</tr>
</table>
<table width="100%">
	<tr  bgcolor="[r: table(PageColor,4)]">
		<td align="center">
      <input type="hidden" name="yesDialog" value="1"></input>
			<input type="hidden" name="ExeMacro" value="OtherDefenseCheck"></input>
      <input type="hidden" name="otherDefense" value="[r: otherDefense]"></input>
      <input type="hidden" name="targList" value="[r: targList]"></input>
			<input type='submit' name='Roll' value='Roll'></input>
		</td>
	</tr>
</table>
</form>
</body>
</html>

!!
@@ @CharSheet
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet ; tooltip= ; minWidth= ; 
[h: page = getStrProp(CharPage, "Page")]
[h: icon = tblImage("Header",1)]

<table width="100%" cellpadding="0" border="1" bgcolor="white">
<table width="100%" cellpadding="2" border="0" bgcolor="[r: table(PageColor,2)]" background="[r: tblImage('Icons',2)]">
  <tr>
    <td width="30%" rowspan="2">
			<a href="[r: macroLinktext("ColorUpdate@this", "none", "", currentToken())]"><image src='[r:getTokenImage(75)]' border="0"></image></a>
		</td>
		<td colspan="5" color="white">
			<h2>[r: token.name]</h2>
		</td>
	</tr>
	<tr>
		<td width="30%" align="center" >
      <a href="[r: macroLinktext("SheetLoad@this", "none", "Page=Stats", currentToken())]">
			<font color="[r: if(page=="Stats","yellow","white")]" size="4"><b>Stats</b></font></a>
		</td>
    <td width="30%" align="center" >
      <a href="[r: macroLinktext("SheetLoad@this", "none", "Page=Skills", currentToken())]">
			<font color="[r: if(page=="Skills","yellow","white")]" size="4"><b>Skills</b></font></a>
		</td>
		<td width="30%" align="center" >
      <a href="[r: macroLinktext("SheetLoad@this", "none", "Page=Powers", currentToken())]">
			<font color="[r: if(page=="Powers","yellow","white")]" size="4"><b>Powers</b></font></a>
		</td>
    <td width="30%" align="center" >
      <a href="[r: macroLinktext("SheetLoad@this", "none", "Page=Muse", currentToken())]">
			<font color="[r: if(page=="Muse","yellow","white")]" size="4"><b>Muse</b></font></a>
		</td>
    <td width="30%" align="center" >
      <a href="[r: macroLinktext("SheetLoad@this", "none", "Page=Combat", currentToken())]">
			<font color="[r: if(page=="Combat","yellow","white")]" size="4"><b>Combat</b></font></a>
		</td>
	</tr>
</table>

[r, macro("HeaderSheet@this"):macro.args]
</table>
<table width="100%" cellpadding="2" border="0">
	<tr>
		<td>
      <image src='[r: tableImage("Actions", 1)]' border="0" align="middle"></image>
		</td>
	</tr>
</table>

!!
@@ @HeaderSheet
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet ; tooltip= ; minWidth= ; 
<table width="100%" cellpadding="2" border="0">
	<tr bgcolor="[r: table(PageColor,4)]">
    <td width="67%">
			<b><font color="black">Background:</b> [r: Background]</font>
		</td>
    <td width="33%">
			<b><font color="black">Movement:</b> [r: Movement]</font>
		</td>
  </tr>
  <tr bgcolor="[r: table(PageColor,4)]">
    <td colspan="2">
      <b><font color="black">Motivations:</b> [r: Motivations]</font>
    </td>
  </tr>
</table>
<table width="100%" cellpadding="2" border="0">
	<tr bgcolor="[r: table(PageColor,4)]">
		<td width="34%">
			<b><font color="black">Faction:</b> [r: Faction]</font>
		</td>
		<td width="33%">
      <b><font color="black">Morph:</b> [r: Morph]</font>
		</td>	
    <td width="33%">
			<b><font color="black">Age:</b> [r: Age]</font>
		</td>
	</tr>
	<tr bgcolor="[r: table(PageColor,4)]">
		<td width="25%" align="center">
			<b><font color="black"><a href='[r:macroLinkText("TableLoad@this","none",'', currentToken())]'>Tables</a></font></b>
		</td>
		<td width="25%" align="center">
			<b><font color="black"><a href='[r: macroLinktext("RezPointsUpdate@this", "all", "Page=Stats", currentToken())]'>Rez Points:</a></font> [r: RezPoints]</b>
		</td>
		<td width="25%" align="center">
      [h: jsonData = json.append("[]"," Custom d100 Roll",0,"Roll")]	
      <font color="black"><a href='[r:macroLinkText("Entry@this","none",jsonData, currentToken())]'><b>Roll d100</b></a></font>
		</td>
    <td width="25%" align="center">
      [h: jsonData = json.append("[]"," Scatter Roll",0,"Scatter")]	
      <font color="black"><a href='[r:macroLinkText("Entry@this","none",jsonData, currentToken())]'><b>Scatter</b></a></font>
		</td>	
	</tr>
</table>
<table width="100%" cellpadding="5" border="0" valign="middle">
  <tr>
    <td  align="left" width="10%">
      <b><font color="black"><a href='[r:macroLinkText("DDUpdateDialog@this","none", "", currentToken())]'>Derangements & Disorders:</a></font></b>
    </td>
    <td align="left">
      [r,if(json.isEmpty(DandD) != 1),CODE:
      {
        <a href='[r:macroLinkText("DDInfoDisplay@this","none",json.get(DandD,0),currentToken())]'>[r: json.get(DandD,0)]</a>
      };
      {}
      ]
      [r,for(i,1,json.length(DandD),1,""),CODE: 
      {
        , <a href='[r:macroLinkText("DDInfoDisplay@this","none",json.get(DandD,i),currentToken())]'>[r: json.get(DandD,i)]</a>
      }]
    </td>
  </tr>
</table>

!!
@@ @PowersSheet
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet ; tooltip= ; minWidth= ; 
<table width="100%" cellpadding="0" valign="top">
	<tr>
		<td width="45%">
			<table width="100%" cellpadding="0" border="1">
        [r, macro("EgoTraitsDisplay@this"):""]
			</table>
      <table width="100%" cellpadding="2" border="0">
        <tr>
          <td>
            <image src='[r: tableImage("Actions", 1)]' border="0" align="middle"></image>
          </td>
        </tr>
      </table>
      <table width="100%" cellpadding="0" border="1">
        [r, macro("MorphTraitsDisplay@this"):""]
      </table>
      <table width="100%" cellpadding="2" border="0">
        <tr>
          <td>
            <image src='[r: tableImage("Actions", 1)]' border="0" align="middle"></image>
          </td>
        </tr>
      </table>
      <table width="100%" cellpadding="0" border="1">
        [r, macro("ImplantsEnhancementsDisplay@this"):""]
      </table>
    </td>
    <table width="100%" cellpadding="1" border="0">
      <tr>
        <td>
          <image src='[r: tableImage("Actions", 1)]' border="0" align="middle"></image>
        </td>
      </tr>
    </table>
		<td width="55%">
      <table width="100%" cellpadding="0" border="1">
        [r, macro("PsiSleightsDisplay@this"):""]
			</table>
      <table width="100%" cellpadding="2" border="0">
        <tr>
          <td>
            <image src='[r: tableImage("Actions", 1)]' border="0" align="middle"></image>
          </td>
        </tr>
      </table>
      <table width="100%" cellpadding="0" border="1">
        [r, macro("GearDisplay@this"):""]
      </table>
		</td>
	</tr>
</table>

!!
@@ @Sheet
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet ; tooltip= ; minWidth= ; 
[h: selectedCount=listCount(getSelected())]
[frame("Sheet"):{
<html>
<link rel="onChangeSelection" type="macro" href="[r: macroLinkText('SheetLoad@this', 'none','fromClick','selected')]"></link>
<head><title>Character Sheet</title></head>
<body>
	[r, if(getPropertyType() != "Basic" && getPropertyType() != "zLibrary" && selectedCount <= 1), code:
		{
      [h: argz = macro.args]
      [h,if(startsWith(argz,"Page=")): argPage = getStrProp(argz, "Page"); argPage = ""]
      [h,if(getStrProp(CharPage, "Page") != argPage && length(argPage) > 0): newPage = 1; newPage = 0]
      [h,if(newPage): CharPage = "Page=" + argPage]
      [h,if(newPage): RecalcTopSheet()]
      [h,if(length(SheetCache) <= 0): RecalcTopSheet()]
      [h,if(length(StatsCache) <= 0): RecalcBottomSheet("Stats")]
      [h,if(length(StatsCache) <= 0): RecalcBottomSheet("Stats")]
      [h,if(length(SkillsCache) <= 0): RecalcBottomSheet("Skills")]
      [h,if(length(PowersCache) <= 0): RecalcBottomSheet("Powers")]
      [h,if(length(MuseCache) <= 0): RecalcBottomSheet("Muse")]
      [h,if(length(CombatCache) <= 0): RecalcBottomSheet("Combat")]
			[r:decode(SheetCache)]
      [h:cPage = getStrProp(CharPage, "Page")]
      [r,switch(cPage): 
        case "Stats": decode(StatsCache);
        case "Skills": decode(SkillsCache);
        case "Powers": decode(PowersCache);
        case "Muse": decode(MuseCache);
        case "Combat": decode(CombatCache);
        default: decode(StatsCache)
      ]
		}; 
		{
			<table width="100%">
				<tr>
					<td align="center"><image src='[r: tableImage("Icons",1,300)]' border="0" align="middle"></image><br>
						<font size = "5"><b>[r, if(SelectedCount <= 1): "This is not a character token."; "Multiple tokens selected."]</b></font>
					</td>
				</tr>
			</table>
		}
	]
</body>
</html>
}]
!!
@@ @SheetLoad
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet ; tooltip= ; minWidth= ; 
[h: argz = macro.args]
[r,if(argz == "fromClick" && hasImpersonated()),CODE:
{};{
  [h: OwnedCurrent = listContains(getOwned(getPlayerName()), currentToken())]
  [h: OwnedSelected = listContains(getOwned(getPlayerName()), getSelected())]

  [r,if(OwnedCurrent == 1 || OwnedSelected == 1 || isGM()), CODE:
	{
    [r, macro("Sheet@this"): macro.args]
  };{
		[h: ""]
  }]
}]

!!
@@ @RecalcTopSheet
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet ; tooltip= ; minWidth= ; 
[h:SheetCache = encode(CharSheet())]

!!
@@ @RecalcBottomSheet
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet ; tooltip= ; minWidth= ; 
[h,if(argCount() > 0): cPage = arg(0); cPage = getStrProp(CharPage, "Page")]
[h,switch(cPage): 
  case "Stats": StatsCache = encode(StatsSheet());
  case "Skills": SkillsCache = encode(SkillsSheet());
  case "Powers": PowersCache = encode(PowersSheet());
  case "Muse": MuseCache = encode(MuseSheet());
  case "Combat": CombatCache = encode(CombatSheet());
  default: StatsCache = encode(StatsSheet())
]

!!
@@ @StatsSheet
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet ; tooltip= ; minWidth= ; 
<table width="100%" cellpadding="0">
	<tr>
		<td width="100%" valign="top">
			[r, macro("AptitudesDisplay@this"):""]
		</td>
	</tr>
</table>
<table width="100%" cellpadding="0">
	<tr>
		<td width="100%" valign="top">
			[r, macro("StatsDisplay@this"):""]
		</td>
	</tr>
</table>
<table width="100%" cellpadding="0">
	<tr>
		<td width="100%" valign="top">
			[r, macro("RepDisplay@this"):""]
		</td>
	</tr>
</table>

!!
@@ @MuseSheet
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet ; tooltip= ; minWidth= ; 
<table width="100%" cellpadding="0">
	<tr>
		<td width="100%" valign="top">
			[r, macro("MuseAptitudesDisplay@this"):""]
		</td>
	</tr>
</table>
<table width="100%" cellpadding="0">
	<tr>
		<td width="100%" valign="top">
			[r, macro("MuseStatsDisplay@this"):""]
		</td>
	</tr>
</table>
<table width="100%" cellpadding="0" border="1">
	<tr>
		<td width="100%" valign="top">
			[r, macro("MuseSkillsDisplayTop@this"):""]
		</td>
	</tr>
</table>

!!
@@ @CombatSheet
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet ; tooltip= ; minWidth= ; 
<table width="100%" cellpadding="0" border="1">
	<tr>
		<td width="100%" valign="top">
			[r, macro("CombatDefenseDisplay@this"):""]
		</td>
	</tr>
</table>
<table width="100%" cellpadding="0">
	<tr>
		<td width="100%" valign="top">
			[r, macro("DamageStressDisplay@this"):""]
		</td>
	</tr>
</table>
<table width="100%" cellpadding="0" border="1">
	<tr>
		<td width="100%" valign="top">
			[r, macro("WeaponDisplayTop@this"):""]
		</td>
	</tr>
</table>

!!
@@ @SkillsSheet
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=Sheet ; tooltip= ; minWidth= ; 
<table width="100%" cellpadding="0" border="1">
  <tr>
    <td width="100%">
      [r, macro("ActiveSkillsDisplayTop@this"):""]
    </td>
  </tr>
</table>
<table width="100%" cellpadding="0" border="1">
  <tr>
    <td width="100%">
      [r, macro("KnowSkillsDisplayTop@this"):""]
    </td>
  </tr>
</table>

!!
@@ @Measurements Table
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=z ; color=default ; playerEditable=false ; applyToSelected=false ; group=GM ; tooltip= ; minWidth= ; 
[dialog("Measurements Table","width=400; height=600; temporary=1; noframe=0; "): {

<table bgcolor="[r: table(PageColor,4)]">
	<tr bgcolor='[r: table(PageColor,2)]'>
		<td ><span style="color:white"><b><center>Rank</td>
		<td ><span style="color:white"><b><center>Mass</td>
		<td ><span style="color:white"><b><center>Time</td>
		<td ><span style="color:white"><b><center>Distance</td>
		<td ><span style="color:white"><b><center>Volume</td>
	</tr><tr>
<td colspan="7" style="background-color:'[r: table(PageColor,3)]'  ; margin:0px; padding:0px; height:0px"><img src='[r: tblImage("Icons",10,5)]' border="0"></img></td>
</tr>
	<tr bgcolor="white">
		<td ><center>-5</td>
		<td ><center>1.5 lb.</td>
		<td ><center>1/8 second</td>
		<td ><center>6 inches</td>
		<td ><center>1/32 cft.</td>
	</tr>
	<tr>
		<td ><center>-4</td>
		<td ><center>3 lbs.</td>
		<td ><center>1/4 second</td>
		<td ><center>1 foot</td>
		<td ><center>1/16 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>-3</td>
		<td ><center>6 lbs.</td>
		<td ><center>1/2 second</td>
		<td ><center>3 feet</td>
		<td ><center>1/8 cft.</td>
	</tr>
	<tr>
		<td ><center>-2</td>
		<td ><center>12 lbs.</td>
		<td ><center>1 second</td>
		<td ><center>6 feet</td>
		<td ><center>1/4 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>-1</td>
		<td ><center>25 lbs.</td>
		<td ><center>3 seconds</td>
		<td ><center>15 feet</td>
		<td ><center>1/2 cft.</td>
	</tr>
	<tr>
		<td ><center>0</td>
		<td ><center>50 lbs.</td>
		<td ><center>6 seconds</td>
		<td ><center>30 feet</td>
		<td ><center>1 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>1</td>
		<td ><center>100 lbs.</td>
		<td ><center>12 seconds</td>
		<td ><center>60 feet</td>
		<td ><center>2 cft.</td>
	</tr>
	<tr>
		<td ><center>2</td>
		<td ><center>200 lbs.</td>
		<td ><center>30 seconds</td>
		<td ><center>120 feet</td>
		<td ><center>4 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>3</td>
		<td ><center>400 lbs.</td>
		<td ><center>1 minute</td>
		<td ><center>250 feet</td>
		<td ><center>8 cft.</td>
	</tr>
	<tr>
		<td ><center>4</td>
		<td ><center>800 lbs.</td>
		<td ><center>2 minutes</td>
		<td ><center>500 feet</td>
		<td ><center>15 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>5</td>
		<td ><center>1600 lbs.</td>
		<td ><center>4 minutes</td>
		<td ><center>900 feet</td>
		<td ><center>30 cft.</td>
	</tr>
	<tr>
		<td ><center>6</td>
		<td ><center>3200 lbs.</td>
		<td ><center>8 minutes</td>
		<td ><center>1800 feet</td>
		<td ><center>60 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>7</td>
		<td ><center>3 tons</td>
		<td ><center>15 minutes</td>
		<td ><center>1/2 mile</td>
		<td ><center>125 cft.</td>
	</tr>
	<tr>
		<td ><center>8</td>
		<td ><center>6 tons</td>
		<td ><center>30 minutes</td>
		<td ><center>1 mile</td>
		<td ><center>250 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>9</td>
		<td ><center>12 tons</td>
		<td ><center>1 hour</td>
		<td ><center>2 miles</td>
		<td ><center>500 cft.</td>
	</tr>
	<tr>
		<td ><center>10</td>
		<td ><center>25 tons</td>
		<td ><center>2 hours</td>
		<td ><center>4 miles</td>
		<td ><center>1,000 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>11</td>
		<td ><center>50 tons</td>
		<td ><center>4 hours</td>
		<td ><center>8 miles</td>
		<td ><center>2,000 cft.</td>
	</tr>
	<tr>
		<td ><center>12</td>
		<td ><center>100 tons</td>
		<td ><center>8 hours</td>
		<td ><center>16 miles</td>
		<td ><center>4,000 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>13</td>
		<td ><center>200 tons</td>
		<td ><center>16 hours</td>
		<td ><center>30 miles</td>
		<td ><center>8,000 cft.</td>
	</tr>
	<tr>
		<td ><center>14</td>
		<td ><center>400 tons</td>
		<td ><center>1 day</td>
		<td ><center>60 miles</td>
		<td ><center>16,000 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>15</td>
		<td ><center>800 tons</td>
		<td ><center>2 days</td>
		<td ><center>120 miles</td>
		<td ><center>32,000 cft.</td>
	</tr>
	<tr>
		<td ><center>16</td>
		<td ><center>1600 tons</td>
		<td ><center>4 days</td>
		<td ><center>250 miles</td>
		<td ><center>65,000 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>17</td>
		<td ><center>3.2 ktons</td>
		<td ><center>1 week</td>
		<td ><center>500 miles</td>
		<td ><center>125,000 cft.</td>
	</tr>
	<tr>
		<td ><center>18</td>
		<td ><center>6 ktons</td>
		<td ><center>2 weeks</td>
		<td ><center>1,000 miles</td>
		<td ><center>250,000 cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>19</td>
		<td ><center>12 ktons</td>
		<td ><center>1 month</td>
		<td ><center>2,000 miles</td>
		<td ><center>500,000 cft.</td>
	</tr>
	<tr>
		<td ><center>20</td>
		<td ><center>25 ktons</td>
		<td ><center>2 months</td>
		<td ><center>4,000 miles</td>
		<td ><center>1 million cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>21</td>
		<td ><center>50 ktons</td>
		<td ><center>4 months</td>
		<td ><center>8,000 miles</td>
		<td ><center>2 million cft.</td>
	</tr>
	<tr>
		<td ><center>22</td>
		<td ><center>100 ktons</td>
		<td ><center>8 months</td>
		<td ><center>1,6000 miles</td>
		<td ><center>4 million cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>23</td>
		<td ><center>200 ktons</td>
		<td ><center>1.5 years</td>
		<td ><center>32,000 miles</td>
		<td ><center>8 million cft.</td>
	</tr>
	<tr>
		<td ><center>24</td>
		<td ><center>400 ktons</td>
		<td ><center>3 years</td>
		<td ><center>64,000 miles</td>
		<td ><center>15 million cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>25</td>
		<td ><center>800 ktons</td>
		<td ><center>6 years</td>
		<td ><center>125,000 miles</td>
		<td ><center>32 million cft.</td>
	</tr>
	<tr>
		<td ><center>26</td>
		<td ><center>1,600 ktons</td>
		<td ><center>12 years</td>
		<td ><center>250,000 miles</td>
		<td ><center>65 million cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>27</td>
		<td ><center>3,200 ktons</td>
		<td ><center>25 years</td>
		<td ><center>500,000 miles</td>
		<td ><center>125 million cft.</td>
	</tr>
	<tr>
		<td ><center>28</td>
		<td ><center>6,400 ktons</td>
		<td ><center>50 years</td>
		<td ><center>1 million miles</td>
		<td ><center>250 million cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>29</td>
		<td ><center>12,500 ktons</td>
		<td ><center>100 years</td>
		<td ><center>2 million miles</td>
		<td ><center>500 million cft.</td>
	</tr>
	<tr>
		<td ><center>30</td>
		<td ><center>25,000 ktons</td>
		<td ><center>200 years</td>
		<td ><center>4 million miles</td>
		<td ><center>1 billion cft.</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>+1</td>
		<td ><center>x2</td>
		<td ><center>x2</td>
		<td ><center>x2</td>
		<td ><center>x2</td>
	</tr>
</table>

}]
[abort(0)]

!!
@@ @Weapon Ranges
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=z ; color=default ; playerEditable=false ; applyToSelected=false ; group=GM ; tooltip= ; minWidth= ; 
[dialog("Weapon Ranges","width=550; height=845; temporary=1; noframe=0; "): {

<table bgcolor="[r: table(PageColor,4)]">
	<tr bgcolor='[r: table(PageColor,2)]'>
		<td ><span style="color:white"><b><center>Weapon (Type)</td>
		<td ><span style="color:white"><b><center>Short Range</td>
		<td ><span style="color:white"><b><center>Medium Range (-10)</td>
		<td ><span style="color:white"><b><center>Long Range (-20)</td>
		<td ><span style="color:white"><b><center>Extreme Range (-30)</td>
	</tr><tr>
<td colspan="7" style="background-color:'[r: table(PageColor,3)]'  ; margin:0px; padding:0px; height:0px"><img src='[r: tblImage("Icons",10,5)]' border="0"></img></td>
</tr>
	<tr bgcolor="white">
		<td><b>Firearms</b></td>
	</tr>
	<tr>
		<td ><center>Light Pistol</td>
		<td ><center>0-10</td>
		<td ><center>11-25</td>
		<td ><center>26-40</td>
		<td ><center>41-60</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>Medium Pistol</td>
		<td ><center>0-10</td>
		<td ><center>11-30</td>
		<td ><center>31-50</td>
		<td ><center>51-70</td>
	</tr>
	<tr>
		<td ><center>Heavy Pistol</td>
		<td ><center>0-10</td>
		<td ><center>11-35</td>
		<td ><center>36-60</td>
		<td ><center>61-80</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>SMG</td>
		<td ><center>0-30</td>
		<td ><center>31-80</td>
		<td ><center>81-125</td>
		<td ><center>126-230</td>
	</tr>
	<tr>
		<td ><center>Assault Rifle</td>
		<td ><center>0-150</td>
		<td ><center>151-250</td>
		<td ><center>251-500</td>
		<td ><center>501-900</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>Sniper Rifle</td>
		<td ><center>0-180</td>
		<td ><center>181-400</td>
		<td ><center>401-1,100</td>
		<td ><center>1,100-2,300</td>
	</tr>
	<tr>
		<td ><center>Machine Gun</td>
		<td ><center>0-100</td>
		<td ><center>101-400</td>
		<td ><center>401-1,000</td>
		<td ><center>1,001-2,000</td>
	</tr>
	<tr bgcolor="white">
		<td ><b>Railguns</b></td>
	</tr>
	<tr>
    <td colspan="5"><center>as Firearms but increase the effective range in each category by +50%</td>
	</tr>
	<tr bgcolor="white">
    <td><b>Beam Weapons</b></td>
	</tr>
	<tr>
		<td ><center>Cybernetic Hand Laser</td>
		<td ><center>0-30</td>
		<td ><center>31-80</td>
		<td ><center>81-125</td>
		<td ><center>126-230</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>Laser Pulser</td>
		<td ><center>0-30</td>
		<td ><center>31-100</td>
		<td ><center>101-150</td>
		<td ><center>151-250</td>
	</tr>
	<tr>
		<td ><center>Microwave Agonizer</td>
		<td ><center>0-5</td>
		<td ><center>6-15</td>
		<td ><center>16-30</td>
		<td ><center>31-50</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>Particle Beam Bolter</td>
		<td ><center>0-30</td>
		<td ><center>31-100</td>
		<td ><center>101-150</td>
		<td ><center>151-300</td>
	</tr>
	<tr>
		<td ><center>Plasma Rifle</td>
		<td ><center>0-20</td>
		<td ><center>21-50</td>
		<td ><center>51-100</td>
		<td ><center>101-300</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>Stunner</td>
		<td ><center>0-10</td>
		<td ><center>11-25</td>
		<td ><center>26-40</td>
		<td ><center>41-60</td>
	</tr>
	<tr>
		<td ><b>Seekers</b></td>
	</tr>
	<tr bgcolor="white">
		<td ><center>Seeker Micromissile</td>
		<td ><center>5-70</td>
		<td ><center>71-180</td>
		<td ><center>181-600</td>
		<td ><center>601-2,000</td>
	</tr>
	<tr>
		<td ><center>Seeker Minimissile</td>
		<td ><center>5-150</td>
		<td ><center>151-300</td>
		<td ><center>301-1,000</td>
		<td ><center>1,001-3,000</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>Seeker Standard Missile</td>
		<td ><center>5-300</td>
		<td ><center>301-1,000</td>
		<td ><center>1001-3,000</td>
		<td ><center>3001-10,000</td>
	</tr>
	<tr>
		<td ><b>Spray Weapons</b></td>
	</tr>
	<tr bgcolor="white">
		<td ><center>Buzzer</td>
		<td ><center>0-5</td>
		<td ><center>6-15</td>
		<td ><center>16-30</td>
		<td ><center>31-50</td>
	</tr>
	<tr>
		<td ><center>Freezer</td>
		<td ><center>0-5</td>
		<td ><center>6-15</td>
		<td ><center>16-30</td>
		<td ><center>31-50</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>Shard Pistol</td>
		<td ><center>0-10</td>
		<td ><center>11-30</td>
		<td ><center>31-50</td>
		<td ><center>51-70</td>
	</tr>
	<tr>
		<td ><center>Shredder</td>
		<td ><center>0-10</td>
		<td ><center>11-40</td>
		<td ><center>41-70</td>
		<td ><center>71-100</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>Sprayer</td>
		<td ><center>0-5</td>
		<td ><center>6-15</td>
		<td ><center>16-30</td>
		<td ><center>31-50</td>
	</tr>
	<tr>
		<td ><center>Torch</td>
		<td ><center>0-5</td>
		<td ><center>6-15</td>
		<td ><center>16-30</td>
		<td ><center>31-50</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>Vortex Ring Gun</td>
		<td ><center>0-5</td>
		<td ><center>6-15</td>
		<td ><center>16-30</td>
		<td ><center>31-50</td>
	</tr>
	<tr>
		<td ><b>Thrown Weapons</b></td>
	</tr>
	<tr bgcolor="white">
		<td ><center>Blades</td>
		<td ><center>To SOM / 5</td>
		<td ><center>To SOM / 2</td>
		<td ><center>To SOM</td>
		<td ><center>To SOM * 2</td>
	</tr>
	<tr>
		<td ><center>Minigrenades</td>
		<td ><center>To SOM / 2</td>
		<td ><center>To SOM</td>
		<td ><center>To SOM * 2</td>
		<td ><center>To SOM * 3</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>Standard Grenades</td>
		<td ><center>To SOM / 5</td>
		<td ><center>To SOM / 2</td>
		<td ><center>To SOM</td>
		<td ><center>To SOM * 3</td>
	</tr>
</table>

}]
[abort(0)]

!!
@@ @Skill List
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=z ; color=default ; playerEditable=false ; applyToSelected=false ; group=GM ; tooltip= ; minWidth= ; 
[dialog("Skill List","width=430; height=845; temporary=1; noframe=0; "): {

<table bgcolor="[r: table(PageColor,4)]">
	<tr bgcolor='[r: table(PageColor,2)]'>
		<td ><span style="color:white"><b><center>Skill</td>
		<td ><span style="color:white"><b><center>Linked Aptitude</td>
		<td ><span style="color:white"><b><center>Category</td>
	</tr><tr>
<td colspan="7" style="background-color:'[r: table(PageColor,3)]'  ; margin:0px; padding:0px; height:0px"><img src='[r: tblImage("Icons",10,5)]' border="0"></img></td>
</tr>
  <tr bgcolor="white">
		<td><center>Academics: (Field)</td>
		<td><center>COG</td>
		<td><center>Knowledge</td>
	</tr>
	<tr>
    <td><center>Animal Handling</td>
		<td><center>SAV</td>
		<td><center>Active, Social</td>
  </tr>
  <tr bgcolor="white">
		<td><center>Art: (Field)</td>
		<td><center>INT</td>
		<td><center>Knowledge</td>
  </tr>
  <tr>
		<td><center>Beam Weapons</td>
		<td><center>COO</td>
		<td><center>Active, Combat</td>
  </tr>
  <tr bgcolor="white">
		<td><center>Blades</td>
		<td><center>SOM</td>
		<td><center>Active, Combat</td>
  </tr>
  <tr>
		<td><center>Climbing</td>
		<td><center>SOM</td>
		<td><center>Active, Physical</td>
  </tr>
  <tr bgcolor="white">
		<td><center>Clubs</td>
		<td><center>SOM</td>
		<td><center>Active, Combat</td>
  </tr>
  <tr>
		<td><center>Control</td>
		<td><center>WIL (no defaulting)</td>
		<td><center>Active, Mental, Psi</td>
  </tr>
  <tr bgcolor="white">
		<td><center>Deception</td>
		<td><center>SAV</td>
		<td><center>Active, Social</td>
  </tr>
  <tr>
		<td><center>Demolitions</td>
		<td><center>COG (no defaulting)</td>
		<td><center>Active, Technical</td>
  </tr>
  <tr bgcolor="white">
		<td><center>Disguise</td>
		<td><center>INT</td>
		<td><center>Active, Physical</td>
  </tr>
  <tr>
		<td><center>Exotic Melee Weapon: (Field)</td>
		<td><center>SOM</td>
		<td><center>Active, Combat</td>
  </tr>
  <tr bgcolor="white">
		<td><center>Exotic Ranged Weapon: (Field)</td>
		<td><center>COO</td>
		<td><center>Active, Combat</td>
  </tr>
  <tr>
		<td><center>Flight</td>
		<td><center>SOM</td>
		<td><center>Active, Physical</td>
  </tr>
  <tr bgcolor="white">
		<td><center>Fray</td>
		<td><center>REF</td>
		<td><center>Active, Combat</td>
  </tr>
  <tr>
		<td><center>Free Fall</td>
		<td><center>REF</td>
		<td><center>Active, Physical</td>
  </tr>
  <tr bgcolor="white">
		<td><center>Freerunning</td>
		<td><center>SOM</td>
		<td><center>Active, Physical</td>
  </tr>
  <tr>
		<td><center>Gunnery</td>
		<td><center>INT</td>
		<td><center>Active, Combat</td>
  </tr>
  <tr bgcolor="white">
		<td><center>Hardware: (Field)</td>
		<td><center>COG</td>
		<td><center>Active, Technical</td>
  </tr>
  <tr>
		<td><center>Impersonation</td>
		<td><center>SAV</td>
		<td><center>Active, Social</td>
  </tr>
  <tr bgcolor="white">
		<td><center>Infiltration</td>
		<td><center>COO</td>
		<td><center>Active, Physical</td>
  </tr>
  <tr>
		<td><center>Infosec</td>
		<td><center>COG (no defaulting)</td>
		<td><center>Active, Technical</td>
  </tr>
  <tr bgcolor="white">
		<td><center>Interest: (Field)</td>
		<td><center>COG</td>
		<td><center>Knowledge</td>
  </tr>
  <tr>
		<td><center>Interfacing</td>
		<td><center>COG</td>
		<td><center>Active, Technical</td>
  </tr>
  <tr bgcolor="white">
		<td><center>Intimidation</td>
		<td><center>SAV</td>
		<td><center>Active, Social</td>
  </tr>
  <tr>
		<td><center>Investigation</td>
		<td><center>INT</td>
		<td><center>Active, Mental</td>
  </tr>
  <tr bgcolor="white">
		<td><center>Kinesics</td>
		<td><center>SAV</td>
		<td><center>Active, Social</td>
  </tr>
  <tr>
		<td><center>Kinetic Weapons</td>
		<td><center>COO</td>
		<td><center>Active, Combat</td>
  </tr>
  <tr bgcolor="white">
		<td><center>Language: (Field)</td>
		<td><center>INT</td>
		<td><center>Knowledge</td>
  </tr>
  <tr>
		<td><center>Medicine: (Field)</td>
		<td><center>COG</td>
		<td><center>Active, Technical</td>
  </tr>
  <tr bgcolor="white">
		<td><center>Navigation</td>
		<td><center>INT</td>
		<td><center>Active, Mental</td>
  </tr>
  <tr>
		<td><center>Networking: (Field)</td>
		<td><center>SAV</td>
		<td><center>Active, Social</td>
  </tr>
  <tr bgcolor="white">
		<td><center>Palming</td>
		<td><center>COO</td>
		<td><center>Active, Physical</td>
  </tr>
  <tr>
		<td><center>Perception</td>
		<td><center>INT</td>
		<td><center>Active, Mental</td>
  </tr>
  <tr bgcolor="white">
		<td><center>Persuasion</td>
		<td><center>SAV</td>
		<td><center>Active, Social</td>
  </tr>
  <tr>
		<td><center>Pilot: (Field)</td>
		<td><center>REF</td>
		<td><center>Active, Vehicle</td>
  </tr>
  <tr bgcolor="white">
		<td><center>Profession: (Field)</td>
		<td><center>COG</td>
		<td><center>Knowledge</td>
  </tr>
  <tr>
		<td><center>Programming</td>
		<td><center>COG (no defaulting)</td>
		<td><center>Active, Technical</td>
  </tr>
  <tr bgcolor="white">
		<td><center>Protocol</td>
		<td><center>SAV</td>
		<td><center>Active, Social</td>
  </tr>
  <tr>
		<td><center>Psi Assault</td>
		<td><center>WIL (no defaulting)</td>
		<td><center>Active, Mental, Psi</td>
  </tr>
  <tr bgcolor="white">
		<td><center>Psychosurgery</td>
		<td><center>INT</td>
		<td><center>Active, Technical</td>
  </tr>
  <tr>
		<td><center>Research</td>
		<td><center>COG</td>
		<td><center>Active, Technical</td>
  </tr>
  <tr bgcolor="white">
		<td><center>Scrounging</td>
		<td><center>INT</td>
		<td><center>Active, Mental</td>
  </tr>
  <tr>
		<td><center>Seeker Weapons</td>
		<td><center>COO</td>
		<td><center>Active, Combat</td>
  </tr>
  <tr bgcolor="white">
		<td><center>Sense</td>
		<td><center>INT (no defaulting)</td>
		<td><center>Active, Mental, Psi</td>
  </tr>
  <tr>
		<td><center>Spray Weapons</td>
		<td><center>COO</td>
		<td><center>Active, Combat</td>
  </tr>
  <tr bgcolor="white">
		<td><center>Swimming</td>
		<td><center>SOM</td>
		<td><center>Active, Physical</td>
  </tr>
  <tr>
		<td><center>Throwing Weapons</td>
		<td><center>COO</td>
		<td><center>Active, Combat</td>
  </tr>
  <tr bgcolor="white">
		<td><center>Unarmed Combat</td>
		<td><center>SOM</td>
		<td><center>Active, Combat</td>
  </tr>
</table>

}]
[abort(0)]

!!
@@ @Size Rank Modifiers
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy=z ; color=default ; playerEditable=false ; applyToSelected=false ; group=GM ; tooltip= ; minWidth= ; 
[dialog("Size Rank Modifiers","width=475; height=353; temporary=1; noframe=0; "): {

<table bgcolor="[r: table(PageColor,4)]">
	<tr bgcolor='[r: table(PageColor,2)]'>
		<td ><span style="color:white"><b><center>Size Rank</td>
		<td ><span style="color:white"><b><center>Height/Length</td>
		<td ><span style="color:white"><b><center>Active Defense</td>
		<td ><span style="color:white"><b><center>Stealth</td>
		<td ><span style="color:white"><b><center>Intimidation</td>
		<td ><span style="color:white"><b><center>STR</td>
		<td ><span style="color:white"><b><center>STA</td>
		<td ><span style="color:white"><b><center>Speed</td>
	</tr>
	<tr>
		<td colspan="8" style="background-color:'[r: table(PageColor,3)]'  ; margin:0px; padding:0px; height:0px"><img src='[r: tblImage("Icons",10,5)]' border="0"></img></td>
	</tr>
	<tr bgcolor="white">
		<td ><center>3</td>
		<td ><center>250 feet.</td>
		<td ><center>-10</td>
		<td ><center>-20</td>
		<td ><center>+10</td>
		<td ><center>+20</td>
		<td ><center>+20</td>
		<td ><center>+2</td>
	</tr>
	<tr>
		<td ><center>2</td>
		<td ><center>120 feet</td>
		<td ><center>-8</td>
		<td ><center>-16</td>
		<td ><center>+8</td>
		<td ><center>+16</td>
		<td ><center>+16</td>
		<td ><center>+2</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>1</td>
		<td ><center>60 feet</td>
		<td ><center>-6</td>
		<td ><center>-12</td>
		<td ><center>+6</td>
		<td ><center>+12</td>
		<td ><center>+12</td>
		<td ><center>+1</td>
	</tr>
	<tr>
		<td ><center>0</td>
		<td ><center>30 feet</td>
		<td ><center>-4</td>
		<td ><center>-8</td>
		<td ><center>+4</td>
		<td ><center>+8</td>
		<td ><center>+8</td>
		<td ><center>+1</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>-1</td>
		<td ><center>15 feet</td>
		<td ><center>-2</td>
		<td ><center>-4</td>
		<td ><center>+2</td>
		<td ><center>+4</td>
		<td ><center>+4</td>
		<td ><center>+0</td>
	</tr>
	<tr>		
		<td ><center>-2</td>
		<td ><center>6 feet</td>
		<td ><center>0</td>
		<td ><center>0</td>
		<td ><center>0</td>
		<td ><center>0</td>
		<td ><center>0</td>
		<td ><center>+0</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>-3</td>
		<td ><center>3 feet</td>
		<td ><center>+2</td>
		<td ><center>+4</td>
		<td ><center>-2</td>
		<td ><center>-1</td>
		<td ><center>0</td>
		<td ><center>+0</td>
	</tr>
	<tr>
		<td ><center>-4</td>
		<td ><center>1 feet</td>
		<td ><center>+4</td>
		<td ><center>+8</td>
		<td ><center>-4</td>
		<td ><center>-2</td>
		<td ><center>0</td>
		<td ><center>-1</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>-5</td>
		<td ><center>6 inches</td>
		<td ><center>+6</td>
		<td ><center>+12</td>
		<td ><center>-6</td>
		<td ><center>-3</td>
		<td ><center>0</td>
		<td ><center>-1</td>
	</tr>
	<tr>
		<td ><center>-6</td>
		<td ><center>3 inches</td>
		<td ><center>+8</td>
		<td ><center>+16</td>
		<td ><center>-8</td>
		<td ><center>-4</td>
		<td ><center>0</td>
		<td ><center>-2</td>
	</tr>
	<tr bgcolor="white">
		<td ><center>-7</td>
		<td ><center>1 inches</td>
		<td ><center>+10</td>
		<td ><center>+20</td>
		<td ><center>-10</td>
		<td ><center>-5</td>
		<td ><center>0</td>
		<td ><center>-2</td>
	</tr>
</table>

}]
[abort(0)]

!!
@@ @TableLoad
@PROPS@ fontColor=black ; autoExecute=true ; fontSize=1.00em ; sortBy= ; color=default ; playerEditable=false ; applyToSelected=false ; group=GM ; tooltip= ; minWidth= ; 
[status=input(
"chart|Weapon Ranges,Skill List|Choose Table|RADIO|VALUE=STRING SPAN=TRUE"
)]

[h: abort(status)]

[r, macro(chart+"@this"):""]

!!
@@ @die100
@PROPS@ fontColor=black;autoExecute=true;fontSize=1.00em;sortBy=;color=default;playerEditable=false;applyToSelected=false;group=User-Defined Functions;tooltip=
[h,if(json.contains(macro.args,"rollTitle")):rollTitle = json.get(macro.args, "rollTitle");rollTitle = "2d10"]
[h,if(json.contains(macro.args,"targetNumber")):targetNumber = json.get(macro.args, "targetNumber");targetNumber = 0]
[h,if(json.contains(macro.args,"mods")):mods = json.get(macro.args, "mods");mods = 0]
[h,if(json.contains(macro.args,"rollerName")):rollerName = json.get(macro.args, "rollerName");rollerName = getPlayerName()]
[h,if(json.contains(macro.args,"teamWork")):teamWork = json.get(macro.args, "teamWork");teamWork = 0]
[h,if(json.contains(macro.args,"secondaryTargetNumber")):secondaryTargetNumber = json.get(macro.args, "secondaryTargetNumber");secondaryTargetNumber = 0]
[h,if(json.contains(macro.args,"useSpec")):useSpec = json.get(macro.args, "useSpec");useSpec = 0]
[h,if(json.contains(macro.args,"useLaser")):useLaser = json.get(macro.args, "useLaser");useLaser = 0]
[h,if(json.contains(macro.args,"specName")):specName = json.get(macro.args, "specName");specName = ""]
[h,if(json.contains(macro.args,"extraText")):extraText = json.get(macro.args, "extraText");extraText = ""]
[h,if(json.contains(macro.args,"weapCheck")):weapCheck = json.get(macro.args, "weapCheck");weapCheck = 0]
[h,if(json.contains(macro.args,"weapDV")):weapDV = json.get(macro.args, "weapDV");weapDV = 0]
[h,if(json.contains(macro.args,"weapAP")):weapAP = json.get(macro.args, "weapAP");weapAP = 0]
[h,if(json.contains(macro.args,"modsDV")):modsDV = json.get(macro.args, "modsDV");modsDV = 0]
[h,if(json.contains(macro.args,"halveSkill")):halveSkill = json.get(macro.args, "halveSkill");halveSkill = 0]

[h,if(json.contains(macro.args,"useWounds")):useWounds = json.get(macro.args, "useWounds");useWounds = 1]
[h,if(json.contains(macro.args,"useTrauma")):useTrauma = json.get(macro.args, "useTrauma");useTrauma = 1]
[h,if(json.contains(macro.args,"useArmorPenalty")):useArmorPenalty = json.get(macro.args, "useArmorPenalty");useArmorPenalty = 1]

[h,if(json.contains(macro.args,"hideRoll")):hideRoll = json.get(macro.args, "hideRoll");hideRoll = 0]

[h,if(isNumber(mods)==0): mods = 0]
[h,if(isNumber(targetNumber)==0): targetNumber = 0]
[h,if(isNumber(secondaryTargetNumber)==0): secondaryTargetNumber = 0]
[h,if(targetNumber==0): targetNumber = secondaryTargetNumber]
[h,if(mods==0): modsText = ""; modsText = strformat(" + %d",mods)]
[h,if(number(teamWork)==0): teamWorkText = ""; teamWorkText = strformat(" + %d (with %d assisting)",number(teamWork)*10,number(teamWork))]
[h,if(useSpec==0): useSpecText = ""; useSpecText = strformat(" + 10 (with %s spec)",specName)]
[h,if(useSpec): specMod = 10; specMod = 0]
[h,if(useLaser==0): useLaserText = ""; useLaserText = " + 10 (with laser/smartlink)"]
[h,if(useLaser): laserMod = 10; laserMod = 0]

[h,if(halveSkill): targetNumber = floor(targetNumber / 2)]
[h,if(halveSkill): halveText = " (halved)";halveText = ""]

[h:dieRoll1=1d10-1]
[h:dieRoll2=1d10-1]
[h,if(dieRoll1 == 0 && dieRoll1 != dieRoll2): dieRoll = dieRoll2; dieRoll = number(concat(string(dieRoll1),string(dieRoll2)))]
[h,if(dieRoll1 == 0 && dieRoll1 == dieRoll2): dieRollText = "00"; dieRollText = string(dieRoll)]

[h,if(dieRoll1 == dieRoll2): result = "CRITICAL "; result = ""]
[h: modifiedTN = targetNumber + mods + specMod + laserMod + number(teamWork)*10 - if(useWounds,WOUNDS*10,0) - if(useTrauma,TRAUMA*10,0) - if(useArmorPenalty,Armor_Penalty,0)]
[h,if(dieRoll <= modifiedTN): result = strformat('<font color="green">%sSUCCESS</font>',result); result = strformat('<font color="red">%sFAILURE</font>',result)]
[h,if(dieRoll <= modifiedTN): marginNum = dieRoll; marginNum = dieRoll - modifiedTN]
[h,if(dieRoll <= modifiedTN): margin = strformat('%sMargin of %s: <b>%d</b>.',if(dieRoll > 30,"<u>Excellent</u> ",""),"Success",dieRoll); margin = strformat('%sMargin of %s: <b>%d</b>.',if((dieRoll - modifiedTN) > 30,"<u>Severe</u> ",""),"Failure",dieRoll - modifiedTN)]

[h: evalDV = ""]
[h,if(length(modsDV)==0): modsDV = 0]
[h,if(modsDV==0): modsDVText = ""; modsDVText = strformat("  <small>+%s (user mod)</small>",modsDV)]
[h,if(isNumber(weapDV) != 1 && weapDV != "spc"): evalDV = floor(eval(replace(weapDV,"SOM",SOM)) + eval(replace(modsDV,"SOM",SOM)))]
[h,if(length(evalDV)==0 && weapDV != "spc"): evalDV = floor(weapDV + eval(replace(modsDV,"SOM",SOM)))]
[h,if(isNumber(weapDV) == 1 && length(evalDV)!=0): weapDV = strformat("%d+%s",weapDV,modsDV)]

[h,if(weapCheck && marginNum > 29 && marginNum < 60 && weapDV != "spc" && dieRoll <= modifiedTN): extraDV = " <small>+5 (from MoS)</small>"; extraDV = ""]
[h,if(weapCheck && marginNum > 29 && marginNum < 60 && weapDV != "spc" && dieRoll <= modifiedTN): evalDV = evalDV + 5]
[h,if(weapCheck && marginNum >= 60 && weapDV != "spc" && dieRoll <= modifiedTN): extraDV = " <small>+10 (from MoS)</small>"]
[h,if(weapCheck && marginNum >= 60 && weapDV != "spc" && dieRoll <= modifiedTN): evalDV = evalDV + 10]
[h: finalDV = strformat("%s%s%s",if(evalDV == "","<b>","<small>"),weapDV,if(evalDV != "","</small> = <b>" + evalDV + "</b>","</b>"))]
[h,if(weapCheck): weapText = strformat('<br><font color="#FF00FF">DV</font> = %s%s%s&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#FF00FF">AP</font> = <b>%s</b>',finalDV,extraDV,modsDVText,weapAP); weapText = ""]

[h,if(useWounds && WOUNDS != 0): penText = strformat(" - %d (Wounds)",WOUNDS * 10); penText = ""]
[h,if(useTrauma && TRAUMA != 0): penText = penText + strformat(" - %d (Trauma)",TRAUMA * 10)]
[h,if(useArmorPenalty && Armor_Penalty != 0): penText = penText + strformat(" - %d (Armor)",Armor_Penalty)]

[h,if(hideRoll): totalModsLine = modsText + teamWorkText + useSpecText + useLaserText + penText; totalModsLine = dieRollText+" vs. "+targetNumber + modsText + teamWorkText + useSpecText + useLaserText + penText]
[h,if(length(totalModsLine) > 0): totalModsLine = "<br><small>"+totalModsLine+"</small>.</p>"; totalModsLine = ""]
[h,if(hideRoll): rollLine = ""; rollLine = "<br>The total rolled is <b>"+dieRollText+"</b>.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Target Number is <b>"+modifiedTN+"</b>."]

<p><span bgcolor=#cccccc><b>{rollerName}</b> rolls a <i>{rollTitle}{halveText}</i>.</span>
{rollLine}
<br>Result: <b>{result}</b>.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{margin}
{weapText}
{extraText}
{totalModsLine}

!!
@@ @die10
@PROPS@ fontColor=black;autoExecute=true;fontSize=1.00em;sortBy=;color=default;playerEditable=false;applyToSelected=false;group=User-Defined Functions;tooltip=
[h,if(json.contains(macro.args,"rollTitle")):rollTitle = json.get(macro.args, "rollTitle");rollTitle = "1d10"]
[h,if(json.contains(macro.args,"MoF")):MoF = json.get(macro.args, "MoF");MoF = 0]
[h,if(json.contains(macro.args,"rollerName")):rollerName = json.get(macro.args, "rollerName");rollerName = getPlayerName()]
[h,if(json.contains(macro.args,"extraText")):extraText = json.get(macro.args, "extraText");extraText = ""]

[h:dieRoll1=1d10]
[h:dieRoll2=1d10]

[h,switch(string(dieRoll1)):
  case "1": direction = "North";
  case "2": direction = "North";
  case "3": direction = "Northeast";
  case "4": direction = "East";
  case "5": direction = "Southeast";
  case "6": direction = "South";
  case "7": direction = "South";
  case "8": direction = "Southwest";
  case "9": direction = "West";
  case "10": direction = "Northwest";
  default: res = "North"
]

[h,if(isNumber(MoF)!=1): MoF = 0]
[h: distance = dieRoll2]
[h,if(MoF > 30 && MoF < 60): distance = distance * 2]
[h,if(MoF > 60): distance = distance * 3]
[h: mofLine = ""]
[h,if(MoF > 30 && MoF < 60): mofLine = "<br/><small>MoF 30+ doubled distance</small>"]
[h,if(MoF > 60): mofLine = "<br/><small>MoF 60+ tripled distance</small>"]

<p><span bgcolor=#cccccc><b>{rollerName}</b> rolls a <i>{rollTitle}</i>.</span>
<br/>Direction: <b>{direction}</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Distance: <b>{distance} meters</b>
{extraText}
{mofLine}

!!
@@ @UseMoxie
@PROPS@ fontColor=black;autoExecute=true;fontSize=1.00em;sortBy=;color=default;playerEditable=false;applyToSelected=false;group=User-Defined Functions;tooltip=
[h,if(MOX==0): input(".|You do not have any Moxie to spend!||LABEL|SPAN=TRUE")]
[h,if(MOX==0): abort(0)]

[h,if(json.contains(macro.args,"moxOption")):moxOption = json.get(macro.args, "moxOption");moxOption = ""]
[h,if(json.contains(macro.args,"rollerName")):rollerName = json.get(macro.args, "rollerName");rollerName = getPlayerName()]

[h,switch(moxOption):
  case "1": res = "<br>Result: Ignore all negative modifiers that apply to a test. The Moxie point must be spent before dice are rolled.";
  case "2": res = "<br>Result: Flip-flop a d100 roll result. For example, an 83 would become a 38.";
  case "3": res = "<br>Result: Upgrade a success, making it a critical success, as if you rolled doubles. You must succeed in the test before you spend the Moxie point.";
  case "4": res = "<br>Result: Ignore a critical failure, treating it as a regular failure instead.";
  case "5": res = "<br>Result: Go first in an Action Phase.";
  default: res = ""
]

[h:MOX = MOX - 1]
<p><span bgcolor=#cccccc><b>{rollerName}</b> spends a Moxie point.</span>
{res}
[h: RecalcBottomSheet("Stats")]
[h, macro("SheetLoad@this"):""]

!!
@@ @BurnRep
@PROPS@ fontColor=black;autoExecute=true;fontSize=1.00em;sortBy=;color=default;playerEditable=false;applyToSelected=false;group=User-Defined Functions;tooltip=
[h,if(json.contains(macro.args,"repName")):repName = json.get(macro.args, "repName");repName = ""]
[h,if(json.contains(macro.args,"repValue")):repValue = json.get(macro.args, "repValue");repValue = 0]
[h,if(repValue==0): input(".|You do not have any "+repName+" to burn!||LABEL|SPAN=TRUE")]
[h,if(repValue==0): abort(0)]
[h,if(json.contains(macro.args,"burnChoice")):burnChoice = json.get(macro.args, "burnChoice");burnChoice = ""]
[h,if(json.contains(macro.args,"choiceOneValue")):choiceOneValue = json.get(macro.args, "choiceOneValue");choiceOneValue = ""]
[h,if(json.contains(macro.args,"choiceTwoValue")):choiceTwoValue = json.get(macro.args, "choiceTwoValue");choiceTwoValue = ""]
[h,if(json.contains(macro.args,"networkName")):networkName = json.get(macro.args, "networkName");networkName = ""]
[h,if(json.contains(macro.args,"rollerName")):rollerName = json.get(macro.args, "rollerName");rollerName = getPlayerName()]
[h,if(burnChoice=="1"),code: 
  {
    [h,if(isNumber(choiceOneValue)==0),code:
      {
        [h: input(".|Invalid input for amount of Rep to burn!||LABEL|SPAN=TRUE")]
        [h: abort(0)]
      };{}
    ]
    [h,if(number(choiceOneValue) < 1),code:
      {
        [h: input(".|Invalid input for amount of Rep to burn!||LABEL|SPAN=TRUE")]
        [h: abort(0)]
      };{}
    ]
    [h,if(number(choiceOneValue) > repValue),code:
      {
        [h: input(".|Entered Rep value to burn is more than you have!||LABEL|SPAN=TRUE")]
        [h: abort(0)]
      };{}
    ]
    [h,if(number(choiceOneValue) > 30),code:
      {
        [h: input(".|Entered Rep value to burn is greater than 30!||LABEL|SPAN=TRUE")]
        [h: abort(0)]
      };{}
    ]
  };{}
]
[h,if(burnChoice=="2" && number(choiceTwoValue) > repValue),code: 
  {
    [h: input(".|Entered Rep value to burn is more than you have!||LABEL|SPAN=TRUE")]
    [h: abort(0)]
  };{}
]

[switch(burnChoice),code:
  case "1": 
  {
    [h:setProperty(repName,repValue - number(choiceOneValue))]
    [h,if(repName=="A-Rep"): repName = "@-Rep"]
    <p><span bgcolor=#cccccc><b>{rollerName}</b> burns {choiceOneValue} {repName} points ({repValue - number(choiceOneValue)} remaining).</span>
    <br>
    Result: Adds a +{choiceOneValue} bonus to a {networkName} roll.
  }; 
  case "2": 
  {
    [h,switch(choiceTwoValue):
      case "0": favorName = "Trivial";
      case "1": favorName = "Low";
      case "5": favorName = "Moderate";
      case "10": favorName = "High";
      case "20": favorName = "Scarce"
    ]
    [h:setProperty(repName,repValue - number(choiceTwoValue))]
    [h,if(repName=="A-Rep"): repName = "@-Rep"]
    <p><span bgcolor=#cccccc><b>{rollerName}</b> burns {choiceTwoValue} {repName} points ({repValue - number(choiceTwoValue)} remaining).</span>
    <br>
    Result: Gets a {favorName} Favor.
  }
]

[h: RecalcBottomSheet("Stats")]
[h, macro("SheetLoad@this"):""]

!!
@@ @UseFavor
@PROPS@ fontColor=black;autoExecute=true;fontSize=1.00em;sortBy=;color=default;playerEditable=false;applyToSelected=false;group=User-Defined Functions;tooltip=
[h,if(json.contains(macro.args,"repName")):repName = json.get(macro.args, "repName");repName = ""]
[h,if(json.contains(macro.args,"rollerName")):rollerName = json.get(macro.args, "rollerName");rollerName = getPlayerName()]
[h,if(json.contains(macro.args,"repFavors")):repFavors = json.get(macro.args, "repFavors");repFavors = ""]

[h:allFavors = json.append("[]","1 (Trivial)","2 (Low)","3 (Moderate)","4 (High)","5 (Scarce)")]
[h:spendFavors = json.sort(json.difference(allFavors,repFavors))]
[h:choice = input(
      strformat(".|Used Favors: %s||LABEL|SPAN=TRUE ",if(json.length(repFavors)>0,json.toList(repFavors,", "),"None")),
      "pick|Use Favor,Regain Favor|Choose Option|RADIO",
      strformat("spendChoice|%s|Favor to Spend|LIST|SELECT=0 VALUE=STRING",if(json.length(spendFavors)>0,json.toList(spendFavors),"None")),
      strformat("regainChoice|%s|Favor to Regain|LIST|SELECT=0 VALUE=STRING",if(json.length(repFavors)>0,json.toList(repFavors),"None"))
)]
[h:abort(choice)]

[h,switch(pick),code:
  case 0:
  {
    [h,if(spendChoice=="None"): updateFavors = "[]"; updateFavors = json.sort(json.append(repFavors,spendChoice))]
    [h,if(json.length(updateFavors)>0): setProperty(repName+"_favors",updateFavors)]
    [h,if(repName=="A-Rep"): repName = "@-Rep"]
    [h,if(spendChoice=="None"): outStr = "";outStr = strformat("spends a Favor (<b>%s</b>)",spendChoice)]
  };
  case 1:
  {
    [h,if(regainChoice=="None"): updateFavors = "[]"; updateFavors = json.sort(json.difference(repFavors,regainChoice))]
    [h,if(regainChoice!="None"): setProperty(repName+"_favors",updateFavors)]
    [h,if(repName=="A-Rep"): repName = "@-Rep"]
    [h,if(regainChoice=="None"): outStr = "";outStr = strformat("regains a Favor (<b>%s</b>)",regainChoice)]
  }
]
[h,if(length(outStr)==0): abort(0)]
[h: RecalcBottomSheet("Stats")]
[h, macro("SheetLoad@this"):""]

<p><span bgcolor=#cccccc><b>{rollerName}</b> {outStr} for {repName}.</span><br>
Result: Has (<b>{json.toList(json.sort(json.difference(allFavors,updateFavors)),"</b>, <b>")}</b>) Favors remaining for {repName}.

!!
@@ @EditArmor
@PROPS@ fontColor=black;autoExecute=true;fontSize=1.00em;sortBy=;color=default;playerEditable=false;applyToSelected=false;group=Update;tooltip=
[h:choice = input(
      strformat("energyChoice|%s|Energy armor bonus",Armor_Energy),
      strformat("kineticChoice|%s|Kinetic armor bonus",Armor_Kinetic),
      strformat("penaltyChoice|%s|Armor penalty",Armor_Penalty)
)]
[h:abort(choice)]

[h,if(energyChoice != Armor_Energy): Armor_Energy = energyChoice]
[h,if(kineticChoice != Armor_Kinetic): Armor_Kinetic = kineticChoice]
[h,if(penaltyChoice != Armor_Penalty): Armor_Penalty = penaltyChoice]
[h: RecalcBottomSheet("Combat")]
[h, macro("SheetLoad@this"):""]

!!
@@ @KnowSpecUpdate
@PROPS@ fontColor=black;autoExecute=true;fontSize=1.00em;sortBy=;color=default;playerEditable=false;applyToSelected=false;group=User-Defined Functions;tooltip=
[h,if(json.contains(macro.args,"specName")):specName = json.get(macro.args, "specName");specName = ""]
[h,if(json.contains(macro.args,"knowName")):knowName = json.get(macro.args, "knowName");knowName = ""]

[h: status = input(
  ".|<html><b>"+knowName+"</b>|Knowledge Skill|LABEL",
  "spec|"+specName+"|Specialization"
)]
[h: abort(status)]
[h,if(spec == "0"): abort(0)]

[h: knowArray = json.get(KnowledgeSkills, knowName)]
[h: knowArray = json.set(knowArray, 4, spec)]
[h: KnowledgeSkills = json.set(KnowledgeSkills, knowName, knowArray)]

[h: RecalcBottomSheet("Skills")]
[h, macro("SheetLoad@this"):""]

!!
@@ @ActiveSpecUpdate
@PROPS@ fontColor=black;autoExecute=true;fontSize=1.00em;sortBy=;color=default;playerEditable=false;applyToSelected=false;group=User-Defined Functions;tooltip=
[h,if(json.contains(macro.args,"specName")):specName = json.get(macro.args, "specName");specName = ""]
[h,if(json.contains(macro.args,"activeName")):activeName = json.get(macro.args, "activeName");activeName = ""]

[h: status = input(
  ".|<html><b>"+activeName+"</b>|Active Skill|LABEL",
  "spec|"+specName+"|Specialization"
)]
[h: abort(status)]
[h,if(spec == "0"): abort(0)]

[h: activeArray = json.get(ActiveSkills, activeName)]
[h: activeArray = json.set(activeArray, 4, spec)]
[h: ActiveSkills = json.set(ActiveSkills, activeName, activeArray)]

[h: RecalcBottomSheet("Skills")]
[h, macro("SheetLoad@this"):""]

!!
@@ @MuseSpecUpdate
@PROPS@ fontColor=black;autoExecute=true;fontSize=1.00em;sortBy=;color=default;playerEditable=false;applyToSelected=false;group=User-Defined Functions;tooltip=
[h,if(json.contains(macro.args,"specName")):specName = json.get(macro.args, "specName");specName = ""]
[h,if(json.contains(macro.args,"museName")):museName = json.get(macro.args, "museName");museName = ""]

[h: status = input(
  ".|<html><b>"+museName+"</b>|Muse Skill|LABEL",
  "spec|"+specName+"|Specialization"
)]
[h: abort(status)]
[h,if(spec == "0"): abort(0)]

[h: museArray = json.get(MuseSkills, museName)]
[h: museArray = json.set(museArray, 4, spec)]
[h: MuseSkills = json.set(MuseSkills, museName, museArray)]

[h: RecalcBottomSheet("Muse")]
[h, macro("SheetLoad@this"):""]

!!
@@ @pause
@PROPS@ fontColor=black;autoExecute=true;fontSize=1.00em;sortBy=;color=default;playerEditable=false;applyToSelected=false;group=User-Defined Functions;tooltip=
[ toolkit.DebugVariableCount = argCount() ]
[ toolkit.DebugVariableArray = macro.args ]
[ toolkit.DebugInputParameter = ".|<html>" +
    "<table cellspacing='2' cellpadding='0' style='background-color:#595751'>" +
    "<tr><td>" +
    "<table width='300px' cellspacing='0' cellpadding='2' style='background-color:#FAF9F5;'>" +
    "%{toolkit.DebugVariableRows}</table></td></tr></html>" +
    "|Debugger|LABEL|SPAN=TRUE"
]
[ toolkit.DebugVariableRow = "<tr %{toolkit.DebugVariableRowStyle}><td>" +
    "<b>%{toolkit.DebugVariableName}</b></td><td>%{toolkit.DebugVariableContent}" +
    "</td></tr>"
]
[ toolkit.DebugVariableRows = "<tr style='background-color:#E0DDD5; font-size:1.1em;'><td><b>Variable</b></td><td><b>Value</b></td></tr>" ]
[ count( toolkit.DebugVariableCount ), code:
{
    [ toolkit.DebugVariableRowStyle = "" ]
    [ toolkit.DebugVariableName = json.get( toolkit.DebugVariableArray, roll.count ) ]
    [ toolkit.DebugVariableContent = eval( toolkit.DebugVariableName ) ]    <!-- this may not be compatible with a custom eval function (which would overwrite macro.args) -->
    [ if( floor( roll.count/2 ) == roll.count/2 ), code:
    {
        [ toolkit.DebugVariableRowStyle = "style='background-color:#EDECE8;'" ]
    } ]
    [ toolkit.DebugVariableRows = toolkit.DebugVariableRows +
        strformat( toolkit.DebugVariableRow )
    ]
} ]
[ if( toolkit.DebugVariableCount == 0 ), code:
{
    [ toolkit.DebugVariableRows = "<tr><td style='font-size: 1.4em' align='center'><b>Pause</b></td></tr>" ]
} ]

[ toolkit.DebugBreak = input( strformat( toolkit.DebugInputParameter ) )]
[ abort( toolkit.DebugBreak ) ] 

!!
@@ @AddAllToInitiative
@PROPS@ fontColor=black;autoExecute=true;fontSize=1.00em;sortBy=;color=default;playerEditable=false;applyToSelected=false;group=GM;tooltip=

[h:initGroup = getTokenNames("json",json.set("{}","layer",json.append("[]","TOKEN")))]

[h,foreach(token,initGroup,""),CODE:
{
  [h,token(token),CODE:
  {       
    [h:addToInitiative()]
    [h:dieRoll=eval("1d10")]
    [h:token.init=dieRoll+if(getProperty("INIT")=="",0,getProperty("INIT"))]
  }]
}]
[h: sortInitiative()]
[h: nextInitiative()]
[h: initJson = getInitiativeList()]
[h: tokenJson = json.get(initJson,"tokens")]
[h: speedCheck = 1]
[h,foreach(thing,tokenJson,""),CODE:
{
  [h: tokId = json.get(thing,"tokenId")]
  [h,if(getProperty("SPD",tokId) > speedCheck),CODE:
  {
    [h,token(tokId): addtoInitiative(1,0)]
  }]
}]
[h: speedCheck = 2]
[h,foreach(thing,tokenJson,""),CODE:
{
  [h: tokId = json.get(thing,"tokenId")]
  [h,if(getProperty("SPD",tokId) > speedCheck),CODE:
  {
    [h,token(tokId): addtoInitiative(1,0)]
  }]
}]
[h: speedCheck = 3]
[h,foreach(thing,tokenJson,""),CODE:
{
  [h: tokId = json.get(thing,"tokenId")]
  [h,if(getProperty("SPD",tokId) > speedCheck),CODE:
  {
    [h,token(tokId): addtoInitiative(1,0)]
  }]
}]

All Tokens added to Initiative!

!!
@@ @PsiSleightsUse
@PROPS@ fontColor=black;autoExecute=true;fontSize=1.00em;sortBy=;color=default;playerEditable=false;applyToSelected=false;group=GM;tooltip=
[h: rollerName = json.get(macro.args, 0)]
[h: psiName = json.get(macro.args, 1)]
[h: psiDetails = json.get(macro.args, 2)]
[h: psiStrain = json.get(macro.args, 3)]
[h: psiStrainType = json.get(macro.args, 4)]
[h: hasSiphon = json.contains(PsiSleights,"Siphon (Chi)")]
[h: hasEfficiency = json.contains(PsiSleights,"Psi Efficiency (Chi)")]
[h,if(psiStrainType == "DV"): strainTypePick = 0;strainTypePick = 1]

[h:choice = input(
    strformat(".|%s||LABEL|SPAN=TRUE","Psi Power: " + psiName),
    strformat(".|%s||LABEL|SPAN=TRUE","Psi Strain: " + psiStrain),
    if(hasSiphon,
       strformat("strainTypePick|Damage (DV),Stress (SV)|Choose Strain Type|RADIO|SELECT=%d",if(psiStrainType == "DV",0,1)),
       strformat(".|%s||LABEL|SPAN=TRUE",if(psiStrainType == "DV","Damage (DV)","Stress (SV)"))),
    "isPrivate|0|Private|CHECK"
)]
[h:abort(choice)]

[h,if(psiStrain != "0"): theRoll = ceiling(eval(psiStrain)); theRoll = -1]
[h,if(hasEfficiency && theRoll > 0): theRoll = theRoll - 1]
[h: formulaLine = "<br/><small>Strain = " + psiStrain + if(hasEfficiency," -1 Psi Efficiency","") + "</small>"]

[h: psiStrainText = "None"]
[h: hurtLine = ""]

[h,if(strainTypePick == 0 && theRoll > 0),code:
  {
    [h: psiStrainText = "Damage (DV)"]
    [h: DAMAGE = DAMAGE + theRoll]
    [h: oldWounds = WOUNDS]
    [h,if(theRoll >= WT && theRoll < WT*2): WOUNDS = WOUNDS + 1]
    [h,if(theRoll >= WT*2 && theRoll < WT*3): WOUNDS = WOUNDS + 2]
    [h,if(theRoll >= WT*3 && theRoll < WT*4): WOUNDS = WOUNDS + 3]
    [h,if(theRoll >= WT*4 && theRoll < WT*5): WOUNDS = WOUNDS + 4]
    [h,if(oldWounds != WOUNDS): hurtLine = "<br/>Suffers <b>" + WOUNDS - oldWounds + "</b> Wound(s) from the excess Psi Strain!"]
  };{}
]
[h,if(strainTypePick == 1 && theRoll > 0),code:
  {
    [h: psiStrainText = "Stress (SV)"]
    [h: STRESS = STRESS + theRoll]
    [h: oldTrauma = TRAUMA]
    [h,if(theRoll >= TT && theRoll < TT*2): TRAUMA = TRAUMA + 1]
    [h,if(theRoll >= TT*2 && theRoll < TT*3): TRAUMA = TRAUMA + 2]
    [h,if(theRoll >= TT*3 && theRoll < TT*4): TRAUMA = TRAUMA + 3]
    [h,if(theRoll >= TT*4 && theRoll < TT*5): TRAUMA = TRAUMA + 4]
    [h,if(oldTrauma != TRAUMA): hurtLine = "<br/>Suffers <b>" + TRAUMA - oldTrauma + "</b> Trauma(s) from the excess Psi Strain!"]
  };{}
]

[h: RecalcBottomSheet("Combat")]
[h, macro("SheetLoad@this"):""]

[h: jsonData = json.append("[]",rollerName,psiName,theRoll,psiStrainText,hurtLine,formulaLine)]
[h: link = macroLinkText("PsiSleightsUseOutput@this",if(isPrivate,if(isGM() == 1,"gm","gm-self"),"all"),jsonData,currentToken())]
[r: execLink(link)]

!!
@@ @PsiSleightsUseOutput
@PROPS@ fontColor=black;autoExecute=true;fontSize=1.00em;sortBy=;color=default;playerEditable=false;applyToSelected=false;group=GM;tooltip=
[h: argz = macro.args]

<p><span bgcolor=#cccccc><b>[r:json.get(argz,0)]</b> uses Psi Sleight: <i>[r:json.get(argz,1)]</i>.</span>
<br/>Strain: <b>[r:json.get(argz,2)]</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Strain Type: <b>[r:json.get(argz,3)]</b>
[r:json.get(argz,4)]
[r:json.get(argz,5)]

!!